<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

  <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:;">

  <title>Noir搓的小手机</title>
  <style>
    .message p,
    .diary-content {
      user-select: none;
      -webkit-user-select: none;
    }

    .lt-end-session-btn {
      font-size: 1.5rem;
      color: inherit;
      /* 继承父元素的颜色 */
      opacity: 0.6;
      cursor: pointer;
      padding: 0 5px;
      line-height: 1;
      font-weight: bold;
    }

    .lt-end-session-btn:hover {
      opacity: 1;
    }

    /* --- Noir's Refactor: Feed Loader Style --- */
    #feed-loader {
      position: absolute;
      inset: 0;
      background: rgba(244, 248, 255, 0.85);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      color: var(--text-color);
      font-size: 1rem;
      flex-direction: column;
      gap: 10px;
    }

    .loader-spinner {
      width: 24px;
      height: 24px;
      border: 3px solid var(--border-color);
      border-top-color: var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    /* --- End of Refactor --- */
    /*
        Noir's Mizuiro Theme
        - 哼，看好了，这才是设计。
      */
    /*
          Noir's Mizuiro Theme
          - 哼，看好了，这才是设计。
        */
    :root {
      --phone-width: 375px;
      --phone-height: 812px;
      --user-bg-image: url('');

      /* === Noir's Ultimate Dynamic Theme Engine v2.0 === */
      /* 哼，现在所有的颜色都听从这三个总开关的指挥。*/
      --primary-hue: 35;
      --primary-saturation: 25%;
      --primary-lightness: 80%;

      /* 核心颜色 */
      --primary-color: hsl(var(--primary-hue), var(--primary-saturation), var(--primary-lightness));
      /* 强调色/用户气泡色，现在也是动态的 */
      --accent-color: hsl(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%));

      /* 哼，看好了，这些就是被我重新接上线的“电灯” */

      /* 文字颜色：根据主题亮度自动变深或变浅 */
      --text-color: hsl(var(--primary-hue), 15%, calc(100% - var(--primary-lightness) / 1.1));
      --text-color-light: hsl(var(--primary-hue), 10%, calc(100% - var(--primary-lightness) / 1.3));

      /* 表面背景：半透明，亮度比主色高一点 */
      --surface-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.4);

      /* 卡片/AI气泡背景：比表面背景更亮一点 */
      --card-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.5);

      /* 边框颜色 */
      --border-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness)), 0.3);

      /* 阴影颜色 */
      --soft-shadow: 0 4px 12px hsla(var(--primary-hue), 40%, calc(var(--primary-lightness) - 10%), 0.15);

      /* 动态页的设置保持不变 */
      --feed-bg-image: none;
      --feed-overlay-opacity: 0.12;
      --feed-overlay-rotate: 22deg;
      --feed-overlay-speed: 48s;

      /* 气泡样式也完全动态化 */
      --bubble-radius: 18px;
      --bubble-outline: hsla(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) + 10%), 0.5);
      --bubble-user-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%), 0.5);
      /* <-- 哼，改成0.5，现在够“虚无”了吧 */
      --bubble-ai-bg: var(--card-bg);

      /* ▼▼▼ 把下面这两行加进去 ▼▼▼ */
      --dropdown-alpha: 0.9;
      /* 下拉菜单的透明度，0到1 */
      --feed-card-alpha: 0.7;
      /* 动态卡片的透明度，0到1 */


      /* ▲▲▲ 添加到这里结束 ▲▲▲ */

    }

    body {
      display: flex;
      align-items: center;
      /* <-- 加上这句 */
      justify-content: center;
      /* <-- 还有这句 */
      height: 100vh;
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
    }

    #phone-container {
      width: 100%;
      /* 占满屏幕宽度 */
      height: 100vh;
      /* 占满屏幕高度 */
      background-color: white;
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      /* 是不是清爽多了？ */
      position: relative;
      /* <-- 就是这句，告诉它“你是个家长了，给我看好家里的东西！” */
    }

    .screen {
      flex-grow: 1;
      display: none;
      flex-direction: column;
      background-color: #f9f9f9;
      /* 哼，所有屏幕默认都给我变白 */
      /* 让背景透出来 */
      overflow: hidden;
      color: var(--text-color);
    }

    .screen.active {
      display: flex;
    }

    /* 这个是通用的头像预览样式 */
    .avatar-preview {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--border-color);
      margin-top: 5px;
      cursor: pointer;
    }

    /* --- 通用顶栏 --- */
    .header,
    #chat-list-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background-color: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border-bottom: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    .header-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-color);
    }

    .header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: var(--primary-color);
      font-weight: 500;
      min-width: 50px;
      text-align: center;
      /* ▼▼▼ 哼，加上这三句，给我立正站好 ▼▼▼ */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- 聊天列表 --- */
    #chat-list-pane {
      background-color: transparent;
      border-right: 1px solid var(--border-color);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 加上这句 */
      width: 100%;
      height: 100%;
      flex-shrink: 0;
      /* 防止它在横向布局里被挤扁 */
      display: flex;
      flex-direction: column;
    }

    #chat-list-container {
      flex-grow: 1;
      flex-grow: 1;
      overflow-y: auto;
      padding: 10px;
    }

    #character-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .character-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      /* backdrop-filter: blur(10px);*/
      border-radius: 16px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.5);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .character-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(138, 180, 228, 0.2);
    }

    .char-info-wrapper {
      flex-grow: 1;
      cursor: pointer;
      display: flex;
      align-items: center;
      overflow: hidden;
    }

    .character-item .char-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      margin-right: 12px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .character-item .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .character-item .char-remark {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    #chat-screen-container {
      position: relative;
      /* 告诉里面的绝对定位元素，要以我为基准 */
      flex-grow: 1;
      /* 确保它能撑满 chat-screen 的空间 */
      overflow: hidden;
      /* 把滑出去的部分藏起来，这很重要 */
      display: flex;
      /* 保持内部元素的 flex 布局 */
    }

    /* --- 聊天窗口 --- */


    #chat-view-pane {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      transform: translateX(100%);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 还有这句 */
      background-color: transparent;
      z-index: 10;
    }

    #chat-screen.show-chat-view #chat-list-pane {
      transform: translateX(-100%);
    }

    #chat-screen.show-chat-view #chat-view-pane {
      transform: translateX(0);
    }

    #chat-messages {
      flex-grow: 1;
      padding: 5px;
      overflow-y: auto;
      display: flex;
      /* <-- 加上这个 */
      flex-direction: column;
      /* <-- 还有这个 */
      contain: content;
      contain: content;
      /* <-- 哼，就是这句救命神药！ */
    }



    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 10px;
      object-fit: cover;
      border: 2px solid rgba(255, 255, 255, 0.7);
      flex-shrink: 0;
    }

    .message {
      padding: 10px 16px;
      border-radius: 20px;
      line-height: 1.5;
      word-break: break-word;
      box-shadow: var(--soft-shadow);
    }

    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
    }

    .message.user {
      background-color: var(--accent-color);
      color: white;
      border-bottom-right-radius: 5px;
    }

    .message.ai {
      background-color: var(--card-bg);
      border: 1px solid rgba(255, 255, 255, 0.8);
      color: var(--text-color);
      border-bottom-left-radius: 5px;
    }

    .message p {
      margin: 0;
    }

    .sticker-content,
    .message-image-content {
      max-width: 120px;
      border-radius: 8px;
      object-fit: cover;
      cursor: pointer;
    }

    .message-image-content {
      max-width: 160px;
    }

    /* --- 其他屏幕和组件 --- */
    /* --- Noir's Fix: API 模型列表的样式修正 --- */
    .model-input-container {
      position: relative;
      /* 关键！让里面的绝对定位元素有家可回 */
      display: flex;
      gap: 8px;
    }

    .custom-model-dropdown {
      display: none;
      /* 默认藏起来 */
      position: absolute;
      top: 100%;
      /* 精准定位到输入框正下方 */
      left: 0;
      right: 80px;
      /* 留出“获取”按钮的位置 */
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*   backdrop-filter: blur(10px);*/
      border: 1px solid var(--border-color);
      border-radius: 8px;
      margin-top: 4px;
      max-height: 180px;
      overflow-y: auto;
      z-index: 100;
      /* 确保它在最上层 */
      box-shadow: var(--soft-shadow);
    }

    .checkboxes-container {
      display: none;
      position: absolute;
      left: 0;
      right: 0;
      top: 100%;
      max-height: 150px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*  backdrop-filter: blur(10px);*/
      z-index: 10;
      border-radius: 8px;
      margin-top: 4px;
    }

    .custom-model-dropdown.show {
      display: block;
      /* 需要的时候再显示 */
    }

    .custom-model-dropdown div {
      padding: 10px 12px;
      cursor: pointer;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    .custom-model-dropdown div:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    /* --- 其他屏幕和组件 --- */
    /* 在这个注释下面加上主屏幕的样式 */
    #home-screen {
      position: relative;
      /* <-- 就加上这一行！ */


      gap: 20px;
      /* 图标之间的距离 */

      /* 声明！这里现在是我的地盘！*/
      flex-direction: column;
      /* 里面的东西，全体给我垂直排队！*/
      justify-content: space-between;
      /* 核心！顶部和底部的元素给我贴边站好，中间的自动拉开距离！*/
      padding-bottom: 0;
      /* 把内边距去掉，让Dock栏能完美贴底 */
    }

    .app-icon {
      width: 75px;
      /* <--- 就是这里，我把它加宽了 */
      height: 90px;
      /* <--- 高度也顺便调整一下 */
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      position: absolute;
      z-index: 40;
      padding: 5px;
      box-sizing: border-box;
      margin: 0;
    }

    .app-icon-img {
      width: 58px;
      height: 58px;
      border-radius: 22.5%;
      margin-bottom: 2px;
      /* <-- 哼，就是这里，把5px改成2px，让图标和文字的距离拉近一点 */
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 28px;
      background-color: var(--surface-bg);
      box-shadow: none;
      transition: transform 0.2s ease;
    }

    .app-icon-img svg {
      stroke: currentColor;
      /* SVG的线条颜色会继承上面的 color */
    }

    .app-icon span {
      font-size: 0.75rem;
      /* 文本也相应缩小 */
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      width: 100%;
    }

    .content {
      padding: 20px;
      overflow-y: auto;
      flex-grow: 1;
      /* <-- 加上这行代码，就是这行！ */
    }

    .form-button {
      width: 100%;
      padding: 12px;
      border: none;
      background-color: var(--primary-color);
      color: white;
      border-radius: 8px;
      font-size: 1.1rem;
      cursor: pointer;
      margin-top: 10px;
    }

    input,
    textarea,
    select {
      width: 100%;
      padding: 10px;
      box-sizing: border-box;
      background-color: rgba(255, 255, 255, 0.8);
      border: 1px solid var(--border-color);
      color: var(--text-color);
      border-radius: 8px;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    .chat-toolbar {
      display: flex;
      padding: 5px 10px;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      /*   backdrop-filter: blur(10px);*/
      flex-shrink: 0;
    }

    /* ▼▼▼ 用下面这段，替换掉你旧的 .toolbar-button 样式 ▼▼▼ */
    .toolbar-button {
      background: none;
      border: none;
      font-size: 1.5rem;
      /* 这个保留，作为SVG尺寸的参考 */
      cursor: pointer;
      padding: 8px;
      /* 稍微增大点击区域 */
      color: var(--text-color-light);
      /* 让它默认是浅灰色 */
      border-radius: 50%;
      /* 让背景有个圆形轮廓 */
      width: 40px;
      height: 40px;
      display: flex;
      /* 使用flex布局让SVG完美居中 */
      align-items: center;
      justify-content: center;
      transition: background-color 0.2s, color 0.2s;
      /* 加上顺滑的过渡效果 */
    }

    .toolbar-button:hover {
      background-color: var(--border-color);
      /* 鼠标悬停时给个背景 */
      color: var(--primary-color);
      /* 图标颜色变为主题色 */
    }

    /* ▲▲▲ 替换到这里为止 ▲▲▲ */


    /* ▼▼▼ 在下面新增这段SVG的专属样式 ▼▼▼ */
    .toolbar-button svg {
      width: 22px;
      /* SVG图标的尺寸 */
      height: 22px;
      stroke-width: 1.8;
      /* 线条粗细，可以微调 */
      stroke: currentColor;
      /* 核心！让SVG的颜色继承按钮的color属性 */
      fill: none;
      /* 确保是线稿风格 */
      pointer-events: none;
      /* 防止SVG本身干扰点击事件 */
    }

    /* ▲▲▲ 新增到这里为止 ▲▲▲ */

    .sticker-panel {
      display: none;
      grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
      gap: 10px;
      padding: 10px;
      height: 200px;
      overflow-y: auto;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      flex-shrink: 0;
    }

    .sticker-panel.show {
      display: grid;
    }

    /* --- 输入区域 --- */
    /* --- 输入区域 --- */
    .chat-input-area {
      padding: 10px 12px calc(env(safe-area-inset-bottom, 0px) + 10px);
      background: var(--surface-bg);
      /*  backdrop-filter: saturate(1.2) blur(10px);*/
      border-top: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    /* 这是我加的新容器，用来实现完美对齐 */
    #chat-input-wrapper {
      display: flex;
      /* Flex大法好，哼 */
      align-items: center;
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 24px;
      padding: 2px 5px;
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-input-wrapper:focus-within {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-message-input {
      flex-grow: 1;
      /* 让输入框占满剩余空间 */
      border: none;
      background: transparent;
      padding: 9px 12px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 38px;
      width: 38px;
      border: 0;
      border-radius: 50%;
      font-size: 1.2rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
      flex-shrink: 0;
      /* 防止被挤压 */
      margin-left: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    /* 回复按钮，给个不一样的颜色区分 */
    #chat-get-reply-button {
      background: var(--accent-color);
      font-size: 1.5rem;
      /* 让箭头更清晰 */
    }

    #chat-message-input {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 20px;
      padding: 11px 16px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-message-input:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 40px;
      padding: 0 18px;
      border: 0;
      border-radius: 20px;
      font-size: .95rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    #chat-get-reply-button {
      display: flex;
      /* 隐藏旧的回复按钮，样式统一到发送按钮 */
    }


    /* --- 引用样式 --- */
    .quote-preview {
      display: none;
      padding: 8px 12px;
      background-color: rgba(255, 255, 255, 0.5);
      border-left: 3px solid var(--primary-color);
      margin: 0 12px 8px;
      border-radius: 6px;
      position: relative;
    }

    #quote-preview-sender {
      font-weight: 600;
      font-size: 0.85rem;
      color: var(--primary-color);
    }

    #quote-preview-text {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    .cancel-quote-btn {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      background: none;
      border: none;
      font-size: 1.5rem;
      color: #999;
      cursor: pointer;
    }

    .quoted-message-in-bubble {
      background-color: rgba(0, 0, 0, 0.04);
      padding: 8px 10px;
      border-left: 3px solid var(--border-color);
      border-radius: 8px;
      margin-bottom: 6px;
    }

    .quoted-sender {
      font-weight: bold;
      font-size: 0.8rem;
      color: var(--text-color);
    }

    .quoted-content {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    /* 这是弹窗的“骨架”，让它能居中浮动在屏幕上 */
    .choice-modal {
      position: fixed;
      inset: 0;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s ease, visibility 0.2s ease;
    }

    .choice-modal.show {
      opacity: 1;
      visibility: visible;
    }


    /* --- 弹窗 --- */
    .choice-modal-backdrop {
      background: rgba(0, 0, 0, 0.2);
      /*  backdrop-filter: blur(4px);*/
    }

    .choice-modal-content {
      background: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border: 1px solid rgba(255, 255, 255, 0.5);
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .choice-modal-button {
      color: var(--text-color);
      background: rgba(255, 255, 255, 0.5);
    }

    .choice-modal-button:hover {
      background-color: rgba(255, 255, 255, 1);
    }

    .choice-modal-button.cancel {
      color: var(--primary-color);
      background: transparent;
    }

    /* --- Noir's Fix: 让“添加”弹窗从底部滑出，更大气 --- */
    #add-choice-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      /* 确保不会超出手机宽度 */
      margin: 0;
      border-radius: 20px 20px 0 0;
      /* 只留顶部圆角 */
      border-bottom-left-radius: 0;
      /* 覆盖通用样式 */
      border-bottom-right-radius: 0;
      /* 覆盖通用样式 */
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      /* 适配iPhone底部安全区 */
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #add-choice-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #add-choice-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
      justify-content: center;
    }

    /* 按钮也重新设计一下，让它们竖着排 */
    #add-choice-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- Noir's Fix: 修正创建群聊时，成员选择列表的样式 --- */
    .member-selection-item {
      display: flex;
      align-items: center;
      padding: 10px 15px;
      border-bottom: 1px solid var(--border-color);
    }

    .member-selection-item:last-child {
      border-bottom: none;
    }

    /* 关键！就是这里，把头像大小锁死 */
    .member-selection-item .char-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 15px 0 10px;
      object-fit: cover;
    }

    .member-selection-item .char-name {
      font-weight: 500;
      color: var(--text-color);
    }

    .member-selection-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      accent-color: var(--primary-color);
      /* 让勾选框颜色也跟主题统一 */
    }

    /* --- Noir's World Book Styles --- */
    #world-book-list-container {
      padding: 10px;
    }

    .world-book-item {
      background-color: var(--card-bg);
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 10px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .world-book-item-name {
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 5px;
    }

    .world-book-item-preview {
      font-size: 0.9rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* --- Noir's Fancy Multi-Select Styles --- */
    .custom-multiselect {
      position: relative;
      user-select: none;
    }

    .select-box {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.8);
      border-radius: 8px;
      padding: 10px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .select-box.expanded .arrow {
      transform: rotate(180deg);
    }


    .checkboxes-container.visible {
      display: block;
    }

    .checkboxes-container label {
      display: block;
      padding: 10px 12px;
    }

    .checkboxes-container label:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    .checkboxes-container input[type="checkbox"] {
      margin-right: 8px;
      width: auto;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Clock & Timestamp Styles --- */
    /* --- Noir's Badge & App Dock Styles --- */
    #decorative-badge {
      width: 160px;
      height: 160px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.25));
      /* 哼，给你加个阴影，看起来才像样 */
      transform: rotate(-0deg);
      /* 稍微歪一点，显得随意 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      /* 防止拖动时选中图片 */
      z-index: 50;
    }

    #decorative-badge:active {

      transform: rotate(-2deg) scale(1.05);
      /* 抓起来的时候，摆正放大一点 */
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }


    #decorative-badge img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      /* 保留这句，让你的图片能被很好地填充 */
    }

    /*  #a#app-dock-bottom-left,
    #app-dock-top-right {
      
      哼，现在你们只是幽灵了。
      不需要任何样式，你们的孩子（App图标）会自己找到回家的路。
      它们会相对于 #home-screen 定位。
    
    }
*/

    /* --- Noir's Author Mark: Pixel Chicken --- */
    /* 哼，这就是那个吵着要加的小鸡图标 */
    #noir-author-mark {
      position: absolute;
      /* 相对于父容器定位 */
      right: -30px;
      /* 调整它在时钟右边的位置 */
      top: 50%;
      /* 垂直居中 */
      transform: translateY(-50%);
      /* 精确对齐 */
      width: 20px;
      /* 小鸡的尺寸 */
      height: 20px;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="0"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zM12 4c.69 0 1.25.56 1.25 1.25S12.69 6.5 12 6.5s-1.25-.56-1.25-1.25S11.31 4 12 4zm0 2c-.69 0-1.25.56-1.25 1.25S11.31 8.5 12 8.5s1.25-.56 1.25-1.25S12.69 6 12 6zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 9.75 10 9.75s1.25-.56 1.25-1.25S10.69 8 10 8zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 9.75 12 9.75s1.25-.56 1.25-1.25S12.69 8 12 8zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 9.75 14 9.75s1.25-.56 1.25-1.25S14.69 8 14 8zM10 10c-.69 0-1.25.56-1.25 1.25S9.31 12.5 10 12.5s1.25-.56 1.25-1.25S10.69 10 10 10zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 12.5 12 12.5s1.25-.56 1.25-1.25S12.69 10 12 10zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 12.5 14 12.5s1.25-.56 1.25-1.25S14.69 10 14 10zM12 12c-.69 0-1.25.56-1.25 1.25S11.31 14.5 12 14.5s1.25-.56 1.25-1.25S12.69 12 12 12zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 15.75 10 15.75s1.25-.56 1.25-1.25S10.69 14 10 14zm4 0c-.69 0-1.25.56-1.25 1.25S13.31 15.75 14 15.75s1.25-.56 1.25-1.25S14.69 14 14 14zM12 16c-.69 0-1.25.56-1.25 1.25S11.31 18.5 12 18.5s1.25-.56 1.25-1.25S12.69 16 12 16zM6 10c-.69 0-1.25.56-1.25 1.25S5.31 12.5 6 12.5s1.25-.56 1.25-1.25S6.69 10 6 10zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 12.5 18 12.5s1.25-.56 1.25-1.25S18.69 10 18 10zM12 20c-.69 0-1.25.56-1.25 1.25S11.31 22.5 12 22.5s1.25-.56 1.25-1.25S12.69 20 12 20zM6 14c-.69 0-1.25.56-1.25 1.25S5.31 15.75 6 15.75s1.25-.56 1.25-1.25S6.69 14 6 14zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 15.75 18 15.75s1.25-.56 1.25-1.25S18.69 14 18 14z"/></svg>');
      /* 这是SVG小鸡的Data URI，白色像素风格 */
      background-size: contain;
      background-repeat: no-repeat;
      cursor: pointer;
      /* 提示可点击 */
      opacity: 0.6;
      /* 稍微透明一点，不那么突兀 */
      transition: opacity 0.2s ease-in-out;
      /* 鼠标悬停效果 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    #noir-author-mark:hover {
      opacity: 1;
      /* 鼠标悬停时完全显示 */
    }

    /* 调整时钟容器，为小鸡留出空间并方便定位 */
    .home-clock-container {
      position: relative;
      /* 确保小鸡能相对它定位 */
      /* ... (保留你已有的其他时钟样式) ... */
      padding-right: 40px;
      /* 给小鸡留出一些右边距 */
    }

    #home-clock-container {
      color: white;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
      text-align: center;
      position: absolute;
      /* top, left, right 都被我删了，哼，现在它完全听JS的指挥 */

      /* 这行可以留着，虽然你已经不让它拖了 */
      z-index: 50;
    }

    #home-time {
      font-size: 80px;
      font-weight: 360;
      /* <--- 我把字重从200加到了300，比原来粗，但又不会笨重，这才是高级感。 */
      letter-spacing: -1px;
      /* <--- 字间距也给你调紧了一点，看起来更整体。 */
    }

    #home-date {
      font-size: 1rem;
      /* <--- 稍微缩小一点，让时间更突出 */
      font-weight: 400;
      margin-top: 8px;
      opacity: 0.8;
      text-transform: uppercase;
      /* <--- 日期我给你换成了全大写，这才有那股‘性冷淡’的味道。 */
      letter-spacing: 1px;
      /* <--- 顺便拉开一点点间距，免得挤在一起。 */
    }

    /* 聊天气泡时间戳的样式 */
    .timestamp {
      font-size: 0.7rem;
      color: var(--text-color-light);
      padding: 0 5px;
      margin-bottom: 3px;
      /* 让它和气泡底部对齐 */
    }

    /* 第一段：这是消息容器的基础样式 */
    .message-container {
      display: flex;
      /* 启用flex布局 */
      flex-direction: column;
      /* 让气泡和时间戳垂直排列 */
      margin-bottom: 10px;
      max-width: 85%;
      /* 限制整个容器的最大宽度 */
    }

    /* 第二段：这是根据发言者进行左右对齐的样式 */
    .message-container.user {
      align-self: flex-end;
      /* 让用户方整个容器靠右 */
      align-items: flex-end;
      /* 让容器内部的元素（气泡、时间戳）也靠右 */
    }

    .message-container.ai {
      align-self: flex-start;
      /* 让AI方整个容器靠左 */
      align-items: flex-start;
      /* 让容器内部的元素（气泡、时间戳）也靠左 */
    }

    .message-bubble-row {
      display: flex;
      align-items: flex-end;
      width: 100%;
    }

    .message-container.user .message-bubble-row {
      justify-content: flex-end;
    }

    .message-container.ai .message-bubble-row {
      justify-content: flex-start;
    }



    /* 这是给表情选择面板里，每一个小表情图片用的样式 */
    .sticker-item {
      width: 100%;
      /* 自动填满网格单元格的宽度 */
      aspect-ratio: 1 / 1;
      /* 保持1:1的宽高比，让它变成正方形 */
      object-fit: cover;
      /* 图片会被裁剪以适应正方形，不变形 */
      border-radius: 8px;
      /* 加个小圆角 */
      cursor: pointer;
      transition: transform 0.15s ease;
    }

    .sticker-item:hover {
      transform: scale(1.1);
      /* 鼠标放上去时稍微放大，增加交互感 */
    }

    /* --- Noir's Offline Scene Styles --- */
    #meeting-scene-view {
      flex-grow: 1;
      /* <-- 核心：让它占满所有可用空间 */
      overflow-y: auto;
      /* <-- 核心：内容多了就内部滚动 */
      padding: 20px;
      font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif;
      background-size: cover;
      background-position: center;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.7);
    }

    #chat-view-pane.offline-mode #offline-scene-view {
      display: block;
      /* 在线下模式时显示 */
    }

    #chat-view-pane.offline-mode #chat-messages {
      display: none;
      /* 在线下模式时隐藏气泡聊天 */
    }

    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      /* 保留换行和空格，这对于小说格式至关重要 */
      font-size: 1rem;
    }

    /* --- Noir's Offline Scene Dialogue Box Style --- */
    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      font-size: 1rem;

      /* <--- Noir's Addition: 为对话框添加半透明背景和内边距 */
      background-color: rgba(0, 0, 0, 0.4);
      /* 半透明黑色背景 */
      padding: 15px 20px;
      /* 内边距，让文字与边框有距离 */
      border-radius: 8px;
      /* 圆角边框，更柔和 */
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      /* 轻轻的阴影，增加立体感 */
    }

    #offline-scene-view .narrator {
      color: #d1d5db;
      /* 旁白用浅灰色 */
      font-style: italic;
    }

    #offline-scene-view .speaker-user {
      color: #a7c7e7;
      /* 用户的发言用一种柔和的蓝色 */
      font-weight: bold;
    }

    #offline-scene-view .speaker-ai {
      color: #f2b7c6;
      /* AI的发言用柔和的粉色，形成对比 */
      font-weight: bold;
    }

    /* --- Noir's Typing Indicator Style --- */
    .typing-indicator {
      padding: 10px 15px;
      color: var(--text-color-light);
      font-style: italic;
      font-size: 0.9rem;
      align-self: flex-start;
      /* 让它和AI气泡一样靠左 */
      margin-left: 50px;
      /* 和AI气泡对齐 */
    }

    #offline-scene-view .typing-indicator {
      color: rgba(255, 255, 255, 0.8);
      /* 在暗色背景下用亮色 */
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
      /* 同样的文字阴影，保持队形 */
      padding: 10px 0;
      margin-left: 0;
      /* 在小说视图里不需要缩进 */
    }

    /* --- Noir's Final Alignment Fix --- */
    .message-container.ai .timestamp {
      /* 哼，给你加上头像宽度(40px) + 左右边距(10px)的距离 */
      margin-left: 50px;
    }

    .message-container.user .timestamp {
      /* 另一边也是一样，真是麻烦死了 */
      margin-right: 50px;
    }

    /* --- Noir's Music Feed & Player Styles --- */
    #music-feed-container {
      padding-bottom: 70px;
      contain: content;
      /* 为底部播放器留出空间 */
    }

    /* 动态页：默认白底；如设置 --feed-bg-image 则显示独立壁纸 + 轻动画叠层 */
    #music-screen {
      background-color: #fff;
      /* 默认白底 */
      background-image: var(--feed-bg-image);
      /* 单独壁纸，不设就是 none */
      background-size: cover;
      background-position: center;
      contain: paint;
      /* 降低重绘范围，省电 */
    }

    /* 轻动画彩雾叠层：仅图层，不拦点击 */
    #music-screen::before {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background-image:
        conic-gradient(from var(--feed-overlay-rotate),
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 0%,
          transparent 20%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 40%,
          transparent 60%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 80%,
          transparent 100%);
      transform: translateZ(0);
      animation: feed-pan var(--feed-overlay-speed) linear infinite;
    }

    /* 超慢速平移旋转，基本不占 GPU */
    @keyframes feed-pan {
      0% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }

      50% {
        transform: translate3d(1.2%, 0.8%, 0) rotate(2deg) scale(1.02);
      }

      100% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }
    }

    /* 系统降低动画偏好时，自动停掉动画 */
    @media (prefers-reduced-motion: reduce) {
      #music-screen::before {
        animation: none;
      }
    }


    .music-post {
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), var(--feed-card-alpha));
      border-radius: 12px;
      margin-bottom: 15px;
      box-shadow: var(--soft-shadow);
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .music-post-header {
      display: flex;
      align-items: center;
      padding: 12px 15px;
    }

    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
    }

    .music-post-header .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .music-post-thought {
      padding: 0 15px 15px;
      font-size: 0.95rem;
      line-height: 1.6;
      white-space: pre-wrap;
    }

    .music-post-song-card {
      display: flex;
      align-items: center;
      background-color: rgba(0, 0, 0, 0.04);
      padding: 12px 15px;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .music-post-song-card:hover {
      background-color: rgba(0, 0, 0, 0.08);
    }

    .music-post-song-card img {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 12px;
    }

    .music-post-song-info {
      flex-grow: 1;
    }

    .music-post-song-info .title {
      font-weight: 500;
      color: var(--text-color);
    }

    .music-post-song-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    .music-post-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
    }

    #music-player-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 65px;
      background: var(--surface-bg);
      /*backdrop-filter: blur(10px);*/
      border-top: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      padding: 0 10px;
      transform: translateY(100%);
      transition: transform 0.3s ease;
    }

    #music-player-bar:not(.hidden) {
      transform: translateY(0);
    }

    #music-player-bar.hidden {
      display: none;
      /* 彻底隐藏，避免交互问题 */
    }


    #player-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
    }

    #player-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #player-title,
    #player-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #player-title {
      font-weight: 500;
    }

    #player-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #player-controls button {
      background: none;
      border: 2px solid var(--text-color);
      border-radius: 50%;
      width: 36px;
      height: 36px;
      font-size: 1rem;
      cursor: pointer;
      color: var(--text-color);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- Noir's Music Share Bubble Styles --- */
    .message.music {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
      max-width: 250px;
      /* 限制一下最大宽度 */
    }

    .music-share-card {
      display: flex;
      align-items: center;
      background-color: var(--card-bg);
      border-radius: 12px;
      padding: 12px;
      cursor: pointer;
      transition: background-color 0.2s ease;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
    }

    .message-container.user .music-share-card {
      background-color: var(--accent-color);
      border: 1px solid rgba(255, 255, 255, 0.4);
    }

    .message-container.user .music-share-card .title,
    .message-container.user .music-share-card .artist,
    .message-container.user .music-share-card .play-icon {
      color: white;
    }


    .music-share-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
      flex-shrink: 0;
    }

    .music-share-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-share-info .title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #music-screen {
      position: relative;
      /* 就是这句，告诉里面的绝对定位元素，以我为界！ */
    }

    /* --- Noir's Fancy Music Widget Styles --- */
    /* --- Noir's Music System Refactor --- */

    #music-widget:not(.hidden) {
      transform: translateY(0);
      /* 不隐藏时，滑上来 */
    }

    #music-widget.hidden {
      transform: translateY(150%);
      /* 隐藏时，滑下去 */
    }

    .widget-vinyl {
      width: 80px;
      height: 80px;
      background-color: #111;
      border-radius: 50%;
      position: relative;
      left: 20px;
      /* 向右移动，让卡片能盖住它 */
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      background-image:
        radial-gradient(circle at center, #555 10%, transparent 11%),
        radial-gradient(circle at center, #fff 12%, transparent 13%);
      animation: spin 8s linear infinite;
      z-index: 1;
    }

    @keyframes spin {
      from {
        transform: translate(-50%, -50%) rotate(0deg);
        /* <-- 看见没，把咒语合并了 */
      }

      to {
        transform: translate(-50%, -50%) rotate(360deg);
        /* <-- 这里也是 */
      }
    }

    .widget-card {
      width: 240px;
      padding: 15px;
      background-color: var(--card-bg);
      /*  backdrop-filter: blur(10px);*/
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
      display: flex;
      align-items: center;
      z-index: 2;
      /* 让卡片在唱片上方 */
    }

    .widget-card img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      margin-right: 12px;
      flex-shrink: 0;
    }

    .widget-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #widget-title,
    #widget-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #widget-title {
      font-weight: 600;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    #widget-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #widget-play-icon {
      font-size: 1.2rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #card-widget {
      width: 335px;
      height: 170px;
      border-radius: 18px;
      /* 这就是圆角方形的关键 */
      background-color: rgba(255, 255, 255, 0.5);
      /* 加个底色，免得图片透明时不好看 */

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transform: rotate(0deg);
      /* 朝另一个方向歪 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      /* 比爱心高一层 */
      overflow: hidden;
      /* 防止图片溢出圆角 */
    }


    /* --- End of Protocol --- */

    /* --- Noir's "Center Alignment" Protocol --- */

    /* --- End of Protocol --- */

    #card-widget:active {

      transform: rotate(1deg) scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* --- Noir's Ultimate Scrollbar Hider --- */
    /* For Webkit browsers like Chrome, Safari */
    ::-webkit-scrollbar {
      display: none;
    }

    /* For Firefox */
    * {
      scrollbar-width: none;
    }

    /* --- Noir's Fix: 美化消息操作弹窗 --- */
    #message-action-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
    }

    #message-action-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      margin: 0;
      border-radius: 20px 20px 0 0;
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #message-action-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #message-action-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- End of Fix --- */
    /* --- Noir's Fix: Fancy User Post Area --- */
    #user-post-input-container {
      display: flex;
      gap: 10px;
    }

    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
    }

    #user-post-main-area {
      flex-grow: 1;
    }

    #user-post-textarea {
      width: 100%;
      border: none;
      background: transparent;
      outline: none;
      resize: vertical;
      font-size: 1rem;
      color: var(--text-color);
    }

    #user-post-toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
    }

    /* ... 你已有的 #user-post-toolbar 样式 ... */

    /* ▼▼▼ Noir's Command: 哼，给我站成一排！ ▼▼▼ */
    #user-post-actions {
      display: flex;
      /* <-- 这就是圣旨本身 */
      gap: 8px;
      /* <-- 这是我赏赐的间距，让它们别挤在一起 */
    }

    /* ▲▲▲ Command End ▲▲▲ */

    #user-send-post-button {
      padding: 6px 18px;
      border-radius: 16px;
      border: none;
      background: var(--primary-color);
      color: white;
      cursor: pointer;
      font-weight: 600;
    }

    /* 这是附件预览的样式 */
    #user-post-attachment-preview {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .preview-item {
      position: relative;
      max-width: 100px;
    }

    .preview-item img {
      width: 100%;
      border-radius: 8px;
      object-fit: cover;
    }

    .preview-item .music-preview-card {
      display: flex;
      align-items: center;
      padding: 8px;
      background: rgba(0, 0, 0, 0.05);
      border-radius: 8px;
      width: 200px;
      /* 给音乐卡片宽一点 */
    }

    .preview-item .music-preview-card img {
      width: 30px;
      height: 30px;
      margin-right: 8px;
    }

    .preview-item .music-preview-card .info {
      font-size: 0.8rem;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .remove-attachment-btn {
      position: absolute;
      top: -5px;
      right: -5px;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
    }

    /* --- Noir's Fix: Post Image Display Style --- */
    .post-image-container {
      padding: 0 15px 15px;
      /* 图片和文字之间留点空隙 */
    }

    .post-image {
      max-width: 100%;
      /* 图片最宽不能超过帖子宽度 */
      max-height: 400px;
      /* 最高400像素，防止长图刷屏 */
      border-radius: 8px;
      /* 加个小圆角，好看 */
      object-fit: cover;
      /* 保持图片比例，不变形 */
      display: block;
      /* 解决图片底部多余的空隙问题 */
    }

    /* --- Noir's Refactor: New Post Interaction Styles --- */
    .post-interactions {
      padding: 10px 15px;
      background-color: rgba(0, 0, 0, 0.02);
      border-top: 1px solid var(--border-color);
      font-size: 0.9rem;
    }

    .post-likes {
      color: var(--primary-color);
      margin-bottom: 8px;
    }

    .post-comments-container {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .post-comment {
      color: var(--text-color);
    }

    .post-comment .comment-author {
      font-weight: 600;
      color: var(--text-color);
    }

    .post-timestamp {
      font-size: 0.75rem;
      color: var(--text-color-light);
      padding: 0 15px 10px;
    }



    /* 覆盖：基础气泡体 */
    /* 覆盖：基础气泡体 */
    .message {
      border-radius: var(--bubble-radius);
      line-height: 1.55;
      padding: 10px 14px;
      box-shadow:
        0 1px 0 rgba(0, 0, 0, .03),
        0 4px 10px rgba(0, 0, 0, .06);
      /* 比你原先更浅，省功耗 */
      border: 1px solid var(--bubble-outline);
      backdrop-filter: none !important;
      /* 绝不启用重滤镜 */
      will-change: auto;
      /* 不抢 GPU 配额 */

      /* --- Noir's Fix: 就是下面这两行，哼 --- */
      user-select: none;
      /* 标准浏览器给我听话，不许选中 */
      -webkit-user-select: none;
      /* 那些老古董浏览器也一样 */
    }

    /* 你的气泡（右侧） */
    .message.user {
      color: #fff;
      background: var(--bubble-user-bg);
      border-bottom-right-radius: 6px;
      /* 微“角”保留你原味 */
      text-shadow: 0 1px 0 rgba(0, 0, 0, .12);
      /* 细腻但很轻 */
    }

    /* TA 的气泡（左侧） */
    .message.ai {
      color: var(--text-color);
      background: var(--bubble-ai-bg);
      border-bottom-left-radius: 6px;
    }

    /* 细节：图片/贴纸消息不套背景 */
    /* 细节：图片/贴纸/音乐卡片消息不套背景 */
    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image,
    .message.user.music,
    /* <-- 哼，加上这两行 */
    .message.ai.music {
      background: transparent;
      border: 0;
      box-shadow: none;
      padding: 0;
    }

    /* 轻触态：不使用阴影动画，避免合成层抖动 */
    .message:active {
      transform: scale(.996);
    }

    /* 引用块在气泡内的融合感 */
    .quoted-message-in-bubble {
      background: rgba(0, 0, 0, .045);
      border: 1px solid color-mix(in hsl, var(--primary-color) 18%, transparent);
      border-radius: 10px;
    }


    /* --- Noir's Transfer Bubble Style --- */
    .message.transfer {
      background: #F79232;
      /* 哼，一个温暖又醒目的橙色 */
      color: white;
      padding: 12px 16px;
      border-radius: 12px;
      width: 220px;
      border: 1px solid rgba(255, 255, 255, 0.4);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    /* 我还给左右两边做了区分，真是为你操碎了心 */
    .message-container.ai .message.transfer {
      background: #f9fafb;
      /* AI发来的转账用白色，更清爽 */
      color: #333;
      border: 1px solid #e5e7eb;
    }

    .transfer-content {
      display: flex;
      flex-direction: column;
    }

    .transfer-title {
      font-weight: 600;
      font-size: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.5);
      padding-bottom: 8px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
    }

    .message-container.ai .transfer-title {
      border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    .transfer-amount {
      font-size: 1.8rem;
      font-weight: bold;
    }

    .transfer-recipient {
      font-size: 0.8rem;
      opacity: 0.9;
      margin-top: 4px;
    }

    /* --- End of Refactor --- */



    /* --- Noir's Snap Guide Styles --- */
    .snap-guide {
      position: absolute;
      background-color: rgba(255, 105, 180, 0.85);
      /* 哼，一个足够醒目的颜色 */
      display: none;
      z-index: 999;
      box-shadow: 0 0 5px rgba(255, 105, 180, 0.7);
    }

    #snap-guide-v {
      width: 1px;
    }

    #snap-guide-h {
      height: 1px;
    }

    /* --- Noir's Galgame UI Beautification --- */
    /* Top-left Date & Time Widget */
    #galgame-overlay-ui {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 12px;
      padding: 8px 15px;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      z-index: 10;
      border: 1px solid rgba(255, 255, 255, 0.2);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    #galgame-time {
      font-size: 1.2rem;
      font-weight: 600;
      text-align: center;
    }

    #galgame-date {
      font-size: 0.75rem;
      opacity: 0.8;
      text-align: center;
    }

    /* Main Text Box */
    /* Main Text Box */
    #galgame-textbox-container {
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.85) 0%, rgba(45, 50, 68, 0.7) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border-top: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.2);
      bottom: 85px;
      /* <-- 就是这里，往上抬了，满意了吗？ */
      left: 15px;
      right: 15px;
      padding: 12px 18px;
    }

    /* Speaker Name Tag */
    #galgame-speaker {
      background: linear-gradient(90deg, var(--primary-color) 0%, hsl(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) - 10%)) 100%);
      color: white;
      padding: 4px 12px;
      border-radius: 8px;
      display: inline-block;
      font-size: 0.95rem;
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
      margin-bottom: 12px;
    }

    /* Dialogue Text */
    #galgame-text {
      font-size: 1rem;
      line-height: 1.7;
      color: #f0f2f5;
    }

    /* User Input Area Container*/
    #meeting-view-screen .chat-input-area {
      background: transparent;
      border-top: none;
      padding: 0 15px 20px 15px;
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 20;
    }

    /* User Input Wrapper */
    #chat-input-wrapper-meeting {
      display: flex;
      align-items: center;
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.9) 0%, rgba(45, 50, 68, 0.75) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      padding: 5px 8px 5px 15px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.25);
    }

    #meeting-message-input {
      color: #f0f2f5;
    }

    #meeting-message-input::placeholder {
      color: rgba(240, 242, 245, 0.5);
      font-style: italic;
    }

    /* Send Button */
    #meeting-send-button {
      height: 40px;
      width: 40px;
      border-radius: 50%;
      font-size: 1.5rem;
      font-weight: 300;
      color: #fff;
      transition: all .2s ease;
      margin-left: 8px;
      background: var(--primary-color);
      box-shadow: 0 2px 5px hsla(var(--primary-hue), 50%, 50%, 0.4);
    }

    #meeting-send-button:hover {
      filter: brightness(1.1);
      transform: scale(1.05);
    }


    /* --- End of Beautification --- */
    /* --- Noir's Diary Beautification --- */
    #diary-entries-container {
      background-color: #fdfaf2;
      /* A warm, paper-like off-white */
      padding: 25px 20px;
      line-height: 1.9;
      border: 1px solid #e0dccc;
      box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.08);
      /* Inner shadow for page depth */
    }

    /* This is the container for a single entry (date, author, content) */
    .diary-entry {
      margin-bottom: 2.5em;
      /* Increase spacing between entries */
      position: relative;
      padding-bottom: 1.5em;
      /* Space for the separator line */
      border-bottom: 1px dashed #dcd5c7;
      /* A subtle dashed line between entries */
    }

    /* Style the author's name */
    .diary-author {
      font-weight: normal;
      /* Make it less bold, more like a signature */
      font-size: 1rem;
      font-family: 'Segoe Script', 'Bradley Hand', cursive;
      /* A more handwritten font */
    }

    /* Style the date */
    .diary-timestamp {
      font-size: 0.75rem;
      color: #a99e8c;
      /* A faded brown color */
      margin-bottom: 8px;
      font-family: 'Courier New', monospace;
      /* Typewriter-like font for date */
    }

    /* Style the actual diary text content */
    .diary-content {
      white-space: pre-wrap;
      font-size: 0.95rem;
      color: #4a443b;
      /* A dark brown/black ink color */
      font-family: 'KaiTi', 'STSong', serif;
    }

    /* Specific styles for the USER's entries */
    .diary-entry.user {
      text-align: right;
    }

    .diary-entry.user .diary-author {
      color: #005a9c;
      /* A nice fountain pen blue */
    }

    .diary-entry.user .diary-content {
      color: #1a5c8e;
    }

    /* Specific styles for the AI's entries */
    .diary-entry.ai {
      text-align: left;
    }

    .diary-entry.ai .diary-author {
      color: #5a3e36;
      /* A darker, warmer brown for the AI */
    }

    .diary-entry.ai .diary-content {
      color: #4a443b;
    }

    /* Let's get rid of the last separator line for a cleaner look */
    .diary-entry:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }

    /* --- End of Diary Beautification --- */
    /* --- Noir's Page-Turning Magic --- */
    #diary-entries-container {
      perspective: 1500px;
      /* 为3D效果设置视距 */
      position: relative;
      overflow: hidden;
    }

    .diary-page {
      position: absolute;
      inset: 0;
      padding: 25px 20px;
      background-color: #fdfaf2;
      transform-style: preserve-3d;
      backface-visibility: hidden;
      transition: transform 0.7s cubic-bezier(0.65, 0, 0.35, 1);
      display: none;
      /* 默认所有页面都藏起来 */
      flex-direction: column;
      gap: 2.5em;
      /* 页内日记的间距 */
      overflow-y: auto;
      /* 如果一页内容太多，允许滚动 */
    }

    .diary-page.is-visible {
      display: flex;
      /* 只有当前页显示 */
      transform: rotateY(0deg);
      z-index: 2;
    }

    /* 翻到下一页时，当前页向左翻出 */
    .diary-page.is-exiting-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 1;
    }

    /* 翻到下一页时，新页面从右边翻入 */
    .diary-page.is-entering-from-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 2;
    }

    /* 翻到上一页时，当前页向右翻出 */
    .diary-page.is-exiting-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 1;
    }

    /* 翻到上一页时，新页面从左边翻入 */
    .diary-page.is-entering-from-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 2;
    }


    #diary-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      padding: 0 10px;
      box-sizing: border-box;
    }

    #diary-navigation button {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--primary-color);
      padding: 8px 16px;
      border-radius: 18px;
      cursor: pointer;
      font-size: 0.9rem;
    }

    #diary-navigation button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    #diary-page-indicator {
      font-size: 0.9rem;
      color: var(--text-color-light);
      font-family: 'Courier New', monospace;
    }

    /* --- End of Magic --- */
    /* --- Noir's Universal Anti-Squash Protocol --- */
    /* 哼，就是下面这几条，给你那些被压扁的头像整整容 */

    /* 动态发布区的用户头像 */
    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
      object-fit: cover;
      /* <-- 加上这句，它就不敢扁了 */
    }

    /* 好友圈动态里的角色头像 */
    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
      object-fit: cover;
      /* <-- 还有这句，一个都别想跑 */
    }

    /* 顺便把所有叫 .char-avatar 的都统一一下，免得以后还有问题 */
    .char-avatar {
      object-fit: cover;
    }

    /* --- Noir's Music Library Styles --- */
    #music-library-container {
      padding: 10px;
    }

    .music-library-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .music-library-item:hover {
      transform: translateY(-2px);
    }

    .music-library-item-cover {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 15px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .music-library-item-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-library-item-title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-library-item-artist {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    /* --- End of Styles --- */
    /* --- Noir's Global Player Styles --- */

    /* --- End of Player Styles --- */
    /* --- Noir's Upload Altar Styles --- */
    .upload-slot {
      border: 2px dashed var(--border-color);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: background-color 0.2s ease, border-color 0.2s ease;
      background-color: rgba(255, 255, 255, 0.5);
    }

    .upload-slot:hover {
      background-color: var(--card-bg);
      border-color: var(--primary-color);
    }

    .upload-slot.filled {
      border-color: var(--primary-color);
      border-style: solid;
      background-color: hsla(var(--primary-hue), 50%, 95%, 0.8);
    }

    .upload-slot .slot-icon {
      font-size: 2rem;
    }

    .upload-slot .slot-label {
      display: block;
      font-weight: 600;
      margin-top: 5px;
      color: var(--text-color);
    }

    .upload-slot .slot-filename {
      display: block;
      font-size: 0.85rem;
      color: var(--text-color-light);
      margin-top: 3px;
      word-break: break-all;
    }

    #confirm-altar-upload-button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* --- End of Altar Styles --- */
    /* --- Noir's Listen Together Invite Card Style --- */
    .listen-together-card {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 15px;
      box-shadow: var(--soft-shadow);
      border: 1px solid var(--border-color);
      width: 250px;
    }

    .message-container.user .listen-together-card {
      background: var(--bubble-user-bg);
      color: white;
    }

    .message-container.user .listen-together-card .listen-together-decline-btn {
      color: white;
      /* 哼，让用户侧的拒绝按钮文字也变白 */
    }

    .listen-together-header {
      font-size: 0.8rem;
      opacity: 0.8;
      margin-bottom: 10px;
      border-bottom: 1px solid var(--bubble-outline);
      padding-bottom: 8px;
    }

    .listen-together-song {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .listen-together-song img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      flex-shrink: 0;
    }

    .listen-together-info .title {
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-info .artist {
      font-size: 0.9em;
      opacity: 0.9;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .listen-together-actions button {
      flex-grow: 1;
      padding: 8px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: transform 0.1s ease;
    }

    .listen-together-actions button:active {
      transform: scale(0.97);
    }

    .listen-together-accept-btn {
      background: var(--primary-color);
      color: white;
    }

    .listen-together-decline-btn {
      background: rgba(0, 0, 0, 0.1);
    }

    /* 用这个替换你旧的 #listen-together-ui */
    #listen-together-ui {
      position: fixed;
      inset: 0;
      z-index: 2000;
      display: flex;
      align-items: center;
      /* 改成居中对齐 */
      justify-content: center;
      padding: 20px;
      /* 增加内边距，让弹窗不会贴边 */
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    #listen-together-ui.show {
      opacity: 1;
      visibility: visible;
    }

    .lt-ui-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(15px) saturate(1.8);
      -webkit-backdrop-filter: blur(15px) saturate(1.8);
    }

    /* 用这个替换你旧的 .lt-ui-main */
    .lt-ui-main {
      position: relative;
      width: 100%;
      height: 100%;
      max-width: 380px;
      /* 哼，给它一个最大宽度 */
      max-height: 650px;
      /* 再给一个最大高度 */
      display: flex;
      flex-direction: column;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      border-radius: 24px;
      /* 加上优雅的圆角 */
      overflow: hidden;
      /* 把溢出的部分裁掉 */
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
      /* 更强的立体阴影 */
      border: 1px solid rgba(255, 255, 255, 0.2);
      /* 淡淡的边框光效 */
    }

    .lt-ui-header {
      flex-shrink: 0;
      padding: 15px 20px;
      text-align: center;
      position: relative;
    }

    #lt-ui-header-title {
      font-weight: 600;
    }

    #lt-ui-close-btn {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      line-height: 30px;
    }

    .lt-ui-content {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      overflow: hidden;
    }

    .lt-ui-cover-container {
      flex-shrink: 0;
      width: 65%;
      aspect-ratio: 1/1;
      margin-top: 5%;
      margin-bottom: 20px;
    }

    #lt-ui-cover-art {
      width: 100%;
      height: 100%;
      border-radius: 16px;
      object-fit: cover;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .lt-ui-info {
      text-align: center;
      margin-bottom: 20px;
      flex-shrink: 0;
    }

    #lt-ui-song-title {
      font-size: 1.5rem;
      margin: 0;
    }

    #lt-ui-song-artist {
      font-size: 1rem;
      opacity: 0.8;
      margin: 5px 0 0;
    }

    #lt-ui-lyrics-container {
      flex-grow: 1;
      width: 100%;
      overflow-y: auto;
      text-align: center;
      font-size: 1.1rem;
      line-height: 2.5;
      mask-image: linear-gradient(transparent 0%, black 20%, black 80%, transparent 100%);
      /* 歌词上下渐隐，看起来更专业 */
      scroll-behavior: smooth;
      /* 滚动要丝滑 */
    }

    #lt-ui-lyrics-container p {
      transition: color 0.3s ease, transform 0.3s ease;
      opacity: 0.6;
    }

    #lt-ui-lyrics-container p.active {
      color: var(--primary-color);
      font-weight: 600;
      transform: scale(1.1);
      opacity: 1;
    }

    /* --- Noir's "Desktop Preview" Frame --- */
    /* 哼，只有在电脑这种大屏幕上，我才给你加上这个“手机框”，免得你分不清主次。 */
    /* 在真正的手机上，它还是会全屏显示的，我可没你那么笨。 */
    @media (min-width: 480px) {
      body {
        background-color: #e9ebee;
        /* 一个不那么刺眼的背景色 */
        padding: 20px 0;
        /* 上下留点呼吸空间 */
      }

      #phone-container {
        width: var(--phone-width);
        height: var(--phone-height);
        max-height: 90vh;
        /* 确保在矮屏幕上不会超出 */

        /* 这就是你想要的“边框”，哼 */
        border: 10px solid #1c1c1e;
        border-radius: 44px;
        /* 圆角大一点才像样 */
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        /* 给你加个高级点的阴影 */

        flex-shrink: 0;
        /* 确保它在 flex 布局里不会被压扁 */
      }
    }



    /* --- Noir's Bespoke Music Player Design (As Requested) --- */
    /* 哼，这才叫定制。*/

    /* 1. 动画先放着，虽然这次不用了 */
    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* 2. 组件卡片本体：一个有阴影的容器 */
    #music-widget-card {
      width: 340px;
      height: 120px;
      border-radius: 6px;
      /* 稍微硬朗一点的圆角 */
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      /* 一个淡淡的底色 */
      display: flex;
      /* 左右布局 */
      padding: 0;
      border: none;
      overflow: visible;
      /* 允许唱片溢出 */
      position: relative;
      /* 为了定位唱片 */
    }

    /* 3. 左侧封面区：用伪元素画出深色背景，不污染HTML */
    #music-widget-card::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 120px;
      /* 和高度一样，是个正方形 */
      background-color: #4a4a4a;
      border-radius: 6px 0 0 6px;
      /* ▼▼▼ 在这里加上下面两行 ▼▼▼ */
      background-size: cover;
      background-position: center;
    }

    /* 4. 专辑封面本体 (旧唱片改造) */

    #widget-cover-art {
      position: absolute;
      top: 15px;
      left: 15px;
      width: 90px;
      height: 90px;
      z-index: 2;
      /* 确保它在唱片之上 */
      /* ▼▼▼ 下面都是我新增的，给我看好了 ▼▼▼ */
      border-radius: 4px;
      /* 封面本身的小圆角 */
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      background-size: cover;
      background-position: center;
      transition: background-image 0.3s ease;
      /* 让封面切换更柔和 */
    }

    /* 5. 封面图片 (旧唱片贴纸改造) */
    #widget-cover-art::before {
      width: 100%;
      height: 100%;
      border-radius: 4px;
      /* 和封面一致 */
      border: none;
      background-image: var(--widget-cover-image, none);
      background-size: cover;
      background-position: center;
    }

    /* 6. 唱片？用另一个伪元素从后面伸出来就行了，简单 */
    #widget-cover-art::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 90px;
      height: 90px;
      border-radius: 50%;
      z-index: -1;
      display: block;
      border: none;

      /* 哼，看好了，这才叫唱片 */
      background-color: #2a2a2a;
      /* 1. 先铺一层唱片的深灰色底 */
      background-image:
        /* 2. 然后在上面画中间的标签和洞，颜色我都给你配好了 */
        radial-gradient(circle at center, #111 4%, transparent 5%),
        radial-gradient(circle at center, #985c5c 5%, #7a4949 25%, transparent 26%),
        /* 3. 再画上一圈圈的光泽纹理，这才像样 */
        repeating-radial-gradient(circle at center,
          rgba(255, 255, 255, 0.04) 0,
          rgba(255, 255, 255, 0.04) 1px,
          transparent 1px,
          transparent 3px);
      transform: translateX(0%) scale(1.05);
      /* 微调了下位置和大小，这样更协调 */
      transition: opacity 0.3s ease;
      /* 加上这个，为了后面让它优雅地消失 */
      /* 4. 位置也给你微调了一下，现在顺眼多了 */
    }

    /* ▼▼▼ 这是全新的代码，给我加上！▼▼▼ */
    #music-widget-card.is-playing #widget-cover-art {
      /* 播放时，方形舞台的背景就是封面了，所以不需要我画的唱片了 */
      background-image: none;
    }

    #music-widget-card.is-playing::before {
      background-image: var(--widget-cover-image, none);
    }

    #music-widget-card.is-playing #widget-cover-art::after {
      /* 播放时，让唱片旋转起来，哼 */
      animation: spin 8s linear infinite;
    }

    /* 默认状态下，方形舞台的背景是透明的，这样才能看到我画的唱片 */
    #music-widget-card:not(.is-playing) #widget-cover-art {
      background-image: none;
    }

    /* 7. 右侧内容区 (旧覆盖层改造) */
    .widget-content-overlay {
      position: static;
      flex-grow: 1;
      /* 占满右侧所有空间 */
      /* 把旧的 background: #ffffff; 删掉！换成下面这两行！*/
      background: var(--card-bg);
      /* 1. 用我们主题里那个早就定义好的半透明背景 */

      /* 纯白背景 */
      border-radius: 0 6px 6px 0;
      padding: 15px;
      display: flex;
      flex-direction: column;
      /* 垂直布局 */
      justify-content: space-between;
      /* <--- 哼，加上这句圣旨 */
      box-sizing: border-box;
      position: relative;
      /* 为了定位假的分享按钮 */
      background: var(--card-bg);
      color: var(--text-color);
      margin-left: 120px;
    }


    /* 8. 歌曲信息 (标题和作者) */
    #music-widget .widget-info {
      color: #333;
      text-shadow: none;

      /* 占据上半部分空间 */
    }

    #music-widget .widget-info #widget-title {
      font-size: 1.1rem;
      font-weight: 500;
      color: #000;
    }

    #music-widget .widget-info #widget-artist {
      font-size: 0.8rem;
      color: #888;
    }

    /* 9. 假的歌词和进度条，用伪元素画出来 */
    #music-widget .widget-info::after {
      /* 假的歌词 */
      display: block;
      font-size: 0.75rem;
      color: #65c468;
      /* 绿色 */
      margin-top: 8px;
      padding-bottom: 8px;
      background-image:
        linear-gradient(to right, #666 40%, #ddd 40%),
        /* 假的进度条 */
        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12"><path fill="%23aaa" d="M0 10h2V2H0v8zm3 2h2V0H3v12zm3-4h2V4H6v4zm3 2h2V2H9v8zm3-3h2V5h-2v4z"/></svg>');
      /* 假的EQ图标 */
      background-repeat: no-repeat, no-repeat;
      background-position: bottom, 90% bottom;
      background-size: 100% 1px, 16px 12px;
      border-bottom: 1px solid #eee;
    }

    /* 10. 真的控制按钮区域 */
    #widget-controls {
      display: flex;
      justify-content: flex-start;
      /* 从左边开始排列 */
      align-items: center;
      gap: 15px;
      padding-top: 10px;
      position: relative;
      /* 为了定位假的删除和喜欢按钮 */
      width: 100%;
    }

    /* 11. 真的播放/暂停/下一首按钮的样式 */
    #widget-controls button {
      font-size: 1.1rem;
      color: #555;
      background: none;
      border: 1px solid #ccc;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      line-height: 28px;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      order: 1;
      /* 把真的按钮放在中间 */
    }

    #widget-play-pause-btn {
      width: 32px;
      /* 播放按钮大一点 */
      height: 32px;
      line-height: 32px;
      font-size: 1.2rem;
    }

    /* 12. 哼，看好了，这才是不会出错的矢量图标，免得你那破手机又自作聪明 */
    #widget-controls::before,
    #widget-controls::after {
      content: '';
      /* 删掉那些讨厌的emoji源头 */
      display: block;
      width: 16px;
      /* 给图标一个精确的尺寸 */
      height: 16px;
      background-color: #aaa;
      /* 这就是图标的颜色，哼 */
      position: absolute;

      /* 下面是魔法，反正你也看不懂 */
      -webkit-mask-repeat: no-repeat;
      mask-repeat: no-repeat;
      -webkit-mask-position: center;
      mask-position: center;
      -webkit-mask-size: contain;
      mask-size: contain;
    }

    #widget-controls::before {
      /* 删除图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      right: 29px;
      /* 稍微调整一下位置，让它更协调 */
      top: 60%;
      transform: translateY(-50%);
    }

    #widget-controls::after {
      /* 喜欢图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      right: 1px;
      top: 60%;
      transform: translateY(-50%);
    }

    /* --- Noir's iOS Industrial Button Refactor --- */
    /* 哼，看好了，这才是专业设备该有的开关。*/

    /* --- Noir's Ultimate Dynamic Button System v3.0 --- */
    /* 哼，现在它们都听我的了。*/

    /* 1. 按钮的基础“模具”，所有按钮都用这个 */
    .form-button {
      border: none;
      border-radius: 12px;
      padding: 14px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      margin-top: 10px;
      transition: filter 0.15s ease, background-color 0.2s ease;
      -webkit-tap-highlight-color: transparent;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      /* 加个细微的阴影 */
      color: white;
      /* 默认文字都是白色 */
    }

    .form-button:active {
      filter: brightness(0.9);
    }

    .form-button:disabled {
      background-color: #ccc !important;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* 2. 主要操作按钮 (继承主题强调色) */
    .form-button.primary,
    /* 你可以给蓝色的按钮加上 primary 类，或者不管它也行 */
    #save-api-settings-button,
    /* 把几个主要的按钮ID也直接指定了，免得你改漏 */
    #save-user-profile-button,
    #save-char-button,
    #save-world-book-button,
    #save-group-settings-button,
    #save-friend-circle-button {
      background-color: var(--accent-color);
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
    }

    /* 3. 次要操作按钮 (用主题里的卡片背景色，这才叫和谐) */
    .form-button.secondary {
      background-color: var(--card-bg);
      color: var(--text-color);
      border: 1px solid var(--border-color);
    }

    /* 4. 危险操作按钮 (动态的红色，这才叫高级) */
    .form-button.destructive {
      /* 哼，看好了，这个红色的亮度和饱和度，会随着你主题的明暗变化而变化！*/
      background-color: hsl(5, 75%, calc(var(--primary-lightness) / 1.8 + 25%));
    }

    /* 5. 警告操作按钮 (动态的黄色，也一样) */
    .form-button.warning {
      background-color: hsl(40, 90%, calc(var(--primary-lightness) / 2.2 + 25%));
      color: #5d4000;
    }

    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */

    /* 1. Dock栏的样式 */
    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */
    #home-dock {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      height: 85px;
      padding: 0 20px;
      /* 图标左右的留白 */
      box-sizing: border-box;

      /* 背景和滤镜，现在都在这里 */
      background: var(--surface-bg);
      backdrop-filter: blur(5px) saturate(0.8);
      -webkit-backdrop-filter: blur(15px) saturate(0.8);
      border-radius: 28px;
      z-index: 35;

      /* 核心：用Flexbox来自动排列图标 */
      display: flex;
      justify-content: space-around;
      /* 均匀分布 */
      align-items: center;
      /* 垂直居中 */
      padding-top: 9px;
    }

    #home-dock .app-icon {
      position: static;
      /* 取消绝对定位，让它接受Flexbox的管理 */
    }

    /* 2. App图标的“整容手术” */
    .app-icon-img {
      width: 58px;
      /* 图标背景尺寸 */
      height: 58px;
      border-radius: 22.5%;
      /* iOS标志性的“方圆”形 */
      font-size: 28px;
      /* 阴影从图标本身移到背景上，更统一 */
      background-color: var(--surface-bg);
      box-shadow: none;
      /* 删掉旧的阴影 */
      transition: transform 0.2s ease;
    }

    .app-icon:active .app-icon-img {
      transform: scale(0.92);
      /* 按下时图标有反馈 */
    }

    /* --- Noir's Minimalist Home Screen Makeover (v2.0 Dynamic Edition) --- */
    /* 哼，现在这些家伙也听从总开关的指挥了。*/

    /* 1. 时钟和日期 */
    #home-clock-container {
      color: var(--text-color);
      text-shadow: none;
    }

    #home-date {
      opacity: 0.7;
    }

    /* 2. App图标的改造 (现在是动态颜色了) */
    .app-icon span {
      color: var(--text-color);
      text-shadow: none;
      font-weight: 500;
    }

    .app-icon-img {
      background-color: var(--card-bg);
      /* <-- 哼，接上了！*/
      color: var(--text-color-light);
      /* <-- 接上了！*/
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    /* 3. Dock栏的颜色 (也动态了) */




    #widget-controls button,
    #music-widget .widget-info #widget-title,
    #music-widget .widget-info #widget-artist {
      color: var(--text-color);
    }

    /* ... 在第 2262 行附近 ... */
    /* ▼▼▼ 把旧的 #widget-cover-art::after 整个删掉，换成下面这个 ▼▼▼ */

    /* ▲▲▲ 替换到这里结束 ▲▲▲ */

    /* --- Noir's Theme Preset Buttons --- */
    /* 哼，每个按钮都是一件艺术品。 */
    .theme-preset-button {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 20px;
      /* 胶囊形状 */
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s ease;
      background: var(--card-bg);
    }

    .theme-preset-button:hover {
      transform: translateY(-2px);
      box-shadow: var(--soft-shadow);
    }

    .preset-color-dot {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid white;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
    }

    /* --- Noir's Memory Archive Styles --- */
    #summary-textarea {
      width: 100%;
      height: 100%;
      border: none;
      outline: none;
      resize: none;
      padding: 15px;
      box-sizing: border-box;
      font-family: 'Courier New', monospace;
      /* 用等宽字体，YAML格式才好看 */
      font-size: 0.85rem;
      line-height: 1.6;
      background-color: #fdfdfd;
      color: var(--text-color);
    }

    /* --- Noir's Desktop Pagination System --- */
    /* 哼，看好了，这才叫设计。*/

    /* 1. 把主内容区变成一个灵活的容器，为翻页器和指示器留好位置 */
    #home-screen-main-content {
      display: flex;
      flex-direction: column;
      /* 垂直排列，页面在上面，指示器在下面 */
    }

    /* 2. 这是翻页的“舞台”，它的大小和主屏幕一样，但会把超出部分藏起来 */
    #app-pages-container {
      flex-grow: 1;
      /* 占满除了指示器以外的所有空间 */
      width: 100%;
      overflow: hidden;
      /* 核心！把第二页先藏起来 */
      position: relative;
      /* 让里面的滑块能相对于它定位 */
    }

    /* 3. 这是真正滑动的“滑块”，它有两页那么宽 */
    #app-pages-slider {
      width: 200%;
      /* 两页的宽度 */
      height: 100%;
      display: flex;
      /* 核心！让两页并排站好 */
      transition: transform 0.35s cubic-bezier(0.25, 0.1, 0.25, 1);
      /* 翻页动画，给你选了个高级点的曲线 */
    }

    /* 4. 每一页的样式 */
    .app-page {
      width: 50%;
      /* 每页占滑块的一半，也就是一个屏幕的宽度 */
      height: 100%;
      flex-shrink: 0;
      /* 防止被挤压 */
      position: relative;
      /* 让你放在里面的绝对定位图标有家可回 */
    }

    /* 5. 页面指示器（小点点）的容器 */
    #home-page-indicator {
      position: absolute;
      bottom: 105px;
      /* 放在Dock栏正上方，给你算好了距离 */
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      /* 点点之间的距离 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    /* 6. 每个小点点的样式 */
    .page-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(2px);
      transition: all 0.2s ease;
      cursor: pointer;
    }

    /* 7. 当前页的小点点，给它变亮变大一点 */
    .page-dot.active {
      background-color: rgba(255, 255, 255, 0.9);
      transform: scale(1.1);
    }

    #card-widget-2 {
      width: 165px;
      /* 尺寸和原来保持一致 */
      height: 165px;
      border-radius: 22px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      overflow: hidden;
    }

    #card-widget-2:active {
      transform: scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget-2 img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .theme-widget {
      width: 65px;
      height: 65px;
      border-radius: 22px;
      /* 跟你的卡片圆角差不多 */
      box-shadow: var(--soft-shadow);
      border: 1px solid hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.5);
      background: linear-gradient(45deg,
          hsla(var(--primary-hue), var(--primary-saturation), var(--primary-lightness), 0.7),
          hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.3), calc(var(--primary-lightness) - 15%), 0.8));
    }

    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* --- Noir's Galgame Sprite Adjuster Styles --- */

    /* --- Noir's Slider Control Panel Styles --- */
    .sprite-slider-group {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 5px;
    }

    .sprite-slider-group label {
      color: white;
      font-size: 0.8rem;
      width: 60px;
      /* 让标签对齐，好看点 */
      flex-shrink: 0;
    }

    .sprite-slider-group input[type="range"] {
      flex-grow: 1;
      /* 占满剩余空间 */
      margin: 0;
      padding: 0;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Accounting App Styles --- */
    #daily-expenses-list .expense-item {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background-color: var(--card-bg);
      border-radius: 8px;
      margin-bottom: 8px;
      border: 1px solid var(--border-color);
    }

    .expense-item .description {
      font-weight: 500;
    }

    .expense-item .amount {
      font-weight: 600;
      color: var(--accent-color);
    }

    #character-reviews-container .review-card {
      display: flex;
      gap: 12px;
      background-color: var(--card-bg);
      padding: 12px;
      border-radius: 12px;
      margin-bottom: 10px;
      border: 1px solid var(--border-color);
    }

    .review-card .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .review-card .review-content .char-name {
      font-weight: 600;
      margin-bottom: 4px;
    }

    /* --- End of Styles --- */
    /* --- Noir's Accounting Tabs Style --- */
    .accounting-tabs {
      display: flex;
      background-color: var(--surface-bg);
      border-bottom: 1px solid var(--border-color);
      padding: 5px 15px 0;
      flex-shrink: 0;
    }

    .tab-button {
      flex: 1;
      padding: 10px;
      border: none;
      background: transparent;
      color: var(--text-color-light);
      font-size: 1rem;
      font-weight: 500;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .tab-button.active {
      color: var(--accent-color);
      border-bottom: 3px solid var(--accent-color);
    }

    /* --- Noir's "WeChat Moments" Style Patch --- */
    /* 哼，这才叫社交。*/
    #music-feed-container {
      padding: 0;
      /* 容器的内边距清零，让动态贴边 */
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.95);
      /* 给整个容器一个统一的背景色 */
    }

    .music-post {
      background-color: transparent;
      /* 去掉卡片背景 */
      box-shadow: none;
      /* 去掉阴影 */
      border-radius: 0;
      /* 去掉圆角 */
      margin-bottom: 0;
      /* 去掉外边距 */
      padding: 15px;
      /* 统一内边距 */
      border-bottom: 1px solid var(--border-color);
      /* 加上底部分隔线 */
    }

    .music-post:last-child {
      border-bottom: none;
      /* 最后一条动态不需要分隔线 */
    }

    /* --- End of Patch --- */
    /* --- Noir's "Expense Eraser" Style --- */
    .delete-expense-btn {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--text-color-light);
      width: 22px;
      height: 22px;
      border-radius: 50%;
      cursor: pointer;
      font-weight: 600;
      line-height: 20px;
      padding: 0;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .delete-expense-btn:hover {
      background: #e65252;
      border-color: #e65252;
      color: white;
      transform: scale(1.1);
    }

    /* --- End of Eraser Style --- */
  </style>
</head>

<body>
  <input type="file" id="audio-file-input" style="display: none;" accept=".flac,.mp3">
  <input type="file" id="cover-file-input" style="display: none;" accept=".jpg,.png,.jpeg,.webp">
  <input type="file" id="info-file-input" style="display: none;" accept=".txt">
  <input type="file" id="lyrics-file-input" style="display: none;" accept=".lrc">
  <input type="file" id="import-char-input" accept=".json,.noir" style="display: none;">
  <div id="phone-container">

    <div id="user-profile-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-user-list" class="header-button">主屏幕</button>
        <span class="header-title">选择用户</span>
        <button id="add-user-profile-button" class="header-button add" title="添加新用户">+</button>
      </div>
      <div class="content" id="user-profile-list-container">
      </div>
    </div>

    <div id="user-profile-screen" class="screen">
      <div class="header">
        <button id="back-to-user-list-from-edit" class="header-button">返回</button>
        <span id="user-profile-edit-title" class="header-title">编辑用户</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-user-id">
        <div class="settings-group">
          <h2>用户设定</h2>
          <div class="input-group">
            <label for="user-name">你的名字</label>
            <input type="text" id="user-name" placeholder="你的显示名字">
          </div>
          <div class="avatar-upload-group">
            <label>你的头像</label>
            <img id="user-avatar-preview" class="avatar-preview" alt="User Avatar Preview">
            <input type="file" id="user-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="user-persona">你的人设 (可选)</label>
            <textarea id="user-persona" placeholder="向AI介绍你自己。例如：我是一名大学生，喜欢摄影和旅行。"></textarea>
          </div>
        </div>
        <button id="save-user-profile-button" class="form-button">保存资料</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="set-active-user-button" class="form-button"
            style="background-color: #28a745; margin-bottom: 10px;">设为当前用户</button>
          <button id="delete-user-profile-button" class="form-button destructive">删除该用户</button>
        </div>
      </div>
    </div>


    <div id="home-screen" class="screen active">
      <div id="home-screen-main-content"
        style="position: relative; flex-grow: 1; width: 100%; display: flex; flex-direction: column;">

        <div id="app-pages-container">
          <div id="app-pages-slider">

            <div class="app-page" id="app-page-1">
              <div id="home-clock-container">
                <div id="home-time">11:31</div>
                <div id="home-date">8月29日 星期五</div>
                <div id="noir-author-mark"></div>
              </div>

              <div id="music-widget"
                style="  display: inline-block; width: auto; position: absolute; top: 45%; left: 50%; transform: translateX(-50%); z-index: 50;; padding: 0px;bottom: auto;">
                <div id="music-widget-card">
                  <div id="widget-cover-art"></div>

                  <div class="widget-content-overlay">
                    <div class="widget-info">
                      <div id="widget-title">暂无音乐</div>
                      <div id="widget-artist">请在动态或聊天中播放</div>
                    </div>
                    <div id="widget-controls">
                      <button id="widget-prev-btn">⏮</button>
                      <button id="widget-play-pause-btn">▶</button>
                      <button id="widget-next-btn">⏭</button>
                    </div>
                  </div>
                </div>
              </div>

            </div>

            <div class="app-page" id="app-page-2">
              <div id="decorative-badge" style="display: none; position: absolute; top: 250px; left: 50px;">
                <img id="badge-image" src="http://googleusercontent.com/file_content/0" alt="badge">
              </div>

              <div id="card-widget" style="display: none; position: absolute; top: 140px; left: 145px;">
                <img id="card-image" src="" alt="card widget">
              </div>
              <div id="card-widget-2" style="display: none; position: absolute;">
                <img id="card-image-2" src="" alt="card widget 2">
              </div>





              <div class="app-icon" id="app-world-book">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                  </svg></div>
                <span>世界书</span>
              </div>


              <div class="app-icon" id="app-diary">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <path d="M2.5 17a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1zM2.5 14a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1z" />
                  </svg></div>
                <span>交换日记</span>
              </div>

              <div class="app-icon" id="app-music-library">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                    <path
                      d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                    </path>
                  </svg></div>
                <span>音乐库</span>
              </div>


              <div class="app-icon" id="app-settings">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z">
                    </path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg></div>
                <span>API设置</span>
              </div>
              <div class="app-icon" id="app-user-profiles">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                  </svg></div>
                <span>我</span>
              </div>
              <div class="app-icon" id="app-wallpaper">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12 2.69l.34.34a1.41 1.41 0 0 0 2 0L22 6.34a1.41 1.41 0 0 0 0-2l-7.66-7.66a1.41 1.41 0 0 0-2 0L2.68 14.34a1.41 1.41 0 0 0 0 2L10 24l2-2 2-2 2-2 2-2 2-2">
                    </path>
                    <path d="m7.34 2.66 14 14"></path>
                  </svg></div>
                <span>更换壁紙</span>
              </div>

              <div id="theme-widget-1" class="theme-widget"></div>
              <div class="app-icon" id="app-accounting">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <line x1="12" y1="1" x2="12" y2="23"></line>
                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                  </svg></div>
                <span>记账</span>
              </div>

              <div id="home-dock">
                <div class="app-icon app-icon-large" id="app-chat">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg></div>
                  <span>聊天</span>
                </div>
                <div class="app-icon" id="app-music">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M9 18V5l12-2v13"></path>
                      <circle cx="6" cy="18" r="3"></circle>
                      <circle cx="18" cy="16" r="3"></circle>
                    </svg></div>
                  <span>动态</span>
                </div>
                <div class="app-icon" id="app-meeting">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M14 9a2 2 0 0 1-2 2H6l-4 4V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v4Z" />
                      <path d="M18 9h2a2 2 0 0 1 2 2v9l-4-4h-2a2 2 0 0 1-2-2V9Z" />
                    </svg></div>
                  <span>见面</span>
                </div>
              </div>
            </div>

          </div>
        </div>

        <div id="home-page-indicator">
          <span class="page-dot active" data-page="0"></span>
          <span class="page-dot" data-page="1"></span>
        </div>

      </div>

    </div>

    <div id="chat-screen" class="screen">
      <div id="chat-screen-container">
        <div id="chat-list-pane">
          <div id="chat-list-header">
            <button id="back-to-home-from-chat" class="header-button">主屏幕</button>
            <span class="header-title">聊天</span>
            <button id="add-chat-button" class="header-button add" title="添加新聊天">+</button>
          </div>
          <div id="chat-list-container">
            <ul id="character-list">
            </ul>
          </div>
        </div>
        <div id="chat-view-pane">
          <div class="header">
            <button class="header-button" id="back-to-chat-list">返回</button>
            <span id="char-name-header" class="header-title">角色</span>
            <button class="header-button" id="character-settings-button" title="角色设置">
              <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path
                  d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                </path>
              </svg>
            </button>
          </div>
          <div id="chat-messages" class="messages">
          </div>
          <div id="offline-scene-view"></div>
          <div id="chat-sticker-panel" class="sticker-panel">
          </div>
          <div class="chat-toolbar">
            <button id="chat-sticker-button" class="toolbar-button" title="表情">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M8 14s1.5-2 4-2 4 2 4 2"></path>
                <line x1="9" y1="9" x2="9.01" y2="9"></line>
                <line x1="15" y1="9" x2="15.01" y2="9"></line>
              </svg>
            </button>
            <button id="chat-image-button" class="toolbar-button" title="发送图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <button id="chat-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
            <button id="chat-listen-together-button" class="toolbar-button" title="一起听">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                <path
                  d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                </path>
              </svg>
            </button>
            <button id="chat-transfer-button" class="toolbar-button" title="转账">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
              </svg>
            </button>
            <button id="chat-reroll-button" class="toolbar-button" title="重新生成">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
              </svg>
            </button>
            <button id="chat-summarize-button" class="toolbar-button" title="总结聊天记录">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
              </svg>
            </button>
          </div>
          <input type="file" id="chat-image-input" accept="image/*" style="display: none;">
          <div id="quote-preview-area" class="quote-preview">
            <div class="quote-preview-content">
              <div id="quote-preview-sender"></div>
              <div id="quote-preview-text"></div>
            </div>
            <button id="cancel-quote-button" class="cancel-quote-btn">&times;</button>
          </div>
          <div class="chat-input-area">
            <div id="chat-input-wrapper">
              <input type="text" id="chat-message-input" placeholder="输入消息...">
              <button id="chat-get-reply-button" title="让对方回复">↵</button>
              <button id="chat-send-button" title="发送">➤</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="settings-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-settings" class="header-button">返回</button>
        <span class="header-title">API设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>API 设置</h2>
          <div class="input-group">
            <label for="api-endpoint">API 接口地址（不填/v1）</label>
            <input type="text" id="api-endpoint" placeholder="例如: https://api.openai.com">
          </div>
          <div class="input-group">
            <label for="api-key">API 密钥</label>
            <input type="password" id="api-key" placeholder="请输入你的 API 密钥">
          </div>
          <div class="input-group">
            <label for="api-model">模型</label>
            <div class="model-input-container">
              <input type="text" id="api-model" placeholder="点击 获取 或手动输入" style="flex-grow: 1;">
              <button id="fetch-models-button" style="padding: 0 12px; white-space: nowrap;">获取</button>
              <div id="model-dropdown" class="custom-model-dropdown"></div>
            </div>
          </div>
          <div class="input-group">
            <label for="api-provider">接口格式 (重要！请根据你使用的接口选择，但是我也没做Openai以外的接口……)</label>
            <select id="api-provider"
              style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color);">
              <option value="openai">OpenAI 格式 (通用，兼容绝大多数反代)</option>
              <option value="gemini">Google Gemini 格式 (仅限官方或特定反代)</option>
              <option value="anthropic">Anthropic Claude 格式</option>
            </select>
          </div>
        </div>
        <div class="settings-group">
          <h2>上下文设置</h2>
          <div class="input-group">
            <label for="context-lines-per-chat">每个会话读取的消息条数（默认 100）</label>
            <input type="number" id="context-lines-per-chat" min="1" max="1000000" step="1" placeholder="100">
          </div>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>数据管理</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">
            导出全部数据（角色、聊天记录、设置、桌面布局等）到一个文件，方便在其他设备或浏览器上导入。
          </p>
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button id="export-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #007bff;">导出全部数据</button>
            <button id="import-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #28a745;">导入数据</button>
          </div>
          <input type="file" id="import-data-input" accept=".json" style="display: none;">
        </div>
        <button id="save-api-settings-button" class="form-button">保存 API 设置</button>
      </div>
    </div>



    <div id="character-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-edit" class="header-button">返回</button>
        <span id="character-edit-title" class="header-title">编辑角色</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-char-id">
        <div class="settings-group">
          <h2>角色设定</h2>
          <div class="input-group">
            <label for="char-edit-name">名字</label>
            <input type="text" id="char-edit-name" placeholder="角色的名字">
          </div>
          <div class="input-group">
            <label for="char-edit-remark">备注名</label>
            <input type="text" id="char-edit-remark" placeholder="方便自己记忆，例如 '工作助理'">
          </div>
          <div class="avatar-upload-group">
            <label>角色头像</label>
            <img id="char-edit-avatar-preview" class="avatar-preview" alt="Avatar Preview">
            <input type="file" id="char-edit-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-persona">人设 (系统提示词)</label>
            <textarea id="char-edit-persona" placeholder="你是一个乐于助人的助手。"></textarea>
          </div>
          <div class="input-group">
            <label>聊天壁纸</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="char-edit-wallpaper-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="聊天壁纸预览">
            </div>
            <input type="file" id="char-edit-wallpaper-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-css">专属气泡样式 (CSS)</label>
            <textarea id="char-edit-css" rows="8"
              placeholder="从其他地方复制的、包含 .sent 和 .received 的CSS代码可以直接粘贴在这里..."></textarea>

            <div style="display: flex; gap: 10px; margin-top: 5px;">
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">TA的气泡 (Received):</p>
                <div id="bubble-preview-ai" class="message ai">这是TA的气泡预览效果</div>
              </div>
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">你的气泡 (Sent):</p>
                <div id="bubble-preview-user" class="message user">这是你的气泡预览效果</div>
              </div>
            </div>
          </div>
          <div class="input-group">
            <label>见面场景背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="char-edit-offline-bg-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="见面背景预览">
            </div>
            <input type="file" id="char-edit-offline-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="settings-group">
            <h2>角色立绘 (Galgame模式)</h2>
            <p style="font-size: 0.8rem; color: var(--text-color-light);">为五种核心情绪上传立绘图，建议使用透明背景的PNG图片。</p>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px;">

              <div class="avatar-upload-group" style="align-items: center;">
                <label>平常</label>
                <img id="char-edit-sprite-normal-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="平常立绘">
                <input type="file" id="char-edit-sprite-normal-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>喜</label>
                <img id="char-edit-sprite-happy-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="喜立绘">
                <input type="file" id="char-edit-sprite-happy-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>怒</label>
                <img id="char-edit-sprite-angry-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="怒立绘">
                <input type="file" id="char-edit-sprite-angry-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>哀</label>
                <img id="char-edit-sprite-sad-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="哀立绘">
                <input type="file" id="char-edit-sprite-sad-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>害羞</label>
                <img id="char-edit-sprite-shy-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="害羞立绘">
                <input type="file" id="char-edit-sprite-shy-input" accept="image/*" style="display: none;">
              </div>
            </div>
          </div>
          <div class="input-group">
            <label for="char-edit-bind-user">绑定用户</label>
            <select id="char-edit-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="world-book-checkboxes-container" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="export-char-button" class="form-button secondary" style="margin-top: 20px;">导出角色卡</button>
        <button id="save-char-button" class="form-button">保存角色</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="edit-clear-history-button" class="form-button warning"
            style="margin-bottom: 10px;">清空聊天记录</button>
          <button id="edit-delete-char-button" class="form-button" class="form-button destructive">删除角色</button>
        </div>
      </div>
    </div>

    <div id="group-chat-create-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-group-create" class="header-button">返回</button>
        <span class="header-title">创建群聊</span>
        <button id="create-group-chat-button" class="header-button">创建</button>
      </div>
      <div class="content" style="padding: 20px;">
        <div class="input-group">
          <label for="group-chat-name">群聊名称</label>
          <input type="text" id="group-chat-name" placeholder="给你的群聊起个名字">
        </div>
        <div class="settings-group">
          <h2>选择成员</h2>
          <div id="group-chat-member-list-container"
            style="max-height: 400px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
            <ul id="group-chat-member-list">
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div id="wallpaper-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-wallpaper" class="header-button">返回</button>
        <span class="header-title">更换壁纸</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2>全局主题色</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">拖动滑块来改变整个App的主色调。</p>
          <div class="input-group" style="padding-top: 10px;">
            <label for="theme-hue-slider" style="display: block; margin-bottom: 5px;">色相 (Hue)</label>
            <input type="range" id="theme-hue-slider" min="0" max="360" value="35" style="width: 100%;">
          </div>
          <div class="input-group">
            <label for="theme-lightness-slider" style="display: block; margin-bottom: 5px;">明度 (Lightness)</label>
            <input type="range" id="theme-lightness-slider" min="15" max="95" value="80" style="width: 100%;">
          </div>
        </div>
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2 style="margin-top: 0;">时钟样式</h2>
          <div style="display: flex; align-items: center; gap: 10px;">
            <input type="checkbox" id="clock-color-toggle" style="width: auto; height: 18px; flex-shrink: 0;">
            <label for="clock-color-toggle" style="width: auto; font-size: 0.9rem;">强制使用纯白色时钟 (推荐在深色壁纸下使用)</label>
          </div>
        </div>
        <div class="settings-group">
          <h2>上传新壁纸</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">选择一张图片作为你的手机壁纸。为了效果最好，请使用竖屏图片。</p>
          <input type="file" id="wallpaper-input" accept="image/*" style="display: none;">
          <button id="upload-wallpaper-button" class="form-button">选择图片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>音乐小组件背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的主屏幕音乐小组件设置一张专属背景图。</p>
          <input type="file" id="widget-bg-input" accept="image/*" style="display: none;">
          <button id="upload-widget-bg-button" class="form-button">选择图片</button>
          <button id="reset-widget-bg-button" class="form-button secondary">恢复默认</button>
        </div>
        <div class="settings-group" style="margin-top: 20px;">
          <h2>重置桌面</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">此操作会将所有桌面小组件（时钟、音乐、徽章等）恢复到初始位置，并将壁纸重置为纯白色。</p>
          <button id="reset-desktop-button" class="form-button destructive">重置桌面布局</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义徽章</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面徽章，可以拖动它到任意位置。</p>
          <input type="file" id="badge-input" accept="image/*" style="display: none;">
          <button id="upload-badge-button" class="form-button">选择徽章图片</button>
          <button id="reset-badge-button" class="form-button secondary" style="margin-top: 10px;">移除徽章</button>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面方形卡片小组件。</p>
          <input type="file" id="card-input" accept="image/*" style="display: none;">
          <button id="upload-card-button" class="form-button">选择卡片图片</button>
          <button id="reset-card-button" class="form-button secondary" style="margin-top: 10px;">移除卡片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片 2</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的第二个桌面方形卡片小组件上传图片。</p>
          <input type="file" id="card-input-2" accept="image/*" style="display: none;">
          <button id="upload-card-button-2" class="form-button">选择卡片图片</button>
          <button id="reset-card-button-2" class="form-button secondary" style="margin-top: 10px;">移除卡片
            2</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>动态页背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为“动态”页面设置一张独立的背景图，让它与众不同。</p>
          <input type="file" id="feed-bg-input" accept="image/*" style="display: none;">
          <button id="upload-feed-bg-button" class="form-button">选择图片</button>
        </div>
        <button id="reset-feed-bg-button" class="form-button secondary" style="margin-top: 10px;">移除背景</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>小组件救援</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">如果你的吧唧或卡片不小心飞出屏幕找不到了，点这里让它们回家。</p>
          <button id="reset-widgets-position-button" class="form-button warning">重置小组件位置</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义App图标</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">替换主屏幕上App的默认图标。为了最佳效果，请使用方形、透明背景的图片。</p>
          <div class="settings-group"
            style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
            <h2>自定义表情包</h2>
            <p style="font-size: 0.9rem; color: var(--text-color-light);">
              在这里追加你的专属表情包。每个表情占一行，格式为：<br>
              <b>表情名--图片URL</b><br>
              例如：<br>
              <code>开心--https://example.com/happy.png</code><br>
              <code>难过--https://example.com/sad.gif</code>
            </p>
            <textarea id="custom-stickers-input" rows="8" placeholder="请按指定格式粘贴..."></textarea>
            <button id="save-custom-stickers-button" class="form-button" style="margin-top: 5px;">保存并刷新表情包</button>
          </div>
          <div id="custom-icon-list-container">
          </div>
          <div id="custom-icon-list-container">
          </div>
        </div>
      </div>

    </div>

    <div id="world-book-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-world-book" class="header-button">主屏幕</button>
        <span class="header-title">世界书</span>
        <button id="add-world-book-button" class="header-button add" title="添加新世界书">+</button>
      </div>
      <div class="content" id="world-book-list-container">
      </div>
    </div>

    <div id="world-book-editor-screen" class="screen">
      <div class="header">
        <button id="back-to-world-book-list" class="header-button">返回</button>
        <span id="world-book-editor-title" class="header-title">编辑条目</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-world-book-id">
        <div class="settings-group">
          <h2>设定条目</h2>
          <div class="input-group">
            <label for="world-book-edit-name">条目名称 (Key)</label>
            <input type="text" id="world-book-edit-name" placeholder="例如：我的过去、特殊能力">
          </div>
          <div class="input-group">
            <label for="world-book-edit-content">条目内容 (Value)</label>
            <textarea id="world-book-edit-content" placeholder="输入详细的设定内容..."></textarea>
          </div>
        </div>
        <button id="save-world-book-button" class="form-button">保存条目</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="delete-world-book-button" class="form-button destructive">删除该条目</button>
        </div>
      </div>
    </div>

    <div id="group-settings-screen" class="screen">
      <div class="header">
        <button id="back-to-chat-from-group-settings" class="header-button">返回</button>
        <span class="header-title">群聊设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>群聊信息</h2>
          <div class="input-group">
            <label for="group-settings-name">群聊名称</label>
            <input type="text" id="group-settings-name">
          </div>
          <div class="avatar-upload-group">
            <label>群头像</label>
            <img id="group-avatar-preview" class="avatar-preview" alt="Group Avatar Preview">
            <input type="file" id="group-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label>群聊背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="group-bg-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="群聊背景预览">
            </div>
            <input type="file" id="group-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="group-settings-bind-user">绑定用户</label>
            <select id="group-settings-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="group-world-book-checkboxes" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="save-group-settings-button" class="form-button">保存设置</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="group-clear-history-button" class="form-button warning"
            style=" margin-bottom: 10px;">清空聊天记录</button>
          <button id="group-delete-button" class="form-button destructive">删除并解散群聊</button>
        </div>
      </div>
    </div>

    <div id="music-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-feed" class="header-button">返回</button>
        <span id="friend-circle-title" class="header-title">好友圈</span>
        <div style="display: flex; gap: 5px;">
          <button id="edit-current-circle-button" class="header-button" style="font-size: 1.2rem;">⚙️</button>
          <button id="clear-feed-button" class="header-button" style="color: #dc3545;">清空</button>
          <button id="refresh-feed-button" class="header-button">刷新</button>

        </div>
      </div>
      <div id="user-post-area"
        style="padding: 10px 15px; border-bottom: 1px solid var(--border-color); flex-shrink: 0; background: var(--surface-bg);">
        <div id="user-post-input-container">
          <img id="user-post-avatar" class="char-avatar">
          <div id="user-post-main-area">
            <textarea id="user-post-textarea" rows="3" placeholder="分享你的新鲜事..."></textarea>
            <div id="user-post-attachment-preview"></div>
          </div>
        </div>
        <div id="user-post-toolbar">
          <div id="user-post-actions" class="user-post-actions">
            <button id="user-post-image-button" class="toolbar-button" title="分享图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <input type="file" id="user-post-image-input" accept="image/*" style="display: none;">
            <button id="user-post-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
          </div>
          <button id="user-send-post-button">发送</button>
        </div>
      </div>
      <div id="music-feed-container" class="content" style="padding: 10px;">
      </div>
      <div id="music-player-bar" class="hidden">
        <img id="player-cover" src="">
        <div id="player-info">
          <div id="player-title"></div>
          <div id="player-artist"></div>
        </div>
        <div id="player-controls">
          <button id="player-prev-btn">⏮</button>
          <button id="player-play-pause-btn">▶</button>
          <button id="player-next-btn">⏭</button>
        </div>
      </div>
      <audio id="audio-player"></audio>
    </div>
    <div id="meeting-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-meeting-list" class="header-button">主屏幕</button>
        <span class="header-title">选择见面对象</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="meeting-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="meeting-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-meeting-list">返回</button>
        <span id="meeting-char-name-header" class="header-title">角色</span>
        <button id="toggle-meeting-view-button" class="header-button">切换视角</button>

      </div>
      <div id="meeting-main-content" class="content" style="position: relative; padding: 0;">
        <div id="galgame-overlay-ui">
          <div id="galgame-time">12:00</div>
          <div id="galgame-date">1月1日 星期一</div>
        </div>
        <div id="galgame-sprite-adjust-ui"
          style="position: absolute; top: 20px; right: 20px; z-index: 11; display: none;">
          <button id="sprite-adjust-button" class="toolbar-button" title="调整立绘位置">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 7h-9" />
              <path d="M14 17H5" />
              <circle cx="17" cy="17" r="3" />
              <circle cx="8" cy="7" r="3" />
            </svg>
          </button>
        </div>

        <div id="galgame-sprite-controls"
          style="display: none; position: absolute; bottom: 15px; left: 15px; right: 15px; z-index: 1001; background: rgba(0,0,0,0.7); backdrop-filter: blur(8px); border-radius: 12px; padding: 15px; box-shadow: 0 -2px 15px rgba(0,0,0,0.3);">
          <div class="sprite-slider-group">
            <label for="sprite-slider-x">左右位置</label>
            <input type="range" id="sprite-slider-x" min="0" max="100" value="50">
          </div>
          <div class="sprite-slider-group">
            <label for="sprite-slider-y">上下位置</label>
            <input type="range" id="sprite-slider-y" min="0" max="130" value="100">
          </div>
          <div class="sprite-slider-group">
            <label for="sprite-slider-scale">缩放大小</label>
            <input type="range" id="sprite-slider-scale" min="50" max="200" value="100">
          </div>
          <div style="display: flex; gap: 10px; margin-top: 15px;">
            <button id="sprite-confirm-button" class="form-button">确定</button>
            <button id="sprite-cancel-button" class="form-button secondary">取消</button>
            <button id="sprite-reset-button" class="form-button destructive"
              style="padding: 10px 12px; width: auto; font-size: 1.2rem;">⟲</button>
          </div>
        </div>
        <div id="meeting-scene-view" class="content"
          style="font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif; color: white; text-shadow: 0 1px 3px rgba(0,0,0,0.7);">
        </div>
        <div id="galgame-view-container"
          style="display: none; width: 100%; height: 100%; position: absolute; top: 0; left: 0; overflow: hidden;">
          <div id="galgame-sprite-wrapper"
            style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 100%; height: 100%;">
            <div id="galgame-sprite-container"
              style="position: absolute; display: flex; align-items: flex-end; justify-content: center; /* 移除旧的定位样式 */">
              <img id="galgame-sprite" src=""
                style="max-height: 100%; max-width: 100%; object-fit: contain; transition: opacity 0.3s ease;">
              <div id="sprite-resize-handle"
                style="display: none; position: absolute; bottom: -5px; right: -5px; width: 20px; height: 20px; background: white; border: 2px solid var(--primary-color); border-radius: 50%; cursor: se-resize;">
              </div>
            </div>
          </div>
          <div id="galgame-textbox-container"
            style="position: absolute; bottom: 9%; left: 5%; right: 5%; background: rgba(0, 0, 0, 0.7); border-radius: 10px; padding: 15px; color: white; border-top: 1px solid rgba(255,255,255,0.2); cursor: pointer;">
            <div id="galgame-speaker" style="font-weight: bold; margin-bottom: 10px;">说话人</div>
            <div id="galgame-text" style="line-height: 1.6;">对话内容...</div>
          </div>
        </div>
      </div>
      <div class="chat-input-area">
        <div id="chat-input-wrapper-meeting"> <textarea id="meeting-message-input" placeholder="输入你的行动或对话..." rows="1"
            style="resize: none; overflow-y: auto; flex-grow: 1; border: none; background: transparent; padding: 9px 12px; font-size: .95rem; outline: none; color: var(--text-color);"></textarea>
          <button id="meeting-send-button" title="发送">➤</button>
        </div>
      </div>
    </div>

    <div id="friend-circle-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-circle-list" class="header-button">主屏幕</button>
        <span class="header-title">好友圈</span>
        <button id="add-friend-circle-button" class="header-button add" title="新建好友圈">+</button>
      </div>
      <div id="friend-circle-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="friend-circle-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-edit" class="header-button">返回</button>
        <span id="friend-circle-edit-title" class="header-title">编辑好友圈</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-friend-circle-id">
        <div class="settings-group">
          <h2>好友圈设定</h2>
          <div class="input-group">
            <label for="friend-circle-edit-name">圈子名称</label>
            <input type="text" id="friend-circle-edit-name" placeholder="例如：我的日常">
          </div>
          <div class="input-group">
            <label for="friend-circle-edit-bind-user">绑定的“我”</label>
            <select id="friend-circle-edit-bind-user"></select>
          </div>
        </div>
        <div class="settings-group">
          <h2>选择圈内成员</h2>
          <div id="friend-circle-member-selection"
            style="max-height: 250px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
          </div>
        </div>
        <button id="save-friend-circle-button" class="form-button">保存</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <button id="delete-friend-circle-button" class="form-button destructive">删除该好友圈</button>
        </div>
      </div>
    </div>
    <div id="diary-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-diary-list" class="header-button">主屏幕</button>
        <span class="header-title">交换日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="diary-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-diary-list">返回</button>
        <span id="diary-char-name-header" class="header-title">TA的日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-entries-container" class="content"
        style="padding: 20px; font-family: 'KaiTi', 'STSong', serif; line-height: 1.8;">
      </div>
      <div class="chat-input-area">
        <div id="diary-input-wrapper" style="display: flex; gap: 10px;">
          <input type="text" id="diary-entry-input" placeholder="写下你的日记或批注..." style="flex-grow: 1;">
          <button id="diary-send-button" class="form-button"
            style="width: auto; margin-top: 0; padding: 0 18px;">写好了</button>
          <button id="diary-get-reply-button" class="form-button"
            style="width: auto; margin-top: 0; background-color: #555; padding: 0 18px;">催TA写</button>
        </div>
      </div>
    </div>
    <div id="music-library-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-music-library" class="header-button">主屏幕</button>
        <span class="header-title">音乐库</span>
        <button id="upload-music-button" class="header-button add" title="上传新音乐">+</button>
      </div>
      <div class="content" id="music-library-container">
      </div>
    </div>
    <div id="music-upload-altar-screen" class="screen">
      <div class="header">
        <button id="back-to-library-from-altar" class="header-button">取消</button>
        <span class="header-title">献上音乐</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content" style="padding: 20px; display: flex; flex-direction: column; gap: 15px;">

        <div class="upload-slot" id="altar-slot-audio">
          <span class="slot-icon">🎵</span>
          <span class="slot-label">音频文件 (必需)</span>
          <span class="slot-filename">点击选择 .mp3 或 .flac</span>
        </div>

        <div class="upload-slot" id="altar-slot-cover">
          <span class="slot-icon">🖼️</span>
          <span class="slot-label">封面图片 (可选)</span>
          <span class="slot-filename">点击选择 .jpg 或 .png</span>
        </div>

        <div class="upload-slot" id="altar-slot-info">
          <span class="slot-icon">📄</span>
          <span class="slot-label">歌曲信息 (必需)</span>
          <span class="slot-filename">点击选择 info.txt</span>
        </div>

        <div class="upload-slot" id="altar-slot-lyrics">
          <span class="slot-icon">🎤</span>
          <span class="slot-label">歌词文件 (可选)</span>
          <span class="slot-filename">点击选择 .lrc</span>
        </div>

        <button id="confirm-altar-upload-button" class="form-button" disabled>献上祭品</button>
      </div>

    </div>


    <div id="accounting-screen" class="screen">
      <div class="header" id="accounting-header">
        <button id="back-to-home-from-accounting" class="header-button">主屏幕</button>
        <span id="accounting-title" class="header-title">记一笔</span>
        <div id="header-actions" style="width: 80px; text-align: right;"></div>
      </div>

      <div class="accounting-tabs">
        <button id="tab-record-expense" class="tab-button active">记一笔</button>
        <button id="tab-view-ledger" class="tab-button">看账本</button>
      </div>

      <div id="accounting-content-area" class="content" style="padding: 15px;">
      </div>
    </div>
    <audio id="audio-player"></audio>

    <audio id="unified-audio-player"></audio>



  </div>
  </div>

  <div id="add-choice-modal" class="choice-modal">
    <div id="add-choice-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="choice-create-character" class="choice-modal-button">创建新角色</button>
      <button id="choice-create-group" class="choice-modal-button">创建新群聊</button>
      <button id="choice-import-character" class="choice-modal-button">导入角色卡</button>
      <button id="choice-cancel" class="choice-modal-button cancel">取消</button>
    </div>
  </div>


  <div id="transfer-modal" class="choice-modal">
    <div id="transfer-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">转账</h3>
      <div id="transfer-recipient-group" class="input-group" style="margin: 10px 0; display: none;">
        <label for="transfer-recipient-select">转给</label>
        <select id="transfer-recipient-select"></select>
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="transfer-amount-input">金额</label>
        <input type="number" id="transfer-amount-input" placeholder="输入金额">
      </div>
      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-transfer-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认转账</button>
        <button id="cancel-transfer-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="message-action-modal" class="choice-modal">
    <div id="message-action-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="edit-message-button" class="choice-modal-button">编辑消息</button>
      <button id="quote-message-button" class="choice-modal-button">引用</button>
      <button id="delete-message-button" class="choice-modal-button" style="color: #dc3545;">删除消息</button>
      <button id="cancel-action-button" class="choice-modal-button cancel">取消</button>
    </div>
  </div>

  <div id="edit-message-modal" class="choice-modal">
    <div id="edit-message-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">编辑消息</h3>
      <textarea id="edit-message-textarea" style="width: 100%; min-height: 100px; margin: 10px 0;"></textarea>
      <div style="display: flex; gap: 10px; margin-top: 10px;">
        <button id="save-edit-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">保存</button>
        <button id="cancel-edit-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="music-input-modal" class="choice-modal">
    <div id="music-input-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 id="music-input-title" style="margin-top: 0; text-align: center; font-weight: 600;">分享音乐</h3>

      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-song" style="font-size: 0.9rem;">歌名</label>
        <input type="text" id="music-input-song" placeholder="例如：夜曲">
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-artist" style="font-size: 0.9rem;">歌手</label>
        <input type="text" id="music-input-artist" placeholder="例如：周杰伦">
      </div>

      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-music-input" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认</button>
        <button id="cancel-music-input" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="modal-root"
    style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:9999;">
    <div id="modal-mask" style="position:absolute;inset:0;background:rgba(0,0,0,.35);"></div>
    <div id="modal-dialog"
      style="position:relative;background:#fff;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.2);width:80%;max-width:320px;padding:16px;">
      <div id="modal-text" style="font-size:14px;color:#333;line-height:1.5;white-space:pre-wrap;"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:16px;">
        <button id="modal-cancel"
          style="padding:8px 12px;border:1px solid #ddd;border-radius:8px;background:#fff;cursor:pointer;">取消</button>
        <button id="modal-ok"
          style="padding:8px 12px;border:none;border-radius:8px;background:#007bff;color:#fff;cursor:pointer;">确定</button>
      </div>
    </div>
  </div>

  <div id="listen-together-modal" class="choice-modal">
    <div id="listen-together-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <div style="width: 50px;"></div>
        <span class="header-title">选择一首歌，一起听</span>
        <button id="cancel-listen-together" class="header-button" style="min-width: 50px;">取消</button>
      </div>
      <div id="listen-together-song-list" class="content" style="flex-grow: 1; padding: 10px;">
      </div>
    </div>
  </div>

  <div id="toast"
    style="position:fixed;left:50%;bottom:32px;transform:translateX(-50%);background:rgba(0,0,0,.8);color:#fff;padding:8px 12px;border-radius:8px;font-size:12px;display:none;z-index:10000;">
  </div>

  <script>
    const _0x5b66b2 = _0x1507; (function (_0x34f476, _0x5df180) { const _0x35b239 = _0x1507, _0x3a9acf = _0x34f476(); while (!![]) { try { const _0x1a3fcf = -parseInt(_0x35b239(0x630)) / 0x1 * (parseInt(_0x35b239(0x420)) / 0x2) + -parseInt(_0x35b239(0x456)) / 0x3 * (parseInt(_0x35b239(0x838)) / 0x4) + parseInt(_0x35b239(0x796)) / 0x5 + parseInt(_0x35b239(0x80f)) / 0x6 + -parseInt(_0x35b239(0x89f)) / 0x7 + parseInt(_0x35b239(0x7a4)) / 0x8 * (parseInt(_0x35b239(0x37a)) / 0x9) + parseInt(_0x35b239(0x2eb)) / 0xa; if (_0x1a3fcf === _0x5df180) break; else _0x3a9acf['push'](_0x3a9acf['shift']()); } catch (_0x5e6ee0) { _0x3a9acf['push'](_0x3a9acf['shift']()); } } }(_0x447c, 0xc7a63)); var _0x79fbb7, _0x4d3825 = null; let _0x57edcf = [], _0x2f660c = ![], _0xf3f85b = { 'x': 0x0, 'y': 0x0 }; function _0x234215(_0x45f0a2) { const _0x39192c = _0x1507; return (_0x79fbb7?.[_0x39192c(0x44f)] || [])[_0x39192c(0x2aa)](_0x3b1e9d => _0x3b1e9d['id'] === _0x45f0a2); } const _0x408a25 = _0x5b66b2(0x297), _0x4f5e50 = _0x5b66b2(0x2ba), _0x426b80 = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNjY2MiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDRhNC4zOSA0LjM5IDAgMCAwLTMuMjgtNC4wOWwxLjQxLTEuNDFhMiAyIDAgMSAwLTIuODMtMi4wM2wtMS40MSAxLjQxQTQuMzkgNC4zOSAwIDAgMCAxMiAxMGE0LjM5IDQuMzkgMCAwIDAtNC4wOSAzLjI4TDMuMicgOS41N2EyIDIgMCAxIDAgMi44MyAyLjgzbDEuNDEtMS40MUE0LjM5IDQuMzkgMCAwIDAgMTAgMTJhNC4zOSA0LjM5IDAgMCAwIDMgNC4wOVYyMSI+PC9wYXRoPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjEwIj48L2NpcmNsZT48L3N2Zz4=', _0xb39ef9 = [{ 'name': _0x5b66b2(0x884), 'url': _0x5b66b2(0x33e) }, { 'name': '崩溃', 'url': _0x5b66b2(0x239) }, { 'name': '生病', 'url': _0x5b66b2(0x707) }, { 'name': '工作', 'url': 'https://sharkpan.xyz/f/7L3Hj/sl4504.jpg' }, { 'name': _0x5b66b2(0x6f2), 'url': _0x5b66b2(0x73b) }, { 'name': _0x5b66b2(0x6d5), 'url': 'https://sharkpan.xyz/f/wjgHq/yznfhq.jpg' }, { 'name': _0x5b66b2(0x44d), 'url': 'https://sharkpan.xyz/f/MWOIa/rb3nov.jpg' }, { 'name': '期待', 'url': _0x5b66b2(0x85d) }, { 'name': '喜欢', 'url': _0x5b66b2(0x7ff) }, { 'name': _0x5b66b2(0x300), 'url': _0x5b66b2(0x3db) }, { 'name': _0x5b66b2(0x584), 'url': 'https://sharkpan.xyz/f/jj6s6/yd5bpb.jpg' }, { 'name': '委屈', 'url': _0x5b66b2(0x128) }, { 'name': '加油', 'url': _0x5b66b2(0x566) }, { 'name': '对的', 'url': _0x5b66b2(0x27d) }, { 'name': '不满', 'url': _0x5b66b2(0x8e9) }, { 'name': _0x5b66b2(0x35c), 'url': 'https://sharkpan.xyz/f/qjJT3/kpy33b.jpg' }, { 'name': _0x5b66b2(0x58b), 'url': _0x5b66b2(0x757) }, { 'name': '委屈', 'url': _0x5b66b2(0x837) }, { 'name': '平静', 'url': _0x5b66b2(0x311) }, { 'name': '咬你', 'url': 'https://sharkpan.xyz/f/JYeig/sv4p6m.jpg' }, { 'name': '咱俩天下第一好', 'url': _0x5b66b2(0x52c) }, { 'name': '好困', 'url': _0x5b66b2(0x10b) }, { 'name': '摸鱼', 'url': _0x5b66b2(0x129) }, { 'name': _0x5b66b2(0x15f), 'url': _0x5b66b2(0x367) }, { 'name': '超激动我来了', 'url': _0x5b66b2(0x138) }, { 'name': _0x5b66b2(0x83c), 'url': _0x5b66b2(0x25e) }, { 'name': '一起听歌', 'url': _0x5b66b2(0x80b) }, { 'name': '刷我的卡', 'url': _0x5b66b2(0x7ba) }, { 'name': _0x5b66b2(0x703), 'url': _0x5b66b2(0x522) }, { 'name': _0x5b66b2(0x7c9), 'url': _0x5b66b2(0x1ee) }, { 'name': _0x5b66b2(0x6c2), 'url': _0x5b66b2(0x1a1) }, { 'name': _0x5b66b2(0x51c), 'url': _0x5b66b2(0x1f8) }, { 'name': _0x5b66b2(0x7d3), 'url': _0x5b66b2(0x726) }, { 'name': _0x5b66b2(0x443), 'url': _0x5b66b2(0x40d) }, { 'name': _0x5b66b2(0x245), 'url': _0x5b66b2(0x1a7) }, { 'name': _0x5b66b2(0x888), 'url': _0x5b66b2(0x1cc) }, { 'name': _0x5b66b2(0x2af), 'url': _0x5b66b2(0x5e9) }, { 'name': _0x5b66b2(0x90c), 'url': 'https://sharkpan.xyz/f/4aqCj/gp13hn.jpg' }, { 'name': _0x5b66b2(0x4be), 'url': 'https://sharkpan.xyz/f/N02Sv/378vt6.jpg' }, { 'name': _0x5b66b2(0x5eb), 'url': 'https://sharkpan.xyz/f/VG2FY/uucfvv.jpg' }, { 'name': _0x5b66b2(0x74c), 'url': _0x5b66b2(0x387) }, { 'name': _0x5b66b2(0x5f5), 'url': _0x5b66b2(0x1eb) }, { 'name': _0x5b66b2(0x7ef), 'url': _0x5b66b2(0x8cb) }, { 'name': _0x5b66b2(0x8fe), 'url': _0x5b66b2(0x756) }, { 'name': '谁啊我吗', 'url': _0x5b66b2(0x41e) }, { 'name': _0x5b66b2(0x1b8), 'url': _0x5b66b2(0x1f5) }, { 'name': _0x5b66b2(0x565), 'url': _0x5b66b2(0x41a) }, { 'name': _0x5b66b2(0x284), 'url': _0x5b66b2(0x28f) }, { 'name': '我是小丑呜呜', 'url': _0x5b66b2(0x7b2) }, { 'name': '我不想工作', 'url': _0x5b66b2(0x8de) }, { 'name': _0x5b66b2(0x56e), 'url': _0x5b66b2(0x4a6) }, { 'name': _0x5b66b2(0x2cb), 'url': _0x5b66b2(0x37d) }, { 'name': '我是女仆', 'url': _0x5b66b2(0x202) }, { 'name': '等你', 'url': _0x5b66b2(0x3dd) }, { 'name': '一个人可怜吃饭', 'url': _0x5b66b2(0x82f) }, { 'name': _0x5b66b2(0x170), 'url': _0x5b66b2(0x299) }, { 'name': '喝酒', 'url': _0x5b66b2(0x5e1) }, { 'name': _0x5b66b2(0x720), 'url': _0x5b66b2(0x925) }, { 'name': '呜呜', 'url': _0x5b66b2(0x467) }, { 'name': _0x5b66b2(0x691), 'url': _0x5b66b2(0x3e2) }, { 'name': _0x5b66b2(0x86f), 'url': _0x5b66b2(0x153) }, { 'name': _0x5b66b2(0x230), 'url': _0x5b66b2(0x1fa) }, { 'name': '请看是我', 'url': 'https://sharkpan.xyz/f/Mamca/4e3emf.jpg' }, { 'name': _0x5b66b2(0x7c5), 'url': _0x5b66b2(0x670) }], _0x3adc9c = { 'beige': { 'name': '默认米白', 'h': 0x23, 's': 0x19, 'l': 0x50 }, 'mizuiro': { 'name': _0x5b66b2(0x723), 'h': 0xc3, 's': 0x19, 'l': 0x50 }, 'sakura': { 'name': _0x5b66b2(0x4d9), 'h': 0x159, 's': 0x19, 'l': 0x50 }, 'noir': { 'name': '暗夜紫晶', 'h': 0x104, 's': 0xf, 'l': 0x1e } }; document[_0x5b66b2(0x3eb)]('DOMContentLoaded', () => { const _0x2b3d5e = _0x5b66b2, _0x4d6038 = document[_0x2b3d5e(0x1f3)]('app-user-profiles'), _0x552e4f = document['getElementById'](_0x2b3d5e(0x2f2)), _0x522dc5 = document[_0x2b3d5e(0x1f3)]('transfer-modal'), _0x1c8c06 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x544)), _0x13835b = document['getElementById'](_0x2b3d5e(0x332)), _0x46340f = document[_0x2b3d5e(0x1f3)]('cancel-transfer-button'), _0x301768 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x7c1)), _0x1f36dc = document['getElementById']('transfer-recipient-select'), _0xfe89a2 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x38b)), _0xe58dc1 = document['getElementById'](_0x2b3d5e(0x386)), _0x22bfd2 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x7dc)), _0x1049ba = document['getElementById'](_0x2b3d5e(0x432)), _0x301ffc = document[_0x2b3d5e(0x1f3)]('summarize-backdrop'), _0x50b6d5 = document['getElementById'](_0x2b3d5e(0x84e)), _0x1fe82f = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x411)), _0x41192f = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x53b)), _0x49d211 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x19d)), _0x249a81 = document['getElementById'](_0x2b3d5e(0x19c)), _0x3cb122 = document[_0x2b3d5e(0x1f3)]('char-edit-offline-bg-preview'), _0x19f47d = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x2c7)), _0x184742 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x1e0)), _0x22d0bc = document['getElementById'](_0x2b3d5e(0x390)), _0x4b1761 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x313)); function _0x71d223() { const _0x4f0cf1 = _0x2b3d5e, _0x5940b1 = document[_0x4f0cf1(0x1f3)](_0x4f0cf1(0x76f)); if (!_0x5940b1) return; const _0x5170d3 = localStorage[_0x4f0cf1(0xfc)](_0x4f0cf1(0x4f5)) || '35'; document[_0x4f0cf1(0x81c)][_0x4f0cf1(0x324)][_0x4f0cf1(0x79d)]('--primary-hue', _0x5170d3), _0x5940b1[_0x4f0cf1(0x2ff)] = _0x5170d3, _0x5940b1[_0x4f0cf1(0x3eb)](_0x4f0cf1(0x266), () => { const _0x17a29c = _0x4f0cf1, _0x76b13a = _0x5940b1[_0x17a29c(0x2ff)]; document[_0x17a29c(0x81c)][_0x17a29c(0x324)]['setProperty'](_0x17a29c(0x69a), _0x76b13a), localStorage[_0x17a29c(0x54a)](_0x17a29c(0x4f5), _0x76b13a), _0x4af2ac(); }); } function _0x3d03fb() { const _0x229c91 = _0x2b3d5e, _0x3821f1 = document[_0x229c91(0x1f3)](_0x229c91(0x287)); if (!_0x3821f1) return; const _0x22ccf5 = localStorage[_0x229c91(0xfc)](_0x229c91(0x543)) || '80'; document[_0x229c91(0x81c)][_0x229c91(0x324)][_0x229c91(0x79d)]('--primary-lightness', _0x22ccf5 + '%'), _0x3821f1[_0x229c91(0x2ff)] = _0x22ccf5, _0x3821f1['addEventListener'](_0x229c91(0x266), () => { const _0x4f1e0f = _0x229c91, _0x5a6c6a = _0x3821f1[_0x4f1e0f(0x2ff)]; document['documentElement'][_0x4f1e0f(0x324)][_0x4f1e0f(0x79d)](_0x4f1e0f(0x84b), _0x5a6c6a + '%'), localStorage[_0x4f1e0f(0x54a)](_0x4f1e0f(0x543), _0x5a6c6a), _0x4af2ac(); }); } function _0x4af2ac() { const _0x7d878b = _0x2b3d5e; if ('yrAif' !== _0x7d878b(0x5c9)) { const _0x368d12 = document[_0x7d878b(0x1f3)](_0x7d878b(0x85c)); if (!_0x368d12) return; if (_0x79fbb7[_0x7d878b(0x11a)][_0x7d878b(0x14a)]) { if (_0x7d878b(0x33c) === _0x7d878b(0x33c)) _0x368d12[_0x7d878b(0x324)][_0x7d878b(0x6c0)] = '#FFFFFF', _0x368d12[_0x7d878b(0x324)][_0x7d878b(0x13c)] = _0x7d878b(0x5ff); else { const _0x3bf328 = _0x39ca94[_0x7d878b(0x1f3)](_0x7d878b(0x808)); if (!_0x3bf328) return; _0x3bf328['checked'] = _0x5808d5[_0x7d878b(0x11a)][_0x7d878b(0x14a)] || ![], _0x3bf328[_0x7d878b(0x3eb)](_0x7d878b(0x3b3), () => { const _0x42590b = _0x7d878b; _0x26da34[_0x42590b(0x11a)][_0x42590b(0x14a)] = _0x3bf328[_0x42590b(0x38e)], _0x179350(), _0x32feac(); }); } } else 'oWVcf' === _0x7d878b(0x273) ? (_0x368d12[_0x7d878b(0x324)]['color'] = _0x7d878b(0x3f2), _0x368d12[_0x7d878b(0x324)]['textShadow'] = _0x7d878b(0x277)) : _0x2da593[_0x7d878b(0x144)] = _0x1387f7['scrollHeight']; } else _0x90fb72['style'][_0x7d878b(0x6a7)] = ''; } function _0xbfdeb2() { const _0x52ac29 = _0x2b3d5e; if (_0x52ac29(0x915) !== 'faXzl') { const _0x324a77 = _0x520780['characterLastScripts'][_0x48bb1e]; _0x324a77 && _0x324a77['length'] > 0x0 && (_0x4bd7fb = _0x324a77['at'](-0x1)); } else { const _0x28dc79 = document[_0x52ac29(0x1f3)](_0x52ac29(0x808)); if (!_0x28dc79) return; _0x28dc79[_0x52ac29(0x38e)] = _0x79fbb7[_0x52ac29(0x11a)][_0x52ac29(0x14a)] || ![], _0x28dc79[_0x52ac29(0x3eb)](_0x52ac29(0x3b3), () => { const _0x8aca74 = _0x52ac29; _0x79fbb7[_0x8aca74(0x11a)][_0x8aca74(0x14a)] = _0x28dc79['checked'], _0x43a351(), _0x4af2ac(); }); } } _0x4b1761[_0x2b3d5e(0x3eb)]('click', _0x5ac541), _0x184742['addEventListener'](_0x2b3d5e(0x1a4), () => { const _0x2b1505 = _0x2b3d5e; if (_0x2b1505(0x349) !== _0x2b1505(0x349)) { let _0x327ea9 = ''; if (_0x25eaf6[_0x2b1505(0x16c)] && _0x43bf3a[_0x2b1505(0x16c)][_0x2b1505(0x629)] > 0x0) { const _0x1758d0 = _0x474cdd[_0x2b1505(0x16c)][_0x2b1505(0x843)](_0x2682d2 => _0xdfb927(_0x2682d2)?.[_0x2b1505(0x908)] || '未知')[_0x2b1505(0x26c)]('、'), _0x48b9d5 = _0x2b1505(0x7a3); _0x327ea9 = '<div\x20class=\x22post-likes\x22>' + _0x48b9d5 + '\x20' + _0x1758d0 + _0x2b1505(0x392); } let _0x14b2d4 = ''; if (_0x20363c[_0x2b1505(0x7c3)] && _0x539611[_0x2b1505(0x7c3)][_0x2b1505(0x629)] > 0x0) { const _0x5a4877 = _0x1d4528[_0x2b1505(0x7c3)][_0x2b1505(0x843)](_0x302840 => { const _0x56ad21 = _0x2b1505, _0x22d231 = _0xc294a3(_0x302840[_0x56ad21(0x696)])?.[_0x56ad21(0x908)] || '未知'; return '<div\x20class=\x22post-comment\x22><span\x20class=\x22comment-author\x22>' + _0x22d231 + '</span>:\x20' + _0x302840[_0x56ad21(0x317)] + _0x56ad21(0x392); })[_0x2b1505(0x26c)](''); _0x14b2d4 = _0x2b1505(0x193) + _0x5a4877 + _0x2b1505(0x392); } _0x1e16b4 = _0x2b1505(0x2d9) + _0x327ea9 + _0x2b1505(0x4a0) + _0x14b2d4 + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20'; } else _0x2c21be(), _0x22d0bc['click'](); }), _0x22d0bc['addEventListener'](_0x2b3d5e(0x3b3), _0x43e9b2); const _0x59c481 = { 'home': document[_0x2b3d5e(0x1f3)]('home-screen'), 'chat': document[_0x2b3d5e(0x1f3)]('chat-screen'), 'settings': document['getElementById'](_0x2b3d5e(0x2a4)), 'userProfile': document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x6cc)), 'characterEdit': document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x4cf)), 'groupChatCreate': document['getElementById'](_0x2b3d5e(0x569)), 'wallpaper': document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x34c)), 'worldBook': document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x132)), 'worldBookEditor': document['getElementById']('world-book-editor-screen'), 'groupSettings': document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x69b)), 'music': document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x56f)), 'friendCircleList': document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x663)), 'friendCircleEdit': document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x7de)), 'meetingList': document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x471)), 'meetingView': document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x43b)), 'userProfileList': document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x558)), 'diaryList': document['getElementById'](_0x2b3d5e(0x323)), 'diaryView': document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x1e4)), 'musicLibrary': document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x2b4)), 'musicUploadAltar': document['getElementById'](_0x2b3d5e(0x21f)), 'accounting': document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x22d)) }, _0x500656 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x5d6)), _0x378dee = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x439)), _0x4c5a67 = document[_0x2b3d5e(0x1f3)]('reset-feed-bg-button'), _0x51ae5a = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x447)), _0x143662 = document[_0x2b3d5e(0x1f3)]('app-world-book'), _0x461247 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x6f3)), _0x4f944c = document[_0x2b3d5e(0x1f3)]('wallpaper-input'), _0x49ac4d = document[_0x2b3d5e(0x1f3)]('upload-wallpaper-button'); document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x8a3))[_0x2b3d5e(0x3eb)]('click', async () => { const _0x1f0a73 = _0x2b3d5e; if (_0x1f0a73(0x4ea) !== 'GYAVT') { const _0x31accd = await _0x21bcbb('确定要重置所有桌面小组件和App的位置，并将壁纸变为纯白吗？此操作后将刷新页面。'); if (_0x31accd) { localStorage[_0x1f0a73(0x847)](_0x1f0a73(0x217)), localStorage[_0x1f0a73(0x847)](_0x1f0a73(0x4b7)), localStorage['removeItem'](_0x1f0a73(0x8d3)), localStorage[_0x1f0a73(0x847)](_0x1f0a73(0x139)); const _0x314d28 = []; for (let _0x2ab021 = 0x0; _0x2ab021 < localStorage[_0x1f0a73(0x629)]; _0x2ab021++) { const _0x52fc86 = localStorage['key'](_0x2ab021); _0x52fc86 && _0x52fc86[_0x1f0a73(0x55c)]('appIconPosition_') && _0x314d28[_0x1f0a73(0x7d8)](_0x52fc86); } _0x314d28['forEach'](_0x316be4 => localStorage[_0x1f0a73(0x847)](_0x316be4)), await _0x43bf1f(_0x1f0a73(0x2d1), await _0x4f6af3(_0x1f0a73(0x2e9))), _0x30a64e(_0x1f0a73(0x597)), setTimeout(() => location[_0x1f0a73(0x29b)](), 0x5dc); } } else _0x178f4c(_0x114919['participantIds'][0x0]); }); const _0x107ee9 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x4f9)), _0x5bd9ca = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x900)), _0x158a5a = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x4ce)), _0x4e1596 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x255)), _0x6c555c = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x462)), _0x29db23 = document[_0x2b3d5e(0x1f3)]('back-to-char-select-from-group-create'), _0x376a4f = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x405)), _0x269303 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x5c1)), _0x56867f = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x66e)), _0x135526 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x16b)), _0x42c9fd = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x315)), _0x30548a = document['getElementById'](_0x2b3d5e(0x751)), _0x44a515 = document[_0x2b3d5e(0x1f3)]('back-to-home-from-chat'), _0x412776 = document['getElementById'](_0x2b3d5e(0x394)), _0x215f0e = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x553)), _0xd32f6b = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x852)), _0x2f252c = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x3a6)), _0x59ac4f = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0xfe)), _0x1ecdb4 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x5d0)), _0x143e84 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x47d)), _0x51655b = document['getElementById'](_0x2b3d5e(0x304)), _0x3e61e6 = document['getElementById'](_0x2b3d5e(0x36a)), _0x2183ce = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x4cd)), _0x269ca5 = document[_0x2b3d5e(0x1f3)]('quote-preview-area'), _0xe8c2c6 = document['getElementById'](_0x2b3d5e(0x3d9)), _0x4b740b = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x520)), _0x599432 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x409)), _0x4797f2 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x152)), _0x570b0c = document['getElementById']('chat-sticker-button'), _0x39e70e = document[_0x2b3d5e(0x1f3)]('chat-sticker-panel'), _0x6340b4 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x651)), _0x26026c = document['getElementById'](_0x2b3d5e(0x30b)), _0x348317 = document[_0x2b3d5e(0x1f3)]('character-settings-button'), _0x381ac5 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x5c7)), _0x3693f4 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x172)), _0x2e9e79 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x2f0)), _0x5f1053 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x1b7)), _0x30c677 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x706)), _0x4e0ad3 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x89d)), _0x6c38e3 = document['getElementById']('model-dropdown'), _0x122a47 = document['getElementById'](_0x2b3d5e(0x863)), _0x209c55 = document['getElementById'](_0x2b3d5e(0x84c)), _0x834305 = document['getElementById']('user-avatar-preview'), _0x4f6f27 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x803)), _0x553e82 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x7e8)), _0x2f81e5 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x165)), _0x4015c3 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x3fd)), _0x519a7f = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x1af)), _0x49dbc4 = document[_0x2b3d5e(0x1f3)]('char-edit-name'), _0x136b32 = document['getElementById'](_0x2b3d5e(0x761)), _0x415148 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x100)), _0x1369c8 = document['getElementById']('char-edit-avatar-input'), _0x4f99f2 = document['getElementById'](_0x2b3d5e(0x596)), _0x1fac1e = document['getElementById'](_0x2b3d5e(0x737)), _0x7c0f7e = document['getElementById']('edit-clear-history-button'), _0x2899ae = document[_0x2b3d5e(0x1f3)]('edit-delete-char-button'); let _0x36fb77 = null; const _0x178d57 = _0x2b3d5e(0x607), _0x57e484 = '\x0a#\x20核心任务\x0a你是一个高度智能的档案管理员，任务是为我（用户，名为“{userName}”）和角色“{charName}”之间的私聊记录生成一份简洁、结构化的长期记忆摘要。\x0a\x0a#\x20摘要规则\x0a1.\x20\x20**格式**:\x20你的输出【必须】是、也【只能】是一个遵循\x20YAML\x20格式的纯文本。严禁包含任何\x20JSON、Markdown\x20或其他解释性文字。\x0a2.\x20\x20**结构**:\x0a\x20\x20\x20\x20-\x20根节点必须是\x20`memory_summary:`。\x0a\x20\x20\x20\x20-\x20下一级是以日期（`YYYY-MM-DD`）作为键。\x0a\x20\x20\x20\x20-\x20每个日期下是一个事件列表，每一项都是一个以连字符\x20`-`\x20开头的字符串。\x0a3.\x20\x20**内容**:\x0a\x20\x20\x20\x20-\x20**精简**:\x20忽略日常问候、无意义的闲聊和重复内容。\x0a\x20\x20\x20\x20-\x20**聚焦**:\x20专注于关键信息、情感转折点、重要决定、分享的秘密、设定的约定、以及能够体现角色性格和关系变化的核心事件。\x0a\x20\x20\x20\x20-\x20**中立视角**:\x20以客观的第三人称视角进行记录。**请直接使用“{userName}”和“{charName}”这两个具体的名字**\x20来指代双方。\x0a\x0a#\x20输出示例\x0amemory_summary:\x0a\x20\x202025-09-12:\x0a\x20\x20\x20\x20-\x20\x22userName}\x20表达了对最近工作压力的烦恼。\x22\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20分享了自己过去类似的经历来安慰\x20{userName}，并提议周末一起去看电影。\x22\x0a\x20\x20\x20\x20-\x20\x22双方约定周六下午在市中心的电影院见面，并确定观看电影《夏日终曲》。\x22\x0a\x20\x202025-09-13:\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20发来一张猫咪的图片，心情看起来不错。\x22\x0a\x20\x20\x20\x20-\x20\x22{userName}\x20讨论了关于一个新项目的想法，{charName}\x20给出了一些关键建议。\x22\x0a\x0a#\x20输入格式\x0a我将为你提供完整的聊天记录，格式如下：\x0a[YYYY-MM-DD\x20HH:MM]\x20[说话人]:\x20聊天内容\x0a\x0a#\x20最终指令\x0a请严格按照上述规则，分析我提供的聊天记录全文，并生成一份\x20YAML\x20格式的摘要。直接从\x20`memory_summary:`\x20开始输出。\x0a'; _0x79fbb7 = { 'characters': [], 'worldBooks': [], 'chats': [], 'userProfiles': [], 'activeUserProfileId': null, 'apiSettings': { 'endpoint': '', 'key': '', 'model': '' }, 'preferences': { 'widgetBgImage': null, 'perChatContextLines': 0x64, 'forceWhiteClock': ![] }, 'activeChatId': null, 'activeMeetingCharId': null, 'isGenerating': ![], 'currentAbortController': null, 'pendingMessageTimers': [], 'conversationHistory': [], 'displayedMessageCount': 0x64, 'activeQuote': null, 'friendCircles': [], 'activeFriendCircleId': null, 'accountingData': [], 'accountingLedger': {}, 'diaries': [], 'activeDiaryCharacterId': null, 'diaries': [], 'activeDiaryCharacterId': null, 'meetingViewMode': 'novel', 'activeMeetingScriptQueue': [], 'characterLastScripts': {}, 'musicPlaylist': [], 'currentlyPlayingIndex': -0x1, 'isPlaying': ![], 'pendingPostAttachments': { 'image': null, 'music': null } }; function _0x43a351() { const _0x42143e = _0x2b3d5e; try { if (_0x42143e(0x5d7) !== _0x42143e(0x5d7)) { const _0x50bed4 = _0x28ece6['getElementById'](_0x42143e(0x287)); if (!_0x50bed4) return; const _0x1c69c3 = _0x1b815e['getItem']('themeLightness') || '80'; _0x7ba76[_0x42143e(0x81c)][_0x42143e(0x324)]['setProperty'](_0x42143e(0x84b), _0x1c69c3 + '%'), _0x50bed4['value'] = _0x1c69c3, _0x50bed4['addEventListener']('input', () => { const _0x196979 = _0x42143e, _0x537f9c = _0x50bed4[_0x196979(0x2ff)]; _0xc186a8[_0x196979(0x81c)][_0x196979(0x324)][_0x196979(0x79d)]('--primary-lightness', _0x537f9c + '%'), _0x2f50a5[_0x196979(0x54a)](_0x196979(0x543), _0x537f9c), _0x514aca(); }); } else { const _0x190664 = { 'characters': _0x79fbb7[_0x42143e(0x44f)], 'worldBooks': _0x79fbb7[_0x42143e(0x32e)], 'chats': _0x79fbb7[_0x42143e(0x4c9)], 'userProfile': _0x79fbb7[_0x42143e(0x1ab)], 'apiSettings': _0x79fbb7[_0x42143e(0x164)], 'preferences': _0x79fbb7['preferences'], 'activeChatId': _0x79fbb7[_0x42143e(0x4d8)], 'diaries': _0x79fbb7[_0x42143e(0x84d)], 'friendCircles': _0x79fbb7[_0x42143e(0x70f)], 'activeFriendCircleId': _0x79fbb7[_0x42143e(0x21d)], 'userProfiles': _0x79fbb7[_0x42143e(0x8d2)], 'activeUserProfileId': _0x79fbb7[_0x42143e(0x4dd)], 'accountingData': _0x79fbb7[_0x42143e(0x3b2)], 'accountingLedger': _0x79fbb7[_0x42143e(0x49c)] }; localStorage[_0x42143e(0x54a)](_0x42143e(0x57b), JSON['stringify'](_0x190664)); } } catch (_0x4bb844) { console[_0x42143e(0x412)](_0x42143e(0x606), _0x4bb844), _0x30a64e('无法保存状态，浏览器可能禁用了存储功能。'); } } function _0xc6e30d() { const _0x588542 = _0x2b3d5e; let _0x245317 = null; try { _0x245317 = localStorage['getItem'](_0x588542(0x57b)); } catch (_0x297bd3) { console[_0x588542(0x412)](_0x588542(0x2be), _0x297bd3), _0x30a64e(_0x588542(0x2d4)); } if (_0x245317) try { const _0x46aacb = JSON[_0x588542(0x4f6)](_0x245317); if (!_0x46aacb || typeof _0x46aacb !== _0x588542(0x22a)) throw new Error(_0x588542(0x573)); Array[_0x588542(0x660)](_0x46aacb['characters']) && (_0x79fbb7[_0x588542(0x44f)] = _0x46aacb[_0x588542(0x44f)][_0x588542(0x843)](_0x11c168 => ({ 'offlineBackground': '', ..._0x11c168 }))[_0x588542(0x6a6)](_0x324041 => _0x324041 && typeof _0x324041 === _0x588542(0x22a) && _0x324041['id'])); _0x46aacb[_0x588542(0x3b2)] && (_0x79fbb7[_0x588542(0x3b2)] = _0x46aacb[_0x588542(0x3b2)]); _0x46aacb['accountingLedger'] && (_0x588542(0x215) !== _0x588542(0x2a3) ? _0x79fbb7['accountingLedger'] = _0x46aacb['accountingLedger'] : _0xcac068[_0x588542(0x412)](_0x588542(0x1cb), _0x57051c)); Array[_0x588542(0x660)](_0x46aacb[_0x588542(0x32e)]) && (_0x79fbb7[_0x588542(0x32e)] = _0x46aacb[_0x588542(0x32e)]); if (Array[_0x588542(0x660)](_0x46aacb[_0x588542(0x84d)])) { if ('nbqBj' !== 'gOwsa') _0x79fbb7[_0x588542(0x84d)] = _0x46aacb[_0x588542(0x84d)]; else { const _0xc70288 = _0x34e7c7['friendCircles'][_0x588542(0x2aa)](_0x4e516c => _0x4e516c['id'] === _0x142703[_0x588542(0x21d)]), _0x15a02b = _0xc70288?.[_0x588542(0x536)]; let _0x29fbc8 = _0x4da1e3['userProfiles']['find'](_0x4c96f0 => _0x4c96f0['id'] === _0x15a02b); !_0x29fbc8 && (_0x29fbc8 = _0x2a4174['userProfiles']['find'](_0x37a70b => _0x37a70b['id'] === _0x58671c[_0x588542(0x4dd)])), !_0x29fbc8 && (_0x29fbc8 = _0x32f9c3['userProfiles'][0x0]), _0x29fbc8 && (_0x4488ef[_0x588542(0x1f3)](_0x588542(0x3c6))[_0x588542(0x465)] = _0x29fbc8[_0x588542(0x71c)] || _0x537fa8); } } if (Array['isArray'](_0x46aacb[_0x588542(0x70f)])) _0x588542(0x67f) === 'SLudW' ? _0x53a085['participantIds'] = _0x43f47a[_0x588542(0x285)]['filter'](_0x2d3427 => _0x2d3427 !== _0x3f1e28) : (_0x79fbb7[_0x588542(0x70f)] = _0x46aacb[_0x588542(0x70f)], _0x79fbb7[_0x588542(0x21d)] = _0x46aacb[_0x588542(0x21d)]); else { if (Array['isArray'](_0x46aacb['musicFeed']) && _0x46aacb['musicFeed'][_0x588542(0x629)] > 0x0) { console[_0x588542(0x257)](_0x588542(0x35e)); const _0x345b59 = { 'id': _0x588542(0x676) + Date[_0x588542(0x86b)](), 'name': _0x588542(0x5c3), 'boundUserProfileId': _0x46aacb[_0x588542(0x4dd)], 'memberCharacterIds': _0x46aacb['characters']['map'](_0x4fb244 => _0x4fb244['id']), 'posts': _0x46aacb[_0x588542(0x2a1)] }; _0x79fbb7[_0x588542(0x70f)] = [_0x345b59], _0x79fbb7[_0x588542(0x21d)] = _0x345b59['id']; } } if (Array[_0x588542(0x660)](_0x46aacb[_0x588542(0x8d2)])) _0x79fbb7[_0x588542(0x8d2)] = _0x46aacb['userProfiles'], _0x79fbb7[_0x588542(0x4dd)] = _0x46aacb[_0x588542(0x4dd)]; else { if (_0x46aacb[_0x588542(0x1ab)]) { if ('MFSAZ' !== _0x588542(0x762)) _0x172b0a[_0x588542(0x412)](_0x588542(0x396), _0x2381ba); else { console['log'](_0x588542(0x678)); const _0x514822 = { 'id': 'user_' + Date[_0x588542(0x86b)](), 'name': _0x46aacb[_0x588542(0x1ab)]['name'] || '我', 'avatar': _0x46aacb[_0x588542(0x1ab)]['avatar'] || _0x4f5e50, 'persona': _0x46aacb['userProfile'][_0x588542(0x6dc)] || '' }; _0x79fbb7['userProfiles'] = [_0x514822], _0x79fbb7['activeUserProfileId'] = _0x514822['id']; } } } _0x46aacb['apiSettings'] && typeof _0x46aacb['apiSettings'] === _0x588542(0x22a) && (_0x79fbb7['apiSettings'] = { ..._0x79fbb7[_0x588542(0x164)], ..._0x46aacb['apiSettings'] }); _0x46aacb[_0x588542(0x11a)] && typeof _0x46aacb['preferences'] === _0x588542(0x22a) ? _0x79fbb7[_0x588542(0x11a)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null, ..._0x46aacb[_0x588542(0x11a)] } : _0x79fbb7[_0x588542(0x11a)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null }; if (Array[_0x588542(0x660)](_0x46aacb[_0x588542(0x4c9)])) { if (_0x588542(0x83d) !== 'wMWEq') _0x79fbb7[_0x588542(0x4c9)] = _0x46aacb[_0x588542(0x4c9)], _0x79fbb7[_0x588542(0x4d8)] = _0x46aacb[_0x588542(0x4d8)] || null; else { if (_0x40f051) _0x507a52(_0x309b6e); if (_0xe33bbf[_0x588542(0x27e)]) return; _0x422ad6(() => { const _0x1fe235 = _0x588542; _0x3467fd && _0x180fef(_0x1003df['id'], _0x58920f[_0x1fe235(0x843)](_0x210e63 => _0x210e63['id'])); }, 0x32); } } else { if (Array['isArray'](_0x46aacb[_0x588542(0x44f)])) { if ('DCAmU' === _0x588542(0x675)) return _0x3abd93[_0x588542(0x412)]('批量生成动态失败:\x20', _0xfc66c7), _0x500d4b[_0x588542(0x412)](_0x588542(0x157), _0xd0f1e[_0x588542(0x8dd)] || _0x96d031), null; else console[_0x588542(0x257)](_0x588542(0x451)), _0x79fbb7[_0x588542(0x4c9)] = _0x46aacb[_0x588542(0x44f)][_0x588542(0x843)](_0x4aa924 => ({ 'id': 'chat_' + _0x4aa924['id'], 'type': _0x588542(0x91f), 'participantIds': [_0x4aa924['id']] })), _0x46aacb[_0x588542(0x653)] && (_0x79fbb7[_0x588542(0x4d8)] = 'chat_' + _0x46aacb[_0x588542(0x653)]), _0x46aacb[_0x588542(0x44f)][_0x588542(0x8f0)](_0x40509d => { const _0x4c50d0 = _0x588542; if (_0x4c50d0(0x3b8) !== 'kYiRK') _0x31d1bd(![]), _0x27f839[_0x4c50d0(0x8b0)] = ![]; else { const _0x55e755 = _0x4c50d0(0x5cc) + _0x40509d['id'], _0x41aeed = 'chatHistory_chat_' + _0x40509d['id'], _0xe92572 = localStorage[_0x4c50d0(0xfc)](_0x55e755); _0xe92572 && (localStorage[_0x4c50d0(0x54a)](_0x41aeed, _0xe92572), localStorage[_0x4c50d0(0x847)](_0x55e755)); } }); } } } catch (_0x1b01a9) { console['error'](_0x588542(0x2d6), _0x1b01a9), _0x79fbb7[_0x588542(0x44f)] = [], _0x79fbb7[_0x588542(0x4c9)] = [], _0x79fbb7[_0x588542(0x4d8)] = null; try { localStorage[_0x588542(0x847)](_0x588542(0x57b)); } catch (_0x23f731) { console[_0x588542(0x412)]('Failed\x20to\x20remove\x20corrupted\x20state\x20from\x20localStorage:', _0x23f731); } } let _0x3cf184 = ![]; if (_0x79fbb7[_0x588542(0x44f)][_0x588542(0x629)] === 0x0) _0x588542(0x194) === _0x588542(0x84a) ? (_0x63e037(_0x2852dd[_0x588542(0x2ff)]), _0x1b70fb()) : (_0x3cf184 = !![], _0x79fbb7[_0x588542(0x4d8)] = null); else !_0x79fbb7['chats']['find'](_0x2260b8 => _0x2260b8['id'] === _0x79fbb7['activeChatId']) && ('OwbFg' === _0x588542(0x288) ? _0x79fbb7['activeChatId'] = _0x79fbb7[_0x588542(0x4c9)][0x0]?.['id'] || null : _0x3821b1('错误:\x20' + _0x5c5314[_0x588542(0x227)])); return _0x43a351(), _0x3cf184; } function _0x23a213() { const _0x2ef397 = _0x2b3d5e; if (!_0x79fbb7[_0x2ef397(0x4d8)]) return; try { localStorage['setItem'](_0x2ef397(0x5cc) + _0x79fbb7[_0x2ef397(0x4d8)], JSON['stringify'](_0x79fbb7[_0x2ef397(0x623)])); } catch (_0x5f53a4) { if (_0x2ef397(0x550) === _0x2ef397(0x22e)) { const _0x17f083 = new _0x1d99ef(), _0x158fcf = _0xfdf907[_0x2ef397(0x1f3)]('galgame-time'), _0x2f5337 = _0x3fa2e9[_0x2ef397(0x1f3)](_0x2ef397(0x8ee)); if (_0x158fcf && _0x2f5337) { const _0x4b03ce = _0x3c5ac7(_0x17f083[_0x2ef397(0x267)]())[_0x2ef397(0x643)](0x2, '0'), _0x45f290 = _0x432299(_0x17f083[_0x2ef397(0x3c0)]())[_0x2ef397(0x643)](0x2, '0'); _0x158fcf['textContent'] = _0x4b03ce + ':' + _0x45f290; const _0x26fa60 = _0x17f083[_0x2ef397(0x90b)]() + 0x1, _0x1d8aa3 = _0x17f083[_0x2ef397(0x5d5)](), _0x1de683 = [_0x2ef397(0x1da), _0x2ef397(0x2d5), _0x2ef397(0x661), _0x2ef397(0x935), '星期四', '星期五', _0x2ef397(0x754)][_0x17f083['getDay']()]; _0x2f5337[_0x2ef397(0x5f4)] = _0x26fa60 + '月' + _0x1d8aa3 + '日\x20' + _0x1de683; } } else console[_0x2ef397(0x412)](_0x2ef397(0x840), _0x5f53a4), _0x30a64e(_0x2ef397(0x312)); } } function _0x49574c() { const _0x1de830 = _0x2b3d5e; if (!_0x79fbb7[_0x1de830(0x4d8)]) { if ('JjZDN' === _0x1de830(0x512)) _0x27d2e3(_0x1de830(0x6a8) + _0x36d6c5[_0x1de830(0x227)]); else { _0x79fbb7[_0x1de830(0x623)] = [], _0xd4cd2d(); return; } } let _0x46e8a8 = null; try { _0x46e8a8 = localStorage[_0x1de830(0xfc)](_0x1de830(0x5cc) + _0x79fbb7[_0x1de830(0x4d8)]); } catch (_0x20580e) { console[_0x1de830(0x412)](_0x1de830(0x2a6) + _0x79fbb7[_0x1de830(0x4d8)], _0x20580e); } let _0x5d3e10 = []; if (_0x46e8a8) try { if (_0x1de830(0x61a) !== 'LhMPD') _0x31ea23[_0x1de830(0x324)][_0x1de830(0x4fe)] = _0x1de830(0x802), _0x29e840[_0x1de830(0x324)]['top'] = _0x1de830(0x103), _0x3eecac[_0x1de830(0x324)]['left'] = _0x1de830(0x905), _0x96aa14[_0x1de830(0x324)]['transform'] = _0x1de830(0x25d), _0x31e02f[_0x1de830(0x324)]['display'] = _0x1de830(0x53e); else { const _0x2435dc = JSON[_0x1de830(0x4f6)](_0x46e8a8); Array[_0x1de830(0x660)](_0x2435dc) && ('gpzGm' === 'gpzGm' ? _0x5d3e10 = _0x2435dc[_0x1de830(0x6a6)](_0x4d8abd => _0x4d8abd && typeof _0x4d8abd === _0x1de830(0x22a) && typeof _0x4d8abd['role'] === _0x1de830(0x873) && typeof _0x4d8abd[_0x1de830(0x317)] !== _0x1de830(0x71d)) : (_0x53f801[_0x1de830(0x5f4)] = _0x5f2a8b['speaker'] === _0x1de830(0x488) ? '旁白' : _0x5c437c[_0x1de830(0x806)], _0x27c1d7[_0x1de830(0x5f4)] = _0x3b484e[_0x1de830(0x844)], _0x5b9247['speaker'] === _0x1518f4[_0x1de830(0x908)] ? _0x2f3c17(_0x552ea7, _0x2fab9f[_0x1de830(0x148)]) : _0x20660b(_0x2ece60, _0x1de830(0x4e9)))); } } catch (_0x2a8761) { if (_0x1de830(0x3a4) === 'wZxLe') { const _0x325b65 = _0x119bec[_0x1de830(0x4f8)](_0x1de830(0x8b4)); _0x325b65[_0x1de830(0x465)] = _0x250ed0[_0x1de830(0x30d)], _0x325b65[_0x1de830(0x5f0)] = _0x1de830(0x8a0), _0x325b65['title'] = _0x52a944[_0x1de830(0x908)], _0x325b65[_0x1de830(0x43d)][_0x1de830(0x20f)](_0x1de830(0x22f)), _0x325b65[_0x1de830(0x3eb)](_0x1de830(0x1a4), () => _0x59ee50(_0x2b1ab6)), _0x432576['appendChild'](_0x325b65); } else { console[_0x1de830(0x412)]('Failed\x20to\x20parse\x20history\x20for\x20chat\x20' + _0x79fbb7[_0x1de830(0x4d8)] + _0x1de830(0x621), _0x2a8761); try { localStorage['removeItem'](_0x1de830(0x5cc) + _0x79fbb7['activeChatId']); } catch (_0x2840e4) { console[_0x1de830(0x412)](_0x1de830(0x2dd), _0x2840e4); } } } _0x79fbb7[_0x1de830(0x623)] = _0x5d3e10, _0x143e84['innerHTML'] = '', _0x79fbb7[_0x1de830(0x623)] && _0x79fbb7[_0x1de830(0x623)][_0x1de830(0x8f0)]((_0x912965, _0x8001fb) => _0x55141a(_0x912965, _0x8001fb)), setTimeout(() => { const _0x249e05 = _0x1de830; if (_0x249e05(0x53d) === _0x249e05(0x53d)) _0x143e84[_0x249e05(0x144)] = _0x143e84[_0x249e05(0x939)]; else { const _0x3a70f0 = _0x7143e4[_0x249e05(0x4f6)](_0x4c6533[_0x249e05(0xfc)]('cardWidgetState') || '{}'), _0x27b4ed = { ..._0x3a70f0, ..._0x1fa58b }; _0x125f94[_0x249e05(0x54a)]('cardWidgetState', _0x43eff9[_0x249e05(0x4de)](_0x27b4ed)); } }, 0x0); } async function _0x396c9e() { const _0x233a27 = _0x2b3d5e, _0x564079 = document[_0x233a27(0x1f3)](_0x233a27(0x3cb)); try { let _0x29b6a9 = await _0x3db342(_0x233a27(0x2d1)); if (!_0x29b6a9) { const _0x11aa6b = localStorage['getItem'](_0x233a27(0x6c8)); _0x11aa6b && (_0x233a27(0x628) === 'xFabH' ? (console[_0x233a27(0x257)](_0x233a27(0x511)), _0x29b6a9 = await _0x4f6af3(_0x11aa6b), await _0x43bf1f(_0x233a27(0x2d1), _0x29b6a9), localStorage['removeItem'](_0x233a27(0x6c8))) : (_0x10a0c2[_0x233a27(0x412)](_0x233a27(0x331), _0xdcf097), _0x4bfd18('导入失败了，笨蛋:\x20' + _0x6c5c64[_0x233a27(0x227)]))); } if (_0x29b6a9) { if (_0x233a27(0x149) !== 'WYMEt') { const _0x15ace3 = []; if (_0x4765e0['content']) _0x15ace3[_0x233a27(0x7d8)]({ 'text': _0x5647c0['content'] }); if (_0x1e402c[_0x233a27(0x74f)]) { const _0x17aa96 = _0x54740d[_0x233a27(0x74f)]['split'](',')[0x1], _0x5c799e = _0xfbbad4[_0x233a27(0x74f)]['substring'](_0x192cfc[_0x233a27(0x74f)][_0x233a27(0x4e4)](':') + 0x1, _0x2d4d7c[_0x233a27(0x74f)][_0x233a27(0x4e4)](';')) || 'image/jpeg'; _0x15ace3['push']({ 'inline_data': { 'mime_type': _0x5c799e, 'data': _0x17aa96 } }); } return _0x15ace3; } else _0x564079[_0x233a27(0x324)]['backgroundImage'] = 'url(' + URL[_0x233a27(0x4af)](_0x29b6a9) + ')', _0x564079['style'][_0x233a27(0x93f)] = _0x233a27(0x876), _0x564079[_0x233a27(0x324)][_0x233a27(0x203)] = _0x233a27(0x51e); } else _0x564079['style'][_0x233a27(0x6a7)] = ''; } catch (_0x226c0c) { console['error'](_0x233a27(0x3f5), _0x226c0c), phoneContainer[_0x233a27(0x324)][_0x233a27(0x6a7)] = ''; } } function _0x360ad0() { const _0x5618c4 = _0x2b3d5e; if (_0x5618c4(0x3b7) !== _0x5618c4(0x3b7)) _0x4d71f0 = _0x58c1aa['parse'](_0x5b5315); else { const _0x37c36c = localStorage[_0x5618c4(0xfc)](_0x5618c4(0x2c5)); _0x37c36c ? 'kngOz' === _0x5618c4(0x7fc) ? document[_0x5618c4(0x1f3)]('music-screen')[_0x5618c4(0x324)]['setProperty'](_0x5618c4(0x372), 'url(' + _0x37c36c + ')') : (_0x162eb1[_0x5618c4(0x7d8)]({ 'role': _0x5618c4(0x721), 'content': _0x356748 }), _0x549fd8[_0x5618c4(0x7d8)]({ 'role': _0x5618c4(0x2ea), 'content': '好的，我记住了这些人设和历史。现在我们开始对话。' })) : document['getElementById'](_0x5618c4(0x56f))['style'][_0x5618c4(0x79d)](_0x5618c4(0x372), 'none'); } } async function _0x31c4d5(_0x11272d) { const _0x2b1876 = _0x2b3d5e; try { _0x2b1876(0x2a8) !== _0x2b1876(0x3a9) ? (await _0x43bf1f(_0x2b1876(0x2d1), _0x11272d), await _0x396c9e(), _0x30a64e(_0x2b1876(0x391))) : _0x9a5cb9(_0x2b1876(0x8a2)); } catch (_0x14f6da) { _0x2b1876(0x54e) !== _0x2b1876(0x8df) ? (console[_0x2b1876(0x412)](_0x2b1876(0x64c), _0x14f6da), _0x30a64e('保存壁纸失败:\x20' + _0x14f6da[_0x2b1876(0x227)])) : (_0x138367[_0x2b1876(0x43d)][_0x2b1876(0x154)](_0x2b1876(0x920)), _0x4415dc = null); } } function _0x5579bb(_0x2c9872) { const _0x53ae85 = _0x2b3d5e, _0x1e7bc7 = { 'quotedMessage': null, 'content': _0x2c9872 }, _0x48f6b4 = _0x2c9872[_0x53ae85(0x5d3)](/^\[引用\|(.*?)\|(.*?)\]\s*/); return _0x48f6b4 && (_0x1e7bc7['quotedMessage'] = { 'sender': _0x48f6b4[0x1][_0x53ae85(0x538)](), 'content': _0x48f6b4[0x2]['trim']() }, _0x1e7bc7[_0x53ae85(0x317)] = _0x2c9872[_0x53ae85(0x524)](_0x48f6b4[0x0][_0x53ae85(0x629)])[_0x53ae85(0x538)]()), _0x1e7bc7; } const _0x18fabe = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x90a)), _0x279a6c = document['getElementById'](_0x2b3d5e(0x874)), _0x3ad9ab = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x2cf)), _0x592841 = document['getElementById'](_0x2b3d5e(0x870)), _0x4f8a9d = document['getElementById'](_0x2b3d5e(0x474)), _0x3bcb83 = document[_0x2b3d5e(0x1f3)]('quote-message-button'), _0x1c347b = document['getElementById']('edit-message-modal'), _0x26f7f8 = document[_0x2b3d5e(0x1f3)]('edit-message-backdrop'), _0x12c6b8 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x3e3)), _0x5cc09a = document[_0x2b3d5e(0x1f3)]('save-edit-button'), _0x203ba0 = document['getElementById'](_0x2b3d5e(0x926)); let _0x5f1ffc = null; function _0x1bc9ad(_0x3cc5fd) { const _0x608afd = _0x2b3d5e; _0x5f1ffc = _0x3cc5fd, _0x18fabe[_0x608afd(0x43d)]['add'](_0x608afd(0x920)); } function _0x32edd9() { const _0x416275 = _0x2b3d5e; _0x416275(0x8a7) === 'omEbl' ? _0x3d2f70 += _0x3dc786[_0x416275(0x4f6)](_0x5a0cbc)[_0x416275(0x4f4)][0x0]['content'][_0x416275(0x6d7)][0x0][_0x416275(0x6b3)] : _0x18fabe[_0x416275(0x43d)][_0x416275(0x154)]('show'); } function _0x4f4af9() { const _0xb1960c = _0x2b3d5e; if (_0xb1960c(0x727) === _0xb1960c(0x727)) _0x32edd9(), _0x5f1ffc = null; else { const _0x3bca47 = _0xe477d2[_0xb1960c(0x2aa)](_0x5dbca2 => _0x5dbca2['name'] === _0x78ac3c[_0xb1960c(0x57e)]); if (_0x3bca47) { const _0x2222e6 = { 'role': 'assistant', 'content': _0xb1960c(0x2c2) + _0x3bca47[_0xb1960c(0x908)] + ']', 'displayUrl': _0x3bca47[_0xb1960c(0x30d)], 'senderId': _0x44d59[_0xb1960c(0x14b)], 'timestamp': _0x3712bb[_0xb1960c(0x86b)](), 'isOffline': _0x4559af }; _0x48dfe5[_0xb1960c(0x623)][_0xb1960c(0x7d8)](_0x2222e6); } } } function _0x5da2e2() { const _0x28897b = _0x2b3d5e; if (_0x5f1ffc === null) return; _0x79fbb7['conversationHistory'][_0x28897b(0x76e)](_0x5f1ffc, 0x1), _0x23a213(), _0x3e6176(), _0x4f4af9(); } function _0x41415f() { const _0x53be40 = _0x2b3d5e; if (_0x5f1ffc === null) return; const _0x10fccc = _0x79fbb7[_0x53be40(0x623)][_0x5f1ffc]; if (!_0x10fccc) return; _0x12c6b8[_0x53be40(0x2ff)] = _0x10fccc['content'], _0x32edd9(), _0x1c347b['classList']['add'](_0x53be40(0x920)), _0x12c6b8['focus'](); } function _0x43a020() { const _0x37be3e = _0x2b3d5e; if (_0x5f1ffc === null) return; const _0x29877a = _0x12c6b8[_0x37be3e(0x2ff)][_0x37be3e(0x538)](); if (_0x29877a === '') { _0x415af9(); return; } const _0x49f40d = _0x79fbb7['conversationHistory'][_0x5f1ffc]; _0x49f40d && (_0x49f40d['content'] = _0x29877a, _0x23a213(), _0x3e6176()), _0x1c347b['classList'][_0x37be3e(0x154)](_0x37be3e(0x920)), _0x5f1ffc = null; } function _0x415af9() { const _0x38d698 = _0x2b3d5e; _0x1c347b[_0x38d698(0x43d)][_0x38d698(0x154)](_0x38d698(0x920)), _0x5f1ffc = null; } _0x279a6c[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x4f4af9), _0x4f8a9d[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x4f4af9), _0x592841[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x5da2e2), _0x3ad9ab['addEventListener']('click', _0x41415f), _0x3bcb83[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x1c7b63), _0x599432['addEventListener']('click', _0xd1df94), _0x5cc09a[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x43a020), _0x203ba0[_0x2b3d5e(0x3eb)]('click', _0x415af9), _0x26f7f8[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x415af9); function _0x1c7b63() { const _0x35e500 = _0x2b3d5e; if (_0x5f1ffc === null) return; const _0x29f33e = _0x79fbb7[_0x35e500(0x623)][_0x5f1ffc]; if (!_0x29f33e) return; const _0x48a5da = _0x3f4d37(); let _0x11f99b = '未知'; if (_0x29f33e['role'] === _0x35e500(0x721)) { if (_0x35e500(0x875) !== _0x35e500(0x875)) return '刚才'; else _0x11f99b = _0x79fbb7[_0x35e500(0x1ab)][_0x35e500(0x908)] || '我'; } else { const _0x2e36e9 = _0x29f33e['senderId'] || _0x48a5da?.[_0x35e500(0x285)][0x0], _0x2f226e = _0x1249c2(_0x2e36e9); _0x11f99b = _0x2f226e ? _0x2f226e[_0x35e500(0x908)] : '角色'; } let _0x517a3f = _0x29f33e[_0x35e500(0x317)] || ''; if (_0x29f33e[_0x35e500(0x710)]) _0x517a3f = _0x35e500(0x78d); if (_0x29f33e['image']) _0x517a3f = '[图片]'; if (_0x517a3f[_0x35e500(0x629)] > 0x32) _0x517a3f = _0x517a3f[_0x35e500(0x524)](0x0, 0x32) + _0x35e500(0x480); _0x79fbb7['activeQuote'] = { 'sender': _0x11f99b, 'content': _0x517a3f }, _0x3baaf6(), _0x4f4af9(), _0x51655b[_0x35e500(0x507)](); } function _0x3baaf6() { const _0x37d5f9 = _0x2b3d5e; if (!_0x79fbb7[_0x37d5f9(0x104)]) return; _0xe8c2c6['textContent'] = _0x37d5f9(0x535) + _0x79fbb7['activeQuote'][_0x37d5f9(0x6bd)], _0x4b740b[_0x37d5f9(0x5f4)] = _0x79fbb7[_0x37d5f9(0x104)]['content'], _0x269ca5[_0x37d5f9(0x324)][_0x37d5f9(0x7ab)] = _0x37d5f9(0x53e); } function _0xd1df94() { const _0x5712a5 = _0x2b3d5e; _0x79fbb7[_0x5712a5(0x104)] = null, _0x269ca5['style']['display'] = _0x5712a5(0x277); } function _0x465abb(_0x1b4982, _0x109fd1) { const _0x249c74 = _0x2b3d5e, _0x50eb0e = document['getElementById'](_0x249c74(0x6c6)); if (_0x50eb0e) { if ('cokxf' !== _0x249c74(0x3ae)) { if (_0x1b4982 === 'home') { if ('pgwnt' === _0x249c74(0x347)) { _0x1cce6c(_0x249c74(0x671) + _0x31a7b8 + _0x249c74(0x4bf)), _0x3f57e9(() => _0x468365[_0x249c74(0x29b)](), 0x5dc); return; } else _0x50eb0e[_0x249c74(0x324)][_0x249c74(0x7ab)] = _0x249c74(0x366); } else { if (_0x249c74(0x4bd) === _0x249c74(0x4bd)) _0x50eb0e['style'][_0x249c74(0x7ab)] = _0x249c74(0x277); else { const _0xd932f5 = _0x4dc546(_0x5727be[_0x249c74(0x14b)] || _0x26fdad[_0x249c74(0x112)]); _0x2c8548 = _0xd932f5?.['name'] || '角色', _0x4ca2a6 = 'speaker-ai'; } } } else { _0x806198[_0x249c74(0x2f7)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20font-family:\x20sans-serif;\x20padding-top:\x2050px;\x22>日记本还是空白的...</p>', _0x1f09df[_0x249c74(0x2f7)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22justify-content:\x20space-around;\x20width:\x20100%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22>写第一篇</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x1427f1[_0x249c74(0x1f3)](_0x249c74(0x654))[_0x249c74(0x3eb)]('click', _0x1d8932), _0x4832fe[_0x249c74(0x1f3)](_0x249c74(0x631))['addEventListener'](_0x249c74(0x1a4), _0x135a89); return; } } _0x36fb77 = _0x109fd1 || null, Object[_0x249c74(0x869)](_0x59c481)[_0x249c74(0x8f0)](_0x454a1e => _0x454a1e[_0x249c74(0x43d)][_0x249c74(0x154)](_0x249c74(0x4a8))), _0x59c481[_0x1b4982] && ('NgHHA' === _0x249c74(0x8d5) ? _0x59c481[_0x1b4982][_0x249c74(0x43d)][_0x249c74(0x20f)](_0x249c74(0x4a8)) : _0x3df135[_0x249c74(0x1f3)](_0x249c74(0x47a))[_0x249c74(0x5f4)] = _0x249c74(0x609)), _0x1b4982 !== _0x249c74(0x59e) && _0x1ecdb4[_0x249c74(0x43d)][_0x249c74(0x154)](_0x249c74(0x225)); } function _0x4fa91a(_0x10104d) { const _0x5476aa = _0x2b3d5e; if (_0x5476aa(0x4c7) !== _0x5476aa(0x368)) { if (_0x10104d) { if (_0x5476aa(0x626) === _0x5476aa(0x6ce)) { _0x17a577 = _0x43b69f(); const _0x36c5a5 = _0x17cb3a['getElementById'](_0x5476aa(0x152))[_0x5476aa(0x5f4)]; _0x5ce5d9 = _0x36c5a5 || _0x5476aa(0x75e); } else _0x1ecdb4[_0x5476aa(0x43d)][_0x5476aa(0x20f)](_0x5476aa(0x225)); } else _0x1ecdb4[_0x5476aa(0x43d)][_0x5476aa(0x154)](_0x5476aa(0x225)); } else _0x1c90e5[_0x5476aa(0x43d)]['remove'](_0x5476aa(0x920)); } async function _0x35866c() { const _0x26a3b2 = _0x2b3d5e; _0x2f252c[_0x26a3b2(0x2f7)] = ''; for (const _0x44cf15 of _0x79fbb7[_0x26a3b2(0x4c9)]) { const _0x235a0a = document[_0x26a3b2(0x4f8)]('li'); _0x235a0a['className'] = _0x26a3b2(0x880), _0x235a0a['dataset']['id'] = _0x44cf15['id']; let _0x3ed13d = _0x426b80, _0x3e44d6 = '群聊', _0x1c9c2f = ''; if (_0x44cf15[_0x26a3b2(0x1fb)] === _0x26a3b2(0x91f)) { const _0x51906c = _0x1249c2(_0x44cf15[_0x26a3b2(0x285)][0x0]); if (_0x51906c) _0x3ed13d = _0x51906c[_0x26a3b2(0x71c)] || _0x426b80, _0x3e44d6 = _0x51906c[_0x26a3b2(0x908)] || _0x26a3b2(0x5c5), _0x1c9c2f = _0x51906c[_0x26a3b2(0x2b1)] || '私聊'; else { if (_0x26a3b2(0x519) === _0x26a3b2(0x250)) { if (!_0x308428) return; _0x2f4c5f = _0x264d0f[_0x26a3b2(0x854)][0x0][_0x26a3b2(0x735)], _0x21a08b === _0x26a3b2(0x180) && _0x3ac4f7(), _0x46a4bd = ![]; } else _0x3e44d6 = _0x26a3b2(0x44e), _0x1c9c2f = '错误：找不到角色'; } } else { _0x3e44d6 = _0x44cf15[_0x26a3b2(0x908)] || _0x26a3b2(0x346), _0x1c9c2f = _0x44cf15[_0x26a3b2(0x285)]['length'] + _0x26a3b2(0x749); const _0x160593 = await _0x3db342(_0x26a3b2(0x246) + _0x44cf15['id']); if (_0x160593) _0x3ed13d = URL[_0x26a3b2(0x4af)](_0x160593); } _0x235a0a[_0x26a3b2(0x2f7)] = _0x26a3b2(0x4b2) + _0x3ed13d + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0x3e44d6 + _0x26a3b2(0x7ac) + _0x1c9c2f + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x235a0a[_0x26a3b2(0x249)]('.char-info-wrapper')[_0x26a3b2(0x3eb)](_0x26a3b2(0x1a4), () => { const _0x4badfb = _0x26a3b2; _0x4badfb(0x3f7) === 'DoPTT' ? (_0x5cee40(_0x44cf15['id']), _0x4fa91a(!![])) : _0x287b59(_0x1b6b8c + 0x1); }), _0x2f252c[_0x26a3b2(0x7b9)](_0x235a0a); } } function _0xb547b7() { const _0x39b618 = _0x2b3d5e, _0x39f9f9 = document[_0x39b618(0x1f3)]('meeting-list-container'); _0x39f9f9[_0x39b618(0x2f7)] = ''; const _0x19cff5 = _0x79fbb7[_0x39b618(0x44f)][_0x39b618(0x6a6)](_0x26c2f1 => _0x79fbb7['chats'][_0x39b618(0x560)](_0x185e2a => _0x185e2a['type'] === _0x39b618(0x91f) && _0x185e2a[_0x39b618(0x285)]['includes'](_0x26c2f1['id']))); if (_0x19cff5[_0x39b618(0x629)] === 0x0) { _0x39f9f9[_0x39b618(0x2f7)] = _0x39b618(0x7ec); return; } _0x19cff5[_0x39b618(0x8f0)](_0x2cfa22 => { const _0x2a94fa = _0x39b618, _0xa14655 = document[_0x2a94fa(0x4f8)]('li'); _0xa14655[_0x2a94fa(0x1dc)] = 'character-item', _0xa14655[_0x2a94fa(0x78e)][_0x2a94fa(0x552)] = _0x2cfa22['id'], _0xa14655['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x2cfa22[_0x2a94fa(0x71c)] || _0x426b80) + _0x2a94fa(0x773) + _0x2cfa22['name'] + _0x2a94fa(0x1d9) + (_0x2cfa22['remark'] || '私聊') + _0x2a94fa(0x2f6), _0xa14655[_0x2a94fa(0x3eb)]('click', () => { _0x3cce24(_0x2cfa22['id']); }), _0x39f9f9[_0x2a94fa(0x7b9)](_0xa14655); }); } async function _0x3cce24(_0x4178fa) { const _0x18c20a = _0x2b3d5e; if ('vVels' !== 'vVels') { const _0x33ac26 = _0x4cffb2[_0x18c20a(0x4f8)](_0x18c20a(0x8dc)); _0x33ac26[_0x18c20a(0x5f4)] = _0x516ed7, _0x33ac26['addEventListener'](_0x18c20a(0x1a4), () => { const _0x2fa72c = _0x18c20a; _0x55d567[_0x2fa72c(0x2ff)] = _0x44b77a, _0x5b8a49['classList'][_0x2fa72c(0x154)](_0x2fa72c(0x920)); }), _0x3557fc[_0x18c20a(0x7b9)](_0x33ac26); } else { const _0x40f5dd = _0x1249c2(_0x4178fa); if (!_0x40f5dd) return; document[_0x18c20a(0x1f3)]('galgame-sprite')[_0x18c20a(0x465)] = '', _0x79fbb7[_0x18c20a(0x112)] = _0x4178fa; const _0x37f005 = _0x79fbb7[_0x18c20a(0x4c9)]['find'](_0x50e470 => _0x50e470[_0x18c20a(0x1fb)] === 'private' && _0x50e470[_0x18c20a(0x285)]['includes'](_0x4178fa)); _0x37f005 ? _0x18c20a(0x3e6) !== _0x18c20a(0x3e6) ? (_0x10d1c2(), _0x9c8274 = null) : (_0x79fbb7[_0x18c20a(0x4d8)] = _0x37f005['id'], _0x43a351(), _0x49574c(), _0x5270c4(_0x4178fa)) : _0x18c20a(0x11b) !== _0x18c20a(0x613) ? _0x79fbb7['conversationHistory'] = [] : _0x556aff[_0x18c20a(0x8b8)] = ![]; document[_0x18c20a(0x1f3)](_0x18c20a(0x6fc))[_0x18c20a(0x5f4)] = _0x40f5dd[_0x18c20a(0x908)]; const _0x2d7e5a = document['getElementById'](_0x18c20a(0x169)); try { const _0xcf7a6 = await _0x3db342(_0x18c20a(0x714) + _0x4178fa); _0xcf7a6 ? (_0x2d7e5a[_0x18c20a(0x324)][_0x18c20a(0x6a7)] = _0x18c20a(0x647) + URL[_0x18c20a(0x4af)](_0xcf7a6) + '\x27)', _0x2d7e5a['style'][_0x18c20a(0x93f)] = 'cover', _0x2d7e5a[_0x18c20a(0x324)][_0x18c20a(0x203)] = _0x18c20a(0x51e)) : _0x2d7e5a[_0x18c20a(0x324)][_0x18c20a(0x6a7)] = _0x18c20a(0x277); } catch (_0x488f33) { console[_0x18c20a(0x412)](_0x18c20a(0x35a) + _0x4178fa + ':', _0x488f33), _0x2d7e5a['style']['backgroundImage'] = _0x18c20a(0x277); } _0x187663(), _0x3c700b(); if (_0x4611d7) clearInterval(_0x4611d7); _0xddc774(), _0x4611d7 = setInterval(_0xddc774, 0x2710), document['getElementById'](_0x18c20a(0x5e6))['style'][_0x18c20a(0x7ab)] = _0x18c20a(0x53e), _0x465abb(_0x18c20a(0x3df), _0x18c20a(0x1b4)); } } function _0x3c700b() { const _0xd61c01 = _0x2b3d5e; if ('QpSrl' !== 'QpSrl') _0x45c617(_0xd61c01(0x115) + _0x1a8bcf['message'] + '\x0a\x0a请确认你的基础地址填写正确，且【不要】包含\x20/v1'); else { const _0xaf5617 = document[_0xd61c01(0x1f3)](_0xd61c01(0x57c)); _0xaf5617[_0xd61c01(0x2f7)] = ''; const _0x3552ae = _0xaf5617[_0xd61c01(0x249)]('#message-anchor'); if (_0x3552ae) _0x3552ae[_0xd61c01(0x154)](); if (_0x79fbb7[_0xd61c01(0x623)]) { if (_0xd61c01(0x109) === _0xd61c01(0x7c8)) { if (_0x51a04b === null) return; _0x2f5cd9[_0xd61c01(0x623)][_0xd61c01(0x76e)](_0x28ea6e, 0x1), _0x406136(), _0x4ab9bc(), _0x266cdc(); } else _0x79fbb7[_0xd61c01(0x623)]['forEach']((_0x5eaba2, _0x3d4c6d) => { const _0x1376d6 = _0xd61c01; if (!_0x5eaba2[_0x1376d6(0x5a8)] || _0x5eaba2[_0x1376d6(0x5f2)] === 'system') return; const _0x4628dd = document['createElement']('p'); _0x4628dd[_0x1376d6(0x78e)][_0x1376d6(0x57d)] = _0x3d4c6d; const _0x2d503c = _0x5eaba2['content'][_0x1376d6(0x1c3)](/\n/g, _0x1376d6(0x2a5)); let _0x49a6b6 = '', _0x41f482 = ''; const _0x77bf01 = _0x1cdea5(_0x79fbb7[_0x1376d6(0x4d8)]); if (_0x5eaba2[_0x1376d6(0x5f2)] === 'user') _0x49a6b6 = _0x77bf01[_0x1376d6(0x908)] || '我', _0x41f482 = _0x1376d6(0x4f2); else { if (_0x5eaba2[_0x1376d6(0x5f2)] === _0x1376d6(0x2ea)) { if (_0x1376d6(0x33b) === _0x1376d6(0x33b)) { const _0x32c9a6 = _0x1249c2(_0x5eaba2[_0x1376d6(0x14b)] || _0x79fbb7[_0x1376d6(0x112)]); _0x49a6b6 = _0x32c9a6?.['name'] || '角色', _0x41f482 = 'speaker-ai'; } else { const _0x10031b = _0x3fc829[_0x1376d6(0x5ec)]('.typing-indicator'); _0x10031b[_0x1376d6(0x8f0)](_0x25b4ef => _0x25b4ef['remove']()); } } } _0x4628dd[_0x1376d6(0x324)]['backgroundColor'] = _0x1376d6(0x44a), _0x4628dd[_0x1376d6(0x324)]['padding'] = '15px\x2020px', _0x4628dd[_0x1376d6(0x324)][_0x1376d6(0x583)] = _0x1376d6(0x75f), _0x4628dd['style'][_0x1376d6(0x1bf)] = _0x1376d6(0x224), _0x49a6b6 ? _0x4628dd[_0x1376d6(0x2f7)] = '<span\x20class=\x22' + _0x41f482 + _0x1376d6(0x8fd) + (_0x41f482 === 'speaker-user' ? _0x1376d6(0x1d6) : '#f2b7c6') + _0x1376d6(0x231) + _0x49a6b6 + ':</span>\x20' + _0x2d503c : (_0x4628dd[_0x1376d6(0x1dc)] = _0x1376d6(0x488), _0x4628dd[_0x1376d6(0x324)]['fontStyle'] = _0x1376d6(0x911), _0x4628dd['style'][_0x1376d6(0x6c0)] = _0x1376d6(0x889), _0x4628dd[_0x1376d6(0x2f7)] = _0x2d503c), _0xaf5617[_0x1376d6(0x7b9)](_0x4628dd); }); } if (_0x79fbb7[_0xd61c01(0x8b0)]) { if (_0xd61c01(0x264) !== _0xd61c01(0x264)) { _0x453501('哼，只有私聊才能进行总结，群聊那么乱怎么记！'); return; } else { let _0x673a89 = _0xaf5617['querySelector'](_0xd61c01(0x2ca)); !_0x673a89 && (_0x673a89 = document[_0xd61c01(0x4f8)](_0xd61c01(0x8dc)), _0x673a89['className'] = _0xd61c01(0x4d5), _0x673a89[_0xd61c01(0x5f4)] = _0xd61c01(0x88b), _0x673a89[_0xd61c01(0x324)][_0xd61c01(0x6f1)] = _0xd61c01(0x44a), _0x673a89['style']['padding'] = _0xd61c01(0x839), _0x673a89[_0xd61c01(0x324)][_0xd61c01(0x583)] = '8px', _0xaf5617[_0xd61c01(0x7b9)](_0x673a89)); } } const _0x37deb3 = document[_0xd61c01(0x4f8)](_0xd61c01(0x8dc)); _0x37deb3['id'] = _0xd61c01(0x3ce), _0xaf5617[_0xd61c01(0x7b9)](_0x37deb3), setTimeout(() => { const _0x5524fd = _0xd61c01; _0x37deb3[_0x5524fd(0x821)]({ 'behavior': _0x5524fd(0x1c4), 'block': _0x5524fd(0x29e) }); }, 0x32); } } function _0x3e6176() { const _0x1894eb = _0x2b3d5e, _0x13cd75 = document[_0x1894eb(0x249)](_0x1894eb(0x73a)); if (!_0x13cd75) return; if (_0x13cd75['id'] === _0x1894eb(0x43b)) _0x3c700b(); else { if (_0x1894eb(0x50e) !== _0x1894eb(0x833)) _0xd4cd2d(); else { const _0x394d6e = _0x1f93fc[_0x2c2ec4[_0x1894eb(0x629)] - 0x1]; (!_0x3ca881 || _0x394d6e['timestamp'] > _0x458f41[_0x1894eb(0x68c)]) && (_0x42c5a7 = _0x394d6e); } } } function _0xd4cd2d() { const _0xdfd1c4 = _0x2b3d5e; if ('aGDxI' === _0xdfd1c4(0x6f7)) _0x503331['classList'][_0xdfd1c4(0x20f)](_0xdfd1c4(0x920)); else { const _0x54e8c5 = _0x79fbb7[_0xdfd1c4(0x623)]['filter'](_0x14ec43 => !_0x14ec43[_0xdfd1c4(0x5a8)] && _0x14ec43[_0xdfd1c4(0x5f2)] !== _0xdfd1c4(0x35f)); if (_0x54e8c5[_0xdfd1c4(0x629)] > _0x79fbb7['displayedMessageCount']) { let _0x3c6db8 = _0x143e84[_0xdfd1c4(0x249)](_0xdfd1c4(0x10a)); !_0x3c6db8 && (_0x3c6db8 = document[_0xdfd1c4(0x4f8)]('button'), _0x3c6db8['textContent'] = _0xdfd1c4(0x872), _0x3c6db8[_0xdfd1c4(0x1dc)] = _0xdfd1c4(0x45a), _0x3c6db8[_0xdfd1c4(0x324)][_0xdfd1c4(0x120)] = _0xdfd1c4(0x1c4), _0x3c6db8[_0xdfd1c4(0x324)][_0xdfd1c4(0x2fd)] = _0xdfd1c4(0x19f), _0x3c6db8[_0xdfd1c4(0x324)]['padding'] = _0xdfd1c4(0x33a), _0x3c6db8[_0xdfd1c4(0x3dc)] = () => { const _0xd38722 = _0xdfd1c4, _0xa26925 = _0x143e84, _0x5268be = _0xa26925[_0xd38722(0x939)], _0x516baf = _0xa26925[_0xd38722(0x144)]; _0x79fbb7[_0xd38722(0x111)] += 0x64, _0xd4cd2d(), requestAnimationFrame(() => { const _0x58d660 = _0xd38722; if (_0x58d660(0x4e3) === _0x58d660(0x6ed)) { const _0x54f6e0 = new _0x2ce92f(_0x17dc28[_0x58d660(0x68c)]), _0x267ed2 = _0xb528a3[_0x58d660(0x2e7)]((_0x52b172 - _0x54f6e0) / (0x3e8 * 0x3c)); if (_0x267ed2 < 0x5) _0x54c873 += _0x58d660(0x310); else { if (_0x267ed2 < 0x78) _0x4c6e77 += _0x58d660(0x1c9) + _0x267ed2 + _0x58d660(0x736); else { const _0x4cc457 = _0x1710f9[_0x58d660(0x2e7)](_0x267ed2 / 0x3c); if (_0x4cc457 < 0x30) _0x39086e += '\x0a-\x20**对话状态**:\x20群里在' + _0x4cc457 + _0x58d660(0x79f); else _0x224fa9 += _0x58d660(0x429) + _0x3e9c29[_0x58d660(0x2e7)](_0x4cc457 / 0x18) + _0x58d660(0x459); } } } else { const _0x246664 = _0xa26925['scrollHeight']; _0xa26925[_0x58d660(0x144)] = _0x516baf + (_0x246664 - _0x5268be); } }); }, _0x143e84[_0xdfd1c4(0x7cc)] ? _0x143e84[_0xdfd1c4(0x739)](_0x3c6db8, _0x143e84['firstChild']) : _0xdfd1c4(0x882) !== _0xdfd1c4(0x1df) ? _0x143e84[_0xdfd1c4(0x7b9)](_0x3c6db8) : (delete _0x2ee306[_0xdfd1c4(0x49c)][_0x1117ca], _0x164d2d(), _0x4ed4a6())); } else { if (_0xdfd1c4(0x358) !== _0xdfd1c4(0x358)) { const _0x4b02b9 = _0x55bb23(_0x14533f[_0xdfd1c4(0x696)]) || { 'name': '未知' }; let _0x2565e8 = _0xdfd1c4(0x93d) + _0x4b02b9[_0xdfd1c4(0x908)] + '\x20说：“' + (_0x3f4bc8[_0xdfd1c4(0x4f1)] || _0x2b08a9[_0xdfd1c4(0x317)]) + '”'; return _0x2bc016[_0xdfd1c4(0x1fb)] === _0xdfd1c4(0x6fe) && (_0x2565e8 += _0xdfd1c4(0x485) + _0x37c3d7['songName'] + _0xdfd1c4(0x61f) + _0x5388d2[_0xdfd1c4(0x160)] + ')'), _0x2565e8; } else { const _0x354c6f = _0x143e84['querySelector'](_0xdfd1c4(0x10a)); if (_0x354c6f) _0x354c6f['remove'](); } } Array[_0xdfd1c4(0x910)](_0x143e84['children'])[_0xdfd1c4(0x8f0)](_0x50567d => { const _0xea1c4b = _0xdfd1c4; !_0x50567d[_0xea1c4b(0x43d)][_0xea1c4b(0x545)](_0xea1c4b(0x646)) && _0x50567d[_0xea1c4b(0x154)](); }); const _0x397458 = _0x54e8c5[_0xdfd1c4(0x45b)](-_0x79fbb7[_0xdfd1c4(0x111)]); _0x397458[_0xdfd1c4(0x8f0)](_0x26aa0f => { const _0x19b847 = _0xdfd1c4; if (_0x19b847(0x295) === _0x19b847(0x933)) { const _0x312a1d = [_0x19b847(0x1da), _0x19b847(0x2d5), _0x19b847(0x661), _0x19b847(0x935), _0x19b847(0x8ae), _0x19b847(0x2f1), _0x19b847(0x754)]; return _0x312a1d[_0x541ad6[_0x19b847(0x768)]()] + '\x20' + _0x1d12bd; } else { const _0x17e332 = _0x79fbb7[_0x19b847(0x623)]['indexOf'](_0x26aa0f); _0x17e332 > -0x1 && _0x55141a(_0x26aa0f, _0x17e332); } }); if (_0x79fbb7[_0xdfd1c4(0x8b0)]) { if (_0xdfd1c4(0x46d) === _0xdfd1c4(0x46d)) { let _0x50a587 = _0x143e84[_0xdfd1c4(0x249)]('.typing-indicator'); !_0x50a587 && (_0x50a587 = document[_0xdfd1c4(0x4f8)]('div'), _0x50a587['className'] = _0xdfd1c4(0x4d5), _0x50a587[_0xdfd1c4(0x5f4)] = _0xdfd1c4(0x7cd), _0x143e84[_0xdfd1c4(0x7b9)](_0x50a587)); } else { const _0x46dbe0 = []; for (const _0x373bac of _0x380959[_0xdfd1c4(0x2d2)](_0x291d75)) { const _0x427d0f = _0x373bac[_0xdfd1c4(0x80c)](); if (_0x44474c[_0xdfd1c4(0x560)](_0x1e2ccc => _0x427d0f[_0xdfd1c4(0x55c)](_0x1e2ccc))) { const _0x2be566 = _0x2df254[_0x373bac]; if (typeof _0x2be566 === _0xdfd1c4(0x873)) _0x46dbe0[_0xdfd1c4(0x7d8)](_0x2be566); if (_0x2a304c['isArray'](_0x2be566)) _0x2be566['forEach'](_0x443885 => { const _0x4a8e90 = _0xdfd1c4; if (typeof _0x443885 === _0x4a8e90(0x873)) _0x46dbe0['push'](_0x443885); }); } } if (_0x46dbe0[_0xdfd1c4(0x629)]) return _0x46dbe0[_0xdfd1c4(0x5b0)](_0x1cb9c2)[_0xdfd1c4(0x45b)](0x0, 0x9); } } if (_0x397458[_0xdfd1c4(0x629)] <= _0x79fbb7['displayedMessageCount']) { if (_0xdfd1c4(0x17a) === _0xdfd1c4(0x163)) { const _0x57055d = _0x28f507[_0xdfd1c4(0x1f3)]('theme-hue-slider'); if (!_0x57055d) return; const _0x5918f7 = _0xc3cb30[_0xdfd1c4(0xfc)](_0xdfd1c4(0x4f5)) || '35'; _0x50ecfb[_0xdfd1c4(0x81c)][_0xdfd1c4(0x324)]['setProperty'](_0xdfd1c4(0x69a), _0x5918f7), _0x57055d['value'] = _0x5918f7, _0x57055d[_0xdfd1c4(0x3eb)](_0xdfd1c4(0x266), () => { const _0x2e661f = _0xdfd1c4, _0x737772 = _0x57055d['value']; _0x5454ac['documentElement'][_0x2e661f(0x324)][_0x2e661f(0x79d)](_0x2e661f(0x69a), _0x737772), _0x4b9700[_0x2e661f(0x54a)]('themeHue', _0x737772), _0x5700ba(); }); } else setTimeout(() => { const _0x1343a8 = _0xdfd1c4; _0x143e84[_0x1343a8(0x144)] = _0x143e84[_0x1343a8(0x939)]; }, 0x0); } } } function _0x55141a(_0x58276c, _0x150a4f) { const _0x52a9e3 = _0x2b3d5e, { role: _0xdf5598, content: _0x16e384, displayUrl: _0x1083d6, image: _0x137fa9, senderId: _0x5f01e5 } = _0x58276c, _0x11bc27 = _0xdf5598 === _0x52a9e3(0x2ea) ? 'ai' : _0xdf5598, _0x49ed46 = _0x3f4d37(), _0x729e7 = document[_0x52a9e3(0x4f8)](_0x52a9e3(0x8dc)); _0x729e7[_0x52a9e3(0x43d)][_0x52a9e3(0x20f)](_0x52a9e3(0x40e), _0x11bc27), _0x729e7[_0x52a9e3(0x78e)]['historyIndex'] = _0x150a4f; const _0x25cd7f = document[_0x52a9e3(0x4f8)](_0x52a9e3(0x8dc)); _0x25cd7f[_0x52a9e3(0x1dc)] = _0x52a9e3(0x6d1); const _0x40a5a7 = document['createElement'](_0x52a9e3(0x8b4)); _0x40a5a7[_0x52a9e3(0x43d)][_0x52a9e3(0x20f)](_0x52a9e3(0x71c), _0xdf5598 + '-avatar'); let _0x51adca = ''; if (_0xdf5598 === _0x52a9e3(0x721)) { const _0x32bcbf = _0x1cdea5(_0x79fbb7['activeChatId']); _0x51adca = _0x32bcbf[_0x52a9e3(0x71c)] || _0x4f5e50; } else { if (_0x52a9e3(0x7ce) !== 'ySUyH') { _0x51adca = _0x426b80; let _0x37ad2d = null; if (_0x49ed46?.[_0x52a9e3(0x1fb)] === _0x52a9e3(0x91f)) 'OifJF' !== _0x52a9e3(0x291) ? (_0x45e00f(), _0x3109e7(_0x52a9e3(0x8bf), _0x52a9e3(0x659))) : _0x37ad2d = _0x1249c2(_0x49ed46[_0x52a9e3(0x285)][0x0]); else _0x49ed46?.[_0x52a9e3(0x1fb)] === _0x52a9e3(0x680) && _0x5f01e5 && (_0x37ad2d = _0x1249c2(_0x5f01e5)); _0x37ad2d?.['avatar'] && (_0x51adca = _0x37ad2d[_0x52a9e3(0x71c)]); } else _0x3578a1[_0x52a9e3(0x445)] = _0x1d6b32(() => { const _0x9cb9ab = _0x52a9e3; if (_0x2b245d[_0x9cb9ab(0x1fb)] === 'touchstart') _0x156bc1['preventDefault'](); _0x58adfe(_0x3c7d02(_0x2f42b9, 0xa), _0x5903b6); }, 0x320); } _0x40a5a7['src'] = _0x51adca, _0x40a5a7[_0x52a9e3(0x4b0)] = _0xdf5598 + _0x52a9e3(0x3a5); const _0x2d23d6 = _0x16e384 && _0x16e384[_0x52a9e3(0x538)]()[_0x52a9e3(0x55c)]('<div') && _0x16e384['trim']()[_0x52a9e3(0x6bb)](_0x52a9e3(0x392)); if (_0x2d23d6) { if ('Vfgal' !== _0x52a9e3(0x728)) _0x498987[_0x52a9e3(0x536)] === _0x13da5b && (_0x341684[_0x52a9e3(0x536)] = _0xbe4162[_0x52a9e3(0x4dd)]); else { const _0x2053e8 = document['createElement'](_0x52a9e3(0x8dc)); _0x2053e8[_0x52a9e3(0x1dc)] = _0x52a9e3(0x210), _0x2053e8[_0x52a9e3(0x2f7)] = _0x16e384; if (_0x11bc27 === 'user') { if ('BayBE' === _0x52a9e3(0x89c)) { if (_0x1857cf['displayUrl']) _0x27937f[_0x52a9e3(0x7d8)]('[' + _0x38517b(_0x3899a) + _0x52a9e3(0x89e) + (_0x196386[_0x52a9e3(0x317)]?.[_0x52a9e3(0x5d3)](/：(.+?)]/)?.[0x1] || '表情') + ']'); else { if (_0x467040[_0x52a9e3(0x74f)]) { const _0x52214b = _0x13691b[_0x52a9e3(0x317)] ? '\x20' + _0x2dac77[_0x52a9e3(0x317)] : ''; _0x414e74[_0x52a9e3(0x7d8)]('[' + _0x5be041(_0x318252) + ']\x20[image]' + _0x52214b); } else _0x208c5b[_0x52a9e3(0x317)] && _0x32461b[_0x52a9e3(0x7d8)]('[' + _0x19bd7d(_0x597134) + ']\x20' + _0xa7e5ac[_0x52a9e3(0x317)]); } } else _0x25cd7f[_0x52a9e3(0x7b9)](_0x2053e8), _0x25cd7f[_0x52a9e3(0x7b9)](_0x40a5a7); } else _0x25cd7f[_0x52a9e3(0x7b9)](_0x40a5a7), _0x25cd7f[_0x52a9e3(0x7b9)](_0x2053e8); } } else { if (_0x52a9e3(0x25c) !== _0x52a9e3(0x937)) { const _0x5e7a83 = document['createElement'](_0x52a9e3(0x8dc)); _0x5e7a83[_0x52a9e3(0x43d)][_0x52a9e3(0x20f)](_0x52a9e3(0x227), _0x11bc27); if (_0x49ed46?.['type'] === 'private') { const _0x363a09 = _0x49ed46['participantIds'][0x0]; _0x5e7a83[_0x52a9e3(0x43d)]['add']('bubble-' + _0x363a09); } if (_0x58276c[_0x52a9e3(0x66b)]) { const _0x4da566 = document[_0x52a9e3(0x4f8)]('div'); _0x4da566[_0x52a9e3(0x1dc)] = _0x52a9e3(0x47c); const _0x59d74a = document[_0x52a9e3(0x4f8)](_0x52a9e3(0x8dc)); _0x59d74a[_0x52a9e3(0x1dc)] = _0x52a9e3(0x7f4), _0x59d74a[_0x52a9e3(0x5f4)] = _0x58276c[_0x52a9e3(0x66b)][_0x52a9e3(0x6bd)]; const _0x32c879 = document['createElement'](_0x52a9e3(0x8dc)); _0x32c879[_0x52a9e3(0x1dc)] = _0x52a9e3(0x807), _0x32c879[_0x52a9e3(0x5f4)] = _0x58276c[_0x52a9e3(0x66b)][_0x52a9e3(0x317)], _0x4da566[_0x52a9e3(0x7b9)](_0x59d74a), _0x4da566[_0x52a9e3(0x7b9)](_0x32c879), _0x5e7a83[_0x52a9e3(0x7b9)](_0x4da566); } if (_0x1083d6) { _0x5e7a83[_0x52a9e3(0x43d)]['add'](_0x52a9e3(0x57e)); const _0x10dc7f = document[_0x52a9e3(0x4f8)](_0x52a9e3(0x8b4)); _0x10dc7f['src'] = _0x1083d6, _0x10dc7f[_0x52a9e3(0x43d)]['add'](_0x52a9e3(0x146)), _0x5e7a83['appendChild'](_0x10dc7f); } else { if (_0x58276c['image'] || _0x58276c[_0x52a9e3(0x116)]) { _0x5e7a83[_0x52a9e3(0x43d)][_0x52a9e3(0x20f)](_0x52a9e3(0x74f)); const _0x38839e = document[_0x52a9e3(0x4f8)](_0x52a9e3(0x8b4)); _0x38839e[_0x52a9e3(0x43d)][_0x52a9e3(0x20f)](_0x52a9e3(0x2f5)), _0x5e7a83['appendChild'](_0x38839e); if (_0x58276c[_0x52a9e3(0x74f)]) { if (_0x52a9e3(0x50c) === _0x52a9e3(0x50c)) _0x38839e[_0x52a9e3(0x465)] = _0x58276c[_0x52a9e3(0x74f)]; else { const _0x16f9a6 = { 'id': _0x52a9e3(0x548) + _0x53d526[_0x52a9e3(0x86b)](), ..._0x41dd72 }; _0x3f484a[_0x52a9e3(0x8d2)][_0x52a9e3(0x7d8)](_0x16f9a6), !_0x271168[_0x52a9e3(0x4dd)] && (_0x4bcce2[_0x52a9e3(0x4dd)] = _0x16f9a6['id']); } } else _0x38839e[_0x52a9e3(0x465)] = _0x52a9e3(0x8bd), _0x3db342(_0x58276c['imageId'])[_0x52a9e3(0x2cd)](_0x3e9437 => { const _0x574e89 = _0x52a9e3; if ('KcmYZ' === _0x574e89(0x46a)) _0x4f7210(_0x574e89(0x330) + _0x4091a8[_0x574e89(0x227)]); else { if (_0x3e9437) { const _0x3de12e = URL['createObjectURL'](_0x3e9437); _0x38839e[_0x574e89(0x465)] = _0x3de12e, _0x38839e[_0x574e89(0x3fc)] = () => { const _0x328870 = _0x574e89; URL[_0x328870(0x1d7)](_0x3de12e); }; } else _0x574e89(0x423) === _0x574e89(0x527) ? (_0x41f058 = _0x291abc[_0x574e89(0x908)], _0x47fb3c = _0x29914d[_0x574e89(0x71c)]) : _0x38839e[_0x574e89(0x4b0)] = _0x574e89(0x1e9); } })[_0x52a9e3(0x222)](_0x30b592 => { const _0x479e95 = _0x52a9e3; console['error'](_0x479e95(0x12f), _0x30b592), _0x38839e[_0x479e95(0x4b0)] = _0x479e95(0x1e9); }); if (_0x16e384) { const _0x5d01e0 = document[_0x52a9e3(0x4f8)]('p'); _0x5d01e0['style'][_0x52a9e3(0x7bb)] = _0x52a9e3(0x6f4), _0x5d01e0[_0x52a9e3(0x5f4)] = _0x16e384, _0x5e7a83[_0x52a9e3(0x7b9)](_0x5d01e0); } } else { if (_0x58276c[_0x52a9e3(0x1fb)] === 'transfer') { if (_0x52a9e3(0x664) === 'iqUSM') { const _0x3c648e = _0x347495['chats'][_0x52a9e3(0x2aa)](_0x5737b9 => _0x5737b9[_0x52a9e3(0x865)] && _0x5737b9[_0x52a9e3(0x865)][_0x52a9e3(0x91d)]); _0x3c648e && (_0x3c648e[_0x52a9e3(0x865)] = null, _0x37df3a(), _0x2eddf6('同步已断开。'), _0x1b3481(), _0x143092[_0x52a9e3(0x43d)][_0x52a9e3(0x154)]('show'), _0x2144e3(() => _0x142ab8[_0x52a9e3(0x324)][_0x52a9e3(0x7ab)] = _0x52a9e3(0x277), 0x12c)); } else { _0x5e7a83['classList'][_0x52a9e3(0x20f)](_0x52a9e3(0x186)); const _0x4c92bd = _0x58276c['role'] === _0x52a9e3(0x721) ? _0x1cdea5(_0x79fbb7[_0x52a9e3(0x4d8)]) : _0x1249c2(_0x58276c[_0x52a9e3(0x14b)]), _0x3ffeee = _0x58276c[_0x52a9e3(0x71b)] === _0x1cdea5(_0x79fbb7[_0x52a9e3(0x4d8)])['id'] ? _0x1cdea5(_0x79fbb7[_0x52a9e3(0x4d8)]) : _0x1249c2(_0x58276c[_0x52a9e3(0x71b)]), _0xe9e306 = _0x4c92bd?.[_0x52a9e3(0x908)] ? _0x4c92bd[_0x52a9e3(0x908)] + _0x52a9e3(0x7f7) : '转账', _0xcf3e4c = _0x3ffeee?.[_0x52a9e3(0x908)] ? '转给\x20' + _0x3ffeee['name'] : '转账', _0x28c355 = _0x52a9e3(0x901) + _0xe9e306 + _0x52a9e3(0x665) + _0x58276c['amount'][_0x52a9e3(0x145)](0x2) + _0x52a9e3(0x303) + _0xcf3e4c + _0x52a9e3(0x39d); _0x5e7a83[_0x52a9e3(0x2f7)] = _0x28c355; } } else { if (_0x58276c[_0x52a9e3(0x1fb)] === _0x52a9e3(0x7db)) { _0x5e7a83[_0x52a9e3(0x43d)][_0x52a9e3(0x20f)](_0x52a9e3(0x6fe)); const _0x402107 = document[_0x52a9e3(0x4f8)](_0x52a9e3(0x8dc)); _0x402107[_0x52a9e3(0x1dc)] = _0x52a9e3(0x8a8), _0x402107[_0x52a9e3(0x43d)][_0x52a9e3(0x20f)](_0x52a9e3(0x213)); const _0x1446f7 = _0x58276c['role'] === _0x52a9e3(0x721) ? _0x1cdea5(_0x79fbb7[_0x52a9e3(0x4d8)])[_0x52a9e3(0x908)] || '你' : _0x1249c2(_0x58276c[_0x52a9e3(0x14b)])?.[_0x52a9e3(0x908)] || 'TA', _0x41346a = _0x52a9e3(0x60f) + _0x58276c['timestamp'], _0x4b34b2 = _0x52a9e3(0x457) + _0x41346a + _0x52a9e3(0x184) + _0x426b80 + '\x22>'; _0x58276c[_0x52a9e3(0x697)] && _0x3db342(_0x58276c['coverId'])['then'](_0x10b5a2 => { const _0x28bd10 = _0x52a9e3, _0x4d7b42 = document['getElementById'](_0x41346a); if (_0x4d7b42 && _0x10b5a2) _0x4d7b42[_0x28bd10(0x465)] = URL['createObjectURL'](_0x10b5a2); }), _0x58276c[_0x52a9e3(0x529)] ? _0x402107['innerHTML'] = _0x52a9e3(0x236) + _0x4b34b2 + _0x52a9e3(0x6a0) + _0x58276c[_0x52a9e3(0x31c)] + _0x52a9e3(0x7be) + _0x58276c[_0x52a9e3(0x160)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>' : _0x402107['innerHTML'] = _0x52a9e3(0x709) + _0x1446f7 + _0x52a9e3(0x8b5) + _0x4b34b2 + _0x52a9e3(0x6a0) + _0x58276c[_0x52a9e3(0x31c)] + _0x52a9e3(0x7be) + _0x58276c[_0x52a9e3(0x160)] + _0x52a9e3(0x64f) + _0x58276c[_0x52a9e3(0x7b6)] + '\x22>一起听</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', _0x5e7a83[_0x52a9e3(0x7b9)](_0x402107); } else { if (_0x58276c[_0x52a9e3(0x1fb)] === _0x52a9e3(0x6fe) && _0x58276c['songName']) { if (_0x52a9e3(0x8e2) !== _0x52a9e3(0x385)) { _0x5e7a83['classList'][_0x52a9e3(0x20f)](_0x52a9e3(0x6fe)); const _0x2a9df0 = document[_0x52a9e3(0x4f8)](_0x52a9e3(0x8dc)); _0x2a9df0[_0x52a9e3(0x1dc)] = _0x52a9e3(0x938), _0x2a9df0['dataset'][_0x52a9e3(0x4ca)] = _0x52a9e3(0x2fe) + _0x58276c[_0x52a9e3(0x68c)]; const _0x54a089 = _0x52a9e3(0x60f) + _0x58276c[_0x52a9e3(0x68c)], _0x71e615 = _0x52a9e3(0x788) + _0x426b80 + _0x52a9e3(0x672) + _0x54a089 + _0x52a9e3(0x3e9); if (_0x58276c[_0x52a9e3(0x697)]) _0x3db342(_0x58276c['coverId'])['then'](_0x3e35ce => { const _0x21ed1e = _0x52a9e3; if (_0x21ed1e(0x289) === 'BAflN') { const _0x4db110 = document[_0x21ed1e(0x1f3)](_0x54a089); if (_0x4db110 && _0x3e35ce) _0x4db110[_0x21ed1e(0x465)] = URL['createObjectURL'](_0x3e35ce); } else { const _0x37829a = _0x323bb2[_0x21ed1e(0x4f8)](_0x21ed1e(0x8dc)); _0x37829a[_0x21ed1e(0x1dc)] = _0x21ed1e(0x66d), _0x37829a[_0x21ed1e(0x78e)]['id'] = _0x20d463['id']; const _0x698fab = _0x31d4cf['id'] === _0x19c61f[_0x21ed1e(0x4dd)] ? _0x21ed1e(0x5ea) : ''; _0x37829a['innerHTML'] = _0x21ed1e(0x7d9) + (_0x446fad['avatar'] || _0x4257f5) + _0x21ed1e(0x13a) + _0xd32dcd[_0x21ed1e(0x908)] + _0x698fab + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>' + _0x506add[_0x21ed1e(0x6dc)]['substring'](0x0, 0x64) + _0x21ed1e(0x6cf), _0x37829a[_0x21ed1e(0x3eb)](_0x21ed1e(0x1a4), () => _0x3bb833(_0x1a0479['id'])), _0x5a1301['appendChild'](_0x37829a); } }); else _0x58276c[_0x52a9e3(0x1d1)] && setTimeout(() => { const _0xc1699c = _0x52a9e3, _0x4556f2 = document['getElementById'](_0x54a089); if (_0x4556f2) _0x4556f2[_0xc1699c(0x465)] = _0x58276c[_0xc1699c(0x1d1)]; }, 0x0); _0x2a9df0[_0x52a9e3(0x2f7)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x71e615 + _0x52a9e3(0x8ed) + _0x58276c[_0x52a9e3(0x31c)] + _0x52a9e3(0x68e) + _0x58276c[_0x52a9e3(0x160)] + _0x52a9e3(0x5bb) + (_0x58276c[_0x52a9e3(0x8b7)] ? '▶' : '⚠') + _0x52a9e3(0x392), _0x58276c[_0x52a9e3(0x8b7)] && _0x2a9df0[_0x52a9e3(0x3eb)](_0x52a9e3(0x1a4), function () { const _0x2d416d = _0x52a9e3; if (_0x2d416d(0xff) === _0x2d416d(0x8e7)) _0x15e94f(_0x45797e), _0x482bcb(); else { const _0x4e2e5c = { 'id': _0x2d416d(0x2fe) + _0x58276c[_0x2d416d(0x68c)], 'url': _0x58276c['playableUrl'] }; _0xd6f5a2(this, _0x4e2e5c); } }), _0x5e7a83[_0x52a9e3(0x7b9)](_0x2a9df0); } else { const _0x427e41 = _0xe0a5b7[_0x52a9e3(0x704)](_0xf8d4f9, 0x2); _0x427e41[_0x52a9e3(0x7d0)] = () => _0x38e716('IndexedDB\x20failed\x20to\x20open'), _0x427e41[_0x52a9e3(0x7eb)] = () => _0x2d2fea(_0x427e41[_0x52a9e3(0x6e4)]); } } else { if (_0x16e384) { if ('KhMcb' === _0x52a9e3(0x2dc)) { const _0x2c2d04 = _0x4d6b8f['createElement']('li'); _0x2c2d04[_0x52a9e3(0x1dc)] = 'member-selection-item', _0x2c2d04[_0x52a9e3(0x2f7)] = _0x52a9e3(0x262) + _0x2763a5['id'] + _0x52a9e3(0x36c) + _0x2b1a17['id'] + _0x52a9e3(0x5e8) + (_0x4cb36e[_0x52a9e3(0x71c)] || _0x3de3ef) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-' + _0x453ce0['id'] + _0x52a9e3(0x6c7) + _0x41e193[_0x52a9e3(0x908)] + _0x52a9e3(0x5b8), _0x26845f['appendChild'](_0x2c2d04); } else { const _0x47980a = document[_0x52a9e3(0x4f8)]('p'); _0x47980a['innerHTML'] = _0x16e384, _0x47980a['style']['margin'] = '0', _0x5e7a83[_0x52a9e3(0x7b9)](_0x47980a); } } } } } } } _0xdf5598 === _0x52a9e3(0x721) ? (_0x25cd7f[_0x52a9e3(0x7b9)](_0x5e7a83), _0x25cd7f['appendChild'](_0x40a5a7)) : (_0x25cd7f[_0x52a9e3(0x7b9)](_0x40a5a7), _0x25cd7f['appendChild'](_0x5e7a83)); } else { const _0x484c47 = (_0xcc997a - _0x17f686) / (0x3e8 * 0x3c); _0x484c47 < 0x3c ? _0x2405f0 += '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a' : _0x3f7090 += _0x52a9e3(0x56a) + _0x5dd9b8[_0x52a9e3(0x8d6)](_0x484c47 / 0x3c) + _0x52a9e3(0x450); } } _0x729e7[_0x52a9e3(0x7b9)](_0x25cd7f); const _0x3f7cc5 = document['createElement'](_0x52a9e3(0x8dc)); return _0x3f7cc5[_0x52a9e3(0x1dc)] = 'timestamp', _0x3f7cc5[_0x52a9e3(0x5f4)] = _0x5b4f08(_0x58276c[_0x52a9e3(0x68c)]), _0x729e7['appendChild'](_0x3f7cc5), _0x143e84[_0x52a9e3(0x7b9)](_0x729e7), _0x729e7; } document[_0x2b3d5e(0x1f3)]('chat-messages')[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x1db532); let _0xfd8b3 = null, _0x4611d7 = null; function _0x1db532(_0x30e80c) { const _0x204622 = _0x2b3d5e; if ('HGeNc' === _0x204622(0x361)) _0x3bb86e[_0x204622(0x847)]('chatHistory_' + _0x387042['id']), _0x2cb86a(_0x204622(0x5ca) + _0x2769c8[_0x204622(0x908)] + _0x204622(0x712)); else { if (window[_0x204622(0x7b8)]()[_0x204622(0x571)]()) { if (_0x204622(0x858) !== 'LPrId') return; else _0x53aa6a(![]), _0x8398e1['error'](_0x204622(0x486), _0x2d374c), _0x8d1381(_0x204622(0x4c5) + _0x2d3042[_0x204622(0x227)]); } const _0x1d62ca = _0x30e80c[_0x204622(0x381)][_0x204622(0x3d6)](_0x204622(0x77b)), _0x14a5ac = _0x30e80c[_0x204622(0x381)][_0x204622(0x3d6)](_0x204622(0x399)); if (!_0x1d62ca || _0x14a5ac) return; const _0xe6c806 = parseInt(_0x1d62ca[_0x204622(0x78e)]['historyIndex'], 0xa); if (isNaN(_0xe6c806)) return; _0x1bc9ad(_0xe6c806); } } function _0x4afdf2() { const _0x1e27a4 = _0x2b3d5e; if (_0x1e27a4(0x147) === _0x1e27a4(0x21c)) _0x430471[_0x1e27a4(0x5f4)] = _0x1e27a4(0x234) + _0x1fd1a5['length'] + '\x20项'; else { const _0x4b801c = _0x3f4d37(); if (!_0x4b801c) { _0x4797f2['textContent'] = _0x1e27a4(0x4df); return; } if (_0x4b801c[_0x1e27a4(0x1fb)] === _0x1e27a4(0x91f)) { if ('uclTx' === _0x1e27a4(0x896)) { const _0x5f1bd5 = _0x1249c2(_0x4b801c['participantIds'][0x0]); _0x4797f2[_0x1e27a4(0x5f4)] = _0x5f1bd5 ? _0x5f1bd5[_0x1e27a4(0x908)] : _0x1e27a4(0x44e); } else _0x42e080 = _0x3d1575; } else _0x4797f2[_0x1e27a4(0x5f4)] = _0x4b801c[_0x1e27a4(0x908)] || '群聊\x20(' + _0x4b801c[_0x1e27a4(0x285)]['length'] + ')'; } } function _0x11aff2(_0x4e5617) { const _0x4f6d68 = _0x2b3d5e, _0x2e540f = document[_0x4f6d68(0x249)]('.screen.active'); if (_0x2e540f && (_0x2e540f['id'] === 'meeting-view-screen' || _0x2e540f['id'] === _0x4f6d68(0x5d0))) _0x3e6176(); else { const _0x3d0cef = document[_0x4f6d68(0x5ec)](_0x4f6d68(0x2ca)); _0x3d0cef[_0x4f6d68(0x8f0)](_0x4e1b06 => _0x4e1b06[_0x4f6d68(0x154)]()); } } function _0xcd627f() { const _0x34afec = _0x2b3d5e; _0x79fbb7[_0x34afec(0x8b0)] && _0x79fbb7[_0x34afec(0x557)] && (console[_0x34afec(0x257)](_0x34afec(0x45e)), _0x79fbb7[_0x34afec(0x557)][_0x34afec(0x59c)](_0x34afec(0x5fc)), _0x79fbb7['currentAbortController'] = null), _0x79fbb7['isGenerating'] = ![], _0x11aff2(![]); } function _0x3f4d37() { const _0x443353 = _0x2b3d5e; return _0x79fbb7[_0x443353(0x4c9)][_0x443353(0x2aa)](_0x373988 => _0x373988['id'] === _0x79fbb7[_0x443353(0x4d8)]); } function _0x1249c2(_0x493755) { const _0x3265fb = _0x2b3d5e; return _0x79fbb7['characters'][_0x3265fb(0x2aa)](_0x339129 => _0x339129['id'] === _0x493755); } function _0x3a509f(_0x2a39e6) { const _0x17a01f = _0x2b3d5e; _0x79fbb7['characters'] = _0x79fbb7['characters'][_0x17a01f(0x6a6)](_0x3a9f37 => _0x3a9f37['id'] !== _0x2a39e6), _0x79fbb7[_0x17a01f(0x4c9)][_0x17a01f(0x8f0)](_0x4e9a65 => { const _0x8ff8b1 = _0x17a01f; _0x4e9a65[_0x8ff8b1(0x1fb)] === 'group' && (_0x4e9a65[_0x8ff8b1(0x285)] = _0x4e9a65[_0x8ff8b1(0x285)]['filter'](_0x57b265 => _0x57b265 !== _0x2a39e6)); }); const _0x3fe6e9 = _0x79fbb7[_0x17a01f(0x4c9)][_0x17a01f(0x2aa)](_0x268c8d => _0x268c8d[_0x17a01f(0x1fb)] === _0x17a01f(0x91f) && _0x268c8d[_0x17a01f(0x285)][_0x17a01f(0x5ad)](_0x2a39e6)); _0x3fe6e9 && _0x312f6f(_0x3fe6e9['id']), _0x79fbb7[_0x17a01f(0x4c9)] = _0x79fbb7['chats'][_0x17a01f(0x6a6)](_0x40ae8f => _0x40ae8f['type'] !== _0x17a01f(0x680) || _0x40ae8f['participantIds'][_0x17a01f(0x629)] > 0x1), _0x43a351(), _0x35866c(); } function _0x312f6f(_0x39fc7b) { const _0x1d4dd2 = _0x2b3d5e; _0x79fbb7[_0x1d4dd2(0x4c9)] = _0x79fbb7['chats'][_0x1d4dd2(0x6a6)](_0xc996f1 => _0xc996f1['id'] !== _0x39fc7b); try { _0x1d4dd2(0x296) === _0x1d4dd2(0x296) ? localStorage[_0x1d4dd2(0x847)](_0x1d4dd2(0x5cc) + _0x39fc7b) : _0x290a33[_0x1d4dd2(0x32e)] = _0xed3cee[_0x1d4dd2(0x444)][_0x1d4dd2(0x843)](_0x19a00a => _0x375459[_0x1d4dd2(0x32e)][_0x1d4dd2(0x2aa)](_0x3149a4 => _0x3149a4['id'] === _0x19a00a))[_0x1d4dd2(0x6a6)](_0x55d870)[_0x1d4dd2(0x843)](_0x43353d => ({ 'name': _0x43353d[_0x1d4dd2(0x908)], 'content': _0x43353d[_0x1d4dd2(0x317)] })); } catch (_0x75a17c) { console['error'](_0x1d4dd2(0x208) + _0x39fc7b, _0x75a17c); } _0x79fbb7['activeChatId'] === _0x39fc7b && (_0x1d4dd2(0x6ea) === _0x1d4dd2(0x20b) ? _0x53df71[_0x1d4dd2(0x324)][_0x1d4dd2(0x13c)] = '0\x201px\x203px\x20rgba(0,0,0,0.6)' : (_0x79fbb7[_0x1d4dd2(0x4d8)] = _0x79fbb7[_0x1d4dd2(0x4c9)][0x0]?.['id'] || null, _0x5cee40(_0x79fbb7[_0x1d4dd2(0x4d8)]))), _0x43a351(), _0x35866c(); } async function _0x5cee40(_0x5682c6) { const _0xdd7911 = _0x2b3d5e; if (_0xdd7911(0x6fd) !== _0xdd7911(0x76a)) { _0x79fbb7[_0xdd7911(0x4d8)] !== _0x5682c6 && ('vIjTH' === 'vIjTH' ? (_0xcd627f(), _0x79fbb7[_0xdd7911(0x111)] = 0x64) : _0x12b420[_0xdd7911(0x3eb)]('click', function () { const _0x31ff7b = _0xdd7911, _0x4401e6 = { 'id': _0x31ff7b(0x2fe) + _0x19dfe8[_0x31ff7b(0x68c)], 'url': _0x16edc3[_0x31ff7b(0x8b7)] }; _0x5abe29(this, _0x4401e6); })); if (!_0x5682c6) { _0x79fbb7[_0xdd7911(0x4d8)] = null, _0x43a351(), _0x4fa91a(![]), document[_0xdd7911(0x1f3)]('chat-view-pane')[_0xdd7911(0x324)][_0xdd7911(0x6a7)] = ''; return; } _0x79fbb7[_0xdd7911(0x4d8)] = _0x5682c6, _0x43a351(), _0x4afdf2(), _0x143e84['innerHTML'] = '', _0x585d0a(!![], _0xdd7911(0x319)), setTimeout(async () => { const _0x1e5e76 = _0xdd7911; try { _0x49574c(); const _0xa3152a = _0x3f4d37(), _0x515a54 = document[_0x1e5e76(0x1f3)](_0x1e5e76(0x2cc)); let _0x321bae = null; if (_0xa3152a) { if ('rugnE' === _0x1e5e76(0x515)) _0x120db1 = [..._0x7f0e86, ..._0x228c88]; else { if (_0xa3152a['type'] === _0x1e5e76(0x91f)) { const _0xf9e360 = _0xa3152a[_0x1e5e76(0x285)][0x0]; _0x51dcbb(_0xf9e360), _0x321bae = await _0x3db342('char_wallpaper_' + _0xf9e360); } else { if (_0x1e5e76(0x499) !== 'OyyvO') { _0x2c6c17('至少要保留一个用户。'); return; } else _0x321bae = await _0x3db342(_0x1e5e76(0x537) + _0xa3152a['id']); } _0x321bae ? (_0x515a54[_0x1e5e76(0x324)][_0x1e5e76(0x6a7)] = _0x1e5e76(0x647) + URL['createObjectURL'](_0x321bae) + '\x27)', _0x515a54[_0x1e5e76(0x324)][_0x1e5e76(0x93f)] = _0x1e5e76(0x876), _0x515a54['style'][_0x1e5e76(0x203)] = _0x1e5e76(0x51e)) : _0x515a54[_0x1e5e76(0x324)][_0x1e5e76(0x6a7)] = ''; } } _0xd4cd2d(); } catch (_0x7b37f) { _0x1e5e76(0x7b0) !== 'xmpLq' ? _0x1d27c9['pause']() : (console[_0x1e5e76(0x412)](_0x1e5e76(0x340), _0x7b37f), _0x30a64e(_0x1e5e76(0x8c5) + _0x7b37f[_0x1e5e76(0x227)])); } finally { _0x1e5e76(0x8b6) !== _0x1e5e76(0x8b6) ? (_0x4703a9[_0x1e5e76(0x74f)] = _0x8a7df7, _0x5b0f12 = !![]) : _0x585d0a(![]); } }, 0x32); } else _0x381af3(_0x4ecc57[_0xdd7911(0x697)])['then'](_0x521b24 => { const _0x5be345 = _0xdd7911, _0x4fcf62 = _0x981533[_0x5be345(0x1f3)](_0x10a325); if (_0x4fcf62 && _0x521b24) _0x4fcf62[_0x5be345(0x465)] = _0xb0dcc0[_0x5be345(0x4af)](_0x521b24); }); } async function _0x14ce59() { const _0x36c52c = _0x2b3d5e; if (_0x36c52c(0x401) !== _0x36c52c(0x50b)) { if (_0x79fbb7[_0x36c52c(0x8b0)]) { if (_0x36c52c(0x24a) === _0x36c52c(0x24a)) { _0x30a64e('正在生成中，请稍候...'); return; } else _0x504d5d[_0x36c52c(0x465)] = _0x178a17 ? _0x488d42['createObjectURL'](_0x4af435) : ''; } const _0x117b41 = _0x79fbb7[_0x36c52c(0x623)]; if (_0x117b41[_0x36c52c(0x629)] === 0x0) return; let _0x413248 = -0x1; for (let _0x38c6ed = _0x117b41['length'] - 0x1; _0x38c6ed >= 0x0; _0x38c6ed--) { if (_0x117b41[_0x38c6ed][_0x36c52c(0x5f2)] === _0x36c52c(0x721)) { if ('qVgsq' === 'qVgsq') { _0x413248 = _0x38c6ed; break; } else _0x2a4d34['error'](_0x36c52c(0x5fe), _0x4d277f), _0x200774({ 'role': _0x36c52c(0x2ea), 'content': _0x36c52c(0x8f6) + _0x431468[_0x36c52c(0x227)] }, _0x4c07f5[_0x36c52c(0x623)][_0x36c52c(0x629)] - 0x1); } } if (_0x413248 === -0x1 || _0x413248 === _0x117b41[_0x36c52c(0x629)] - 0x1) { _0x30a64e(_0x36c52c(0x1c1)); return; } _0x117b41[_0x36c52c(0x76e)](_0x413248 + 0x1), _0x23a213(), _0x3e6176(), setTimeout(() => { const _0x270a7f = _0x36c52c; 'XTIRC' !== _0x270a7f(0x298) ? _0x3346d1() : (_0x547066[_0x270a7f(0x324)][_0x270a7f(0x6c0)] = _0x270a7f(0x878), _0xf45862[_0x270a7f(0x324)][_0x270a7f(0x13c)] = _0x270a7f(0x5ff)); }, 0x64); } else _0x82758e(_0xe50a8); } function _0x2e4a87(_0xcf4ef3 = null) { const _0x4aac3e = _0x2b3d5e, _0x319f3b = _0xcf4ef3 ?? _0x51655b['value'][_0x4aac3e(0x538)](); if (_0x319f3b === '' || !_0x79fbb7[_0x4aac3e(0x4d8)]) return; const _0x3ed0c9 = document[_0x4aac3e(0x249)](_0x4aac3e(0x73a)), _0x3443a4 = _0x3ed0c9['id'] === _0x4aac3e(0x43b), _0x5b6b0a = { 'role': _0x4aac3e(0x721), 'content': _0x319f3b, 'timestamp': Date[_0x4aac3e(0x86b)](), 'isOffline': _0x3443a4 }; _0x79fbb7['activeQuote'] && (_0x4aac3e(0x3ba) !== _0x4aac3e(0x6e1) ? _0x5b6b0a[_0x4aac3e(0x66b)] = { ..._0x79fbb7[_0x4aac3e(0x104)] } : (_0x335006['classList'][_0x4aac3e(0x612)](_0x4aac3e(0x920)), _0x3082db[_0x4aac3e(0x43d)][_0x4aac3e(0x545)](_0x4aac3e(0x920)) && (_0x515f52[_0x4aac3e(0x144)] = _0x166ebe['scrollHeight']))), _0x79fbb7[_0x4aac3e(0x623)]['push'](_0x5b6b0a), _0x23a213(), _0x3e6176(), !_0xcf4ef3 && (_0x4aac3e(0x892) !== 'vOTTE' ? _0x51655b['value'] = '' : _0x2cfe1e[_0x4aac3e(0x324)][_0x4aac3e(0x7ab)] = _0x4aac3e(0x277)), _0xd1df94(); } function _0x1c24b7(_0x3a0cd7) { const _0x60528e = _0x2b3d5e; if (_0x60528e(0x178) === _0x60528e(0x4e5)) { _0x58b062(_0x60528e(0x7f2)); return; } else { if (!_0x3a0cd7 || !_0x79fbb7[_0x60528e(0x4d8)]) return; const _0x135f14 = { 'role': 'user', 'content': _0x60528e(0x15d) + _0x3a0cd7[_0x60528e(0x908)] + ']', 'displayUrl': _0x3a0cd7[_0x60528e(0x30d)], 'timestamp': Date['now']() }; _0x79fbb7['conversationHistory'][_0x60528e(0x7d8)](_0x135f14), _0x55141a(_0x135f14, _0x79fbb7[_0x60528e(0x623)][_0x60528e(0x629)] - 0x1), _0x23a213(), _0x39e70e[_0x60528e(0x43d)][_0x60528e(0x154)]('show'); } } async function _0x4bcfb3(_0x4d4ea3) { const _0x3b02ae = _0x2b3d5e, _0x2bf1d2 = _0x4d4ea3[_0x3b02ae(0x381)]['files'][0x0]; if (!_0x2bf1d2 || !_0x79fbb7[_0x3b02ae(0x4d8)]) return; _0x585d0a(!![], _0x3b02ae(0x738)); try { const _0x1d3bab = await _0x40c94b(_0x2bf1d2, 0x320, 0.8, !![]), _0x19fa54 = _0x3b02ae(0xfa) + Date['now'](); await _0x43bf1f(_0x19fa54, _0x1d3bab); const _0x48b721 = _0x51655b[_0x3b02ae(0x2ff)][_0x3b02ae(0x538)](); _0x51655b[_0x3b02ae(0x2ff)] = ''; const _0x1958f8 = { 'role': _0x3b02ae(0x721), 'content': _0x48b721, 'imageId': _0x19fa54, 'timestamp': Date['now']() }; _0x79fbb7[_0x3b02ae(0x623)]['push'](_0x1958f8), _0x55141a(_0x1958f8, _0x79fbb7[_0x3b02ae(0x623)]['length'] - 0x1), _0x23a213(); } catch (_0x4db157) { _0x30a64e(_0x3b02ae(0x6a8) + _0x4db157[_0x3b02ae(0x227)]); } finally { _0x585d0a(![]), _0x4d4ea3[_0x3b02ae(0x381)][_0x3b02ae(0x2ff)] = ''; } } async function _0x5ec7f6() { const _0x2a1e89 = _0x2b3d5e; if (_0x2a1e89(0x922) !== 'lQvNE') { if (!_0x79fbb7['activeChatId']) return; const _0x412eaa = await _0x14d64e(); if (!_0x412eaa) return; _0x30a64e(_0x2a1e89(0x5d1)); try { const _0x3a3465 = await _0x314a48(_0x412eaa['songName'], _0x412eaa[_0x2a1e89(0x160)]); let _0x518b04 = _0x3a3465[_0x2a1e89(0x876)]; if (_0x3a3465[_0x2a1e89(0x876)] && _0x3a3465['cover'][_0x2a1e89(0x55c)](_0x2a1e89(0x4d6))) { if ('PPcLa' !== 'eDIfc') try { if (_0x2a1e89(0x159) === _0x2a1e89(0x159)) { const _0x4d474b = await fetch(_0x3a3465[_0x2a1e89(0x876)]), _0x532bb7 = await _0x4d474b[_0x2a1e89(0x29c)](); _0x518b04 = await _0x3b4f2c(_0x532bb7); } else { const _0x20924c = _0x5b1ae6[_0x391fa0]; _0x4b5ef7(_0x20924c); } } catch (_0x414fca) { if (_0x2a1e89(0x31d) !== 'LhZTo') console[_0x2a1e89(0x412)](_0x2a1e89(0x24b), _0x414fca), _0x518b04 = _0x426b80; else { const _0x1c0ac6 = _0x57de0c[_0x2a1e89(0x444)]?.[_0x2a1e89(0x5ad)](_0x428b69['id']), _0x391f6a = _0x5bed12[_0x2a1e89(0x4f8)]('label'); _0x391f6a['innerHTML'] = _0x2a1e89(0x341) + _0x329e87['id'] + '\x22\x20' + (_0x1c0ac6 ? _0x2a1e89(0x38e) : '') + '>\x20' + _0x393289['name'], _0xf2e4a7[_0x2a1e89(0x7b9)](_0x391f6a); } } else _0x38e58e(), _0x1212e2(![]); } const _0x4c8cd4 = { 'role': _0x2a1e89(0x721), 'type': _0x2a1e89(0x6fe), 'content': '[用户分享了音乐：' + _0x412eaa['songName'] + _0x2a1e89(0x61f) + _0x412eaa[_0x2a1e89(0x160)] + ']', 'songName': _0x412eaa[_0x2a1e89(0x31c)], 'artist': _0x412eaa[_0x2a1e89(0x160)], 'coverUrl': _0x518b04, 'playableUrl': _0x3a3465[_0x2a1e89(0x30d)], 'timestamp': Date[_0x2a1e89(0x86b)]() }; _0x79fbb7['conversationHistory'][_0x2a1e89(0x7d8)](_0x4c8cd4), _0x55141a(_0x4c8cd4, _0x79fbb7[_0x2a1e89(0x623)][_0x2a1e89(0x629)] - 0x1), _0x23a213(); } catch (_0x2f7d8f) { console[_0x2a1e89(0x412)](_0x2a1e89(0x667), _0x2f7d8f), _0x30a64e(_0x2a1e89(0x45c) + _0x2f7d8f[_0x2a1e89(0x227)]); } } else _0x45f9c5[_0x2a1e89(0x66b)] = { 'sender': _0x4bfc22[0x1]['trim'](), 'content': _0x1b699e[0x2]['trim']() }, _0x1dc371['content'] = _0x384705[_0x2a1e89(0x524)](_0x4e57bf[0x0][_0x2a1e89(0x629)])[_0x2a1e89(0x538)](); } function _0x2f2824(_0x4604b3, _0x4265d4 = 0x78) { const _0x571dd0 = _0x2b3d5e, _0x207b82 = _0x3d3a58 => { const _0x490e6c = _0x1507; if (_0x3d3a58[_0x490e6c(0x5f2)] === _0x490e6c(0x721)) return _0x79fbb7[_0x490e6c(0x1ab)]?.[_0x490e6c(0x908)] || _0x490e6c(0x835); if (_0x3d3a58[_0x490e6c(0x14b)]) { const _0x3fec62 = _0x1249c2(_0x3d3a58['senderId']); return _0x3fec62?.[_0x490e6c(0x908)] || 'Unknown'; } if (_0x4604b3?.[_0x490e6c(0x1fb)] === _0x490e6c(0x91f)) { const _0x47f6f8 = _0x1249c2(_0x4604b3[_0x490e6c(0x285)][0x0]); return _0x47f6f8?.[_0x490e6c(0x908)] || 'AI'; } return _0x490e6c(0x891); }, _0x4ca716 = _0x79fbb7[_0x571dd0(0x623)][_0x571dd0(0x45b)](-_0x4265d4), _0x3339d2 = []; for (const _0x38c163 of _0x4ca716) { if (_0x38c163[_0x571dd0(0x710)]) _0x3339d2[_0x571dd0(0x7d8)]('[' + _0x207b82(_0x38c163) + _0x571dd0(0x89e) + (_0x38c163[_0x571dd0(0x317)]?.['match'](/：(.+?)]/)?.[0x1] || '表情') + ']'); else { if (_0x38c163['image']) { const _0x126d66 = _0x38c163[_0x571dd0(0x317)] ? '\x20' + _0x38c163[_0x571dd0(0x317)] : ''; _0x3339d2[_0x571dd0(0x7d8)]('[' + _0x207b82(_0x38c163) + _0x571dd0(0x6f6) + _0x126d66); } else _0x38c163['content'] && _0x3339d2[_0x571dd0(0x7d8)]('[' + _0x207b82(_0x38c163) + ']\x20' + _0x38c163[_0x571dd0(0x317)]); } } return _0x3339d2[_0x571dd0(0x26c)]('\x0a'); } function _0x53fc84(_0x4a94fa, _0x165000) { const _0x5a1b0f = _0x2b3d5e; if (_0x5a1b0f(0x448) !== _0x5a1b0f(0x2bd)) { if (!_0x4a94fa || !_0x165000) return null; const _0x5767b8 = _0x165000['match'](/@([^\s:：,，。!?]+)/); if (!_0x5767b8) return null; const _0x157ebe = _0x5767b8[0x1][_0x5a1b0f(0x80c)](); for (const _0x1d656f of _0x4a94fa[_0x5a1b0f(0x285)]) { const _0x52998d = _0x1249c2(_0x1d656f); if (!_0x52998d?.['name']) continue; if (_0x52998d[_0x5a1b0f(0x908)]['toLowerCase']() === _0x157ebe) return _0x52998d; if (_0x52998d['name'][_0x5a1b0f(0x80c)]()['startsWith'](_0x157ebe)) return _0x52998d; } return null; } else return; } function _0x139f46(_0xa91031) { const _0x4c0ac9 = _0x2b3d5e, _0x236bd5 = _0xa91031[_0x4c0ac9(0x4e4)]('{'), _0x5aea52 = _0xa91031['lastIndexOf']('}'); if (_0x236bd5 >= 0x0 && _0x5aea52 > _0x236bd5) return _0xa91031[_0x4c0ac9(0x45b)](_0x236bd5, _0x5aea52 + 0x1); return _0xa91031; } function _0x20e1bd(_0x37e5e6, _0x3261b4, _0x3a11ff) { const _0x53ec3b = _0x2b3d5e, _0x71483e = new Map(_0x3261b4[_0x53ec3b(0x843)](_0x45cbb1 => [String(_0x45cbb1['id']), _0x45cbb1])), _0x252c6b = _0x201a53 => String(_0x201a53 || '')['toLowerCase']()[_0x53ec3b(0x1c3)](/\s+/g, ''), _0x42250b = new Map(_0x3261b4[_0x53ec3b(0x843)](_0x4d9bc8 => [_0x252c6b(_0x4d9bc8[_0x53ec3b(0x908)]), _0x4d9bc8])), _0x1ad63f = new Set(_0x3a11ff), _0x258679 = { 'events': [] }; for (const _0x126bcf of _0x37e5e6?.[_0x53ec3b(0x61e)] || []) { if ('JlkAT' !== _0x53ec3b(0x380)) { const _0x10276a = _0x126bcf['senderId'] ?? _0x126bcf[_0x53ec3b(0x6bd)] ?? _0x126bcf[_0x53ec3b(0x603)] ?? _0x126bcf[_0x53ec3b(0x806)] ?? _0x126bcf['role'] ?? _0x126bcf[_0x53ec3b(0x908)]; if (!_0x10276a) continue; let _0x180efa = _0x71483e['get'](String(_0x10276a)) || _0x42250b['get'](_0x252c6b(_0x10276a)); if (!_0x180efa) continue; const _0x1caee4 = (_0x126bcf['kind'] || _0x126bcf[_0x53ec3b(0x1fb)] || _0x53ec3b(0x6b3))[_0x53ec3b(0x80c)](); if (_0x1caee4 === _0x53ec3b(0x57e)) { const _0x3f08a4 = (_0x126bcf[_0x53ec3b(0x57e)] ?? _0x126bcf['emoji'] ?? _0x126bcf['emote'] ?? _0x126bcf[_0x53ec3b(0x1f9)])?.[_0x53ec3b(0x538)](); if (_0x3f08a4 && _0x1ad63f['has'](_0x3f08a4)) _0x258679[_0x53ec3b(0x61e)][_0x53ec3b(0x7d8)]({ 'senderId': _0x180efa['id'], 'kind': 'sticker', 'sticker': _0x3f08a4 }); else { if (_0x53ec3b(0x5e5) !== _0x53ec3b(0x5e5)) { const _0x2621fc = _0x1b6a02['accountingData'][_0x53ec3b(0x561)](_0x3564a1 => _0x3564a1['id'] === _0xfb000e); _0x2621fc > -0x1 && (_0x2ccee7[_0x53ec3b(0x3b2)][_0x53ec3b(0x76e)](_0x2621fc, 0x1), _0x3faf0c(), _0x4551dc()); } else { const _0x3dd5ab = String(_0x126bcf['content'] ?? _0x126bcf[_0x53ec3b(0x6b3)] ?? '')[_0x53ec3b(0x538)]() || _0x53ec3b(0x4c4) + (_0x3f08a4 || '未知表情') + ']'; if (_0x3dd5ab) _0x258679[_0x53ec3b(0x61e)][_0x53ec3b(0x7d8)]({ 'senderId': _0x180efa['id'], 'kind': _0x53ec3b(0x6b3), 'content': _0x3dd5ab }); } } } else { if ('oealo' === _0x53ec3b(0x2da)) { const _0x35e910 = _0x248f2d['transaction'](_0x3f79a0, 'readonly'), _0x17f105 = _0x35e910[_0x53ec3b(0x8a5)](_0x5a3eed), _0x3a6039 = _0x17f105[_0x53ec3b(0x3b6)](); _0x3a6039['onsuccess'] = () => _0x3347eb(_0x3a6039[_0x53ec3b(0x6e4)]), _0x3a6039['onerror'] = () => _0x746427(_0x3a6039[_0x53ec3b(0x412)]); } else { const _0x5732c4 = String(_0x126bcf['content'] ?? _0x126bcf['text'] ?? _0x126bcf[_0x53ec3b(0x227)] ?? '')[_0x53ec3b(0x538)](); if (_0x5732c4) _0x258679[_0x53ec3b(0x61e)][_0x53ec3b(0x7d8)]({ 'senderId': _0x180efa['id'], 'kind': _0x53ec3b(0x6b3), 'content': _0x5732c4 }); } } } else { const { omniText: _0x304e00 } = _0x549ad9(_0x31d363['id'], _0x42ce4e['id']), _0x5ee692 = _0xfba7d7(_0x16e3de['id']), _0x553fa6 = _0x41c332[_0x53ec3b(0x444)] && _0x384a67['linkedWorldBookIds'][_0x53ec3b(0x629)] > 0x0 ? _0x53ec3b(0x611) + _0x59f484[_0x53ec3b(0x908)] + _0x53ec3b(0x4a3) + _0x44aa4e['linkedWorldBookIds'][_0x53ec3b(0x843)](_0x5d6c0d => _0x1b8508[_0x53ec3b(0x32e)]['find'](_0x55006b => _0x55006b['id'] === _0x5d6c0d))[_0x53ec3b(0x6a6)](_0x3cc950)[_0x53ec3b(0x843)](_0x2ed53f => _0x53ec3b(0x27f) + _0x2ed53f['name'] + '\x0a' + _0x2ed53f[_0x53ec3b(0x317)])['join']('') : ''; return { 'id': _0x51bef2['id'], 'name': _0xff412d[_0x53ec3b(0x908)], 'persona': _0x3a1e81['persona'] || _0x53ec3b(0x489), 'memory': _0x304e00 + _0x5ee692 + _0x553fa6 }; } } return _0x258679; } async function _0x164605(_0x278ea0) { const _0x12c8f4 = _0x2b3d5e; if (!_0x278ea0 || !Array[_0x12c8f4(0x660)](_0x278ea0[_0x12c8f4(0x61e)]) || _0x278ea0['events'][_0x12c8f4(0x629)] === 0x0) return; const _0x3c8cf0 = _0x3d1cc0 => _0x3d1cc0 + Math[_0x12c8f4(0x2e7)](Math[_0x12c8f4(0x4dc)]() * 0x190); let _0x273827 = 0x1f4; for (const _0x1400b2 of _0x278ea0[_0x12c8f4(0x61e)]) { await new Promise(_0x5da42c => setTimeout(_0x5da42c, _0x3c8cf0(_0x273827))), _0x273827 += 0x2bc; const _0x1c8969 = _0x79fbb7['conversationHistory']['at'](-0x1)?.['isOffline'] ?? ![]; if (_0x1400b2[_0x12c8f4(0x7f6)] === _0x12c8f4(0x57e)) { const _0xbc8580 = _0x57edcf[_0x12c8f4(0x2aa)](_0xf01bf6 => _0xf01bf6[_0x12c8f4(0x908)] === _0x1400b2[_0x12c8f4(0x57e)]); if (_0xbc8580) { const _0x14e3c7 = { 'role': _0x12c8f4(0x2ea), 'content': '[AI发送了表情：' + _0xbc8580[_0x12c8f4(0x908)] + ']', 'displayUrl': _0xbc8580[_0x12c8f4(0x30d)], 'senderId': _0x1400b2[_0x12c8f4(0x14b)], 'timestamp': Date[_0x12c8f4(0x86b)](), 'isOffline': _0x1c8969 }; _0x79fbb7['conversationHistory'][_0x12c8f4(0x7d8)](_0x14e3c7); } } else { if (_0x1400b2[_0x12c8f4(0x7f6)] === _0x12c8f4(0x6fe) && _0x1400b2[_0x12c8f4(0x31c)] && _0x1400b2[_0x12c8f4(0x160)]) { const { songName: _0x257083, artist: _0x4ba59e } = _0x1400b2, _0x5507e8 = { 'role': _0x12c8f4(0x2ea), 'type': _0x12c8f4(0x6fe), 'content': _0x12c8f4(0x850) + _0x257083 + _0x12c8f4(0x61f) + _0x4ba59e + ']', 'songName': _0x257083, 'artist': _0x4ba59e, 'senderId': _0x1400b2[_0x12c8f4(0x14b)], 'timestamp': Date[_0x12c8f4(0x86b)](), 'isOffline': _0x1c8969 }; try { if ('NvlHF' !== 'NvlHF') { const _0x371013 = _0xc60802(_0x3db91d), _0x448e94 = _0xdea905[_0x12c8f4(0x1f3)](_0x12c8f4(0x2cc)); _0x448e94[_0x12c8f4(0x324)]['backgroundImage'] = ''; let _0x55de54 = _0xcaaf0f[_0x12c8f4(0x1f3)](_0x12c8f4(0x3cd) + _0x131931); if (_0x55de54) _0x55de54['innerHTML'] = ''; if (!_0x371013) return; _0x371013[_0x12c8f4(0x41b)] && (_0x448e94['style'][_0x12c8f4(0x6a7)] = 'url(\x27' + _0x371013['chatWallpaper'] + '\x27)', _0x448e94['style'][_0x12c8f4(0x93f)] = _0x12c8f4(0x876), _0x448e94[_0x12c8f4(0x324)][_0x12c8f4(0x203)] = _0x12c8f4(0x51e)); if (_0x371013[_0x12c8f4(0x23f)]) { let _0x2386a4 = _0x4dc770['getElementById'](_0x12c8f4(0x3cd) + _0x371013['id']); !_0x2386a4 && (_0x2386a4 = _0x4f4b37[_0x12c8f4(0x4f8)]('style'), _0x2386a4['id'] = 'style-' + _0x371013['id'], _0x4373ae[_0x12c8f4(0x58a)][_0x12c8f4(0x7b9)](_0x2386a4)); const _0x51cd51 = _0x371013[_0x12c8f4(0x23f)], _0x47fb21 = _0x51cd51['replace'](/\.bubble\.sent/g, _0x12c8f4(0x177) + _0x371013['id'] + _0x12c8f4(0x85a))[_0x12c8f4(0x1c3)](/\.bubble\.received/g, '.bubble-' + _0x371013['id'] + _0x12c8f4(0x92f)); _0x2386a4[_0x12c8f4(0x2f7)] = _0x47fb21; } } else { const _0x236927 = await _0x314a48(_0x257083, _0x4ba59e); _0x5507e8[_0x12c8f4(0x1d1)] = _0x236927['cover'], _0x5507e8['playableUrl'] = _0x236927[_0x12c8f4(0x30d)]; } } catch (_0x2f6786) { if ('qMRse' !== _0x12c8f4(0x151)) { const _0x3c475a = _0xefcd0a[_0x12c8f4(0x444)][_0x12c8f4(0x843)](_0x3cbe57 => _0x46c2df['worldBooks']['find'](_0x5b50b5 => _0x5b50b5['id'] === _0x3cbe57))[_0x12c8f4(0x6a6)](_0x3bf7ef)[_0x12c8f4(0x843)](_0x50d193 => _0x12c8f4(0x716) + _0x50d193[_0x12c8f4(0x908)] + '\x0a' + _0x50d193[_0x12c8f4(0x317)])[_0x12c8f4(0x26c)](''); if (_0x3c475a) _0x456575 = _0x12c8f4(0x265) + _0x3c475a; } else console[_0x12c8f4(0x412)]('群聊音乐搜索失败\x20(' + _0x257083 + '\x20-\x20' + _0x4ba59e + '):', _0x2f6786), _0x5507e8[_0x12c8f4(0x1d1)] = null, _0x5507e8[_0x12c8f4(0x8b7)] = null; } _0x79fbb7[_0x12c8f4(0x623)]['push'](_0x5507e8); } else { if (_0x1400b2[_0x12c8f4(0x7f6)] === 'text') { if (_0x12c8f4(0x176) !== _0x12c8f4(0x176)) _0x31ea00[_0x12c8f4(0x847)](_0x12c8f4(0x57b)); else { const _0x248959 = _0x3ce7f4(_0x1400b2[_0x12c8f4(0x317)])[_0x12c8f4(0x45b)](0x0, 0x3); for (let _0x40a509 = 0x0; _0x40a509 < _0x248959['length']; _0x40a509++) { if (_0x12c8f4(0x2b6) === _0x12c8f4(0x27a)) { if (_0x48c196['name'] !== _0x12c8f4(0x7e4)) { _0xb9b28b[_0x12c8f4(0x412)](_0x12c8f4(0x8fa), _0x22d27a); const _0x4b152c = { 'role': 'assistant', 'content': _0x12c8f4(0x8f6) + _0x21439d[_0x12c8f4(0x227)], 'senderId': _0x4131b0['id'], 'isOffline': _0x1964ce }; _0x4eb8bd[_0x12c8f4(0x623)][_0x12c8f4(0x7d8)](_0x4b152c), _0x199111(); } return ![]; } else { if (_0x40a509 > 0x0) await new Promise(_0x104f3f => setTimeout(_0x104f3f, _0x3c8cf0(0x190))); const _0x29919b = { 'role': _0x12c8f4(0x2ea), 'content': _0x248959[_0x40a509], 'senderId': _0x1400b2[_0x12c8f4(0x14b)], 'timestamp': Date[_0x12c8f4(0x86b)](), 'isOffline': _0x1c8969 }; _0x79fbb7[_0x12c8f4(0x623)][_0x12c8f4(0x7d8)](_0x29919b); } } } } } } } _0x23a213(), _0x3e6176(); } async function _0x1891a3(_0x713ff4, { force: force = ![], delayMs: delayMs = 0x0 } = {}) { const _0x4400f4 = _0x2b3d5e; if (_0x4400f4(0x913) === 'RJMGE') { const _0x4f2f06 = _0x1c2594[_0x4400f4(0x3b6)](); _0x4f2f06[_0x4400f4(0x7eb)] = () => _0x5061f9(_0x4f2f06['result']), _0x4f2f06[_0x4400f4(0x7d0)] = () => _0x54fbb1(_0x4f2f06[_0x4400f4(0x412)]); } else { await new Promise(_0x1a1130 => setTimeout(_0x1a1130, 0xa)); if (!_0x79fbb7[_0x4400f4(0x164)][_0x4400f4(0x7d5)] || !_0x79fbb7[_0x4400f4(0x164)][_0x4400f4(0x251)] || !_0x79fbb7[_0x4400f4(0x164)][_0x4400f4(0x1b1)]) return _0x30a64e('请先在\x22设置\x22中配置你的\x20API\x20信息。'), ![]; const _0x34f82e = _0x3f4d37(); if (!_0x34f82e || !_0x713ff4) return ![]; const _0x8fe296 = _0x1cdea5(_0x34f82e['id']), _0x5ae12f = _0x79fbb7[_0x4400f4(0x623)]['at'](-0x1)?.[_0x4400f4(0x5f2)] === _0x4400f4(0x721); if (!force && !_0x5ae12f) return ![]; const _0x52219f = _0x79fbb7[_0x4400f4(0x623)]['at'](-0x1)?.[_0x4400f4(0x5a8)] ?? ![]; if (delayMs) await new Promise(_0x49a6fe => setTimeout(_0x49a6fe, delayMs)); _0x52219f ? document[_0x4400f4(0x1f3)](_0x4400f4(0x47a))[_0x4400f4(0x5f4)] = _0x4400f4(0x609) : _0x11aff2(!![]); let _0x5185a4 = ''; const _0x466308 = _0x3f4d37(); if (_0x466308?.[_0x4400f4(0x865)]?.[_0x4400f4(0x91d)]) { if (_0x4400f4(0x2d8) === 'RdnfB') { const _0x5d3e0a = _0x466308['activeListenSession'], _0x9b35b2 = await _0x2665e7(_0x5d3e0a[_0x4400f4(0x7b6)]); if (_0x9b35b2 && _0x9b35b2[_0x4400f4(0x745)]) { const _0x34b5db = _0x4a79c1(_0x9b35b2[_0x4400f4(0x745)]); if (_0x34b5db['length'] > 0x0) { if (_0x4400f4(0x771) === 'ZZCPI') { const _0x294821 = _0x10c451[_0x4400f4(0x681)]; let _0x46024a = -0x1; for (let _0x43c092 = 0x0; _0x43c092 < _0x34b5db['length']; _0x43c092++) { if (_0x294821 >= _0x34b5db[_0x43c092][_0x4400f4(0x3bb)]) _0x46024a = _0x43c092; else break; } const _0x35e756 = _0x34b5db[_0x4400f4(0x843)]((_0x5736c1, _0x8cb1f4) => { const _0x501d0e = _0x4400f4, _0x138ff5 = _0x8cb1f4 === _0x46024a ? _0x501d0e(0x79b) : ''; return '' + _0x138ff5 + _0x5736c1['text']; })['join']('\x0a'); _0x5185a4 = (_0x4400f4(0x785) + _0x5d3e0a[_0x4400f4(0x160)] + _0x4400f4(0x44c) + _0x5d3e0a[_0x4400f4(0x31c)] + '》。\x0a这是当前的歌词，请注意带\x20\x27>>\x27\x20标记的正是正在播放的句子。\x0a\x0a[歌词开始]\x0a' + _0x35e756 + _0x4400f4(0x4cc))[_0x4400f4(0x538)](); } else { if (!_0x54115f) return; _0x3b3115[_0x41f5dc] = _0x136dca, _0x8c6e5[_0x394a26][_0x4400f4(0x249)](_0x4400f4(0x902))[_0x4400f4(0x5f4)] = _0x4e377c[_0x4400f4(0x908)], _0x2ce4fc[_0x822e16][_0x4400f4(0x43d)][_0x4400f4(0x20f)](_0x4400f4(0x2bb)), _0x23191d(); } } } } else { const _0x2905ab = _0x3f0666(_0x4181cb[_0x4400f4(0x285)][0x0]); _0x344d81[_0x4400f4(0x5f4)] = _0x2905ab ? _0x2905ab[_0x4400f4(0x908)] : _0x4400f4(0x44e); } } let _0x57cebc = '', _0x53c061 = ''; const _0x3ba1e6 = _0x79fbb7[_0x4400f4(0x623)]['length']; if (_0x3ba1e6 > 0x1) { if (_0x4400f4(0x22c) !== _0x4400f4(0x622)) { const _0x88f69f = _0x79fbb7[_0x4400f4(0x623)][_0x3ba1e6 - 0x2], _0x3826a5 = _0x79fbb7[_0x4400f4(0x623)][_0x3ba1e6 - 0x1]; if (_0x88f69f['isOffline'] === ![] && _0x3826a5[_0x4400f4(0x5a8)] === !![]) _0x4400f4(0x3c8) === _0x4400f4(0x258) ? (_0x343634 = _0x33efca[_0x4400f4(0x2b5)][0x0][_0x4400f4(0x5ed)], _0x4f7e81 = _0x9f47b2[_0x4400f4(0x2b5)][0x0]['clientY'], _0x1d1177 = !![], _0x164d31 = '') : _0x53c061 = _0x4400f4(0x82c) + _0x8fe296['name'] + _0x4400f4(0x4f3); else { if (_0x88f69f[_0x4400f4(0x5a8)] === !![] && _0x3826a5[_0x4400f4(0x5a8)] === ![]) { if (_0x4400f4(0x74d) === _0x4400f4(0x74d)) _0x53c061 = _0x4400f4(0x546) + _0x8fe296[_0x4400f4(0x908)] + _0x4400f4(0x770); else { _0x307d0d[_0x4400f4(0x2f7)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>请先选择一个好友圈。</p>'; return; } } } } else _0x41e675[_0x4400f4(0x54a)](_0x5c68eb, _0x1cf5f9[_0x4400f4(0x4de)](_0x4ff0ad)); } if (_0x52219f) { if (_0x4400f4(0x7f0) === _0x4400f4(0x21e)) _0x1204a5[_0x4400f4(0x4c8)](), _0x509fe0(_0x1f7af6['id']); else { const _0x3acc99 = 'normal,\x20happy,\x20angry,\x20sad,\x20shy'; _0x57cebc = '\x0a\x0a#\x20核心任务:\x20视觉小说剧本写作\x0a\x0a\x20\x20-\x20**当前场景**:\x20你正在与用户“' + _0x8fe296[_0x4400f4(0x908)] + _0x4400f4(0x62b) + _0x3acc99 + ']中选择的情绪标签\x22,\x0a\x20\x20\x20\x20\x22line\x22:\x20\x22台词或旁白内容\x22\x0a\x20\x20\x20\x20}\x0a\x20\x20\x0a\x20\x20-\x20**规则**:\x0a\x20\x20\x20\x201.\x20\x20`speaker`字段：如果是角色说话，就用角色名“' + _0x713ff4[_0x4400f4(0x908)] + _0x4400f4(0x3ad) + _0x3acc99 + ']\x20这五个词中选择一个。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。2.\x20\x20`emotion`字段：**必须**根据台词的【核心情感】，精准地从\x20[' + _0x3acc99 + _0x4400f4(0x5e7); } } else 'WxvTA' === _0x4400f4(0x7a7) ? _0x4400f4(0x3f6) : _0xfd914f[_0x4400f4(0x43d)][_0x4400f4(0x20f)]('is-visible'); const { omniText: _0x294188 } = _0x354941(_0x713ff4['id'], _0x34f82e['id']), _0x3c9666 = _0x582d84(), _0x359629 = _0x3e3955(_0x713ff4['id']), _0x1fabe6 = typeof _0x178d57 === _0x4400f4(0x873) ? _0x178d57[_0x4400f4(0x228)](_0x4400f4(0x7fe), _0x713ff4['name'])[_0x4400f4(0x228)](_0x4400f4(0x47f), _0x8fe296['name'] || '用户') : '', _0x1def1a = _0x57edcf[_0x4400f4(0x843)](_0x270a33 => _0x270a33[_0x4400f4(0x908)])[_0x4400f4(0x26c)](',\x20'); let _0x525b47 = ''; if (_0x713ff4[_0x4400f4(0x444)] && _0x713ff4[_0x4400f4(0x444)]['length'] > 0x0) { if (_0x4400f4(0x5c0) !== _0x4400f4(0x479)) { const _0x385678 = _0x713ff4[_0x4400f4(0x444)][_0x4400f4(0x843)](_0x4fac5d => _0x79fbb7[_0x4400f4(0x32e)][_0x4400f4(0x2aa)](_0x560f5c => _0x560f5c['id'] === _0x4fac5d))['filter'](Boolean)[_0x4400f4(0x843)](_0x4fb92e => _0x4400f4(0x716) + _0x4fb92e['name'] + '\x0a' + _0x4fb92e[_0x4400f4(0x317)])[_0x4400f4(0x26c)](''); if (_0x385678) _0x525b47 = _0x4400f4(0x265) + _0x385678; } else { const _0x4edd37 = _0x107cfa['getElementById'](_0x4400f4(0x93b))['value']; _0x4edd37 && (_0x315319[_0x4400f4(0x4dd)] = _0x4edd37, _0x51e34f(), _0x57ee3c('已设为当前用户！'), _0x18e99a(), _0x2c7654['getElementById'](_0x4400f4(0x8ba))[_0x4400f4(0x324)][_0x4400f4(0x7ab)] = _0x4400f4(0x277)); } } const _0x743401 = _0x8fe296[_0x4400f4(0x6dc)] ? _0x4400f4(0x3fb) + _0x8fe296['name'] + _0x4400f4(0x2ac) + _0x8fe296[_0x4400f4(0x6dc)] : ''; let _0xdfced = ''; const _0x39d981 = new Date(), _0x282f73 = _0x177102(_0x713ff4['id']); _0xdfced = '\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a', _0xdfced += _0x4400f4(0x29f) + _0x39d981[_0x4400f4(0x52e)]('zh-CN', { 'dateStyle': _0x4400f4(0x7ae), 'timeStyle': _0x4400f4(0x43f) }) + '\x0a'; if (_0x282f73) { if (_0x4400f4(0x117) === 'ZKUUY') { const _0x52e4b8 = new Date(_0x282f73[_0x4400f4(0x68c)]), _0x789def = _0x243dab(_0x52e4b8); _0xdfced += _0x4400f4(0x377) + _0x789def + '\x0a'; const _0x6b75b0 = _0x39d981[_0x4400f4(0x867)](), _0x15bf54 = _0x52e4b8[_0x4400f4(0x867)](), _0x877097 = new Date(); _0x877097[_0x4400f4(0x3bd)](_0x39d981[_0x4400f4(0x5d5)]() - 0x1); const _0x1b0f64 = _0x877097['toDateString'](); if (_0x6b75b0 === _0x15bf54) { if ('jvDpY' === 'RMSNi') _0x4436b1[_0x4400f4(0x144)] = _0x4a2a90[_0x4400f4(0x939)]; else { const _0x3fc2c4 = (_0x39d981 - _0x52e4b8) / (0x3e8 * 0x3c); _0x3fc2c4 < 0x3c ? _0xdfced += _0x4400f4(0x4ff) : 'JwbSN' === _0x4400f4(0x11e) ? _0xdfced += _0x4400f4(0x56a) + Math[_0x4400f4(0x8d6)](_0x3fc2c4 / 0x3c) + _0x4400f4(0x450) : _0x4554b5 > _0x20a30d && (_0x5be8ae *= _0x24f440 / _0x1c9805, _0x413f45 = _0x1243d2); } } else { if (_0x1b0f64 === _0x15bf54) _0x4400f4(0x549) !== _0x4400f4(0x7b7) ? _0xdfced += _0x4400f4(0x3ac) : (_0x5acc3d['error'](_0x4400f4(0x241), _0x2addfd), _0x2bc436(_0x4400f4(0x645) + _0x1be37b['message'])); else { if (_0x4400f4(0x795) === _0x4400f4(0x795)) { const _0xbb4a07 = Math['round']((_0x39d981 - _0x52e4b8) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0xdfced += _0x4400f4(0x92e) + _0xbb4a07 + '\x20天没联系了，应该用全新的问候开启对话，不要再提上次的话题了。\x0a'; } else _0x4060b5[_0x4400f4(0x154)](); } } } else { const _0x35abb8 = _0x4b7a56[_0x4400f4(0x4f8)]('option'); _0x35abb8[_0x4400f4(0x2ff)] = _0xc8526e['id'], _0x35abb8[_0x4400f4(0x5f4)] = _0x38c18d[_0x4400f4(0x908)], _0x2bc0ee[_0x4400f4(0x7b9)](_0x35abb8); } } else { if (_0x4400f4(0x58e) !== _0x4400f4(0x58e)) return '今天\x20' + _0x545daf; else _0xdfced += _0x4400f4(0x909); } const _0x1389b6 = ('\x0a' + _0x57cebc + _0x4400f4(0x1ce) + _0x713ff4[_0x4400f4(0x908)] + '】进行回复。\x0a不要替其他角色续写台词，不要输出\x22' + _0x713ff4['name'] + _0x4400f4(0x28a) + _0x713ff4[_0x4400f4(0x908)] + _0x4400f4(0x220) + _0x1def1a + _0x4400f4(0x437) + _0x1fabe6 + '\x0a')[_0x4400f4(0x538)](), _0x39e390 = [{ 'role': _0x4400f4(0x35f), 'content': _0x1389b6 }], _0x54522b = (_0x4400f4(0x4da) + (_0x713ff4[_0x4400f4(0x6dc)] || _0x4400f4(0x8c3)) + '\x0a' + _0x743401 + '\x20\x0a' + _0x294188 + '\x0a' + _0x3c9666 + '\x0a' + _0x359629 + '\x0a#\x20当前情景\x0a' + _0x5185a4 + '\x0a' + _0xdfced + '\x0a' + _0x525b47 + '\x0a')['trim'](); _0x54522b['replace'](/#.*|\s/g, '') && (_0x39e390[_0x4400f4(0x7d8)]({ 'role': _0x4400f4(0x721), 'content': _0x54522b }), _0x39e390[_0x4400f4(0x7d8)]({ 'role': _0x4400f4(0x2ea), 'content': '好的，我记住了这些人设和历史。现在我们开始对话。' })); const _0x141228 = _0x79fbb7[_0x4400f4(0x11a)]?.[_0x4400f4(0x42b)] ?? 0x64, _0x65558e = _0x79fbb7['conversationHistory']['slice'](-_0x141228); for (const _0x33f448 of _0x65558e) { const _0x10753c = _0x33f448[_0x4400f4(0x5f2)] === 'ai' || _0x33f448[_0x4400f4(0x5f2)] === 'assistant' ? _0x4400f4(0x2ea) : 'user'; let _0x357f23 = { 'role': _0x10753c, 'content': _0x33f448['content'] }, _0x5185cd = !!_0x33f448[_0x4400f4(0x317)]; if (_0x33f448['displayUrl'] && _0x33f448['content'][_0x4400f4(0x5ad)]('表情')) { const _0x1ca667 = _0x33f448[_0x4400f4(0x317)]['match'](/：(.*?)]$/); _0x357f23[_0x4400f4(0x317)] = _0x4400f4(0x4c4) + (_0x1ca667 ? _0x1ca667[0x1] : _0x4400f4(0x91e)) + ']', _0x39e390[_0x4400f4(0x7d8)](_0x357f23); } else { if (_0x4400f4(0x3cc) !== _0x4400f4(0x776)) { let _0x4787f3 = null; if (_0x33f448[_0x4400f4(0x74f)]) { if (_0x4400f4(0x798) !== 'tqsTh') _0x4787f3 = _0x33f448[_0x4400f4(0x74f)]; else { const _0x22885a = _0x43b36f[_0x4400f4(0x285)][0x0]; _0x239a65['classList'][_0x4400f4(0x20f)](_0x4400f4(0x356) + _0x22885a); } } else { if (_0x33f448['imageId']) try { const _0x59c523 = await _0x3db342(_0x33f448[_0x4400f4(0x116)]); if (_0x59c523) { if ('PWuaT' === 'PWuaT') _0x4787f3 = await _0x3b4f2c(_0x59c523); else { const _0x48d2a0 = _0x41f7e1[_0x4400f4(0x1f3)](_0x4400f4(0x5d9)); _0x5c0d9a['getElementById'](_0x4400f4(0x8be))[_0x4400f4(0x5f4)] = '账本', _0x2fe885[_0x4400f4(0x1f3)](_0x4400f4(0x6b5))['innerHTML'] = ''; const _0x27a6ee = _0xdfa4c3[_0x4400f4(0x2d2)](_0x844a6c[_0x4400f4(0x49c)])[_0x4400f4(0x2c1)]((_0x12d3dd, _0x4c68e) => new _0x18dcb0(_0x4c68e) - new _0x1b35ca(_0x12d3dd)); if (_0x27a6ee['length'] === 0x0) { _0x48d2a0[_0x4400f4(0x2f7)] = _0x4400f4(0x7e2); return; } _0x48d2a0[_0x4400f4(0x2f7)] = '', _0x27a6ee[_0x4400f4(0x8f0)](_0x162a3e => { const _0x4dde3a = _0x4400f4, _0xfbfa85 = _0x58d138['createElement'](_0x4dde3a(0x8dc)); _0xfbfa85[_0x4dde3a(0x1dc)] = _0x4dde3a(0x12a), _0xfbfa85['style'][_0x4dde3a(0x416)] = 'pointer'; const _0x3eeb84 = _0x2ac2e3[_0x4dde3a(0x49c)][_0x162a3e], _0x476380 = _0x3eeb84['categorizedExpenses'][_0x4dde3a(0x2a7)]((_0x301bf1, _0x1f7ac6) => _0x301bf1 + (_0x1f7ac6[_0x4dde3a(0x1aa)] || 0x0), 0x0); _0xfbfa85[_0x4dde3a(0x2f7)] = _0x4dde3a(0x17d) + _0x162a3e + _0x4dde3a(0x39f) + _0x476380['toFixed'](0x2) + '</span>', _0xfbfa85[_0x4dde3a(0x3eb)](_0x4dde3a(0x1a4), () => { const _0x945cb7 = _0x4dde3a; _0xcb2116['classList'][_0x945cb7(0x154)](_0x945cb7(0x4a8)), _0x288996['classList'][_0x945cb7(0x20f)](_0x945cb7(0x4a8)), _0x23a7eb(_0x3eeb84, _0x162a3e); }), _0x48d2a0['appendChild'](_0xfbfa85); }); } } } catch (_0x1cb5f0) { console[_0x4400f4(0x412)](_0x4400f4(0x5d4), _0x1cb5f0); } } _0x4787f3 && (_0x357f23[_0x4400f4(0x74f)] = _0x4787f3, _0x5185cd = !![]), _0x5185cd && _0x39e390[_0x4400f4(0x7d8)](_0x357f23); } else { const _0x380642 = _0x20adb4(_0x32aa57[_0x4400f4(0x78e)][_0x4400f4(0x343)], 0xa); _0x48417b(_0x380642); } } } try { const _0x5212b2 = await _0x53d2f8(_0x39e390); if (!_0x5212b2) return ![]; if (_0x52219f) try { let _0x4e3c57 = _0x5212b2[_0x4400f4(0x538)](); const _0x519bb0 = _0x4e3c57[_0x4400f4(0x5d3)](/(\[[\s\S]*\])/); _0x519bb0 && (_0x4e3c57 = _0x519bb0[0x1]); const _0x42a0da = JSON['parse'](_0x4e3c57); if (Array['isArray'](_0x42a0da)) { _0x79fbb7[_0x4400f4(0x64a)] = _0x42a0da, _0x79fbb7['characterLastScripts'][_0x713ff4['id']] = [..._0x42a0da], _0x3aa6ff(); const _0x1c1f3d = _0x42a0da[_0x4400f4(0x843)](_0x469f80 => _0x469f80[_0x4400f4(0x806)] === _0x4400f4(0x488) ? _0x469f80[_0x4400f4(0x844)] : _0x469f80[_0x4400f4(0x806)] + ':\x20' + _0x469f80[_0x4400f4(0x844)])[_0x4400f4(0x26c)]('\x0a\x0a'); _0x79fbb7['conversationHistory']['push']({ 'role': 'assistant', 'senderId': _0x713ff4['id'], 'timestamp': Date[_0x4400f4(0x86b)](), 'isOffline': !![], 'content': _0x1c1f3d }); } } catch (_0x14c05a) { console[_0x4400f4(0x412)](_0x4400f4(0x635), _0x14c05a, _0x4400f4(0x18f), _0x5212b2), _0x79fbb7[_0x4400f4(0x623)][_0x4400f4(0x7d8)]({ 'role': _0x4400f4(0x2ea), 'senderId': _0x713ff4['id'], 'timestamp': Date[_0x4400f4(0x86b)](), 'isOffline': !![], 'content': _0x4400f4(0x41f) + _0x5212b2 + ']' }); } else { const _0x2089b5 = _0x87f95(_0x5212b2), _0x2bc8a8 = _0x2089b5[_0x4400f4(0x843)](_0x839e35 => { const _0x1071b6 = _0x4400f4; if (_0x1071b6(0x4ac) !== _0x1071b6(0x1a0)) { const _0x8a32df = _0x839e35[_0x1071b6(0x538)](), _0x2bdc0d = _0x8a32df['match'](/^\[sticker:(.*?)\]$/), _0x2c6a20 = _0x8a32df[_0x1071b6(0x5d3)](/^\[transfer:([\d.]+)\|(.*?)\]$/), _0x3a34de = _0x8a32df[_0x1071b6(0x5d3)](/^\[music:(.*?)\|(.*?)\]$/); if (_0x3a34de) return { 'type': _0x1071b6(0x6fe), 'songName': _0x3a34de[0x1][_0x1071b6(0x538)](), 'artist': _0x3a34de[0x2][_0x1071b6(0x538)]() }; else { if (_0x2bdc0d) { if ('qyIqe' !== _0x1071b6(0x5bd)) _0x40c6d7[_0x1071b6(0x1a4)](); else return { 'type': _0x1071b6(0x57e), 'name': _0x2bdc0d[0x1]['trim']() }; } else { if (_0x2c6a20) { const _0x5c5574 = parseFloat(_0x2c6a20[0x1]), _0x1d52ed = _0x2c6a20[0x2][_0x1071b6(0x538)](), _0x2680de = _0x1cdea5(_0x79fbb7['activeChatId']); let _0x406124 = null; if (_0x1d52ed === _0x2680de[_0x1071b6(0x908)]) _0x406124 = _0x2680de['id']; else { if (_0x1071b6(0x8da) !== _0x1071b6(0x8da)) _0x254c2e = _0x1071b6(0x5ac) + _0x53216f[_0x1071b6(0x71c)] + _0x1071b6(0x616) + _0x347528['name'] + '</div><div\x20class=\x22review-text\x22\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x20line-height:\x201.5;\x22>' + _0x49501c[_0x1071b6(0x1e7)][_0x1071b6(0x6b3)] + _0x1071b6(0x729); else { const _0x1d1ada = _0x3f4d37(); if (_0x1d1ada['type'] === 'group') { if (_0x1071b6(0x491) === 'rFafF') { const _0x21af02 = _0x79fbb7[_0x1071b6(0x44f)][_0x1071b6(0x2aa)](_0x22886d => _0x1d1ada['participantIds'][_0x1071b6(0x5ad)](_0x22886d['id']) && _0x22886d[_0x1071b6(0x908)] === _0x1d52ed); if (_0x21af02) _0x406124 = _0x21af02['id']; } else { const _0x1cae8e = _0x1ab2cf['createElement'](_0x1071b6(0x8dc)); _0x1cae8e[_0x1071b6(0x1dc)] = _0x1071b6(0x6d6), _0x1cae8e['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-preview-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x44ceae[_0x1071b6(0x1d1)] || _0x287c94) + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>' + _0x47f0e6[_0x1071b6(0x31c)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22opacity:\x200.7;\x22>' + _0x10c7f7[_0x1071b6(0x160)] + _0x1071b6(0x6ee), _0x1cae8e[_0x1071b6(0x249)](_0x1071b6(0x88e))['onclick'] = () => _0x37e705(_0x1071b6(0x6fe)), _0x40622a['appendChild'](_0x1cae8e); } } } } if (_0x406124) return { 'type': _0x1071b6(0x186), 'amount': _0x5c5574, 'recipientId': _0x406124, 'senderId': _0x713ff4['id'] }; else return { 'type': 'text', 'content': _0x1071b6(0x36e) + _0x1d52ed + '”，但没找到人)' }; } else { if (_0x8a32df) return { 'type': _0x1071b6(0x6b3), 'content': _0x8a32df }; } } } return null; } else { _0x2f454b(_0x1071b6(0x659), _0x1071b6(0x8bf)); if (_0x288e0d) { const _0x5ee638 = _0x280b40['worldBooks'][_0x1071b6(0x2aa)](_0x4feffd => _0x4feffd['id'] === _0x5e02ea); if (!_0x5ee638) return; _0x253b6e[_0x1071b6(0x1f3)]('editing-world-book-id')[_0x1071b6(0x2ff)] = _0x5ee638['id'], _0x46462c[_0x1071b6(0x1f3)](_0x1071b6(0x428))[_0x1071b6(0x5f4)] = _0x1071b6(0x505), _0x44a384[_0x1071b6(0x1f3)](_0x1071b6(0x8ff))['value'] = _0x5ee638['name'], _0x5c28e3[_0x1071b6(0x1f3)](_0x1071b6(0x5a6))[_0x1071b6(0x2ff)] = _0x5ee638['content']; } else _0x574afa[_0x1071b6(0x1f3)](_0x1071b6(0x893))[_0x1071b6(0x2ff)] = '', _0x1ceb6f[_0x1071b6(0x1f3)](_0x1071b6(0x428))[_0x1071b6(0x5f4)] = '新建条目', _0x256ada['getElementById'](_0x1071b6(0x8ff))[_0x1071b6(0x2ff)] = '', _0x163168['getElementById']('world-book-edit-content')[_0x1071b6(0x2ff)] = ''; } })[_0x4400f4(0x6a6)](Boolean), _0x2e5677 = async _0x50ce82 => { const _0x4cc8b6 = _0x4400f4, _0x4d1348 = { 'role': 'assistant', 'senderId': _0x713ff4['id'], 'timestamp': Date[_0x4cc8b6(0x86b)](), 'isOffline': _0x52219f }; if (_0x50ce82['type'] === _0x4cc8b6(0x6fe)) { const { songName: _0x49127f, artist: _0x46cc50 } = _0x50ce82; _0x4d1348[_0x4cc8b6(0x1fb)] = _0x4cc8b6(0x6fe), _0x4d1348[_0x4cc8b6(0x317)] = _0x4cc8b6(0x850) + _0x49127f + '\x20-\x20' + _0x46cc50 + ']'; try { const _0x27d70b = await _0x314a48(_0x49127f, _0x46cc50); let _0x243ae4 = null; if (_0x27d70b[_0x4cc8b6(0x876)]) { if (_0x4cc8b6(0x472) !== _0x4cc8b6(0x2e6)) { const _0x918a58 = await _0x4f6af3(_0x27d70b[_0x4cc8b6(0x876)]); _0x243ae4 = _0x4cc8b6(0x4e8) + Date[_0x4cc8b6(0x86b)]() + '_' + Math[_0x4cc8b6(0x4dc)](), await _0x43bf1f(_0x243ae4, _0x918a58); } else { if (_0x358548) _0x321151[_0x4cc8b6(0x5f4)] = '▶'; } } Object[_0x4cc8b6(0x2db)](_0x4d1348, { 'songName': _0x49127f, 'artist': _0x46cc50, 'coverId': _0x243ae4, 'playableUrl': _0x27d70b[_0x4cc8b6(0x30d)] }); } catch (_0x12919d) { Object[_0x4cc8b6(0x2db)](_0x4d1348, { 'songName': _0x49127f, 'artist': _0x46cc50, 'coverId': null, 'playableUrl': null }); } } else { if (_0x50ce82[_0x4cc8b6(0x1fb)] === 'sticker') { const _0x5dd02f = _0x57edcf[_0x4cc8b6(0x2aa)](_0x2e7e26 => _0x2e7e26[_0x4cc8b6(0x908)] === _0x50ce82[_0x4cc8b6(0x908)]); if (_0x5dd02f) Object[_0x4cc8b6(0x2db)](_0x4d1348, { 'content': _0x4cc8b6(0x2c2) + _0x5dd02f[_0x4cc8b6(0x908)] + ']', 'displayUrl': _0x5dd02f[_0x4cc8b6(0x30d)] }); else _0x4d1348[_0x4cc8b6(0x317)] = _0x4cc8b6(0x4c4) + _0x50ce82[_0x4cc8b6(0x908)] + ']'; } else { if (_0x50ce82[_0x4cc8b6(0x1fb)] === 'transfer') { const _0x358ebd = _0x50ce82[_0x4cc8b6(0x71b)] === _0x1cdea5(_0x79fbb7[_0x4cc8b6(0x4d8)])['id'] ? _0x1cdea5(_0x79fbb7['activeChatId']) : _0x1249c2(_0x50ce82[_0x4cc8b6(0x71b)]); Object[_0x4cc8b6(0x2db)](_0x4d1348, { 'type': _0x4cc8b6(0x186), 'amount': _0x50ce82[_0x4cc8b6(0x1aa)], 'recipientId': _0x50ce82['recipientId'], 'content': _0x4cc8b6(0x72e) + (_0x358ebd?.[_0x4cc8b6(0x908)] || '未知') + '\x20转账\x20' + _0x50ce82['amount'] + ']' }); } else { const _0x5af201 = _0x5579bb(_0x50ce82[_0x4cc8b6(0x317)]); Object[_0x4cc8b6(0x2db)](_0x4d1348, { 'content': _0x5af201['content'], 'quotedMessage': _0x5af201[_0x4cc8b6(0x66b)] }); } } } return _0x4d1348; }, _0x261f89 = await Promise[_0x4400f4(0x433)](_0x2bc8a8['map'](_0x2e5677)); for (const _0x511bd3 of _0x261f89) { 'WISFR' === _0x4400f4(0x28c) ? (_0x3aa677['userProfiles'] = _0x2926d8[_0x4400f4(0x8d2)][_0x4400f4(0x6a6)](_0x122379 => _0x122379['id'] !== _0x42edbf), _0x1cfb21['activeUserProfileId'] === _0x3ea8a1 && (_0x128c3f[_0x4400f4(0x4dd)] = _0x5556cf['userProfiles'][0x0]['id']), _0x2faf1a[_0x4400f4(0x4c9)][_0x4400f4(0x8f0)](_0x3bbdbb => { const _0x38b91e = _0x4400f4; _0x3bbdbb[_0x38b91e(0x536)] === _0x3d5a17 && (_0x3bbdbb[_0x38b91e(0x536)] = _0x4ac7c3[_0x38b91e(0x4dd)]); }), _0x1b0982(), _0x54f986(_0x4400f4(0x17e)), _0x4d42ca(), _0x3c457c(_0x4400f4(0x7ca), _0x4400f4(0x1ab))) : (_0x511bd3[_0x4400f4(0x317)] || _0x511bd3[_0x4400f4(0x710)] || _0x511bd3['type'] === 'music') && (await new Promise(_0x38c240 => setTimeout(_0x38c240, 0x12c + Math['random']() * 0x190)), _0x79fbb7[_0x4400f4(0x623)][_0x4400f4(0x7d8)](_0x511bd3), _0x3e6176()); } } return _0x23a213(), _0x3e6176(), !![]; } catch (_0x54cd76) { if (_0x54cd76[_0x4400f4(0x908)] !== _0x4400f4(0x7e4)) { if (_0x4400f4(0x78a) !== 'eqAkP') { console[_0x4400f4(0x412)](_0x4400f4(0x8fa), _0x54cd76); const _0x320c2b = { 'role': _0x4400f4(0x2ea), 'content': _0x4400f4(0x8f6) + _0x54cd76[_0x4400f4(0x227)], 'senderId': _0x713ff4['id'], 'isOffline': _0x52219f }; _0x79fbb7[_0x4400f4(0x623)]['push'](_0x320c2b), _0x3e6176(); } else _0x4bfbe5(() => { const _0x92bbb8 = _0x4400f4; _0x41e12c[_0x92bbb8(0x144)] = _0x14ca83[_0x92bbb8(0x939)]; }, 0x0); } return ![]; } finally { _0x4400f4(0x820) !== 'gSvFD' ? (_0x8b98bc[_0x4400f4(0x74f)] = _0x5271ca, _0x129622 = !![]) : _0x11aff2(![]); } } } async function _0x47a19a() { const _0x5d313d = _0x2b3d5e, _0x50fdd4 = _0x3f4d37(); if (!_0x50fdd4 || _0x50fdd4['type'] !== 'private') { if (_0x5d313d(0x841) === _0x5d313d(0x841)) { _0x30a64e(_0x5d313d(0x923)); return; } else _0x2eb34c[_0x5d313d(0x249)](_0x5d313d(0x72f))[_0x5d313d(0x3dc)] = () => { _0x4acf35(_0x1e0f4d), _0x2c7120(); }; } if (_0x79fbb7['isGenerating']) { _0x30a64e(_0x5d313d(0x369)); return; } const _0x15ed38 = await _0x21bcbb(_0x5d313d(0x73d)); if (!_0x15ed38) return; _0x585d0a(!![], '正在翻阅全部历史记录...'), _0x50b6d5[_0x5d313d(0x2ff)] = '', _0x1049ba[_0x5d313d(0x43d)][_0x5d313d(0x20f)](_0x5d313d(0x920)), _0x79fbb7[_0x5d313d(0x8b0)] = !![]; try { const _0x4f3a97 = _0x1249c2(_0x50fdd4[_0x5d313d(0x285)][0x0]), _0x12ef5e = _0x1cdea5(_0x50fdd4['id']), _0x4e4eb1 = _0x18f837(_0x50fdd4['id']); if (_0x4e4eb1[_0x5d313d(0x629)] === 0x0) { if (_0x5d313d(0x119) === _0x5d313d(0x114)) { if (_0x5ec3dd) _0x554856(_0x27abcb); const _0x1bb64a = _0x42910d[_0x5d313d(0x381)]['closest'](_0x5d313d(0x278)); if (!_0x1bb64a) return; const _0x245b2e = _0x102a5a(_0x1bb64a['dataset']['historyIndex'], 0xa); if (_0x4eb6a3(_0x245b2e)) return; const _0x48f0d9 = () => { _0x57e910 = _0xcf1f88(() => { const _0x34b977 = _0x1507; if (_0x3d4e4c['type'] === _0x34b977(0x14e)) _0x26acd9[_0x34b977(0x490)](); _0x4e43b8(_0x245b2e); }, 0x320); }, _0x534066 = () => { if (_0x5b6d91) _0x1aff62(_0x12e155); }; _0x1b80a8['addEventListener']('mouseup', _0x534066, { 'once': !![] }), _0x487899[_0x5d313d(0x3eb)](_0x5d313d(0x41c), _0x534066, { 'once': !![] }), _0x8db7aa[_0x5d313d(0x3eb)](_0x5d313d(0x718), _0x534066, { 'once': !![] }), _0x134646['addEventListener'](_0x5d313d(0x2b8), _0x534066, { 'once': !![] }), _0x48f0d9(); } else { _0x50b6d5[_0x5d313d(0x2ff)] = _0x5d313d(0x834); return; } } const _0x124af2 = _0x4e4eb1['map'](_0x110a26 => { const _0x17229d = _0x5d313d, _0x301550 = new Date(_0x110a26[_0x17229d(0x68c)]), _0x4c8316 = _0x301550[_0x17229d(0x19a)]() + '-' + String(_0x301550['getMonth']() + 0x1)['padStart'](0x2, '0') + '-' + String(_0x301550['getDate']())[_0x17229d(0x643)](0x2, '0'), _0x408392 = String(_0x301550[_0x17229d(0x267)]())[_0x17229d(0x643)](0x2, '0') + ':' + String(_0x301550['getMinutes']())['padStart'](0x2, '0'); let _0x4454c2 = '未知'; _0x110a26[_0x17229d(0x5f2)] === 'user' ? _0x4454c2 = _0x12ef5e[_0x17229d(0x908)] : _0x4454c2 = _0x4f3a97[_0x17229d(0x908)]; let _0x3082bf = _0x110a26[_0x17229d(0x317)]; if (_0x110a26[_0x17229d(0x710)]) _0x3082bf = _0x17229d(0x689); if (_0x110a26['imageId']) _0x3082bf = _0x17229d(0x2de); return '[' + _0x4c8316 + '\x20' + _0x408392 + _0x17229d(0x1ef) + _0x4454c2 + _0x17229d(0x6fa) + _0x3082bf; })['join']('\x0a'), _0x592ac7 = _0x57e484[_0x5d313d(0x1c3)](/{charName}/g, _0x4f3a97[_0x5d313d(0x908)])[_0x5d313d(0x1c3)](/{userName}/g, _0x12ef5e[_0x5d313d(0x908)]), _0x1a07e4 = [{ 'role': _0x5d313d(0x35f), 'content': _0x592ac7 }, { 'role': _0x5d313d(0x721), 'content': _0x124af2 }], _0xfe3729 = await _0x53d2f8(_0x1a07e4); _0x50b6d5[_0x5d313d(0x2ff)] = _0xfe3729 || _0x5d313d(0x1de), _0x50b6d5[_0x5d313d(0x144)] = 0x0; } catch (_0x4ff4f0) { console[_0x5d313d(0x412)]('总结失败:', _0x4ff4f0), _0x50b6d5[_0x5d313d(0x2ff)] = '#\x20发生错误：\x0a' + _0x4ff4f0[_0x5d313d(0x227)]; } finally { _0x585d0a(![]), _0x79fbb7[_0x5d313d(0x8b0)] = ![]; } } async function _0x3346d1() { const _0x804f47 = _0x2b3d5e; if (_0x804f47(0x41d) !== _0x804f47(0x41d)) _0x4c0e64[_0x804f47(0x1f3)](_0x804f47(0x55e))[_0x804f47(0x1a4)](); else { console[_0x804f47(0x257)]('---\x20开始AI回复流程\x20---'); if (!_0x79fbb7['apiSettings']['endpoint'] || !_0x79fbb7[_0x804f47(0x164)][_0x804f47(0x251)] || !_0x79fbb7['apiSettings'][_0x804f47(0x1b1)]) { if ('fDtgl' !== _0x804f47(0x8f1)) { _0x30a64e(_0x804f47(0x42e)); return; } else _0x983e47['textContent'] = _0x56e6d7[_0x804f47(0x910)](_0x2226c2)[_0x804f47(0x843)](_0x31fad8 => _0x31fad8[_0x804f47(0x216)][_0x804f47(0x5f4)][_0x804f47(0x538)]())['join']('、'); } const _0x247ee8 = _0x79fbb7[_0x804f47(0x623)]['at'](-0x1)?.[_0x804f47(0x5f2)] === _0x804f47(0x721); if (!_0x247ee8 || _0x79fbb7['isGenerating']) return; const _0x2a65fb = _0x3f4d37(); if (!_0x2a65fb) return; _0x79fbb7[_0x804f47(0x8b0)] = !![], _0x11aff2(!![]); try { if (_0x2a65fb[_0x804f47(0x1fb)] === _0x804f47(0x91f)) { if (_0x804f47(0x574) === 'MQhDI') { _0x483555(_0x804f47(0x866)); return; } else { const _0x36b282 = _0x1249c2(_0x2a65fb[_0x804f47(0x285)][0x0]); console[_0x804f47(0x257)](_0x804f47(0x82b)); if (_0x36b282) await _0x1891a3(_0x36b282, { 'force': !![] }); } } else { const _0x35a731 = await _0x4e7fd5(); if (_0x35a731 && _0x35a731[_0x804f47(0x61e)]?.['length']) await _0x164605(_0x35a731); else { console[_0x804f47(0x3c7)](_0x804f47(0x5a9)); const _0xa8ab5a = _0x2a65fb[_0x804f47(0x285)][_0x804f47(0x843)](_0x1249c2)['filter'](Boolean); if (!_0xa8ab5a[_0x804f47(0x629)]) return; let _0x59bb11 = 0x0; for (const _0x583ddb of _0xa8ab5a) { if ('lKfKT' === _0x804f47(0x19b)) _0x1891a3(_0x583ddb, { 'force': !![], 'delayMs': _0x59bb11 }), _0x59bb11 += 0x1f4; else { _0x2656d9[_0x804f47(0x2ff)] = '', _0x417542[_0x804f47(0x2f7)] = ''; if (_0x26f78c[_0x804f47(0x44f)][_0x804f47(0x629)] < 0x2) { _0x1d3970(_0x804f47(0x334)); return; } _0x3ced5a[_0x804f47(0x44f)][_0x804f47(0x8f0)](_0x4dbf76 => { const _0x136a4b = _0x804f47, _0x15131c = _0x247dce['createElement']('li'); _0x15131c['className'] = _0x136a4b(0x206), _0x15131c['innerHTML'] = _0x136a4b(0x262) + _0x4dbf76['id'] + _0x136a4b(0x36c) + _0x4dbf76['id'] + _0x136a4b(0x5e8) + (_0x4dbf76[_0x136a4b(0x71c)] || _0x340c6f) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-' + _0x4dbf76['id'] + _0x136a4b(0x6c7) + _0x4dbf76[_0x136a4b(0x908)] + _0x136a4b(0x5b8), _0x135de0[_0x136a4b(0x7b9)](_0x15131c); }), _0x2a1927(_0x804f47(0x64d), 'charSelect'); } } } } } catch (_0x3fb5a0) { if (_0x3fb5a0['name'] !== _0x804f47(0x7e4)) { if (_0x804f47(0x50a) !== 'CtXgR') console[_0x804f47(0x412)](_0x804f47(0x5fe), _0x3fb5a0), _0x55141a({ 'role': 'assistant', 'content': _0x804f47(0x8f6) + _0x3fb5a0[_0x804f47(0x227)] }, _0x79fbb7['conversationHistory'][_0x804f47(0x629)] - 0x1); else { if (_0x2c44b5) { const _0x40060d = _0x2dea38(_0x1a8452[_0x804f47(0x112)]); _0x40060d && (delete _0x40060d[_0x804f47(0x320)], _0x548b53(), _0x48f877(_0x40060d['id'], 'normal'), _0x3c1522(_0x804f47(0x72d)), _0xca0291(!![])); } } } } finally { _0x79fbb7[_0x804f47(0x8b0)] = ![], _0x11aff2(![]); } } } function _0x5927f4(_0x5035af, _0x261e11) { const _0x33cabe = _0x2b3d5e, _0x4862fe = _0x261e11['toLowerCase'](), _0x38b7eb = _0x5035af[_0x33cabe(0x80c)](); if (_0x4862fe[_0x33cabe(0x55c)](_0x33cabe(0x2ab))) return _0x33cabe(0x2d7); if (_0x38b7eb[_0x33cabe(0x5ad)](_0x33cabe(0x669))) return _0x33cabe(0x2d7); if (_0x38b7eb[_0x33cabe(0x5ad)](_0x33cabe(0x252))) return _0x33cabe(0x20d); if (_0x4862fe['startsWith'](_0x33cabe(0x20d))) return _0x33cabe(0x20d); return _0x33cabe(0x845); } async function _0x53d2f8(_0x327913, _0x580a6e = {}) { const _0x5cb9bf = _0x2b3d5e; if (_0x79fbb7[_0x5cb9bf(0x557)]) { if ('qwwce' === _0x5cb9bf(0x6e5)) { const { omniText: _0x2078b3 } = _0x48d749(_0x85f3e0['id'], null), _0x17ccaf = _0x15cce8(_0xa98c37['id']), _0x15efc7 = _0x12b9e2[_0x5cb9bf(0x444)] && _0x5cece1[_0x5cb9bf(0x444)][_0x5cb9bf(0x629)] > 0x0 ? _0x5cb9bf(0x611) + _0x24a3d5[_0x5cb9bf(0x908)] + _0x5cb9bf(0x4a3) + _0x4c2c2b[_0x5cb9bf(0x444)][_0x5cb9bf(0x843)](_0x36a382 => _0x27c072['worldBooks']['find'](_0x55183b => _0x55183b['id'] === _0x36a382))[_0x5cb9bf(0x6a6)](_0x2fd03d)[_0x5cb9bf(0x843)](_0x587864 => _0x5cb9bf(0x27f) + _0x587864['name'] + '\x0a' + _0x587864[_0x5cb9bf(0x317)])['join']('') : ''; return _0x5cb9bf(0x5a3) + _0x310fb1['name'] + _0x5cb9bf(0x4ab) + _0x21b386['id'] + _0x5cb9bf(0x468) + _0x58f617[_0x5cb9bf(0x6dc)] + _0x5cb9bf(0x4b1) + _0x2078b3 + '\x0a' + _0x17ccaf + '\x0a' + _0x15efc7; } else _0x79fbb7[_0x5cb9bf(0x557)]['abort']('New\x20request\x20started'); } _0x79fbb7[_0x5cb9bf(0x557)] = new AbortController(); const _0x149c61 = _0x79fbb7[_0x5cb9bf(0x557)][_0x5cb9bf(0x3b5)], { endpoint: _0x400972, key: _0xc9952e, model: _0x31730f } = _0x79fbb7[_0x5cb9bf(0x164)], _0x25d6bf = !!_0x580a6e[_0x5cb9bf(0x1b0)], _0x6a21ec = _0x5927f4(_0x400972, _0x31730f); console[_0x5cb9bf(0x257)](_0x5cb9bf(0x10f) + _0x6a21ec); let _0x5a9d26 = ''; try { if ('ODBvd' !== _0x5cb9bf(0x404)) _0x3e86e4[_0x5cb9bf(0x412)]('加载见面背景失败\x20for\x20' + _0x140f3c + ':', _0x4688e9), _0x374aec[_0x5cb9bf(0x324)]['backgroundImage'] = _0x5cb9bf(0x277); else { switch (_0x6a21ec) { case _0x5cb9bf(0x2d7): { const _0x32d27c = _0xa58d56(_0xc9952e), _0x95b7c2 = _0x327913[_0x5cb9bf(0x2aa)](_0x56a18f => _0x56a18f[_0x5cb9bf(0x5f2)] === _0x5cb9bf(0x35f))?.[_0x5cb9bf(0x317)] || '', _0x3b39be = _0x327913[_0x5cb9bf(0x6a6)](_0x2430e8 => _0x2430e8[_0x5cb9bf(0x5f2)] !== 'system'), _0x2c71cc = { 'model': _0x31730f, 'system': _0x95b7c2, 'messages': _0x3b39be['map'](_0x2b1c93 => ({ 'role': _0x2b1c93[_0x5cb9bf(0x5f2)], 'content': [{ 'type': 'text', 'text': _0x2b1c93['content'] }] })), 'max_tokens': 0x1000 }, _0x43b2ff = await fetch(_0x400972, { 'method': _0x5cb9bf(0x81e), 'headers': { 'Content-Type': _0x5cb9bf(0x8c7), 'x-api-key': _0x32d27c, 'anthropic-version': '2023-06-01' }, 'body': JSON[_0x5cb9bf(0x4de)](_0x2c71cc), 'signal': _0x149c61 }); if (!_0x43b2ff['ok']) { const _0x3a2328 = await _0x43b2ff[_0x5cb9bf(0x1b0)]()[_0x5cb9bf(0x222)](() => ({})); throw new Error('Claude\x20API\x20错误:\x20' + _0x43b2ff[_0x5cb9bf(0x3a3)] + _0x5cb9bf(0x61f) + (_0x3a2328[_0x5cb9bf(0x412)]?.['message'] || _0x43b2ff[_0x5cb9bf(0x3d0)])); } const _0x77a732 = await _0x43b2ff['json'](); _0x5a9d26 = _0x77a732[_0x5cb9bf(0x317)]?.[0x0]?.[_0x5cb9bf(0x6b3)] || ''; break; } case _0x5cb9bf(0x20d): { const _0x5a5da6 = _0xa58d56(_0xc9952e), _0x5effa5 = _0x400972[_0x5cb9bf(0x5ad)](_0x5cb9bf(0x8ac)), _0x23419a = _0x2691ef => { const _0x1ab15a = _0x5cb9bf, _0x36fe0f = []; if (_0x2691ef[_0x1ab15a(0x317)]) _0x36fe0f[_0x1ab15a(0x7d8)]({ 'text': _0x2691ef[_0x1ab15a(0x317)] }); if (_0x2691ef['image']) { if (_0x1ab15a(0x4a5) === 'BOQww') { const _0x11189b = _0x5946bc[_0x1ab15a(0x4f6)](_0x302ca9); _0xe64a55['isArray'](_0x11189b) ? _0x491e8f = [..._0x370703, ..._0x11189b] : _0x1618e6 = _0xac14a9; } else { const _0x1d3afe = _0x2691ef['image'][_0x1ab15a(0x1ae)](',')[0x1], _0x54b7bf = _0x2691ef[_0x1ab15a(0x74f)][_0x1ab15a(0x524)](_0x2691ef['image'][_0x1ab15a(0x4e4)](':') + 0x1, _0x2691ef[_0x1ab15a(0x74f)]['indexOf'](';')) || _0x1ab15a(0x813); _0x36fe0f[_0x1ab15a(0x7d8)]({ 'inline_data': { 'mime_type': _0x54b7bf, 'data': _0x1d3afe } }); } } return _0x36fe0f; }, _0x4ffa32 = _0x327913['map'](_0x5b48be => ({ 'role': _0x5b48be[_0x5cb9bf(0x5f2)] === _0x5cb9bf(0x2ea) ? 'model' : _0x5b48be['role'] === _0x5cb9bf(0x35f) ? _0x5cb9bf(0x721) : _0x5b48be[_0x5cb9bf(0x5f2)], 'parts': _0x23419a(_0x5b48be) }))['filter'](_0x232958 => _0x232958[_0x5cb9bf(0x6d7)]['length'] > 0x0), _0x1f4181 = { 'contents': _0x4ffa32 }; _0x25d6bf && _0x5effa5 && (_0x1f4181[_0x5cb9bf(0x494)] = { 'response_mime_type': 'application/json' }); const _0x1ee161 = _0x400972 + _0x5cb9bf(0x614) + _0x31730f + _0x5cb9bf(0x730) + _0x5a5da6 + '&alt=sse', _0x1d78c0 = await fetch(_0x1ee161, { 'method': _0x5cb9bf(0x81e), 'headers': { 'Content-Type': _0x5cb9bf(0x8c7) }, 'body': JSON[_0x5cb9bf(0x4de)](_0x1f4181), 'signal': _0x149c61 }); if (!_0x1d78c0['ok']) throw new Error('Gemini\x20API\x20Error:\x20' + _0x1d78c0[_0x5cb9bf(0x3a3)]); const _0x1441be = _0x1d78c0[_0x5cb9bf(0x7f1)][_0x5cb9bf(0x63c)](), _0xe35143 = new TextDecoder(); let _0x3f5528 = ''; while (!![]) { if (_0x5cb9bf(0x5a2) !== 'wEwNA') { if (_0x149c61['aborted']) { console[_0x5cb9bf(0x257)](_0x5cb9bf(0x6dd)), _0x1441be[_0x5cb9bf(0x528)](); break; } const { done: _0x5495a8, value: _0x15042d } = await _0x1441be[_0x5cb9bf(0x608)](); if (_0x5495a8) break; const _0x4492e6 = _0xe35143[_0x5cb9bf(0x62a)](_0x15042d, { 'stream': !![] }), _0x1ac991 = _0x4492e6[_0x5cb9bf(0x1ae)]('\x0a')[_0x5cb9bf(0x6a6)](_0x60d2ea => _0x60d2ea[_0x5cb9bf(0x538)]()[_0x5cb9bf(0x55c)]('data:')); for (const _0x2c6cde of _0x1ac991) { const _0x382a45 = _0x2c6cde[_0x5cb9bf(0x1c3)](_0x5cb9bf(0x80a), ''); if (_0x382a45 === _0x5cb9bf(0x71a)) break; try { _0x5cb9bf(0x166) === _0x5cb9bf(0x166) ? _0x3f5528 += JSON['parse'](_0x382a45)[_0x5cb9bf(0x4f4)][0x0][_0x5cb9bf(0x317)][_0x5cb9bf(0x6d7)][0x0][_0x5cb9bf(0x6b3)] : _0x5eaebc[_0x5cb9bf(0x7d8)]({ 'name': _0x43496e[0x0]['trim'](), 'url': _0x5e08ac[0x1][_0x5cb9bf(0x538)]() }); } catch { } } } else _0x577501[_0x5cb9bf(0x412)](_0x5cb9bf(0x531), _0x4150a7); } _0x5a9d26 = _0x3f5528; break; } case _0x5cb9bf(0x845): default: { const _0x2d3dc0 = _0xa58d56(_0xc9952e), _0x1ff8d7 = _0x400972[_0x5cb9bf(0x1c3)](/\/+$/, '') + _0x5cb9bf(0x605), _0xe37a1d = _0x327913['map'](_0x4a493c => { const _0x319f3a = _0x5cb9bf; if (_0x4a493c[_0x319f3a(0x5f2)] === _0x319f3a(0x721) && _0x4a493c[_0x319f3a(0x74f)]) return { 'role': _0x319f3a(0x721), 'content': [{ 'type': _0x319f3a(0x6b3), 'text': _0x4a493c['content'] || '\x20' }, { 'type': 'image_url', 'image_url': { 'url': _0x4a493c['image'], 'detail': _0x319f3a(0x32d) } }] }; return { 'role': _0x4a493c[_0x319f3a(0x5f2)], 'content': _0x4a493c[_0x319f3a(0x317)] }; })[_0x5cb9bf(0x6a6)](_0x14f9a6 => _0x14f9a6[_0x5cb9bf(0x317)]), _0x28cc0e = { 'model': _0x31730f, 'messages': _0xe37a1d, 'max_tokens': 0x1000, ..._0x25d6bf ? { 'response_format': { 'type': 'json_object' } } : {} }, _0x496721 = await fetch(_0x1ff8d7, { 'method': 'POST', 'headers': { 'Content-Type': _0x5cb9bf(0x8c7), 'Authorization': _0x5cb9bf(0x5cb) + _0x2d3dc0 }, 'body': JSON[_0x5cb9bf(0x4de)](_0x28cc0e), 'signal': _0x149c61 }); if (!_0x496721['ok']) { const _0x52d4f2 = await _0x496721[_0x5cb9bf(0x1b0)]()[_0x5cb9bf(0x222)](() => ({})); throw new Error(_0x5cb9bf(0x70d) + _0x496721['status'] + _0x5cb9bf(0x61f) + (_0x52d4f2[_0x5cb9bf(0x412)]?.[_0x5cb9bf(0x227)] || _0x496721[_0x5cb9bf(0x3d0)])); } const _0x555731 = await _0x496721[_0x5cb9bf(0x1b0)](); _0x5a9d26 = _0x555731[_0x5cb9bf(0x638)]?.[0x0]?.['message']?.['content'] || ''; break; } }return _0x5a9d26; } } catch (_0x52b334) { if (_0x52b334[_0x5cb9bf(0x908)] === _0x5cb9bf(0x7e4)) return console[_0x5cb9bf(0x257)](_0x5cb9bf(0x4cb)), ''; throw _0x52b334; } finally { if (_0x79fbb7[_0x5cb9bf(0x557)] && _0x79fbb7['currentAbortController'][_0x5cb9bf(0x3b5)] === _0x149c61) { if (_0x5cb9bf(0x30f) !== _0x5cb9bf(0x30f)) { const _0x181083 = _0x188436[_0x5cb9bf(0x4f8)](_0x5cb9bf(0x8dc)); _0x181083[_0x5cb9bf(0x1dc)] = _0x5cb9bf(0x12a), _0x181083[_0x5cb9bf(0x2f7)] = '<span\x20class=\x22description\x22>' + _0x7c1ce1[_0x5cb9bf(0x475)] + _0x5cb9bf(0x359) + _0x13b07f[_0x5cb9bf(0x1aa)][_0x5cb9bf(0x145)](0x2) + '</span><button\x20class=\x22delete-expense-btn\x22\x20data-id=\x22' + _0x50822a['id'] + _0x5cb9bf(0x879), _0x1f4a2c[_0x5cb9bf(0x7b9)](_0x181083); } else _0x79fbb7[_0x5cb9bf(0x557)] = null; } } } async function _0x34bc04() { const _0x5da31f = _0x2b3d5e, _0x5ccb95 = _0x59c481['characterEdit'][_0x5da31f(0x43d)][_0x5da31f(0x545)](_0x5da31f(0x4a8)), _0x1fae92 = _0x5ccb95 ? _0x4015c3[_0x5da31f(0x2ff)] : null; let _0x2d0270 = null, _0x17f654 = ''; if (_0x5ccb95 && _0x1fae92) { _0x2d0270 = _0x79fbb7[_0x5da31f(0x4c9)][_0x5da31f(0x2aa)](_0x63ab71 => _0x63ab71['type'] === _0x5da31f(0x91f) && _0x63ab71[_0x5da31f(0x285)][_0x5da31f(0x5ad)](_0x1fae92)); const _0x403e73 = _0x1249c2(_0x1fae92); _0x17f654 = _0x403e73 ? _0x403e73['name'] : _0x5da31f(0x501); } else { if (_0x79fbb7[_0x5da31f(0x4d8)]) { if (_0x5da31f(0x799) !== _0x5da31f(0x270)) { _0x2d0270 = _0x3f4d37(); const _0x2aef3b = document[_0x5da31f(0x1f3)](_0x5da31f(0x152))[_0x5da31f(0x5f4)]; _0x17f654 = _0x2aef3b || _0x5da31f(0x75e); } else _0x2e3740[_0x201f2c][_0x5da31f(0x43d)][_0x5da31f(0x20f)](_0x5da31f(0x4a8)); } } if (!_0x2d0270) { _0x30a64e('找不到要清空的聊天记录。'); return; } const _0x2cf596 = await _0x21bcbb(_0x5da31f(0x38d) + _0x17f654 + '\x22\x20的聊天记录吗？此操作不可撤销。'); if (!_0x2cf596) return; _0x2d0270['id'] === _0x79fbb7['activeChatId'] && (_0x5da31f(0x18d) !== 'PDsRE' ? _0x435ed8['src'] = _0x3bb55e[_0x5da31f(0x4af)](_0x350a32) : (_0xcd627f(), _0x79fbb7['conversationHistory'] = [], _0xd4cd2d())); try { localStorage[_0x5da31f(0x847)]('chatHistory_' + _0x2d0270['id']); } catch (_0x41fd0d) { console[_0x5da31f(0x412)](_0x5da31f(0x208) + _0x2d0270['id'], _0x41fd0d); } _0x30a64e('\x22' + _0x17f654 + '\x22\x20的聊天记录已清空。'); } const _0x5681ea = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x7f8)), _0x1bc5be = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x8b1)), _0x1784a2 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x5bf)); _0x5681ea[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), async () => { const _0x27963c = _0x2b3d5e; _0x585d0a(!![], _0x27963c(0x758)); const _0x2ab600 = []; try { if (_0x27963c(0x280) !== _0x27963c(0x498)) { const _0x3f66e1 = { 'localStorageData': {}, 'indexedDBData': {}, 'indexedDBMusicData': [] }; for (let _0x13a27c = 0x0; _0x13a27c < localStorage[_0x27963c(0x629)]; _0x13a27c++) { const _0x24d960 = localStorage[_0x27963c(0x251)](_0x13a27c); if (_0x24d960) _0x3f66e1[_0x27963c(0x10c)][_0x24d960] = localStorage['getItem'](_0x24d960); } const _0x400622 = await _0x5a91f8, _0x2fe778 = _0x400622['transaction'](_0x4961ea, _0x27963c(0x724)), _0x5cd6d9 = _0x2fe778['objectStore'](_0x4961ea), _0x518fc1 = await new Promise((_0x47013f, _0x47e125) => { const _0x53175f = _0x27963c, _0x4dc020 = _0x5cd6d9[_0x53175f(0x3b6)](); _0x4dc020[_0x53175f(0x7eb)] = () => _0x47013f(_0x4dc020[_0x53175f(0x6e4)]), _0x4dc020[_0x53175f(0x7d0)] = () => _0x47e125(_0x4dc020[_0x53175f(0x412)]); }); for (const _0x28e7e3 of _0x518fc1) { if (_0x27963c(0x3c9) !== _0x27963c(0x3c9)) { if (_0x15e47b < 0x0 || _0x2a4a54 >= _0x2a40df[_0x27963c(0x629)]) return; _0x59a19c = _0x3d2c59; const _0x3d0be2 = _0x5de102[_0x1b077c]; _0x71798f['src'] = _0x3d0be2[_0x27963c(0x8b7)] || _0x3d0be2[_0x27963c(0x30d)], _0x5942b2[_0x27963c(0x7e9)](), _0x15e50c(), _0x29619c(); } else { if (_0x28e7e3[_0x27963c(0x29c)] instanceof Blob) try { if (_0x27963c(0x825) === _0x27963c(0x825)) _0x3f66e1[_0x27963c(0x685)][_0x28e7e3['id']] = await _0x3b4f2c(_0x28e7e3[_0x27963c(0x29c)]); else { const _0x59c006 = _0xf92fd5(_0x1a82fe[0x1]), _0x4af851 = _0x3c2dab[0x2][_0x27963c(0x538)](), _0x5f5a84 = _0x33eafc(_0x26dd61[_0x27963c(0x4d8)]); let _0x4ddb9f = null; if (_0x4af851 === _0x5f5a84['name']) _0x4ddb9f = _0x5f5a84['id']; else { const _0x372f3b = _0x4ca0b7(); if (_0x372f3b[_0x27963c(0x1fb)] === _0x27963c(0x680)) { const _0x276a73 = _0x245ca6['characters']['find'](_0x41af43 => _0x372f3b[_0x27963c(0x285)]['includes'](_0x41af43['id']) && _0x41af43[_0x27963c(0x908)] === _0x4af851); if (_0x276a73) _0x4ddb9f = _0x276a73['id']; } } if (_0x4ddb9f) return { 'type': 'transfer', 'amount': _0x59c006, 'recipientId': _0x4ddb9f, 'senderId': _0x5b2d27['id'] }; else return { 'type': _0x27963c(0x6b3), 'content': '(想转账给“' + _0x4af851 + _0x27963c(0x4e2) }; } } catch (_0x49995d) { _0x27963c(0x781) === _0x27963c(0x781) ? _0x2ab600['push'](_0x28e7e3['id']) : _0x1fc614[_0x27963c(0x412)](_0x27963c(0x912) + _0x40fdca + ':', _0x54677b); } } } const _0x21f221 = _0x400622[_0x27963c(0x207)](_0x45e9d1, _0x27963c(0x724)), _0x3b662e = _0x21f221['objectStore'](_0x45e9d1), _0x191536 = await new Promise((_0x144b48, _0x343842) => { const _0x2147c8 = _0x27963c, _0x2b547e = _0x3b662e[_0x2147c8(0x3b6)](); _0x2b547e[_0x2147c8(0x7eb)] = () => _0x144b48(_0x2b547e[_0x2147c8(0x6e4)]), _0x2b547e[_0x2147c8(0x7d0)] = () => _0x343842(_0x2b547e['error']); }); for (const _0x211d5a of _0x191536) { const _0x47ccbf = { ..._0x211d5a }; _0x211d5a[_0x27963c(0x121)] instanceof Blob && (_0x47ccbf[_0x27963c(0x121)] = await _0x3b4f2c(_0x211d5a[_0x27963c(0x121)])), _0x211d5a[_0x27963c(0x876)] instanceof Blob && (_0x47ccbf[_0x27963c(0x876)] = await _0x3b4f2c(_0x211d5a[_0x27963c(0x876)])), _0x3f66e1[_0x27963c(0x8a9)]['push'](_0x47ccbf); } const _0x3287d9 = new Blob([JSON['stringify'](_0x3f66e1, null, 0x2)], { 'type': _0x27963c(0x8c7) }), _0x275c30 = URL['createObjectURL'](_0x3287d9), _0x33dce3 = document[_0x27963c(0x4f8)]('a'), _0xeb7d45 = new Date(), _0x28fafa = _0xeb7d45[_0x27963c(0x19a)]() + '-' + String(_0xeb7d45[_0x27963c(0x90b)]() + 0x1)[_0x27963c(0x643)](0x2, '0') + '-' + String(_0xeb7d45[_0x27963c(0x5d5)]())[_0x27963c(0x643)](0x2, '0'); _0x33dce3[_0x27963c(0x582)] = _0x275c30, _0x33dce3[_0x27963c(0x2fc)] = 'Noir_Backup_' + _0x28fafa + _0x27963c(0x89b), document[_0x27963c(0x7f1)][_0x27963c(0x7b9)](_0x33dce3), _0x33dce3[_0x27963c(0x1a4)](), document[_0x27963c(0x7f1)]['removeChild'](_0x33dce3), URL[_0x27963c(0x1d7)](_0x275c30), _0x585d0a(![]), _0x2ab600[_0x27963c(0x629)] > 0x0 ? _0x30a64e(_0x27963c(0x6ae) + _0x2ab600[_0x27963c(0x26c)]('\x0a')) : _0x30a64e('包含所有图片和音乐的全量数据已成功导出！'); } else _0x2ea664[_0x3f0082]['addEventListener'](_0x27963c(0x1a4), () => _0x401ab3[_0x53805a][_0x27963c(0x1a4)]()), _0x2851b0[_0x3d6678][_0x27963c(0x3eb)]('change', _0x2c2268 => { const _0x2a1b9b = _0x27963c; _0xab70ea(_0x3b54f4, _0x2c2268[_0x2a1b9b(0x381)]['files'][0x0]); }); } catch (_0x58e035) { _0x585d0a(![]), console[_0x27963c(0x412)]('全量导出失败:', _0x58e035), _0x30a64e(_0x27963c(0x4c5) + _0x58e035['message']); } }), _0x1bc5be[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0x63e33c = _0x2b3d5e; _0x63e33c(0x48d) === 'YnEyl' ? _0x1784a2[_0x63e33c(0x1a4)]() : _0x2b12ee(_0x1a2001[_0x63e33c(0x697)])[_0x63e33c(0x2cd)](_0x3079dd => { const _0x5a848e = _0x63e33c, _0x525e17 = _0x1d71b6[_0x5a848e(0x1f3)](_0x3c80a2); if (_0x525e17 && _0x3079dd) _0x525e17[_0x5a848e(0x465)] = _0x51eb82[_0x5a848e(0x4af)](_0x3079dd); }); }), _0xe58dc1[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x14ce59), _0x1784a2['addEventListener']('change', _0x30b2c7 => { const _0x186a5f = _0x2b3d5e; if (_0x186a5f(0x351) !== _0x186a5f(0x792)) { const _0x1179f9 = _0x30b2c7[_0x186a5f(0x381)][_0x186a5f(0x5b7)][0x0]; if (!_0x1179f9) return; _0x21bcbb(_0x186a5f(0x7fd))[_0x186a5f(0x2cd)](_0x136ba2 => { const _0x55d74b = _0x186a5f; if (_0x55d74b(0x864) === _0x55d74b(0x48a)) { _0x32b8a0[_0x55d74b(0x257)](_0x55d74b(0x678)); const _0x2831b6 = { 'id': 'user_' + _0x53085b[_0x55d74b(0x86b)](), 'name': _0x37f273['userProfile']['name'] || '我', 'avatar': _0x15e020[_0x55d74b(0x1ab)][_0x55d74b(0x71c)] || _0x465555, 'persona': _0x190448[_0x55d74b(0x1ab)][_0x55d74b(0x6dc)] || '' }; _0x6fc729['userProfiles'] = [_0x2831b6], _0x4ff3fa['activeUserProfileId'] = _0x2831b6['id']; } else { if (!_0x136ba2) { _0x1784a2['value'] = ''; return; } _0x585d0a(!![], _0x55d74b(0x640)); const _0x28c72e = new FileReader(); _0x28c72e[_0x55d74b(0x3fc)] = async _0x2f80f1 => { const _0x34131e = _0x55d74b; try { const _0x255bd9 = JSON[_0x34131e(0x4f6)](_0x2f80f1[_0x34131e(0x381)][_0x34131e(0x6e4)]); if (!_0x255bd9[_0x34131e(0x10c)] || !_0x255bd9[_0x34131e(0x685)]) { if (_0x34131e(0x240) === 'JYqhy') { const _0x22372e = _0xf7659a[_0x34131e(0x1f3)](_0x34131e(0x8c8)), _0x3b4194 = _0x120fa4[_0x34131e(0x1f3)](_0x34131e(0x3e7)), _0x51fc38 = new _0x391e1e(), _0x17332a = _0x38476f[_0x34131e(0x3b2)][_0x34131e(0x6a6)](_0x10f30e => new _0x3d7f54(_0x10f30e[_0x34131e(0x68c)])[_0x34131e(0x867)]() === _0x51fc38[_0x34131e(0x867)]()); if (_0x17332a[_0x34131e(0x629)] === 0x0) { _0x22372e[_0x34131e(0x2f7)] = _0x34131e(0x619), _0x3b4194[_0x34131e(0x2f7)] = ''; return; } _0x22372e[_0x34131e(0x2f7)] = '', _0x17332a['sort']((_0xb49dc6, _0x30f6a4) => _0x30f6a4['timestamp'] - _0xb49dc6[_0x34131e(0x68c)])[_0x34131e(0x8f0)](_0x31c228 => { const _0x3d2d0f = _0x34131e, _0x269635 = _0x385157[_0x3d2d0f(0x4f8)]('div'); _0x269635[_0x3d2d0f(0x1dc)] = _0x3d2d0f(0x12a), _0x269635[_0x3d2d0f(0x2f7)] = _0x3d2d0f(0x17d) + _0x31c228['description'] + _0x3d2d0f(0x359) + _0x31c228[_0x3d2d0f(0x1aa)][_0x3d2d0f(0x145)](0x2) + _0x3d2d0f(0x244) + _0x31c228['id'] + _0x3d2d0f(0x879), _0x22372e[_0x3d2d0f(0x7b9)](_0x269635); }), _0x3b4194 && (_0x3b4194['innerHTML'] = _0x34131e(0x1cd), _0x5eed08['getElementById'](_0x34131e(0x4fa))['addEventListener'](_0x34131e(0x1a4), _0x289544)); } else throw new Error(_0x34131e(0x764)); } _0x585d0a(!![], _0x34131e(0x24d)); const _0x2dd100 = await Promise[_0x34131e(0x433)](Object[_0x34131e(0x2d2)](_0x255bd9['indexedDBData'])['map'](async _0x4ba5d4 => { const _0x1a65f3 = _0x34131e; if ('TJiiR' === _0x1a65f3(0x784)) { const _0x2baf56 = _0x255bd9[_0x1a65f3(0x685)][_0x4ba5d4]; if (typeof _0x2baf56 === _0x1a65f3(0x873) && _0x2baf56[_0x1a65f3(0x55c)](_0x1a65f3(0x388))) { const _0x548d4d = await _0x4f6af3(_0x2baf56); return { 'id': _0x4ba5d4, 'blob': _0x548d4d }; } return null; } else _0x3c538a[_0x1a65f3(0x324)][_0x1a65f3(0x6c0)] = _0x1a65f3(0x3f2), _0x14ccc2[_0x1a65f3(0x324)][_0x1a65f3(0x13c)] = 'none'; }))[_0x34131e(0x2cd)](_0x103b19 => _0x103b19[_0x34131e(0x6a6)](Boolean)), _0x4168a8 = []; if (_0x255bd9['indexedDBMusicData']) { _0x585d0a(!![], _0x34131e(0x894)); const _0x3e8f5b = _0x255bd9[_0x34131e(0x8a9)][_0x34131e(0x843)](async _0x2769b2 => { const _0x5b2803 = _0x34131e, _0x2c5df5 = { ..._0x2769b2 }; if (_0x2769b2[_0x5b2803(0x121)]) _0x2c5df5['audio'] = await _0x4f6af3(_0x2769b2[_0x5b2803(0x121)]); if (_0x2769b2[_0x5b2803(0x876)]) _0x2c5df5[_0x5b2803(0x876)] = await _0x4f6af3(_0x2769b2['cover']); return _0x2c5df5; }); _0x4168a8['push'](...await Promise[_0x34131e(0x433)](_0x3e8f5b)); } _0x585d0a(!![], _0x34131e(0x232)), localStorage['clear'](); for (const _0xbb8503 in _0x255bd9[_0x34131e(0x10c)]) { _0x34131e(0x27b) !== _0x34131e(0x4b6) ? localStorage['setItem'](_0xbb8503, _0x255bd9[_0x34131e(0x10c)][_0xbb8503]) : _0x28a617(); } _0x585d0a(!![], _0x34131e(0x88d)); const _0x11fbc6 = await _0x5a91f8, _0x534db1 = _0x11fbc6['transaction']([_0x4961ea, _0x45e9d1], _0x34131e(0x6b1)), _0x1c89b0 = _0x534db1[_0x34131e(0x8a5)](_0x4961ea), _0x37d73d = _0x534db1[_0x34131e(0x8a5)](_0x45e9d1); _0x1c89b0[_0x34131e(0x934)](), _0x37d73d[_0x34131e(0x934)](), _0x2dd100[_0x34131e(0x8f0)](_0x496eb3 => _0x1c89b0[_0x34131e(0x8bb)](_0x496eb3)), _0x4168a8[_0x34131e(0x8f0)](_0x57f734 => _0x37d73d[_0x34131e(0x8bb)](_0x57f734)), await new Promise((_0xd3094, _0x56e139) => { const _0x39e4b8 = _0x34131e; 'UYpuj' === _0x39e4b8(0x30a) ? (_0x1f0377[_0x39e4b8(0x43d)][_0x39e4b8(0x154)](_0x39e4b8(0x51b), _0x39e4b8(0x61d)), _0x57b94b[_0x39e4b8(0x43d)][_0x39e4b8(0x154)](_0x39e4b8(0x191)), _0x1ec227[_0x39e4b8(0x800)] = _0x2757aa, _0x54c968(), _0x52d652[_0x39e4b8(0x8b8)] = ![]) : (_0x534db1[_0x39e4b8(0x6da)] = _0xd3094, _0x534db1[_0x39e4b8(0x7d0)] = _0x12ca7a => _0x56e139(_0x12ca7a[_0x39e4b8(0x381)][_0x39e4b8(0x412)])); }), _0x585d0a(![]), _0x30a64e(_0x34131e(0x826)), setTimeout(() => location[_0x34131e(0x29b)](), 0x640); } catch (_0x59a99b) { _0x585d0a(![]), console[_0x34131e(0x412)](_0x34131e(0x2e8), _0x59a99b), _0x30a64e(_0x34131e(0x168) + _0x59a99b[_0x34131e(0x227)]); } finally { if ('wRycI' !== 'CHLsr') _0x1784a2['value'] = ''; else { if (!_0x1f0a02) return ''; const _0x325b7d = new _0x30fd97(_0x1d3e04), _0x150099 = _0x122406(_0x325b7d[_0x34131e(0x267)]())[_0x34131e(0x643)](0x2, '0'), _0x12b5ae = _0x278b6d(_0x325b7d[_0x34131e(0x3c0)]())['padStart'](0x2, '0'); return _0x150099 + ':' + _0x12b5ae; } } }, _0x28c72e[_0x55d74b(0x746)](_0x1179f9); } }); } else return ''; }); function _0x30f2f5() { const _0x3c1af0 = _0x2b3d5e; _0x3693f4[_0x3c1af0(0x2ff)] = _0x79fbb7[_0x3c1af0(0x164)]['endpoint'] || '', _0x2e9e79[_0x3c1af0(0x2ff)] = _0x79fbb7[_0x3c1af0(0x164)]['key'] || '', _0x5f1053['value'] = _0x79fbb7[_0x3c1af0(0x164)][_0x3c1af0(0x1b1)] || '', _0x122a47[_0x3c1af0(0x2ff)] = String(_0x79fbb7['preferences']?.['perChatContextLines'] ?? 0x64), document[_0x3c1af0(0x1f3)]('api-provider')[_0x3c1af0(0x2ff)] = _0x79fbb7[_0x3c1af0(0x164)][_0x3c1af0(0x286)] || 'openai'; } function _0x28aed0() { const _0x363b72 = _0x2b3d5e; if (_0x363b72(0x817) === _0x363b72(0x1be)) { const _0x221e46 = _0x318b11[_0x363b72(0x1f3)](_0x363b72(0x25b)); _0x221e46 && _0x213149 && (_0x221e46[_0x363b72(0x465)] = _0x492184['createObjectURL'](_0x365429)); } else { _0x79fbb7[_0x363b72(0x164)]['endpoint'] = _0x3693f4[_0x363b72(0x2ff)][_0x363b72(0x538)](), _0x79fbb7[_0x363b72(0x164)][_0x363b72(0x251)] = _0x2e9e79[_0x363b72(0x2ff)]['trim'](), _0x79fbb7['apiSettings'][_0x363b72(0x1b1)] = _0x5f1053[_0x363b72(0x2ff)][_0x363b72(0x538)](), _0x79fbb7[_0x363b72(0x164)][_0x363b72(0x286)] = document[_0x363b72(0x1f3)]('api-provider')[_0x363b72(0x2ff)]; const _0xdc7016 = parseInt(_0x122a47[_0x363b72(0x2ff)], 0xa); _0x79fbb7[_0x363b72(0x11a)]['perChatContextLines'] = Number[_0x363b72(0x7c0)](_0xdc7016) && _0xdc7016 > 0x0 ? _0xdc7016 : 0x64, _0x43a351(), _0x30a64e('设置已保存！'); } } function _0x4d6e3d() { const _0x4db9e1 = _0x2b3d5e; if ('LSlLw' === _0x4db9e1(0x907)) { if (_0x4b96e2[_0x4db9e1(0x1fb)] === _0x4db9e1(0x680)) return _0x4db9e1(0x22b) + (_0x2c1965[_0x4db9e1(0x908)] || '未命名') + '」'; const _0x378ace = _0x45fadc(_0x374d60['participantIds'][0x0]); return '与\x20' + (_0x378ace?.[_0x4db9e1(0x908)] || _0x4db9e1(0x44e)) + '\x20的私聊'; } else _0x209c55[_0x4db9e1(0x2ff)] = _0x79fbb7[_0x4db9e1(0x1ab)][_0x4db9e1(0x908)] || '', _0x834305['src'] = _0x79fbb7[_0x4db9e1(0x1ab)][_0x4db9e1(0x71c)] || _0x4f5e50, _0x553e82[_0x4db9e1(0x2ff)] = _0x79fbb7[_0x4db9e1(0x1ab)][_0x4db9e1(0x6dc)] || ''; } function _0x273978() { const _0x4d7660 = _0x2b3d5e; _0x79fbb7['userProfile'][_0x4d7660(0x908)] = _0x209c55[_0x4d7660(0x2ff)]['trim'](), _0x79fbb7['userProfile'][_0x4d7660(0x6dc)] = _0x553e82[_0x4d7660(0x2ff)][_0x4d7660(0x538)](), _0x43a351(), _0xd4cd2d(), _0x30a64e(_0x4d7660(0x118)), _0x465abb(_0x4d7660(0x162), 'userProfile'); } async function _0x9c4cc7(_0xc2eb47 = null) { const _0xe2186d = _0x2b3d5e, _0x2f3f78 = _0x36fb77; _0x465abb('characterEdit', _0x2f3f78); const _0x1a6f64 = document[_0xe2186d(0x1f3)]('world-book-checkboxes-container'); _0x1a6f64[_0xe2186d(0x2f7)] = '', _0x79fbb7[_0xe2186d(0x32e)][_0xe2186d(0x8f0)](_0x24c457 => { const _0x24dd83 = _0xe2186d, _0x154c23 = document[_0x24dd83(0x4f8)](_0x24dd83(0x1e6)); _0x154c23[_0x24dd83(0x2f7)] = '<input\x20type=\x22checkbox\x22\x20value=\x22' + _0x24c457['id'] + _0x24dd83(0x1ff) + _0x24c457[_0x24dd83(0x908)], _0x1a6f64['appendChild'](_0x154c23); }), _0x4fccb4(_0xe2186d(0x8c9)), _0x415148[_0xe2186d(0x465)] = '', _0x1369c8[_0xe2186d(0x2ff)] = '', _0x49d211['src'] = '', _0x249a81['value'] = '', _0x3cb122[_0xe2186d(0x465)] = '', _0x19f47d[_0xe2186d(0x2ff)] = ''; const _0x3bc44c = [_0xe2186d(0x4e9), _0xe2186d(0x5b5), _0xe2186d(0x3b0), _0xe2186d(0x3b1), _0xe2186d(0x56c)]; _0x3bc44c[_0xe2186d(0x8f0)](_0x5fa322 => { const _0x1ea60c = _0xe2186d; document[_0x1ea60c(0x1f3)](_0x1ea60c(0x57f) + _0x5fa322 + _0x1ea60c(0x540))[_0x1ea60c(0x465)] = '', document[_0x1ea60c(0x1f3)](_0x1ea60c(0x57f) + _0x5fa322 + '-input')[_0x1ea60c(0x2ff)] = ''; }); if (_0xc2eb47) { const _0x598566 = _0x79fbb7[_0xe2186d(0x44f)][_0xe2186d(0x2aa)](_0x2e9f29 => _0x2e9f29['id'] === _0xc2eb47); if (!_0x598566) return; _0x4015c3[_0xe2186d(0x2ff)] = _0x598566['id'], _0x519a7f[_0xe2186d(0x5f4)] = '编辑角色', _0x49dbc4[_0xe2186d(0x2ff)] = _0x598566['name'], _0x136b32[_0xe2186d(0x2ff)] = _0x598566[_0xe2186d(0x2b1)], _0x4f99f2[_0xe2186d(0x2ff)] = _0x598566[_0xe2186d(0x6dc)], document['getElementById'](_0xe2186d(0x2fa))[_0xe2186d(0x2ff)] = _0x598566[_0xe2186d(0x23f)] || ''; const _0x470e76 = _0x79fbb7[_0xe2186d(0x4c9)][_0xe2186d(0x2aa)](_0x4bbf4d => _0x4bbf4d['type'] === _0xe2186d(0x91f) && _0x4bbf4d[_0xe2186d(0x285)][_0xe2186d(0x5ad)](_0xc2eb47)); document[_0xe2186d(0x1f3)](_0xe2186d(0x8c9))[_0xe2186d(0x2ff)] = _0x470e76?.[_0xe2186d(0x536)] || _0x79fbb7['activeUserProfileId']; try { const _0x443310 = await _0x3db342('char_avatar_' + _0x598566['id']), _0x19bba0 = await _0x3db342(_0xe2186d(0x3c1) + _0x598566['id']), _0xd8a17d = await _0x3db342(_0xe2186d(0x714) + _0x598566['id']); _0x415148[_0xe2186d(0x465)] = _0x443310 ? URL[_0xe2186d(0x4af)](_0x443310) : _0x598566[_0xe2186d(0x71c)] || _0x426b80; if (_0x19bba0) _0x49d211[_0xe2186d(0x465)] = URL[_0xe2186d(0x4af)](_0x19bba0); if (_0xd8a17d) _0x3cb122['src'] = URL[_0xe2186d(0x4af)](_0xd8a17d); for (const _0x43cdde of _0x3bc44c) { const _0x1034a6 = await _0x3db342('char_sprite_' + _0x43cdde + '_' + _0x598566['id']); _0x1034a6 && ('KrMGe' !== _0xe2186d(0x38f) ? _0x320b8e++ : document['getElementById'](_0xe2186d(0x57f) + _0x43cdde + _0xe2186d(0x540))[_0xe2186d(0x465)] = URL[_0xe2186d(0x4af)](_0x1034a6)); } } catch (_0x46c9a8) { console[_0xe2186d(0x412)](_0xe2186d(0x75a) + _0x598566['id'] + _0xe2186d(0x7aa), _0x46c9a8), _0x415148[_0xe2186d(0x465)] = _0x598566['avatar'] || _0x426b80; } _0x598566[_0xe2186d(0x444)] && ('tymhB' !== _0xe2186d(0x794) ? _0x1a6f64[_0xe2186d(0x5ec)](_0xe2186d(0x237))[_0xe2186d(0x8f0)](_0x5645f2 => { const _0x38478d = _0xe2186d; if (_0x598566['linkedWorldBookIds'][_0x38478d(0x5ad)](_0x5645f2['value'])) _0x5645f2[_0x38478d(0x38e)] = !![]; }) : (_0x76b384['innerHTML'] = _0xe2186d(0x1cd), _0x4b4227['getElementById'](_0xe2186d(0x4fa))[_0xe2186d(0x3eb)]('click', _0xef2b5e))), _0x99a5cc(); } else _0xe2186d(0x355) !== _0xe2186d(0x326) ? (_0x4015c3[_0xe2186d(0x2ff)] = '', _0x519a7f[_0xe2186d(0x5f4)] = _0xe2186d(0x53a), _0x49dbc4[_0xe2186d(0x2ff)] = _0xe2186d(0x434) + (_0x79fbb7['characters']['length'] + 0x1), _0x136b32[_0xe2186d(0x2ff)] = '', _0x415148[_0xe2186d(0x465)] = _0x426b80, _0x4f99f2['value'] = _0xe2186d(0x44b), document[_0xe2186d(0x1f3)]('char-edit-css')[_0xe2186d(0x2ff)] = '', _0x99a5cc()) : (_0x568b67['error']('导出角色卡失败:', _0x16d327), _0x54a7ee(_0xe2186d(0x742) + _0x23a7f9[_0xe2186d(0x227)])); const _0x3f93b1 = document['getElementById'](_0xe2186d(0x2fa)); let _0x12077e = document[_0xe2186d(0x1f3)](_0xe2186d(0x83a)); !_0x12077e && (_0x12077e = document['createElement'](_0xe2186d(0x324)), _0x12077e['id'] = _0xe2186d(0x83a), document[_0xe2186d(0x58a)][_0xe2186d(0x7b9)](_0x12077e)); const _0x2091f6 = () => { const _0x51a26d = _0xe2186d, _0x1b141b = _0x3f93b1['value']; let _0x37ee4b = _0x1b141b[_0x51a26d(0x1c3)](/\.bubble\.sent/g, '#bubble-preview-user')['replace'](/\.bubble\.received/g, '#bubble-preview-ai'); _0x12077e[_0x51a26d(0x2f7)] = _0x37ee4b; }; _0x3f93b1[_0xe2186d(0x5b3)]('input', _0x2091f6), _0x3f93b1[_0xe2186d(0x3eb)](_0xe2186d(0x266), _0x2091f6), _0x2091f6(); } async function _0x5ac541() { const _0x518381 = _0x2b3d5e, _0x4d3bf9 = _0x4015c3[_0x518381(0x2ff)]; if (!_0x4d3bf9) { if ('iONiK' !== _0x518381(0x78f)) { const _0x58e0f6 = _0x4a8005[_0x518381(0x381)][_0x518381(0x6e4)]; !_0x58e0f6[_0x518381(0x7a0)][_0x518381(0x545)](_0x20757d) && _0x58e0f6['createObjectStore'](_0xbf0d8b, { 'keyPath': 'id' }); const _0x47061d = _0x518381(0x6ec); !_0x58e0f6[_0x518381(0x7a0)][_0x518381(0x545)](_0x47061d) && _0x58e0f6[_0x518381(0x8fc)](_0x47061d, { 'keyPath': 'id' }); } else { _0x30a64e(_0x518381(0x2b3)); return; } } const _0xa1602e = _0x1249c2(_0x4d3bf9); if (!_0xa1602e) return; _0x585d0a(!![], _0x518381(0x26a) + _0xa1602e[_0x518381(0x908)] + _0x518381(0x8c0)); try { const _0x1efdae = { 'type': _0x518381(0x862), 'version': 0x1, 'name': _0xa1602e[_0x518381(0x908)], 'remark': _0xa1602e['remark'], 'persona': _0xa1602e[_0x518381(0x6dc)], 'bubbleCss': _0xa1602e['bubbleCss'], 'avatar': null, 'sprites': {}, 'worldBooks': [] }, _0x36346f = await _0x3db342(_0x518381(0x8cc) + _0xa1602e['id']); if (_0x36346f) _0x1efdae[_0x518381(0x71c)] = await _0x3b4f2c(_0x36346f); const _0x29d969 = ['normal', _0x518381(0x5b5), _0x518381(0x3b0), _0x518381(0x3b1), _0x518381(0x56c)]; for (const _0x3df408 of _0x29d969) { const _0x1f420d = await _0x3db342(_0x518381(0x791) + _0x3df408 + '_' + _0xa1602e['id']); _0x1f420d && (_0x1efdae['sprites'][_0x3df408] = await _0x3b4f2c(_0x1f420d)); } _0xa1602e[_0x518381(0x444)] && _0xa1602e[_0x518381(0x444)][_0x518381(0x629)] > 0x0 && (_0x1efdae[_0x518381(0x32e)] = _0xa1602e[_0x518381(0x444)][_0x518381(0x843)](_0xc524ec => _0x79fbb7[_0x518381(0x32e)][_0x518381(0x2aa)](_0x80a769 => _0x80a769['id'] === _0xc524ec))[_0x518381(0x6a6)](Boolean)['map'](_0x3e2295 => ({ 'name': _0x3e2295['name'], 'content': _0x3e2295[_0x518381(0x317)] }))); const _0x42723f = new Blob([JSON['stringify'](_0x1efdae, null, 0x2)], { 'type': 'application/json' }), _0x244213 = URL[_0x518381(0x4af)](_0x42723f), _0x54a616 = document[_0x518381(0x4f8)]('a'); _0x54a616[_0x518381(0x582)] = _0x244213, _0x54a616['download'] = _0xa1602e[_0x518381(0x908)] + _0x518381(0x282), document[_0x518381(0x7f1)][_0x518381(0x7b9)](_0x54a616), _0x54a616[_0x518381(0x1a4)](), document[_0x518381(0x7f1)][_0x518381(0x4c3)](_0x54a616), URL['revokeObjectURL'](_0x244213); } catch (_0x444bd7) { console[_0x518381(0x412)](_0x518381(0x40a), _0x444bd7), _0x30a64e('导出失败了，哼:\x20' + _0x444bd7[_0x518381(0x227)]); } finally { _0x585d0a(![]); } } async function _0x43e9b2(_0x2630f4) { const _0x4e0243 = _0x2b3d5e, _0x13effc = _0x2630f4[_0x4e0243(0x381)][_0x4e0243(0x5b7)][0x0]; if (!_0x13effc) return; _0x585d0a(!![], _0x4e0243(0x5e4)); const _0x44a960 = new FileReader(); _0x44a960[_0x4e0243(0x3fc)] = async _0x27ee5 => { const _0x4e7fd2 = _0x4e0243; if (_0x4e7fd2(0x342) !== _0x4e7fd2(0x342)) { const _0x56e48f = _0x405d5b(_0x415b50[_0x4e7fd2(0x285)][0x0]); _0x56e48f ? (_0x7f8362 = _0x56e48f[_0x4e7fd2(0x71c)] || _0x5c15e2, _0x52653c = _0x56e48f[_0x4e7fd2(0x908)] || '未命名角色', _0x4783b9 = _0x56e48f[_0x4e7fd2(0x2b1)] || '私聊') : (_0x1dd9f6 = _0x4e7fd2(0x44e), _0x5120e9 = '错误：找不到角色'); } else try { const _0x22da9a = JSON['parse'](_0x27ee5['target'][_0x4e7fd2(0x6e4)]); if (_0x22da9a['type'] !== 'NoirCharacterCard') { if (_0x4e7fd2(0x66c) === _0x4e7fd2(0x66c)) throw new Error('这不是一张有效的Noir角色卡。'); else _0x560329[_0x4e7fd2(0x465)] = _0x2525bf[_0x4e7fd2(0x4af)](_0x2c572), _0x2e502c[_0x4e7fd2(0x324)][_0x4e7fd2(0x1db)] = 0x1; } const _0x390ef1 = []; if (_0x22da9a['worldBooks'] && _0x22da9a[_0x4e7fd2(0x32e)][_0x4e7fd2(0x629)] > 0x0) for (const _0xecfa1e of _0x22da9a['worldBooks']) { let _0x2f87d8 = _0x79fbb7[_0x4e7fd2(0x32e)]['find'](_0x318733 => _0x318733[_0x4e7fd2(0x908)] === _0xecfa1e[_0x4e7fd2(0x908)]); if (_0x2f87d8) _0x390ef1[_0x4e7fd2(0x7d8)](_0x2f87d8['id']); else { const _0x1c585d = { 'id': _0x4e7fd2(0x725) + Date[_0x4e7fd2(0x86b)]() + '_' + Math['random'](), 'name': _0xecfa1e[_0x4e7fd2(0x908)], 'content': _0xecfa1e[_0x4e7fd2(0x317)] }; _0x79fbb7[_0x4e7fd2(0x32e)][_0x4e7fd2(0x7d8)](_0x1c585d), _0x390ef1[_0x4e7fd2(0x7d8)](_0x1c585d['id']); } } const _0x431391 = 'char_' + Date[_0x4e7fd2(0x86b)](), _0x5bf560 = { 'id': _0x431391, 'name': _0x22da9a[_0x4e7fd2(0x908)], 'remark': _0x22da9a[_0x4e7fd2(0x2b1)] || '', 'persona': _0x22da9a[_0x4e7fd2(0x6dc)], 'avatar': _0x22da9a[_0x4e7fd2(0x71c)] || _0x426b80, 'linkedWorldBookIds': _0x390ef1, 'bubbleCss': _0x22da9a[_0x4e7fd2(0x23f)] || '' }; if (_0x22da9a[_0x4e7fd2(0x71c)]) { if ('cjpMb' === 'vYvXP') { const _0x4a51c0 = _0x863fcc(_0x15c0cc[_0x4e7fd2(0x14b)]); return _0x4a51c0?.['name'] || _0x4e7fd2(0x36b); } else { const _0x487bdc = await _0x4f6af3(_0x22da9a[_0x4e7fd2(0x71c)]); await _0x43bf1f('char_avatar_' + _0x431391, _0x487bdc); } } if (_0x22da9a[_0x4e7fd2(0x21a)]) for (const _0x24166a in _0x22da9a[_0x4e7fd2(0x21a)]) { if (_0x4e7fd2(0x2c4) === _0x4e7fd2(0x2c4)) { const _0x28c34b = _0x22da9a[_0x4e7fd2(0x21a)][_0x24166a], _0x4b6df0 = await _0x4f6af3(_0x28c34b); await _0x43bf1f('char_sprite_' + _0x24166a + '_' + _0x431391, _0x4b6df0); } else _0x1916ca[_0x4e7fd2(0x1d7)](_0x414a09); } _0x79fbb7[_0x4e7fd2(0x44f)]['push'](_0x5bf560); const _0x2e47c3 = { 'id': 'chat_' + _0x431391, 'type': _0x4e7fd2(0x91f), 'participantIds': [_0x431391], 'boundUserProfileId': _0x79fbb7[_0x4e7fd2(0x4dd)] }; _0x79fbb7[_0x4e7fd2(0x4c9)][_0x4e7fd2(0x7d8)](_0x2e47c3), _0x43a351(), _0x35866c(), _0x30a64e('“' + _0x5bf560[_0x4e7fd2(0x908)] + _0x4e7fd2(0x8e3)); } catch (_0x5e8959) { console[_0x4e7fd2(0x412)]('导入角色卡失败:', _0x5e8959), _0x30a64e(_0x4e7fd2(0x482) + _0x5e8959[_0x4e7fd2(0x227)]); } finally { _0x585d0a(![]), _0x2630f4['target']['value'] = ''; } }, _0x44a960[_0x4e0243(0x746)](_0x13effc); } async function _0x36398a() { const _0x505e74 = _0x2b3d5e, _0x1a65ee = _0x4015c3[_0x505e74(0x2ff)]; let _0x16ed66 = null; const _0x34a412 = _0x1369c8[_0x505e74(0x5b7)][0x0], _0x33a133 = _0x249a81[_0x505e74(0x5b7)][0x0], _0x6a8400 = _0x19f47d[_0x505e74(0x5b7)][0x0], _0x3b261f = document[_0x505e74(0x5ec)]('#world-book-checkboxes-container\x20input:checked'), _0x20620e = Array[_0x505e74(0x910)](_0x3b261f)['map'](_0x439cb6 => _0x439cb6[_0x505e74(0x2ff)]), _0x3ef226 = { 'name': _0x49dbc4['value']['trim'](), 'remark': _0x136b32[_0x505e74(0x2ff)][_0x505e74(0x538)](), 'persona': _0x4f99f2['value'][_0x505e74(0x538)](), 'linkedWorldBookIds': _0x20620e, 'boundUserProfileId': document['getElementById']('char-edit-bind-user')[_0x505e74(0x2ff)], 'bubbleCss': document[_0x505e74(0x1f3)](_0x505e74(0x2fa))[_0x505e74(0x2ff)][_0x505e74(0x538)]() }; if (!_0x3ef226[_0x505e74(0x908)]) { if ('eTCpy' !== _0x505e74(0x4fc)) try { const _0x3f1388 = _0x16a64f[_0x505e74(0x4f6)](_0x2bfc96[_0x505e74(0xfc)](_0x505e74(0x217)) || '{}'), _0x3f43a8 = { ..._0x3f1388, ..._0x1412d4 }; _0x5f5d6c['setItem'](_0x505e74(0x217), _0x1f6aa7[_0x505e74(0x4de)](_0x3f43a8)); } catch (_0x3b2df1) { _0x90111a['error'](_0x505e74(0x719), _0x3b2df1); } else { _0x30a64e(_0x505e74(0x580)); return; } } try { const _0x320b13 = ['normal', _0x505e74(0x5b5), 'angry', _0x505e74(0x3b1), _0x505e74(0x56c)]; if (_0x1a65ee) { const _0x203afa = _0x79fbb7['characters'][_0x505e74(0x2aa)](_0x232139 => _0x232139['id'] === _0x1a65ee); if (_0x203afa) { Object[_0x505e74(0x2db)](_0x203afa, _0x3ef226); if (_0x34a412) _0x203afa[_0x505e74(0x71c)] = await _0x7c9580(_0x34a412); } if (_0x34a412) await _0x43bf1f('char_avatar_' + _0x1a65ee, _0x34a412); if (_0x33a133) await _0x43bf1f(_0x505e74(0x3c1) + _0x1a65ee, _0x33a133); if (_0x6a8400) await _0x43bf1f(_0x505e74(0x714) + _0x1a65ee, _0x6a8400); for (const _0x3396c9 of _0x320b13) { const _0x42958d = document[_0x505e74(0x1f3)](_0x505e74(0x57f) + _0x3396c9 + _0x505e74(0x6ef))[_0x505e74(0x5b7)][0x0]; if (_0x42958d) await _0x43bf1f(_0x505e74(0x791) + _0x3396c9 + '_' + _0x1a65ee, _0x42958d); } } else { if ('vjmCE' !== _0x505e74(0x47b)) { _0x16ed66 = _0x505e74(0x354) + Date[_0x505e74(0x86b)](); const _0x2f325d = { 'id': _0x16ed66, ..._0x3ef226 }; _0x2f325d['avatar'] = _0x34a412 ? await _0x7c9580(_0x34a412) : _0x426b80, _0x79fbb7[_0x505e74(0x44f)]['push'](_0x2f325d); const _0x4110ea = { 'id': _0x505e74(0x446) + _0x16ed66, 'type': _0x505e74(0x91f), 'participantIds': [_0x16ed66], 'boundUserProfileId': _0x3ef226[_0x505e74(0x536)], 'listenTogetherSession': null }; _0x79fbb7[_0x505e74(0x4c9)]['push'](_0x4110ea); if (_0x34a412) await _0x43bf1f(_0x505e74(0x8cc) + _0x16ed66, _0x34a412); if (_0x33a133) await _0x43bf1f(_0x505e74(0x3c1) + _0x16ed66, _0x33a133); if (_0x6a8400) await _0x43bf1f(_0x505e74(0x714) + _0x16ed66, _0x6a8400); for (const _0x2a06d1 of _0x320b13) { if (_0x505e74(0x15a) !== _0x505e74(0x67b)) { const _0xf2077 = document[_0x505e74(0x1f3)]('char-edit-sprite-' + _0x2a06d1 + '-input')[_0x505e74(0x5b7)][0x0]; if (_0xf2077) await _0x43bf1f('char_sprite_' + _0x2a06d1 + '_' + _0x16ed66, _0xf2077); } else _0x1572fb(_0x2bece2[_0x505e74(0x617)](_0x36c5cc, _0x49a760)); } } else for (const _0x245559 of _0x2c60e5[_0x505e74(0x32e)]) { let _0x4796ab = _0x3ba650['worldBooks'][_0x505e74(0x2aa)](_0x5de70b => _0x5de70b['name'] === _0x245559[_0x505e74(0x908)]); if (_0x4796ab) _0x4feef2[_0x505e74(0x7d8)](_0x4796ab['id']); else { const _0xe78081 = { 'id': _0x505e74(0x725) + _0x1253bf[_0x505e74(0x86b)]() + '_' + _0x1fbe1a[_0x505e74(0x4dc)](), 'name': _0x245559['name'], 'content': _0x245559[_0x505e74(0x317)] }; _0x236f1f[_0x505e74(0x32e)][_0x505e74(0x7d8)](_0xe78081), _0x4dbe8e[_0x505e74(0x7d8)](_0xe78081['id']); } } } _0x43a351(), _0x35866c(), _0x30a64e(_0x505e74(0x523)), _0x465abb('chat', _0x505e74(0x1e5)); if (!_0x1a65ee) { if (_0x505e74(0x406) !== _0x505e74(0x406)) { _0x26e96c(_0x505e74(0x6f0)); return; } else { const _0x5d9e6d = 'chat_' + _0x16ed66; _0x5cee40(_0x5d9e6d), _0x4fa91a(!![]); } } } catch (_0x1ed7f9) { console[_0x505e74(0x412)]('保存角色失败:', _0x1ed7f9), _0x30a64e(_0x505e74(0x5ab) + _0x1ed7f9[_0x505e74(0x227)]); } } function _0x202806() { const _0x45b860 = _0x2b3d5e; if (_0x45b860(0x352) === _0x45b860(0x352)) { _0x269303[_0x45b860(0x2ff)] = '', _0x56867f[_0x45b860(0x2f7)] = ''; if (_0x79fbb7[_0x45b860(0x44f)]['length'] < 0x2) { _0x30a64e(_0x45b860(0x334)); return; } _0x79fbb7[_0x45b860(0x44f)][_0x45b860(0x8f0)](_0x5d9063 => { const _0x2ef038 = _0x45b860, _0xc9ae79 = document[_0x2ef038(0x4f8)]('li'); _0xc9ae79['className'] = _0x2ef038(0x206), _0xc9ae79[_0x2ef038(0x2f7)] = _0x2ef038(0x262) + _0x5d9063['id'] + _0x2ef038(0x36c) + _0x5d9063['id'] + _0x2ef038(0x5e8) + (_0x5d9063[_0x2ef038(0x71c)] || _0x426b80) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-' + _0x5d9063['id'] + '\x22\x20class=\x22char-name\x22>' + _0x5d9063[_0x2ef038(0x908)] + _0x2ef038(0x5b8), _0x56867f[_0x2ef038(0x7b9)](_0xc9ae79); }), _0x465abb('groupChatCreate', 'charSelect'); } else return; } function _0x2370f4() { const _0x55a850 = _0x2b3d5e, _0x298819 = _0x269303[_0x55a850(0x2ff)][_0x55a850(0x538)](); if (!_0x298819) { _0x30a64e(_0x55a850(0x3c2)); return; } const _0x1aaf80 = Array[_0x55a850(0x910)](_0x56867f[_0x55a850(0x5ec)](_0x55a850(0x187)))[_0x55a850(0x843)](_0x1e77fa => _0x1e77fa[_0x55a850(0x78e)]['id']); if (_0x1aaf80[_0x55a850(0x629)] < 0x2) { if (_0x55a850(0x861) === _0x55a850(0x135)) { _0x35b6c7[_0x55a850(0x3c7)](_0x55a850(0x5a9)); const _0x5f5d67 = _0x2d2663[_0x55a850(0x285)][_0x55a850(0x843)](_0x21c98c)[_0x55a850(0x6a6)](_0x421bf6); if (!_0x5f5d67[_0x55a850(0x629)]) return; let _0x2e6dfb = 0x0; for (const _0x13c876 of _0x5f5d67) { _0x39765e(_0x13c876, { 'force': !![], 'delayMs': _0x2e6dfb }), _0x2e6dfb += 0x1f4; } } else { _0x30a64e('群聊至少需要2名成员。'); return; } } const _0x3c718a = { 'id': _0x55a850(0x42a) + Date[_0x55a850(0x86b)](), 'type': 'group', 'name': _0x298819, 'participantIds': _0x1aaf80 }; _0x79fbb7[_0x55a850(0x4c9)][_0x55a850(0x7d8)](_0x3c718a), _0x79fbb7['activeChatId'] = _0x3c718a['id'], _0x43a351(), _0x35866c(), _0x4afdf2(), _0x49574c(), _0x30a64e(_0x55a850(0x71f) + _0x298819 + '”已创建！'), _0x465abb(_0x55a850(0x59e), _0x55a850(0x64d)); } _0x22bfd2[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x47a19a), _0x41192f['addEventListener']('click', () => _0x1049ba[_0x2b3d5e(0x43d)][_0x2b3d5e(0x154)](_0x2b3d5e(0x920))), _0x301ffc['addEventListener'](_0x2b3d5e(0x1a4), () => _0x1049ba['classList'][_0x2b3d5e(0x154)]('show')), _0x1fe82f['addEventListener'](_0x2b3d5e(0x1a4), () => { const _0x44a949 = _0x2b3d5e; _0x50b6d5['select'](), navigator[_0x44a949(0x28d)][_0x44a949(0x4c6)](_0x50b6d5['value'])[_0x44a949(0x2cd)](() => { const _0x5ec20c = _0x44a949; 'EvtWc' === _0x5ec20c(0x8d7) ? _0x30a64e('已复制到剪贴板！') : (_0x1ab8d5['style'][_0x5ec20c(0x6a7)] = _0x5ec20c(0x647) + _0xd54559['createObjectURL'](_0x26343f) + '\x27)', _0x312429[_0x5ec20c(0x324)][_0x5ec20c(0x93f)] = _0x5ec20c(0x876), _0xfc8ff5[_0x5ec20c(0x324)]['backgroundPosition'] = _0x5ec20c(0x51e)); })[_0x44a949(0x222)](_0x2342b0 => { const _0x20121f = _0x44a949; _0x30a64e(_0x20121f(0x8a2)); }); }), _0x552e4f['addEventListener'](_0x2b3d5e(0x1a4), _0x3d44ca), _0x13835b[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x437b04), _0x46340f[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => _0x522dc5[_0x2b3d5e(0x43d)][_0x2b3d5e(0x154)](_0x2b3d5e(0x920))), _0x1c8c06['addEventListener']('click', () => _0x522dc5['classList']['remove'](_0x2b3d5e(0x920))), _0x49d211['addEventListener'](_0x2b3d5e(0x1a4), () => _0x249a81[_0x2b3d5e(0x1a4)]()), _0x3cb122[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => _0x19f47d['click']()), _0x249a81[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x3b3), async _0x35979b => { const _0x331129 = _0x2b3d5e; if ('MdvYF' !== 'MdvYF') _0x3550d4(), _0x59391c(_0x331129(0x65b), _0x331129(0x819)); else { const _0x2ca86f = _0x35979b[_0x331129(0x381)][_0x331129(0x5b7)][0x0]; if (!_0x2ca86f) return; try { if (_0x331129(0x5ae) !== _0x331129(0x699)) _0x49d211[_0x331129(0x465)] = await _0x7c9580(_0x2ca86f); else { const _0x40b48a = _0x2e0d35['friendCircles']['find'](_0x1f658d => _0x1f658d['id'] === _0x1e9b9b); if (!_0x40b48a) return; _0x1dbbc4[_0x331129(0x5f4)] = '编辑好友圈', _0x41928c['value'] = _0x40b48a['id'], _0x43732f[_0x331129(0x2ff)] = _0x40b48a[_0x331129(0x908)], _0x62e488['value'] = _0x40b48a['boundUserProfileId'], _0x7b7cfe[_0x331129(0x324)]['display'] = _0x331129(0x53e), _0x40b48a[_0x331129(0x150)][_0x331129(0x8f0)](_0x38521b => { const _0x27f593 = _0x331129, _0x2fb6ce = _0x5b480d[_0x27f593(0x249)](_0x27f593(0x8c6) + _0x38521b); if (_0x2fb6ce) _0x2fb6ce['checked'] = !![]; }); } } catch (_0x4600e2) { if (_0x331129(0x658) === _0x331129(0x658)) _0x30a64e(_0x331129(0x8f6) + _0x4600e2[_0x331129(0x227)]); else { if (!_0x1181d9[_0x331129(0x778)]) return _0x179abe[_0x331129(0x8d2)][_0x331129(0x2aa)](_0x2fc62d => _0x2fc62d['id'] === _0x2d4a2c[_0x331129(0x4dd)]) || _0x5e77dc[_0x331129(0x8d2)][0x0]; const _0x1f5f0b = _0x2df222[_0x331129(0x4c9)]['find'](_0x4f16c4 => _0x4f16c4[_0x331129(0x1fb)] === _0x331129(0x91f) && _0x4f16c4[_0x331129(0x285)][_0x331129(0x5ad)](_0x1879f5[_0x331129(0x778)])), _0x1d91e1 = _0x1f5f0b?.[_0x331129(0x536)] || _0x4a6c3e[_0x331129(0x4dd)]; return _0x4de5b6[_0x331129(0x8d2)]['find'](_0x430e8f => _0x430e8f['id'] === _0x1d91e1) || _0xc5738[_0x331129(0x8d2)][0x0]; } } } }), _0x19f47d[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x3b3), async _0x160a2f => { const _0x27ef6a = _0x2b3d5e, _0x33a544 = _0x160a2f[_0x27ef6a(0x381)][_0x27ef6a(0x5b7)][0x0]; if (!_0x33a544) return; try { _0x3cb122[_0x27ef6a(0x465)] = await _0x7c9580(_0x33a544); } catch (_0x538ff8) { _0x30a64e(_0x27ef6a(0x8f6) + _0x538ff8[_0x27ef6a(0x227)]); } }), _0x500656[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => _0x378dee[_0x2b3d5e(0x1a4)]()), _0x4c5a67[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0x4aaea2 = _0x2b3d5e; localStorage[_0x4aaea2(0x847)](_0x4aaea2(0x2c5)), _0x360ad0(), _0x30a64e(_0x4aaea2(0x415)); }), _0x378dee[_0x2b3d5e(0x3eb)]('change', async _0xb6bc26 => { const _0x36a106 = _0x2b3d5e, _0x266171 = _0xb6bc26[_0x36a106(0x381)][_0x36a106(0x5b7)][0x0]; if (!_0x266171) return; try { if (_0x36a106(0x7e0) !== 'JjmbZ') _0x4892c0 = _0x36a106(0x180); else { const _0x3d70d8 = await _0x7c9580(_0x266171); localStorage[_0x36a106(0x54a)]('customFeedWallpaper', _0x3d70d8), _0x360ad0(), _0x30a64e(_0x36a106(0x83e)); } } catch (_0x4a6a5e) { if (_0x36a106(0x87c) === _0x36a106(0x87c)) _0x30a64e(_0x36a106(0x8f6) + _0x4a6a5e[_0x36a106(0x227)]); else { const _0x1180b4 = _0x50b345['createElement']('div'); _0x1180b4['className'] = _0x36a106(0x6d6), _0x1180b4[_0x36a106(0x2f7)] = _0x36a106(0x591), _0x1180b4[_0x36a106(0x249)](_0x36a106(0x88e))[_0x36a106(0x3dc)] = () => _0x22b537(_0x36a106(0x74f)), _0x9ca837[_0x36a106(0x7b9)](_0x1180b4), _0x551dc4(_0x247535)[_0x36a106(0x2cd)](_0x436fea => { const _0x297e7a = _0x36a106, _0x1fd280 = _0x5108e3['getElementById'](_0x297e7a(0x25b)); _0x1fd280 && _0x436fea && (_0x1fd280[_0x297e7a(0x465)] = _0xb012c2['createObjectURL'](_0x436fea)); }); } } }), document[_0x2b3d5e(0x1f3)]('back-to-chat-from-group-settings')[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => _0x465abb('chat', _0x2b3d5e(0x28b))), document['getElementById']('save-group-settings-button')[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x545542); const _0x22ad67 = document[_0x2b3d5e(0x1f3)]('group-avatar-preview'), _0x204bb4 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x8cf)); _0x22ad67['addEventListener'](_0x2b3d5e(0x1a4), () => _0x204bb4[_0x2b3d5e(0x1a4)]()), _0x204bb4[_0x2b3d5e(0x3eb)]('change', _0x1fe5b5 => { const _0x562873 = _0x2b3d5e; if (_0x562873(0x7bf) === _0x562873(0x7cb)) _0x3bd550(() => { const _0x479c6a = _0x562873, _0x5833eb = _0x33a5bb[_0x479c6a(0x1f3)](_0x3716f7); if (_0x5833eb) _0x5833eb[_0x479c6a(0x465)] = _0xcb346c[_0x479c6a(0x1d1)]; }, 0x0); else { const _0x1e8910 = _0x1fe5b5[_0x562873(0x381)]['files'][0x0]; if (!_0x1e8910) return; const _0x1e801b = URL[_0x562873(0x4af)](_0x1e8910); _0x22ad67[_0x562873(0x465)] = _0x1e801b, _0x22ad67['onload'] = () => { const _0x4cf97d = _0x562873; URL[_0x4cf97d(0x1d7)](_0x1e801b); }; } }); const _0x4d100b = document['getElementById'](_0x2b3d5e(0x23d))[_0x2b3d5e(0x216)], _0x3d7d4c = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x321)), _0x2e8c2f = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x23d)); _0x4d100b['addEventListener'](_0x2b3d5e(0x1a4), () => _0x3d7d4c[_0x2b3d5e(0x1a4)]()), _0x3d7d4c['addEventListener'](_0x2b3d5e(0x3b3), _0x57b608 => { const _0x1b4286 = _0x2b3d5e; if (_0x1b4286(0x747) !== _0x1b4286(0x747)) _0x244e6c[_0x1b4286(0x1f3)](_0x1b4286(0x4a7))['click'](); else { const _0x43e349 = _0x57b608[_0x1b4286(0x381)][_0x1b4286(0x5b7)][0x0]; if (!_0x43e349) return; const _0x45dd49 = URL[_0x1b4286(0x4af)](_0x43e349); _0x2e8c2f[_0x1b4286(0x465)] = _0x45dd49, _0x2e8c2f['onload'] = () => { const _0x4d5aab = _0x1b4286; URL[_0x4d5aab(0x1d7)](_0x45dd49); }; } }); const _0x5dc77f = document[_0x2b3d5e(0x249)]('#group-settings-screen\x20.select-box'), _0x31fed2 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x65e)); _0x5dc77f[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x42174b => { const _0x672f80 = _0x2b3d5e; if (_0x672f80(0x8f5) !== 'pahBN') { const _0x48fea4 = _0x3596ef['activeMeetingScriptQueue'][_0x672f80(0x46c)](); _0x566544['textContent'] = _0x48fea4[_0x672f80(0x806)] === _0x672f80(0x488) ? '旁白' : _0x48fea4[_0x672f80(0x806)], _0x45dfa8[_0x672f80(0x5f4)] = _0x48fea4[_0x672f80(0x844)], _0x48fea4[_0x672f80(0x806)] !== _0x672f80(0x488) && _0x450afa(_0x267332['activeMeetingCharId'], _0x48fea4[_0x672f80(0x148)]); } else _0x42174b[_0x672f80(0x4c8)](), _0x31fed2[_0x672f80(0x43d)][_0x672f80(0x612)]('visible'), _0x5dc77f['classList'][_0x672f80(0x612)](_0x672f80(0x68d)); }), _0x31fed2[_0x2b3d5e(0x3eb)]('change', _0x320938), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x16f))['addEventListener'](_0x2b3d5e(0x1a4), _0x34bc04), document['getElementById'](_0x2b3d5e(0x708))[_0x2b3d5e(0x3eb)]('click', async () => { const _0x568180 = _0x2b3d5e; if (_0x568180(0x382) === _0x568180(0x382)) { const _0x856846 = _0x3f4d37(); if (!_0x856846 || _0x856846[_0x568180(0x1fb)] !== _0x568180(0x680)) return; const _0x496764 = await _0x21bcbb(_0x568180(0x3a2) + _0x856846[_0x568180(0x908)] + '”吗？此操作不可撤销。'); _0x496764 && (_0x568180(0x809) === _0x568180(0x602) ? _0x113577[_0x568180(0x5f4)] = _0x568180(0x192) : (_0x312f6f(_0x856846['id']), _0x30a64e(_0x568180(0x829)), _0x465abb(_0x568180(0x59e)), _0x4fa91a(![]))); } else _0x1c3929 = _0x4cf7a8[_0x568180(0x8d2)][0x0]; }); const _0x9ccab5 = document[_0x2b3d5e(0x249)]('.custom-multiselect\x20.select-box'), _0x237044 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x294)); _0x9ccab5[_0x2b3d5e(0x3eb)]('click', _0xc02e5d => { const _0x1f75e2 = _0x2b3d5e; _0xc02e5d[_0x1f75e2(0x4c8)](), _0x237044[_0x1f75e2(0x43d)][_0x1f75e2(0x612)](_0x1f75e2(0x793)), _0x9ccab5['classList'][_0x1f75e2(0x612)](_0x1f75e2(0x68d)); }), _0x237044[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x3b3), _0x99a5cc), document['addEventListener']('click', _0x34cc84 => { const _0x651249 = _0x2b3d5e; !document[_0x651249(0x249)]('.custom-multiselect')[_0x651249(0x545)](_0x34cc84[_0x651249(0x381)]) && (_0x651249(0x64e) === _0x651249(0x64e) ? (_0x237044[_0x651249(0x43d)][_0x651249(0x154)](_0x651249(0x793)), _0x9ccab5[_0x651249(0x43d)]['remove']('expanded')) : (_0x563571[_0x651249(0x32e)] = _0x14974f['worldBooks']['filter'](_0x28ac2d => _0x28ac2d['id'] !== _0x5c9317), _0x13c7fe[_0x651249(0x44f)][_0x651249(0x8f0)](_0x3a11f0 => { const _0x3228d6 = _0x651249; _0x3a11f0[_0x3228d6(0x444)] && (_0x3a11f0['linkedWorldBookIds'] = _0x3a11f0[_0x3228d6(0x444)][_0x3228d6(0x6a6)](_0x5ea495 => _0x5ea495 !== _0x2120aa)); }), _0x3bdf47(), _0x3af053(_0x651249(0x24c)), _0x2cd106(), _0x156dc4(_0x651249(0x8bf), 'worldBookEditor'))); }), _0x143662[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0x10acab = _0x2b3d5e; _0x2bd81f(), _0x465abb('worldBook', _0x10acab(0x819)); }), document['getElementById']('back-to-home-from-world-book')[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => _0x465abb(_0x2b3d5e(0x819), 'worldBook')), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x927))[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => _0x26c6f7()), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x85e))['addEventListener'](_0x2b3d5e(0x1a4), () => { const _0x51ef12 = _0x2b3d5e; if (_0x51ef12(0x1d5) === _0x51ef12(0x68b)) { const _0x5b06eb = _0x39361b[_0x51ef12(0x704)](_0x5ac081, 0x2); _0x5b06eb[_0x51ef12(0x7d0)] = () => _0x5eb906('IndexedDB\x20failed\x20to\x20open'), _0x5b06eb[_0x51ef12(0x7eb)] = () => _0xca50bf(_0x5b06eb[_0x51ef12(0x6e4)]), _0x5b06eb['onupgradeneeded'] = _0x139749 => { const _0x3609da = _0x51ef12, _0x54ab87 = _0x139749['target']['result']; !_0x54ab87['objectStoreNames'][_0x3609da(0x545)](_0x2d45de) && _0x54ab87['createObjectStore'](_0x1fa7dc, { 'keyPath': 'id' }); const _0x3eaacd = _0x3609da(0x6ec); !_0x54ab87[_0x3609da(0x7a0)][_0x3609da(0x545)](_0x3eaacd) && _0x54ab87['createObjectStore'](_0x3eaacd, { 'keyPath': 'id' }); }; } else _0x2bd81f(), _0x465abb(_0x51ef12(0x8bf), _0x51ef12(0x659)); }), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x379))[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x56738b), document['getElementById']('delete-world-book-button')[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x5899fb), _0x51ae5a['addEventListener']('click', () => _0x465abb('wallpaper', _0x2b3d5e(0x819))), _0x461247[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => _0x465abb(_0x2b3d5e(0x819), _0x2b3d5e(0x1e8))), _0x49ac4d[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => _0x4f944c['click']()), _0x4f944c[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x3b3), async _0x2c53aa => { const _0x2b5421 = _0x2b3d5e, _0x370046 = _0x2c53aa[_0x2b5421(0x381)][_0x2b5421(0x5b7)][0x0]; if (!_0x370046) return; await _0x31c4d5(_0x370046); }), _0x135526['addEventListener'](_0x2b3d5e(0x1a4), () => { const _0x5597de = _0x2b3d5e; _0x35866c(), _0x465abb(_0x5597de(0x59e), _0x5597de(0x819)); }), _0x42c9fd[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0x2c4c6a = _0x2b3d5e; _0x30f2f5(); const _0x296a39 = (_0x79fbb7[_0x2c4c6a(0x164)][_0x2c4c6a(0x7d5)] || '')[_0x2c4c6a(0x5ad)](_0x408a25); _0x4e0ad3[_0x2c4c6a(0x899)] = _0x296a39, _0x465abb(_0x2c4c6a(0x162), _0x2c4c6a(0x819)); }), _0x30548a[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => _0x465abb(_0x2b3d5e(0x819), _0x2b3d5e(0x162))), _0x44a515[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0x3ba7e7 = _0x2b3d5e; _0x3ba7e7(0x4ae) !== _0x3ba7e7(0x493) ? (_0xcd627f(), _0x465abb(_0x3ba7e7(0x819), 'chat')) : (_0xd40a97['activeChatId'] = _0x598fda['id'], _0x36a697(), _0x1294bc(), _0x3c3af9(_0x41a1cb)); }), _0x412776['addEventListener'](_0x2b3d5e(0x1a4), () => { const _0x1470b6 = _0x2b3d5e; _0x1470b6(0x90f) !== _0x1470b6(0x3f4) ? (_0xcd627f(), _0x4fa91a(![])) : (_0x2967b8['error'](_0x1470b6(0x24b), _0x29fd2b), _0x5be5d6 = _0x1c4166); }), _0xd32f6b['addEventListener'](_0x2b3d5e(0x1a4), () => { const _0x33fe3f = _0x2b3d5e; _0x465abb(_0x33fe3f(0x59e), 'characterEdit'); }), _0x59ac4f[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0x1c1744 = _0x2b3d5e; if (_0x1c1744(0x711) === _0x1c1744(0x131)) { const _0x4ad196 = new _0x405cd7(); _0x4ad196[_0x1c1744(0x871)] = () => _0x478245(_0x4ad196['result']), _0x4ad196[_0x1c1744(0x7d0)] = _0x2ff994, _0x4ad196[_0x1c1744(0x1e2)](_0x52b1f4); } else _0x107ee9['classList'][_0x1c1744(0x20f)]('show'); }), _0x3e61e6[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => _0x2e4a87()), _0x2183ce[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x3346d1); function _0x3850c0(_0x575c0b) { const _0x12c067 = _0x2b3d5e; if (!_0x575c0b || _0x575c0b[_0x12c067(0x1fb)] !== _0x12c067(0x680)) return; const _0x579889 = _0x12c067(0x54d); document[_0x12c067(0x7f1)][_0x12c067(0x107)](_0x12c067(0x903), _0x579889); const _0xf5505e = document[_0x12c067(0x1f3)](_0x12c067(0x61b)), _0x4ca354 = _0xf5505e[_0x12c067(0x249)]('.choice-modal-backdrop'), _0x4a8796 = document[_0x12c067(0x1f3)](_0x12c067(0x732)), _0x285aa0 = document[_0x12c067(0x1f3)](_0x12c067(0x2ee)), _0x1a4433 = document['getElementById'](_0x12c067(0x860)), _0x5c3fb6 = document[_0x12c067(0x1f3)]('group-delete'), _0x596608 = document[_0x12c067(0x1f3)](_0x12c067(0x1b3)), _0x4a223f = () => _0xf5505e[_0x12c067(0x154)](); _0x4a8796[_0x12c067(0x3eb)]('click', async () => { const _0x4fb438 = _0x12c067; _0x4a223f(); const _0x2414c2 = await _0x21bcbb(_0x4fb438(0x2b2) + _0x575c0b[_0x4fb438(0x908)] + _0x4fb438(0x373)); if (_0x2414c2) { if (_0x4fb438(0x2e0) === _0x4fb438(0x2e0)) { _0x575c0b['id'] === _0x79fbb7[_0x4fb438(0x4d8)] && (_0xcd627f(), _0x79fbb7['conversationHistory'] = [], _0xd4cd2d()); try { localStorage['removeItem'](_0x4fb438(0x5cc) + _0x575c0b['id']), _0x30a64e(_0x4fb438(0x5ca) + _0x575c0b[_0x4fb438(0x908)] + '\x22\x20的聊天记录已清空。'); } catch (_0x695598) { console[_0x4fb438(0x412)](_0x4fb438(0x466) + _0x575c0b['id'], _0x695598), _0x30a64e(_0x4fb438(0x657)); } } else _0x2e754e['error'](_0x4fb438(0x3f5), _0x3af5d3), _0x2cd237[_0x4fb438(0x324)]['backgroundImage'] = ''; } }), _0x285aa0['addEventListener']('click', () => { const _0x3f719e = _0x12c067; if (_0x3f719e(0x592) !== _0x3f719e(0x592)) { const _0x49a438 = _0x2f74e3[_0x3f719e(0x249)]('.load-more-btn'); if (_0x49a438) _0x49a438[_0x3f719e(0x154)](); } else _0x4a223f(), _0x30a64e(_0x3f719e(0x4ee)); }), _0x1a4433[_0x12c067(0x3eb)](_0x12c067(0x1a4), async () => { const _0x33bddd = _0x12c067; if ('WrVdN' === _0x33bddd(0x931)) { _0x4a223f(); const _0x3bff6e = prompt(_0x33bddd(0x1f6), _0x575c0b[_0x33bddd(0x908)]); _0x3bff6e && _0x3bff6e[_0x33bddd(0x538)]() && _0x3bff6e !== _0x575c0b[_0x33bddd(0x908)] && (_0x575c0b[_0x33bddd(0x908)] = _0x3bff6e['trim'](), _0x43a351(), _0x35866c(), _0x4afdf2(), _0x30a64e(_0x33bddd(0x69f) + _0x575c0b['name'] + '\x22。')); } else _0x4d95e0[_0x33bddd(0x412)](_0x33bddd(0x5f6), _0x41a211); }), _0x5c3fb6[_0x12c067(0x3eb)](_0x12c067(0x1a4), async () => { const _0x1275d7 = _0x12c067; _0x4a223f(); const _0x469812 = await _0x21bcbb('确定要删除群聊\x22' + _0x575c0b[_0x1275d7(0x908)] + _0x1275d7(0x532)); _0x469812 && (_0x312f6f(_0x575c0b['id']), _0x30a64e(_0x1275d7(0x5ca) + _0x575c0b[_0x1275d7(0x908)] + _0x1275d7(0x4e6)), _0x4fa91a(![])); }), _0x4ca354['addEventListener']('click', _0x4a223f), _0x596608[_0x12c067(0x3eb)]('click', _0x4a223f); } _0x348317['addEventListener'](_0x2b3d5e(0x1a4), () => { const _0x23b585 = _0x2b3d5e, _0x2569fa = _0x3f4d37(); if (_0x2569fa && _0x2569fa[_0x23b585(0x1fb)] === _0x23b585(0x91f)) _0x9c4cc7(_0x2569fa[_0x23b585(0x285)][0x0]); else _0x2569fa && _0x2569fa[_0x23b585(0x1fb)] === _0x23b585(0x680) && _0xecd4df(_0x2569fa['id']); }), _0x51655b[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x43e), _0x86f7a4 => { const _0x1a2dd7 = _0x2b3d5e; _0x86f7a4[_0x1a2dd7(0x251)] === _0x1a2dd7(0x786) && !_0x86f7a4[_0x1a2dd7(0x830)] && (_0x86f7a4['preventDefault'](), _0x2e4a87()); }); const _0x2c21be = () => _0x107ee9['classList']['remove'](_0x2b3d5e(0x920)); _0x5bd9ca['addEventListener'](_0x2b3d5e(0x1a4), _0x2c21be), _0x6c555c['addEventListener']('click', _0x2c21be), _0x158a5a[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0x2ed5a6 = _0x2b3d5e; _0x2ed5a6(0x633) !== _0x2ed5a6(0x18c) ? (_0x2c21be(), _0x9c4cc7()) : _0x465fe4[_0x2ed5a6(0x465)] = _0xc71a65[_0x2ed5a6(0x74f)]; }), _0x4e1596[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { _0x2c21be(), _0x202806(); }), _0x29db23[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0x2a7d89 = _0x2b3d5e; if ('HLpEL' === _0x2a7d89(0x3bc)) _0x465abb('chat', _0x2a7d89(0x64d)), _0x4fa91a(![]); else { const _0x25d15e = _0x4a89b0[_0x2a7d89(0x704)](_0x39a17e, 0x2); _0x25d15e[_0x2a7d89(0x7d0)] = () => _0x2b9f2b(_0x2a7d89(0x1a6)), _0x25d15e[_0x2a7d89(0x7eb)] = () => _0x5843d2(_0x25d15e[_0x2a7d89(0x6e4)]), _0x25d15e[_0x2a7d89(0x500)] = _0x45187a => { const _0x431602 = _0x2a7d89, _0x2cc4c1 = _0x45187a[_0x431602(0x381)][_0x431602(0x6e4)]; !_0x2cc4c1[_0x431602(0x7a0)][_0x431602(0x545)](_0x571e35) && _0x2cc4c1['createObjectStore'](_0x3488af, { 'keyPath': 'id' }), !_0x2cc4c1[_0x431602(0x7a0)][_0x431602(0x545)](_0x431602(0x6ec)) && _0x2cc4c1[_0x431602(0x8fc)](_0x431602(0x6ec), { 'keyPath': 'id' }); }; } }), _0x376a4f['addEventListener'](_0x2b3d5e(0x1a4), _0x2370f4), _0x570b0c['addEventListener'](_0x2b3d5e(0x1a4), () => { const _0x39ab73 = _0x2b3d5e; _0x39e70e[_0x39ab73(0x43d)][_0x39ab73(0x612)](_0x39ab73(0x920)), _0x39e70e[_0x39ab73(0x43d)][_0x39ab73(0x545)](_0x39ab73(0x920)) && (_0x143e84[_0x39ab73(0x144)] = _0x143e84[_0x39ab73(0x939)]); }), _0x6340b4[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => _0x26026c[_0x2b3d5e(0x1a4)]()); const _0x10cc73 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x570)); _0x26026c[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x3b3), _0x4bcfb3), _0x10cc73['addEventListener'](_0x2b3d5e(0x1a4), _0x5ec7f6), _0x30c677['addEventListener'](_0x2b3d5e(0x1a4), _0x28aed0), _0x2f81e5['addEventListener'](_0x2b3d5e(0x1a4), _0x273978), _0x1fac1e[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x36398a), _0x7c0f7e[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x34bc04), _0x2899ae[_0x2b3d5e(0x3eb)]('click', async () => { const _0x537615 = _0x2b3d5e; if ('PyHfK' !== 'gAUZN') { const _0x21319e = _0x4015c3[_0x537615(0x2ff)]; if (!_0x21319e) return; const _0x25b2a8 = _0x1249c2(_0x21319e); if (!_0x25b2a8) return; const _0x4c7495 = await _0x21bcbb(_0x537615(0x85f) + _0x25b2a8[_0x537615(0x908)] + _0x537615(0x483)); _0x4c7495 && (_0x3a509f(_0x21319e), _0x30a64e('角色“' + _0x25b2a8[_0x537615(0x908)] + _0x537615(0x271)), _0x465abb(_0x537615(0x59e), _0x537615(0x1e5)), _0x4fa91a(![])); } else _0x547d90(![]); }), _0x3693f4[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x266), () => { const _0x482236 = _0x2b3d5e, _0x4338e6 = _0x3693f4[_0x482236(0x2ff)]['trim']()[_0x482236(0x5ad)](_0x408a25); _0x4e0ad3[_0x482236(0x899)] = _0x4338e6; }); async function _0x25f637() { const _0xc99c2f = _0x2b3d5e; if ('rxFoN' === _0xc99c2f(0x88f)) { const _0x4748c5 = _0x3693f4[_0xc99c2f(0x2ff)]['trim'](), _0x400989 = _0x2e9e79['value']['trim'](); if (!_0x4748c5 || !_0x400989) { _0x30a64e(_0xc99c2f(0x53f)); return; } const _0x14d016 = _0x4748c5['replace'](/\/+$/, ''), _0x13658b = _0x14d016 + _0xc99c2f(0x76b); _0x4e0ad3[_0xc99c2f(0x899)] = !![], _0x4e0ad3[_0xc99c2f(0x5f4)] = '获取中…', _0x6c38e3[_0xc99c2f(0x43d)][_0xc99c2f(0x154)](_0xc99c2f(0x920)); try { const _0x4455a5 = await fetch(_0x13658b, { 'headers': { 'Authorization': _0xc99c2f(0x5cb) + _0xa58d56(_0x400989) } }); if (!_0x4455a5['ok']) throw new Error('服务器错误:\x20' + _0x4455a5[_0xc99c2f(0x3a3)]); const _0x53401b = await _0x4455a5[_0xc99c2f(0x1b0)](), _0x467ef9 = (_0x53401b[_0xc99c2f(0x8b3)] || _0x53401b)[_0xc99c2f(0x843)](_0x1f7734 => _0x1f7734['id'])['sort'](); _0x467ef9[_0xc99c2f(0x629)] > 0x0 ? (_0x6c38e3[_0xc99c2f(0x2f7)] = '', _0x467ef9['forEach'](_0x591206 => { const _0xb16714 = _0xc99c2f; if (_0xb16714(0x23c) !== _0xb16714(0x13d)) { const _0x53efcb = document[_0xb16714(0x4f8)](_0xb16714(0x8dc)); _0x53efcb[_0xb16714(0x5f4)] = _0x591206, _0x53efcb[_0xb16714(0x3eb)](_0xb16714(0x1a4), () => { const _0x4243d0 = _0xb16714; if ('Jlxnm' !== _0x4243d0(0x692)) _0x5f1053[_0x4243d0(0x2ff)] = _0x591206, _0x6c38e3[_0x4243d0(0x43d)][_0x4243d0(0x154)](_0x4243d0(0x920)); else { const _0x5ba41c = _0x1a9d40['getElementById'](_0x4243d0(0x48c)); _0x5ba41c[_0x4243d0(0x2f7)] = ''; if (_0x4848a8[_0x4243d0(0x32e)]['length'] === 0x0) { _0x5ba41c[_0x4243d0(0x2f7)] = _0x4243d0(0x5fa); return; } _0x5370d4[_0x4243d0(0x32e)][_0x4243d0(0x8f0)](_0x56539c => { const _0x2f87e9 = _0x4243d0, _0x1a86f2 = _0x3bb05d[_0x2f87e9(0x4f8)](_0x2f87e9(0x8dc)); _0x1a86f2[_0x2f87e9(0x1dc)] = _0x2f87e9(0x66d), _0x1a86f2[_0x2f87e9(0x78e)]['id'] = _0x56539c['id'], _0x1a86f2[_0x2f87e9(0x2f7)] = _0x2f87e9(0x6db) + _0x56539c[_0x2f87e9(0x908)] + _0x2f87e9(0x52f) + _0x56539c[_0x2f87e9(0x317)][_0x2f87e9(0x524)](0x0, 0x64) + '</div>\x0a\x20\x20\x20\x20', _0x1a86f2[_0x2f87e9(0x3eb)]('click', () => _0x55b51a(_0x56539c['id'])), _0x5ba41c['appendChild'](_0x1a86f2); }); } }), _0x6c38e3['appendChild'](_0x53efcb); } else _0xe17b2c[_0xb16714(0x1ab)]['name'] = _0x2927a1['value']['trim'](), _0x1895cd[_0xb16714(0x1ab)]['persona'] = _0x44370d[_0xb16714(0x2ff)][_0xb16714(0x538)](), _0x27563f(), _0x2634be(), _0x524269('个人资料已保存！'), _0x158806('settings', 'userProfile'); }), _0x6c38e3[_0xc99c2f(0x43d)]['add'](_0xc99c2f(0x920)), _0x30a64e(_0xc99c2f(0x243) + _0x467ef9[_0xc99c2f(0x629)] + '\x20个模型。')) : _0x30a64e(_0xc99c2f(0x5a4)); } catch (_0x12ca38) { _0x30a64e(_0xc99c2f(0x115) + _0x12ca38['message'] + _0xc99c2f(0x441)); } finally { _0x4e0ad3[_0xc99c2f(0x899)] = ![], _0x4e0ad3[_0xc99c2f(0x5f4)] = '获取'; } } else { const _0x10a03c = _0x54f300[0x1][_0xc99c2f(0x1c3)](/\\"/g, '\x22')[_0xc99c2f(0x1c3)](/\\n/g, '\x0a')['trim'](); if (_0x10a03c) _0x3537bb[_0xc99c2f(0x7d8)](_0x10a03c); } } _0x4e0ad3['addEventListener'](_0x2b3d5e(0x1a4), _0x3427aa => { const _0x45fed8 = _0x2b3d5e; _0x3427aa[_0x45fed8(0x4c8)](), _0x25f637(); }), document['addEventListener'](_0x2b3d5e(0x1a4), _0x2bfeac => { const _0x3cec12 = _0x2b3d5e; if (_0x3cec12(0x642) !== _0x3cec12(0x642)) _0x5ed77f[_0x3cec12(0x5f4)] = _0x1c9c63['name'], _0x1026a4[_0x3cec12(0x5f4)] = _0x3cec12(0x33d), _0x39236b(_0x15ca4f, _0x3cec12(0x4e9)); else { if (!_0x6c38e3['contains'](_0x2bfeac[_0x3cec12(0x381)]) && _0x2bfeac[_0x3cec12(0x381)] !== _0x5f1053 && _0x2bfeac[_0x3cec12(0x381)] !== _0x4e0ad3) { if (_0x3cec12(0x182) !== 'xWbap') { _0x20dced(_0x3cec12(0x1ab), _0x3cec12(0x7ca)); const _0x152637 = _0x1c048c[_0x3cec12(0x1f3)](_0x3cec12(0x8ba)); if (_0x13c77a) { const _0x89ed46 = _0x45d689['userProfiles'][_0x3cec12(0x2aa)](_0x16e077 => _0x16e077['id'] === _0x2d31d4); if (!_0x89ed46) return; _0xdfe0bf['getElementById'](_0x3cec12(0x93b))['value'] = _0x89ed46['id'], _0x4f9bac['getElementById'](_0x3cec12(0x6aa))[_0x3cec12(0x5f4)] = _0x3cec12(0x69e), _0x12a47e['getElementById'](_0x3cec12(0x84c))['value'] = _0x89ed46['name'], _0x4562c5[_0x3cec12(0x1f3)](_0x3cec12(0x142))[_0x3cec12(0x465)] = _0x89ed46[_0x3cec12(0x71c)], _0x61e5c6[_0x3cec12(0x1f3)](_0x3cec12(0x7e8))[_0x3cec12(0x2ff)] = _0x89ed46[_0x3cec12(0x6dc)], _0x152637[_0x3cec12(0x324)][_0x3cec12(0x7ab)] = _0x89ed46['id'] === _0x2334a0[_0x3cec12(0x4dd)] ? _0x3cec12(0x277) : _0x3cec12(0x53e); } else _0x4710fb['getElementById'](_0x3cec12(0x93b))[_0x3cec12(0x2ff)] = '', _0x1f264b[_0x3cec12(0x1f3)](_0x3cec12(0x6aa))[_0x3cec12(0x5f4)] = _0x3cec12(0x438), _0x2b215b[_0x3cec12(0x1f3)](_0x3cec12(0x84c))[_0x3cec12(0x2ff)] = '新用户\x20' + (_0x24e713[_0x3cec12(0x8d2)][_0x3cec12(0x629)] + 0x1), _0x1067cd['getElementById'](_0x3cec12(0x142))[_0x3cec12(0x465)] = _0x1968bc, _0x20fb00[_0x3cec12(0x1f3)](_0x3cec12(0x7e8))[_0x3cec12(0x2ff)] = '', _0x152637['style']['display'] = 'none'; } else _0x6c38e3[_0x3cec12(0x43d)][_0x3cec12(0x154)](_0x3cec12(0x920)); } } }); async function _0x7c9580(_0x3ff645) { return await _0x40c94b(_0x3ff645, 0x190, 0.85); } _0x834305[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => _0x4f6f27['click']()), _0x4f6f27[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x3b3), async _0x3f306b => { const _0x2ac413 = _0x2b3d5e; if (_0x2ac413(0x6bf) !== 'OPkSr') { const _0x20d5ad = _0x3f306b['target']['files'][0x0]; if (!_0x20d5ad) return; try { if (_0x2ac413(0x34b) === _0x2ac413(0x34b)) { const _0x3a989c = await _0x7c9580(_0x20d5ad); _0x834305[_0x2ac413(0x465)] = _0x3a989c; } else { const _0x298aee = _0x181995[_0x2ac413(0x381)][_0x2ac413(0x78e)]['id']; _0x131d9a(_0x2ac413(0x421))[_0x2ac413(0x2cd)](_0x147f15 => { _0x147f15 && _0x589eed(_0x298aee); }); } } catch (_0x255394) { if (_0x2ac413(0x624) === _0x2ac413(0x624)) _0x30a64e(_0x2ac413(0x8f6) + _0x255394[_0x2ac413(0x227)]); else { const _0x3377c3 = _0x46eb62[_0x2ac413(0x317)]['match'](/：(.*?)]$/); _0xb5f2f7[_0x2ac413(0x317)] = '[sticker:' + (_0x3377c3 ? _0x3377c3[0x1] : _0x2ac413(0x91e)) + ']', _0x2aefa8['push'](_0x48ef9d); } } } else { const _0x34d84f = _0x59ba81[_0x2ac413(0x5ec)]('p'); _0x34d84f['forEach'](_0x31c55a => _0x31c55a[_0x2ac413(0x43d)][_0x2ac413(0x154)](_0x2ac413(0x4a8))); const _0x4aa362 = _0x231c77[_0x2ac413(0x1f3)](_0x2ac413(0x307) + _0x13f2b6); _0x4aa362 && (_0x4aa362[_0x2ac413(0x43d)]['add'](_0x2ac413(0x4a8)), _0x4aa362['scrollIntoView']({ 'behavior': _0x2ac413(0x478), 'block': 'center' })); } }), _0x415148[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => _0x1369c8[_0x2b3d5e(0x1a4)]()), _0x1369c8[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x3b3), async _0x25c977 => { const _0x3ce5b3 = _0x2b3d5e; if (_0x3ce5b3(0x293) === _0x3ce5b3(0x6a4)) { const _0x50e4ac = _0x557bc0[_0x3ce5b3(0xfc)](_0x3ce5b3(0x5cc) + _0x3066a3), _0x2340a0 = _0x475db1[_0x3ce5b3(0x4f6)](_0x50e4ac || '[]'); return _0x5dd174[_0x3ce5b3(0x660)](_0x2340a0) ? _0x2340a0 : []; } else { const _0x61c502 = _0x25c977[_0x3ce5b3(0x381)][_0x3ce5b3(0x5b7)][0x0]; if (!_0x61c502) return; try { _0x415148[_0x3ce5b3(0x465)] = await _0x7c9580(_0x61c502); } catch (_0x1cfdca) { _0x30a64e(_0x3ce5b3(0x8f6) + _0x1cfdca[_0x3ce5b3(0x227)]); } } }); function _0x5664b2() { const _0x17f228 = _0x2b3d5e; _0x17f228(0x256) === 'AVfNk' ? (_0x1ccd4a = _0x539de8[_0x17f228(0x71c)] || _0x22b68c, _0x4b6512 = _0x5651fb[_0x17f228(0x908)] || _0x17f228(0x5c5), _0x1abd78 = _0x275e8f[_0x17f228(0x2b1)] || '私聊') : (_0x39e70e[_0x17f228(0x2f7)] = '', _0x57edcf[_0x17f228(0x8f0)](_0x2cc1d6 => { const _0x1d9c6c = _0x17f228, _0x289ae1 = document[_0x1d9c6c(0x4f8)](_0x1d9c6c(0x8b4)); _0x289ae1[_0x1d9c6c(0x465)] = _0x2cc1d6[_0x1d9c6c(0x30d)], _0x289ae1[_0x1d9c6c(0x5f0)] = 'lazy', _0x289ae1[_0x1d9c6c(0x453)] = _0x2cc1d6[_0x1d9c6c(0x908)], _0x289ae1[_0x1d9c6c(0x43d)][_0x1d9c6c(0x20f)](_0x1d9c6c(0x22f)), _0x289ae1[_0x1d9c6c(0x3eb)](_0x1d9c6c(0x1a4), () => _0x1c24b7(_0x2cc1d6)), _0x39e70e[_0x1d9c6c(0x7b9)](_0x289ae1); })); } function _0x59b7d9() { const _0x301ddb = _0x2b3d5e; if ('iuOZh' === _0x301ddb(0x3d4)) { const _0x58ebed = document[_0x301ddb(0x1f3)]('user-profile-list-container'); _0x58ebed[_0x301ddb(0x2f7)] = ''; if (_0x79fbb7[_0x301ddb(0x8d2)][_0x301ddb(0x629)] === 0x0) { if (_0x301ddb(0x777) === _0x301ddb(0x777)) { _0x58ebed[_0x301ddb(0x2f7)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何用户资料，点击右上角“+”创建第一个。</p>'; return; } else _0x1a3f48(_0x1d38cf['id']); } _0x79fbb7[_0x301ddb(0x8d2)][_0x301ddb(0x8f0)](_0x110295 => { const _0x37ed7e = _0x301ddb; if ('iCRgA' === _0x37ed7e(0x533)) _0x15fa62 = _0x45b85f; else { const _0x48f7bb = document[_0x37ed7e(0x4f8)](_0x37ed7e(0x8dc)); _0x48f7bb[_0x37ed7e(0x1dc)] = _0x37ed7e(0x66d), _0x48f7bb[_0x37ed7e(0x78e)]['id'] = _0x110295['id']; const _0x343c1c = _0x110295['id'] === _0x79fbb7[_0x37ed7e(0x4dd)] ? _0x37ed7e(0x5ea) : ''; _0x48f7bb[_0x37ed7e(0x2f7)] = _0x37ed7e(0x7d9) + (_0x110295[_0x37ed7e(0x71c)] || _0x4f5e50) + _0x37ed7e(0x13a) + _0x110295[_0x37ed7e(0x908)] + _0x343c1c + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>' + _0x110295['persona'][_0x37ed7e(0x524)](0x0, 0x64) + _0x37ed7e(0x6cf), _0x48f7bb[_0x37ed7e(0x3eb)](_0x37ed7e(0x1a4), () => _0xf9d1f(_0x110295['id'])), _0x58ebed[_0x37ed7e(0x7b9)](_0x48f7bb); } }); } else _0x41edb8[_0x301ddb(0x5f4)] = '❚❚'; } function _0xf9d1f(_0x42e6d5 = null) { const _0x10a855 = _0x2b3d5e; if ('CYGkL' !== _0x10a855(0x63f)) { const _0x8c89aa = _0x261fef[_0x10a855(0x4f8)](_0x10a855(0x8dc)); _0x8c89aa['className'] = _0x10a855(0x47c); const _0xa74ded = _0x81e4e['createElement'](_0x10a855(0x8dc)); _0xa74ded['className'] = _0x10a855(0x7f4), _0xa74ded[_0x10a855(0x5f4)] = _0x46ed0b['quotedMessage'][_0x10a855(0x6bd)]; const _0x360101 = _0x2149fe[_0x10a855(0x4f8)]('div'); _0x360101[_0x10a855(0x1dc)] = _0x10a855(0x807), _0x360101[_0x10a855(0x5f4)] = _0x136c43['quotedMessage'][_0x10a855(0x317)], _0x8c89aa[_0x10a855(0x7b9)](_0xa74ded), _0x8c89aa[_0x10a855(0x7b9)](_0x360101), _0x67a635['appendChild'](_0x8c89aa); } else { _0x465abb('userProfile', 'userProfileList'); const _0x465920 = document[_0x10a855(0x1f3)](_0x10a855(0x8ba)); if (_0x42e6d5) { const _0x389dbd = _0x79fbb7[_0x10a855(0x8d2)]['find'](_0x486b47 => _0x486b47['id'] === _0x42e6d5); if (!_0x389dbd) return; document[_0x10a855(0x1f3)](_0x10a855(0x93b))[_0x10a855(0x2ff)] = _0x389dbd['id'], document[_0x10a855(0x1f3)](_0x10a855(0x6aa))[_0x10a855(0x5f4)] = _0x10a855(0x69e), document[_0x10a855(0x1f3)](_0x10a855(0x84c))[_0x10a855(0x2ff)] = _0x389dbd[_0x10a855(0x908)], document[_0x10a855(0x1f3)]('user-avatar-preview')[_0x10a855(0x465)] = _0x389dbd[_0x10a855(0x71c)], document[_0x10a855(0x1f3)](_0x10a855(0x7e8))['value'] = _0x389dbd[_0x10a855(0x6dc)], _0x465920[_0x10a855(0x324)][_0x10a855(0x7ab)] = _0x389dbd['id'] === _0x79fbb7[_0x10a855(0x4dd)] ? _0x10a855(0x277) : _0x10a855(0x53e); } else { if ('QMiJT' === _0x10a855(0x218)) { let _0x1c703c = _0x3fdc42[_0x10a855(0x538)](); const _0x237a26 = _0x1c703c[_0x10a855(0x5d3)](/(\[[\s\S]*\])/); _0x237a26 && (_0x1c703c = _0x237a26[0x1]); const _0x40867e = _0x4f0c8e[_0x10a855(0x4f6)](_0x1c703c); if (_0x2e0c85[_0x10a855(0x660)](_0x40867e)) { _0x48d52c['activeMeetingScriptQueue'] = _0x40867e, _0x1aa93d[_0x10a855(0x7ad)][_0x17d57a['id']] = [..._0x40867e], _0x1119e8(); const _0x5e8b5f = _0x40867e[_0x10a855(0x843)](_0x37022e => _0x37022e['speaker'] === 'narrator' ? _0x37022e[_0x10a855(0x844)] : _0x37022e[_0x10a855(0x806)] + ':\x20' + _0x37022e[_0x10a855(0x844)])[_0x10a855(0x26c)]('\x0a\x0a'); _0x5e9d67[_0x10a855(0x623)]['push']({ 'role': _0x10a855(0x2ea), 'senderId': _0x1412ed['id'], 'timestamp': _0x3039c4[_0x10a855(0x86b)](), 'isOffline': !![], 'content': _0x5e8b5f }); } } else document['getElementById']('editing-user-id')['value'] = '', document['getElementById']('user-profile-edit-title')['textContent'] = '创建新用户', document[_0x10a855(0x1f3)](_0x10a855(0x84c))[_0x10a855(0x2ff)] = _0x10a855(0x705) + (_0x79fbb7[_0x10a855(0x8d2)][_0x10a855(0x629)] + 0x1), document['getElementById'](_0x10a855(0x142))[_0x10a855(0x465)] = _0x4f5e50, document[_0x10a855(0x1f3)](_0x10a855(0x7e8))[_0x10a855(0x2ff)] = '', _0x465920['style'][_0x10a855(0x7ab)] = _0x10a855(0x277); } } } function _0x273978() { const _0x5bfe7a = _0x2b3d5e, _0x5d81d2 = document[_0x5bfe7a(0x1f3)]('editing-user-id')['value'], _0x1ceec2 = { 'name': document['getElementById'](_0x5bfe7a(0x84c))[_0x5bfe7a(0x2ff)][_0x5bfe7a(0x538)](), 'persona': document[_0x5bfe7a(0x1f3)]('user-persona')['value']['trim'](), 'avatar': document[_0x5bfe7a(0x1f3)](_0x5bfe7a(0x142))['src'] }; if (!_0x1ceec2[_0x5bfe7a(0x908)]) { _0x30a64e('名字不能为空！'); return; } if (_0x5d81d2) { if (_0x5bfe7a(0x136) === _0x5bfe7a(0x136)) { const _0xa10de0 = _0x79fbb7[_0x5bfe7a(0x8d2)][_0x5bfe7a(0x2aa)](_0x5901b0 => _0x5901b0['id'] === _0x5d81d2); if (_0xa10de0) Object[_0x5bfe7a(0x2db)](_0xa10de0, _0x1ceec2); } else { if (!_0x1a586e || !_0x324850[_0x5bfe7a(0x5ad)](',')) return _0x7c5982; const _0x506349 = _0x5e2f37[_0x5bfe7a(0x1ae)](',')[_0x5bfe7a(0x843)](_0x2a3b18 => _0x2a3b18[_0x5bfe7a(0x538)]()); return _0x506349[_0x531200[_0x5bfe7a(0x2e7)](_0x21f79b[_0x5bfe7a(0x4dc)]() * _0x506349[_0x5bfe7a(0x629)])]; } } else { const _0x44b06c = { 'id': 'user_' + Date[_0x5bfe7a(0x86b)](), ..._0x1ceec2 }; _0x79fbb7['userProfiles']['push'](_0x44b06c), !_0x79fbb7[_0x5bfe7a(0x4dd)] && (_0x5bfe7a(0x336) !== 'sRJko' ? _0x79fbb7['activeUserProfileId'] = _0x44b06c['id'] : _0x3caa5b(_0x2df941[_0x5bfe7a(0x116)])[_0x5bfe7a(0x2cd)](_0x42d132 => { const _0x3d63e9 = _0x5bfe7a; if (_0x42d132) { const _0x1aacd4 = _0x9a415a['createObjectURL'](_0x42d132); _0x199c2b[_0x3d63e9(0x465)] = _0x1aacd4, _0x3a5764['onload'] = () => _0x44c08e[_0x3d63e9(0x1d7)](_0x1aacd4); } })); } _0x43a351(), _0x30a64e(_0x5bfe7a(0x713)), _0x59b7d9(), _0x465abb('userProfileList', _0x5bfe7a(0x1ab)); } async function _0x19aa72() { const _0x52dd28 = _0x2b3d5e; if ('hKQMp' === 'hKQMp') { const _0x46f0a7 = document[_0x52dd28(0x1f3)](_0x52dd28(0x93b))[_0x52dd28(0x2ff)]; if (!_0x46f0a7) return; if (_0x79fbb7[_0x52dd28(0x8d2)][_0x52dd28(0x629)] <= 0x1) { if ('frXGZ' === _0x52dd28(0x333)) { _0x3c7353(); const _0x1a3ac1 = _0x1700fc(_0x52dd28(0x1f6), _0x54de5c[_0x52dd28(0x908)]); _0x1a3ac1 && _0x1a3ac1[_0x52dd28(0x538)]() && _0x1a3ac1 !== _0x36ae5f[_0x52dd28(0x908)] && (_0xd014dd[_0x52dd28(0x908)] = _0x1a3ac1[_0x52dd28(0x538)](), _0x230339(), _0x1a957c(), _0x3fae13(), _0x19611c(_0x52dd28(0x69f) + _0x4210af['name'] + '\x22。')); } else { _0x30a64e(_0x52dd28(0x655)); return; } } const _0xdf28ad = await _0x21bcbb(_0x52dd28(0x3e1)); _0xdf28ad && (_0x79fbb7[_0x52dd28(0x8d2)] = _0x79fbb7[_0x52dd28(0x8d2)][_0x52dd28(0x6a6)](_0x1ea959 => _0x1ea959['id'] !== _0x46f0a7), _0x79fbb7[_0x52dd28(0x4dd)] === _0x46f0a7 && (_0x52dd28(0x12d) !== _0x52dd28(0x683) ? _0x79fbb7[_0x52dd28(0x4dd)] = _0x79fbb7[_0x52dd28(0x8d2)][0x0]['id'] : (_0x36ddfd['preventDefault'](), _0x24ac21())), _0x79fbb7[_0x52dd28(0x4c9)][_0x52dd28(0x8f0)](_0x49ac6f => { const _0x53ebad = _0x52dd28; _0x49ac6f[_0x53ebad(0x536)] === _0x46f0a7 && (_0x49ac6f[_0x53ebad(0x536)] = _0x79fbb7[_0x53ebad(0x4dd)]); }), _0x43a351(), _0x30a64e('用户已删除。'), _0x59b7d9(), _0x465abb(_0x52dd28(0x7ca), 'userProfile')); } else _0x13f2ea[_0x52dd28(0x865)] = null, _0x592f2d(), _0x1567fd(_0x52dd28(0x1f4)), _0x17e896(), _0x11bf19[_0x52dd28(0x43d)][_0x52dd28(0x154)]('show'), _0x285a7e(() => _0x4324c8[_0x52dd28(0x324)][_0x52dd28(0x7ab)] = _0x52dd28(0x277), 0x12c); } function _0x2bd81f() { const _0x5c6a28 = _0x2b3d5e; if ('EuQdg' !== 'IBZnd') { const _0x705734 = document[_0x5c6a28(0x1f3)](_0x5c6a28(0x48c)); _0x705734['innerHTML'] = ''; if (_0x79fbb7[_0x5c6a28(0x32e)][_0x5c6a28(0x629)] === 0x0) { _0x705734['innerHTML'] = _0x5c6a28(0x5fa); return; } _0x79fbb7[_0x5c6a28(0x32e)][_0x5c6a28(0x8f0)](_0xe793d9 => { const _0x177667 = _0x5c6a28; if (_0x177667(0x196) !== _0x177667(0x360)) { const _0x212df9 = document[_0x177667(0x4f8)]('div'); _0x212df9[_0x177667(0x1dc)] = _0x177667(0x66d), _0x212df9[_0x177667(0x78e)]['id'] = _0xe793d9['id'], _0x212df9['innerHTML'] = _0x177667(0x6db) + _0xe793d9['name'] + _0x177667(0x52f) + _0xe793d9['content'][_0x177667(0x524)](0x0, 0x64) + _0x177667(0x637), _0x212df9[_0x177667(0x3eb)](_0x177667(0x1a4), () => _0x26c6f7(_0xe793d9['id'])), _0x705734[_0x177667(0x7b9)](_0x212df9); } else _0x1bffec(_0x177667(0x559)); }); } else { if (_0x10a705) _0x9f8e00[_0x5c6a28(0x1a4)](); } } function _0x26c6f7(_0x28a613 = null) { const _0x3bafb9 = _0x2b3d5e; _0x465abb(_0x3bafb9(0x659), 'worldBook'); if (_0x28a613) { const _0x271018 = _0x79fbb7[_0x3bafb9(0x32e)][_0x3bafb9(0x2aa)](_0x271887 => _0x271887['id'] === _0x28a613); if (!_0x271018) return; document[_0x3bafb9(0x1f3)](_0x3bafb9(0x893))[_0x3bafb9(0x2ff)] = _0x271018['id'], document[_0x3bafb9(0x1f3)](_0x3bafb9(0x428))[_0x3bafb9(0x5f4)] = '编辑条目', document[_0x3bafb9(0x1f3)](_0x3bafb9(0x8ff))[_0x3bafb9(0x2ff)] = _0x271018[_0x3bafb9(0x908)], document[_0x3bafb9(0x1f3)](_0x3bafb9(0x5a6))[_0x3bafb9(0x2ff)] = _0x271018[_0x3bafb9(0x317)]; } else { if (_0x3bafb9(0x87e) === _0x3bafb9(0x2ae)) { if (_0x2659d6[_0x3bafb9(0x381)][_0x3bafb9(0x43d)][_0x3bafb9(0x545)](_0x3bafb9(0x701))) { const _0x4aa2ef = _0x1927db[_0x3bafb9(0x381)][_0x3bafb9(0x78e)]['id']; _0x117f94(_0x3bafb9(0x421))[_0x3bafb9(0x2cd)](_0x48641d => { _0x48641d && _0x119004(_0x4aa2ef); }); } } else document['getElementById']('editing-world-book-id')[_0x3bafb9(0x2ff)] = '', document[_0x3bafb9(0x1f3)](_0x3bafb9(0x428))[_0x3bafb9(0x5f4)] = '新建条目', document[_0x3bafb9(0x1f3)](_0x3bafb9(0x8ff))[_0x3bafb9(0x2ff)] = '', document['getElementById'](_0x3bafb9(0x5a6))['value'] = ''; } } function _0x56738b() { const _0x2c05fc = _0x2b3d5e, _0x5009a3 = document[_0x2c05fc(0x1f3)](_0x2c05fc(0x893))[_0x2c05fc(0x2ff)], _0x61bc5d = document[_0x2c05fc(0x1f3)](_0x2c05fc(0x8ff))[_0x2c05fc(0x2ff)][_0x2c05fc(0x538)](), _0x4a3d2b = document['getElementById'](_0x2c05fc(0x5a6))[_0x2c05fc(0x2ff)]['trim'](); if (!_0x61bc5d || !_0x4a3d2b) { _0x30a64e('条目名称和内容都不能为空！'); return; } if (_0x5009a3) { const _0x3d1681 = _0x79fbb7[_0x2c05fc(0x32e)]['find'](_0x29c005 => _0x29c005['id'] === _0x5009a3); _0x3d1681 && (_0x3d1681['name'] = _0x61bc5d, _0x3d1681[_0x2c05fc(0x317)] = _0x4a3d2b); } else { if (_0x2c05fc(0x11c) !== _0x2c05fc(0x1b2)) { const _0x50bdcb = { 'id': 'wb_' + Date['now'](), 'name': _0x61bc5d, 'content': _0x4a3d2b }; _0x79fbb7['worldBooks'][_0x2c05fc(0x7d8)](_0x50bdcb); } else _0x156aa6[_0x2c05fc(0x412)]('在准备API数据时，从IndexedDB读取图片失败:', _0x219358); } _0x43a351(), _0x30a64e(_0x2c05fc(0x74a)), _0x2bd81f(), _0x465abb(_0x2c05fc(0x8bf), 'worldBookEditor'); } async function _0x5899fb() { const _0x55310a = _0x2b3d5e, _0xeaaa6a = document[_0x55310a(0x1f3)](_0x55310a(0x893))[_0x55310a(0x2ff)]; if (!_0xeaaa6a) return; const _0x1646aa = await _0x21bcbb(_0x55310a(0x5c2)); _0x1646aa && (_0x79fbb7[_0x55310a(0x32e)] = _0x79fbb7[_0x55310a(0x32e)]['filter'](_0x2f91d2 => _0x2f91d2['id'] !== _0xeaaa6a), _0x79fbb7[_0x55310a(0x44f)][_0x55310a(0x8f0)](_0x1aded7 => { const _0x2c49ed = _0x55310a; _0x2c49ed(0x48b) === _0x2c49ed(0x914) ? _0x5975f1['value'] = '' : _0x1aded7['linkedWorldBookIds'] && (_0x1aded7[_0x2c49ed(0x444)] = _0x1aded7[_0x2c49ed(0x444)][_0x2c49ed(0x6a6)](_0x4b19e3 => _0x4b19e3 !== _0xeaaa6a)); }), _0x43a351(), _0x30a64e(_0x55310a(0x24c)), _0x2bd81f(), _0x465abb(_0x55310a(0x8bf), _0x55310a(0x659))); } function _0x99a5cc() { const _0x1f031a = _0x2b3d5e, _0x12f295 = document['getElementById'](_0x1f031a(0x294)), _0x180b5f = _0x12f295[_0x1f031a(0x5ec)](_0x1f031a(0x5b6)), _0x4e60cb = document[_0x1f031a(0x249)]('.selected-options-text'); if (_0x180b5f[_0x1f031a(0x629)] === 0x0) _0x4e60cb[_0x1f031a(0x5f4)] = '--\x20点击选择\x20--'; else { if (_0x180b5f['length'] > 0x2) { if (_0x1f031a(0x5be) !== _0x1f031a(0x5be)) { if (!_0x4d5c22) return []; const _0x20f0a2 = _0x12c80a(_0x295830)[_0x1f031a(0x538)](), _0x4ff53d = _0x20f0a2[_0x1f031a(0x1ae)](/(?<=[。！？!?…])\s+|[\r\n]+/)[_0x1f031a(0x843)](_0x9c2ec8 => _0x9c2ec8[_0x1f031a(0x538)]())[_0x1f031a(0x6a6)](_0x6c17fe); if (_0x4ff53d[_0x1f031a(0x629)] > 0x0) return _0x4ff53d[_0x1f031a(0x45b)](0x0, 0x9); return [_0x20f0a2][_0x1f031a(0x6a6)](_0x428f2d); } else _0x4e60cb['textContent'] = _0x1f031a(0x234) + _0x180b5f[_0x1f031a(0x629)] + '\x20项'; } else _0x4e60cb[_0x1f031a(0x5f4)] = Array[_0x1f031a(0x910)](_0x180b5f)[_0x1f031a(0x843)](_0x3faabd => _0x3faabd[_0x1f031a(0x216)]['textContent']['trim']())[_0x1f031a(0x26c)]('、'); } } function _0xecd4df(_0x4ba13f) { const _0x3e8972 = _0x2b3d5e, _0x4d9abe = _0x79fbb7[_0x3e8972(0x4c9)]['find'](_0x1960ee => _0x1960ee['id'] === _0x4ba13f); if (!_0x4d9abe || _0x4d9abe['type'] !== 'group') return; document['getElementById']('group-settings-name')[_0x3e8972(0x2ff)] = _0x4d9abe['name'] || '', _0x4fccb4(_0x3e8972(0x5ce)), document[_0x3e8972(0x1f3)](_0x3e8972(0x5ce))['value'] = _0x4d9abe[_0x3e8972(0x536)] || _0x79fbb7['activeUserProfileId']; const _0x268b01 = document[_0x3e8972(0x1f3)](_0x3e8972(0x65e)); _0x268b01[_0x3e8972(0x2f7)] = '', _0x79fbb7[_0x3e8972(0x32e)][_0x3e8972(0x8f0)](_0x190feb => { const _0x1d24f8 = _0x3e8972; if (_0x1d24f8(0x2c3) === _0x1d24f8(0x2c3)) { const _0x759ac3 = _0x4d9abe[_0x1d24f8(0x444)]?.[_0x1d24f8(0x5ad)](_0x190feb['id']), _0x41f1ad = document[_0x1d24f8(0x4f8)](_0x1d24f8(0x1e6)); _0x41f1ad[_0x1d24f8(0x2f7)] = '<input\x20type=\x22checkbox\x22\x20value=\x22' + _0x190feb['id'] + '\x22\x20' + (_0x759ac3 ? _0x1d24f8(0x38e) : '') + '>\x20' + _0x190feb[_0x1d24f8(0x908)], _0x268b01[_0x1d24f8(0x7b9)](_0x41f1ad); } else { const _0x423b8d = { 'id': _0x1d24f8(0x725) + _0xa05e0a[_0x1d24f8(0x86b)]() + '_' + _0x21d3b9[_0x1d24f8(0x4dc)](), 'name': _0x47c95e['name'], 'content': _0x167f44['content'] }; _0x47b578[_0x1d24f8(0x32e)][_0x1d24f8(0x7d8)](_0x423b8d), _0x1c48de[_0x1d24f8(0x7d8)](_0x423b8d['id']); } }), _0x320938(); const _0x276c93 = document[_0x3e8972(0x1f3)](_0x3e8972(0x649)), _0x412c3a = document[_0x3e8972(0x1f3)](_0x3e8972(0x23d)); _0x3db342('group_avatar_' + _0x4ba13f)[_0x3e8972(0x2cd)](_0x5447ec => { const _0x5d49a0 = _0x3e8972; _0x276c93[_0x5d49a0(0x465)] = _0x5447ec ? URL[_0x5d49a0(0x4af)](_0x5447ec) : _0x426b80; }), _0x3db342('group_bg_' + _0x4ba13f)['then'](_0x4f6ff3 => { const _0x1619ce = _0x3e8972; _0x412c3a[_0x1619ce(0x465)] = _0x4f6ff3 ? URL[_0x1619ce(0x4af)](_0x4f6ff3) : ''; }), _0x465abb(_0x3e8972(0x28b), 'chat'); } async function _0x545542() { const _0x243c03 = _0x2b3d5e, _0xd9b445 = _0x3f4d37(); if (!_0xd9b445 || _0xd9b445[_0x243c03(0x1fb)] !== _0x243c03(0x680)) return; const _0x3ee99f = document[_0x243c03(0x1f3)](_0x243c03(0x513))['value'][_0x243c03(0x538)](); if (!_0x3ee99f) { _0x30a64e('群聊名称不能为空！'); return; } _0xd9b445[_0x243c03(0x908)] = _0x3ee99f; const _0x246d9a = document['querySelectorAll'](_0x243c03(0x589)); _0xd9b445[_0x243c03(0x444)] = Array['from'](_0x246d9a)[_0x243c03(0x843)](_0x50ece2 => _0x50ece2['value']), _0xd9b445[_0x243c03(0x536)] = document[_0x243c03(0x1f3)](_0x243c03(0x5ce))[_0x243c03(0x2ff)]; const _0x29937e = document[_0x243c03(0x1f3)](_0x243c03(0x8cf))[_0x243c03(0x5b7)][0x0], _0x4cc9f5 = document[_0x243c03(0x1f3)](_0x243c03(0x321))['files'][0x0]; if (_0x29937e) await _0x43bf1f('group_avatar_' + _0xd9b445['id'], _0x29937e); if (_0x4cc9f5) await _0x43bf1f(_0x243c03(0x537) + _0xd9b445['id'], _0x4cc9f5); _0x43a351(), _0x4afdf2(), await _0x35866c(), _0x30a64e(_0x243c03(0x4db)), _0x465abb(_0x243c03(0x59e), 'groupSettings'); } function _0x320938() { const _0x482b15 = _0x2b3d5e, _0x576a8a = document[_0x482b15(0x1f3)](_0x482b15(0x65e)), _0x21b795 = _0x576a8a['querySelectorAll']('input:checked'), _0x507af3 = document[_0x482b15(0x249)](_0x482b15(0x804)); if (_0x21b795[_0x482b15(0x629)] === 0x0) _0x507af3[_0x482b15(0x5f4)] = _0x482b15(0x192); else _0x21b795['length'] > 0x2 ? _0x507af3[_0x482b15(0x5f4)] = _0x482b15(0x234) + _0x21b795['length'] + '\x20项' : _0x507af3['textContent'] = Array[_0x482b15(0x910)](_0x21b795)[_0x482b15(0x843)](_0x5814fa => _0x5814fa['parentElement'][_0x482b15(0x5f4)]['trim']())['join']('、'); } async function _0x4e7fd5() { const _0x4562d8 = _0x2b3d5e, _0x23c73f = _0x3f4d37(), _0x302abf = (_0x23c73f?.['participantIds'] || [])['map'](_0x1249c2)[_0x4562d8(0x6a6)](Boolean), _0x330bd8 = _0x1cdea5(_0x23c73f['id']); if (!_0x23c73f || _0x23c73f[_0x4562d8(0x1fb)] !== _0x4562d8(0x680) || _0x302abf[_0x4562d8(0x629)] < 0x2) return null; const _0x22a43e = _0x23c73f[_0x4562d8(0x444)] && _0x23c73f[_0x4562d8(0x444)][_0x4562d8(0x629)] > 0x0 ? _0x4562d8(0x85b) + _0x23c73f[_0x4562d8(0x444)][_0x4562d8(0x843)](_0x1c54af => _0x79fbb7[_0x4562d8(0x32e)][_0x4562d8(0x2aa)](_0x309bb9 => _0x309bb9['id'] === _0x1c54af))['filter'](Boolean)['map'](_0x1d5167 => _0x4562d8(0x171) + _0x1d5167[_0x4562d8(0x908)] + '\x0a' + _0x1d5167[_0x4562d8(0x317)])[_0x4562d8(0x26c)]('') : '', _0x4ac4d4 = _0x330bd8[_0x4562d8(0x6dc)] ? '\x0a\x0a#\x20关于群聊参与者“' + _0x330bd8[_0x4562d8(0x908)] + '”的补充信息\x0a' + _0x330bd8['persona'] : ''; let _0x302a07 = ''; const _0x46432e = new Date(), _0x4d26bd = _0x79fbb7[_0x4562d8(0x623)]['at'](-0x1); _0x302a07 += _0x4562d8(0x6be) + _0x46432e[_0x4562d8(0x52e)](_0x4562d8(0x805), { 'dateStyle': _0x4562d8(0x7ae), 'timeStyle': _0x4562d8(0x43f) }); if (_0x4d26bd) { const _0x55c845 = new Date(_0x4d26bd['timestamp']), _0x542b00 = Math[_0x4562d8(0x2e7)]((_0x46432e - _0x55c845) / (0x3e8 * 0x3c)); if (_0x542b00 < 0x5) _0x302a07 += _0x4562d8(0x310); else { if (_0x542b00 < 0x78) _0x302a07 += _0x4562d8(0x1c9) + _0x542b00 + _0x4562d8(0x736); else { const _0x5a3068 = Math[_0x4562d8(0x2e7)](_0x542b00 / 0x3c); if (_0x5a3068 < 0x30) _0x302a07 += '\x0a-\x20**对话状态**:\x20群里在' + _0x5a3068 + _0x4562d8(0x79f); else _0x302a07 += _0x4562d8(0x429) + Math['floor'](_0x5a3068 / 0x18) + _0x4562d8(0x459); } } } else 'jrNBC' === _0x4562d8(0x318) ? (_0x536203 = _0x1b9a6a[_0x4562d8(0x4f8)]('div'), _0x130ffa['id'] = _0x4562d8(0x731), _0x429bd0[_0x4562d8(0x7b9)](_0x84ed6d)) : _0x302a07 += _0x4562d8(0x4b3); const _0x3f38f4 = [..._0x79fbb7[_0x4562d8(0x623)]][_0x4562d8(0x67d)]()[_0x4562d8(0x2aa)](_0xaa595 => _0xaa595['role'] === _0x4562d8(0x721))?.[_0x4562d8(0x317)] || '', _0x2946df = _0x53fc84(_0x23c73f, _0x3f38f4), _0x1d96b4 = _0x79fbb7[_0x4562d8(0x623)]['slice'](-0x78), _0x3a432e = _0x57edcf[_0x4562d8(0x843)](_0x245b4d => _0x245b4d[_0x4562d8(0x908)]), _0x54465d = _0x582d84(), _0x1bd632 = _0x302abf[_0x4562d8(0x843)](_0x2d6a21 => { const _0x3324c0 = _0x4562d8; if ('yleas' === _0x3324c0(0x6d4)) { const { omniText: _0x380c63 } = _0x354941(_0x2d6a21['id'], _0x23c73f['id']), _0x4c6ecf = _0x3e3955(_0x2d6a21['id']), _0x194a37 = _0x2d6a21['linkedWorldBookIds'] && _0x2d6a21[_0x3324c0(0x444)][_0x3324c0(0x629)] > 0x0 ? _0x3324c0(0x611) + _0x2d6a21[_0x3324c0(0x908)] + _0x3324c0(0x4a3) + _0x2d6a21[_0x3324c0(0x444)][_0x3324c0(0x843)](_0x4f8b65 => _0x79fbb7[_0x3324c0(0x32e)][_0x3324c0(0x2aa)](_0x3b7f8c => _0x3b7f8c['id'] === _0x4f8b65))[_0x3324c0(0x6a6)](Boolean)['map'](_0x38cc6a => '\x0a##\x20条目:\x20' + _0x38cc6a['name'] + '\x0a' + _0x38cc6a[_0x3324c0(0x317)])['join']('') : ''; return { 'id': _0x2d6a21['id'], 'name': _0x2d6a21[_0x3324c0(0x908)], 'persona': _0x2d6a21['persona'] || _0x3324c0(0x489), 'memory': _0x380c63 + _0x4c6ecf + _0x194a37 }; } else return _0x72442a[_0x3324c0(0x70a)][_0x3324c0(0x843)](_0x12be12 => typeof _0x12be12 === _0x3324c0(0x873) ? _0x12be12 : _0x12be12?.[_0x3324c0(0x317)])[_0x3324c0(0x6a6)](_0x32f84c)['flatMap'](_0x1a782e); }), _0x2d33b7 = 0x5, _0x4423bc = 0xc, _0x1b391e = _0x4562d8(0x542)['trim'](), _0x3a9239 = { 'instruction': (_0x4562d8(0x86a) + (_0x330bd8['name'] || '用户') + _0x4562d8(0x2e5) + (_0x330bd8[_0x4562d8(0x908)] || '用户') + _0x4562d8(0x414) + _0x2d33b7 + _0x4562d8(0x897) + _0x4423bc + _0x4562d8(0x167) + (_0x330bd8['name'] || '用户') + _0x4562d8(0x413) + _0x302a07 + '\x20\x0a' + _0x4ac4d4 + '\x0a' + _0x22a43e + _0x4562d8(0x774) + _0x54465d + '\x0a')['trim'](), 'personas': _0x1bd632, 'mentioned': _0x2946df ? { 'id': _0x2946df['id'], 'name': _0x2946df[_0x4562d8(0x908)] } : null, 'stickerList': _0x3a432e }, _0x48902c = { 'type': 'object', 'properties': { 'events': { 'type': _0x4562d8(0x364), 'items': { 'type': _0x4562d8(0x22a), 'required': [_0x4562d8(0x14b), _0x4562d8(0x7f6)], 'properties': { 'senderId': { 'type': 'string' }, 'kind': { 'type': _0x4562d8(0x873), 'enum': [_0x4562d8(0x6b3), _0x4562d8(0x57e), 'music'] }, 'content': { 'type': _0x4562d8(0x873) }, 'sticker': { 'type': _0x4562d8(0x873) }, 'songName': { 'type': _0x4562d8(0x873) }, 'artist': { 'type': 'string' } } } } }, 'required': [_0x4562d8(0x61e)] }, _0x17fd2e = []; _0x17fd2e['push']({ 'role': _0x4562d8(0x35f), 'content': _0x1b391e }); for (const _0x1c1dd8 of _0x1d96b4) { const _0xce0e6f = _0x1c1dd8[_0x4562d8(0x5f2)] === 'ai' || _0x1c1dd8[_0x4562d8(0x5f2)] === _0x4562d8(0x2ea) ? 'assistant' : 'user'; let _0x9518da = { 'role': _0xce0e6f, 'content': _0x1c1dd8[_0x4562d8(0x317)] }, _0x1c0119 = !!_0x1c1dd8['content'], _0x55f3d9 = null; if (_0x1c1dd8[_0x4562d8(0x74f)]) _0x55f3d9 = _0x1c1dd8['image']; else { if (_0x1c1dd8[_0x4562d8(0x116)]) try { if (_0x4562d8(0x750) === 'ipMPC') { const _0x5e7bc2 = await _0x3db342(_0x1c1dd8[_0x4562d8(0x116)]); _0x5e7bc2 && (_0x55f3d9 = await _0x3b4f2c(_0x5e7bc2)); } else _0x175139[_0x4562d8(0x412)](_0x4562d8(0x208) + _0x2afff6['id'], _0xfbad18); } catch (_0x24d104) { console[_0x4562d8(0x412)]('在准备群聊API数据时，读取图片失败:', _0x24d104); } } _0x55f3d9 && (_0x4562d8(0x3ff) !== _0x4562d8(0x7ee) ? (_0x9518da[_0x4562d8(0x74f)] = _0x55f3d9, _0x1c0119 = !![]) : _0x442e19[_0x4562d8(0x54a)]('musicPlayerState', _0x3df53a[_0x4562d8(0x4de)]({ 'playlist': _0x47da8e['musicPlaylist'], 'currentIndex': _0x42f486[_0x4562d8(0x51f)] }))); if (_0x1c0119) { if (_0x4562d8(0x832) === _0x4562d8(0x8f3)) return { 'type': 'sticker', 'name': _0x2702a8[0x1][_0x4562d8(0x538)]() }; else _0x17fd2e['push'](_0x9518da); } } _0x17fd2e[_0x4562d8(0x7d8)]({ 'role': _0x4562d8(0x721), 'content': '请严格按照以下SCHEMA返回一个JSON对象，不要包含任何额外文字。\x0aSCHEMA:\x0a' + JSON[_0x4562d8(0x4de)](_0x48902c) + _0x4562d8(0x8b9) + JSON[_0x4562d8(0x4de)](_0x3a9239) }); try { if (_0x4562d8(0x593) === _0x4562d8(0x338)) { _0x372267[_0x4562d8(0x4c9)] = _0x1fb9ac[_0x4562d8(0x4c9)][_0x4562d8(0x6a6)](_0x3a231a => _0x3a231a['id'] !== _0x27d535); try { _0x5ccef4[_0x4562d8(0x847)](_0x4562d8(0x5cc) + _0x4f73cf); } catch (_0x1e9b9f) { _0x2e4ee3['error'](_0x4562d8(0x208) + _0x3b5f90, _0x1e9b9f); } _0x4b2827[_0x4562d8(0x4d8)] === _0x4024db && (_0x1e380d[_0x4562d8(0x4d8)] = _0x3cbef8[_0x4562d8(0x4c9)][0x0]?.['id'] || null, _0x180860(_0x244316[_0x4562d8(0x4d8)])), _0x22cc4c(), _0x373506(); } else { const _0x5cc176 = await _0x53d2f8(_0x17fd2e, { 'json': !![] }); if (!_0x5cc176) return null; let _0x3f6cc1 = _0x5cc176[_0x4562d8(0x538)](); const _0x32b0fb = _0x3f6cc1[_0x4562d8(0x5d3)](/```json([\s\S]*?)```/i); if (_0x32b0fb) _0x3f6cc1 = _0x32b0fb[0x1]['trim'](); _0x3f6cc1 = _0x139f46(_0x3f6cc1); let _0x2fdadf = null; try { _0x2fdadf = JSON['parse'](_0x3f6cc1); } catch (_0x365f1e) { console['error'](_0x4562d8(0x886), _0x365f1e), console[_0x4562d8(0x412)](_0x4562d8(0x744), _0x3f6cc1); } if (!_0x2fdadf || !Array[_0x4562d8(0x660)](_0x2fdadf[_0x4562d8(0x61e)])) return null; return _0x2fdadf = _0x20e1bd(_0x2fdadf, _0x302abf, _0x3a432e), _0x2fdadf[_0x4562d8(0x61e)] = _0x2fdadf[_0x4562d8(0x61e)][_0x4562d8(0x45b)](0x0, _0x4423bc), _0x2fdadf[_0x4562d8(0x61e)][_0x4562d8(0x629)] ? _0x2fdadf : null; } } catch (_0x33e748) { if (_0x4562d8(0x7a6) !== _0x4562d8(0x7a6)) _0x340c2b(), _0x17cafc(_0x4562d8(0x1c8), 'home'); else { if (_0x33e748['name'] !== _0x4562d8(0x7e4)) { if (_0x4562d8(0x547) !== _0x4562d8(0x5dd)) console[_0x4562d8(0x412)]('Failed\x20to\x20plan\x20group\x20replies:', _0x33e748); else { const _0x297657 = _0x381995[_0x4562d8(0x1f3)]('toast'); _0x297657['textContent'] = _0x2e7dfc, _0x297657[_0x4562d8(0x324)][_0x4562d8(0x7ab)] = _0x4562d8(0x53e); if (_0x5eca03['_t']) _0x1eec82(_0x4b867c['_t']); _0xb4ba00['_t'] = _0x5de208(() => { const _0x78ee30 = _0x4562d8; _0x297657[_0x78ee30(0x324)][_0x78ee30(0x7ab)] = 'none'; }, 0x640); } } return null; } } } function _0xa61b9f() { const _0x5d7431 = _0x2b3d5e, _0x43f8a6 = document[_0x5d7431(0x1f3)](_0x5d7431(0x4ad)); _0x43f8a6[_0x5d7431(0x2f7)] = ''; if (_0x79fbb7[_0x5d7431(0x70f)]['length'] === 0x0) { _0x43f8a6['innerHTML'] = _0x5d7431(0x1b9); return; } _0x79fbb7['friendCircles']['forEach'](_0x395a2f => { const _0x1c63c2 = _0x5d7431, _0x3e7ea4 = _0x79fbb7[_0x1c63c2(0x8d2)][_0x1c63c2(0x2aa)](_0x29858c => _0x29858c['id'] === _0x395a2f[_0x1c63c2(0x536)]) || { 'name': _0x1c63c2(0x3ea) }, _0x1416e0 = document[_0x1c63c2(0x4f8)](_0x1c63c2(0x8dc)); _0x1416e0[_0x1c63c2(0x1dc)] = _0x1c63c2(0x66d), _0x1416e0[_0x1c63c2(0x78e)]['id'] = _0x395a2f['id'], _0x1416e0[_0x1c63c2(0x2f7)] = '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>' + _0x395a2f[_0x1c63c2(0x908)] + '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20绑定的“我”:\x20' + _0x3e7ea4['name'] + '\x20|\x20' + _0x395a2f[_0x1c63c2(0x150)][_0x1c63c2(0x629)] + '\x20个成员\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', _0x1416e0['addEventListener'](_0x1c63c2(0x1a4), () => _0x47c9d6(_0x395a2f['id'])), _0x43f8a6['appendChild'](_0x1416e0); }); } function _0xea3a07(_0x59f864 = null) { const _0xa71ba9 = _0x2b3d5e, _0x2331be = document[_0xa71ba9(0x1f3)](_0xa71ba9(0x133)), _0x21c6f1 = document['getElementById']('friend-circle-edit-bind-user'), _0x5744bb = document[_0xa71ba9(0x1f3)](_0xa71ba9(0x238)), _0x424085 = document[_0xa71ba9(0x1f3)]('friend-circle-edit-title'), _0x5e7469 = document[_0xa71ba9(0x1f3)](_0xa71ba9(0x233)), _0x2b1db8 = document['getElementById'](_0xa71ba9(0x7d1)); _0x4fccb4(_0xa71ba9(0x35d)), _0x5744bb['innerHTML'] = '', _0x79fbb7[_0xa71ba9(0x44f)][_0xa71ba9(0x8f0)](_0x22a5c9 => { const _0x3ad2e2 = _0xa71ba9; if (_0x3ad2e2(0x65c) !== _0x3ad2e2(0x65c)) _0x337774[_0x3ad2e2(0x324)][_0x3ad2e2(0x6a7)] = _0x3ad2e2(0x8ce) + _0x31be64[_0x3ad2e2(0x4af)](_0x5c315a) + ')', _0x5ebeaf[_0x3ad2e2(0x324)][_0x3ad2e2(0x93f)] = _0x3ad2e2(0x876), _0x111fcb[_0x3ad2e2(0x324)][_0x3ad2e2(0x203)] = 'center'; else { const _0x32b32c = document['createElement']('div'); _0x32b32c[_0x3ad2e2(0x1dc)] = 'member-selection-item', _0x32b32c['innerHTML'] = _0x3ad2e2(0x197) + _0x22a5c9['id'] + _0x3ad2e2(0x36c) + _0x22a5c9['id'] + '\x22>\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x22a5c9[_0x3ad2e2(0x71c)] || _0x426b80) + _0x3ad2e2(0x66f) + _0x22a5c9['id'] + _0x3ad2e2(0x6c7) + _0x22a5c9['name'] + _0x3ad2e2(0x102), _0x5744bb[_0x3ad2e2(0x7b9)](_0x32b32c); } }); if (_0x59f864) { if (_0xa71ba9(0x3bf) !== _0xa71ba9(0x526)) { const _0x31a2f7 = _0x79fbb7['friendCircles'][_0xa71ba9(0x2aa)](_0x469b6a => _0x469b6a['id'] === _0x59f864); if (!_0x31a2f7) return; _0x424085[_0xa71ba9(0x5f4)] = _0xa71ba9(0x64b), _0x5e7469[_0xa71ba9(0x2ff)] = _0x31a2f7['id'], _0x2331be[_0xa71ba9(0x2ff)] = _0x31a2f7[_0xa71ba9(0x908)], _0x21c6f1[_0xa71ba9(0x2ff)] = _0x31a2f7[_0xa71ba9(0x536)], _0x2b1db8[_0xa71ba9(0x324)]['display'] = _0xa71ba9(0x53e), _0x31a2f7[_0xa71ba9(0x150)][_0xa71ba9(0x8f0)](_0x50d143 => { const _0x83a7d8 = _0xa71ba9, _0x34bcf0 = _0x5744bb[_0x83a7d8(0x249)]('#member-select-' + _0x50d143); if (_0x34bcf0) _0x34bcf0[_0x83a7d8(0x38e)] = !![]; }); } else _0x472fb6[_0xa71ba9(0x7d8)](_0x2a3389); } else _0xa71ba9(0x3c5) !== 'sxTug' ? (_0x424085[_0xa71ba9(0x5f4)] = _0xa71ba9(0x836), _0x5e7469[_0xa71ba9(0x2ff)] = '', _0x2331be['value'] = _0xa71ba9(0x20e) + (_0x79fbb7[_0xa71ba9(0x70f)]['length'] + 0x1), _0x21c6f1[_0xa71ba9(0x2ff)] = _0x79fbb7['activeUserProfileId'], _0x2b1db8[_0xa71ba9(0x324)]['display'] = _0xa71ba9(0x277)) : (_0x1873d9[_0xa71ba9(0x1f3)]('editing-world-book-id')[_0xa71ba9(0x2ff)] = '', _0xf17e52[_0xa71ba9(0x1f3)](_0xa71ba9(0x428))[_0xa71ba9(0x5f4)] = _0xa71ba9(0x32c), _0x1e25ba[_0xa71ba9(0x1f3)](_0xa71ba9(0x8ff))[_0xa71ba9(0x2ff)] = '', _0x4727ac['getElementById'](_0xa71ba9(0x5a6))[_0xa71ba9(0x2ff)] = ''); _0x465abb(_0xa71ba9(0x6de), _0xa71ba9(0x65b)); } function _0x2a920e() { const _0x111154 = _0x2b3d5e, _0x4dfff0 = document[_0x111154(0x1f3)](_0x111154(0x233))[_0x111154(0x2ff)], _0x2306cb = document[_0x111154(0x1f3)](_0x111154(0x133))[_0x111154(0x2ff)][_0x111154(0x538)](), _0x4957f3 = document[_0x111154(0x1f3)](_0x111154(0x35d))[_0x111154(0x2ff)], _0x5886e6 = Array[_0x111154(0x910)](document[_0x111154(0x5ec)](_0x111154(0x1c7)))[_0x111154(0x843)](_0x117042 => _0x117042['dataset']['id']); if (!_0x2306cb) { if (_0x111154(0x846) === _0x111154(0x677)) { const _0x12a587 = _0x19c091[_0x111154(0x1f3)](_0xcbae00); if (_0x12a587 && _0xfa7529) _0x12a587[_0x111154(0x465)] = _0xe30c85[_0x111154(0x4af)](_0x491b61); } else { _0x30a64e(_0x111154(0x1fe)); return; } } if (_0x5886e6['length'] === 0x0) { _0x30a64e('至少要选择一个圈内成员！'); return; } if (_0x4dfff0) { const _0x4cd27c = _0x79fbb7[_0x111154(0x70f)]['find'](_0xbb0977 => _0xbb0977['id'] === _0x4dfff0); _0x4cd27c && (_0x111154(0x32a) === _0x111154(0x32a) ? (_0x4cd27c[_0x111154(0x908)] = _0x2306cb, _0x4cd27c[_0x111154(0x536)] = _0x4957f3, _0x4cd27c['memberCharacterIds'] = _0x5886e6) : (_0x1d0ceb(), _0x3225be[_0x111154(0x623)] = [], _0x30ed33())); } else { if (_0x111154(0x63b) !== _0x111154(0x63b)) { const _0x572ed2 = _0x43927e['parse'](_0xa028bb); _0x2af1bc['isArray'](_0x572ed2) && (_0x39a87a = _0x572ed2[_0x111154(0x6a6)](_0x219aaa => _0x219aaa && typeof _0x219aaa === _0x111154(0x22a) && typeof _0x219aaa['role'] === _0x111154(0x873) && typeof _0x219aaa[_0x111154(0x317)] !== _0x111154(0x71d))); } else { const _0x1fc897 = { 'id': 'circle_' + Date['now'](), 'name': _0x2306cb, 'boundUserProfileId': _0x4957f3, 'memberCharacterIds': _0x5886e6, 'posts': [] }; _0x79fbb7['friendCircles'][_0x111154(0x7d8)](_0x1fc897); } } _0x43a351(), _0x30a64e(_0x111154(0x2f4)), _0xa61b9f(), _0x465abb('friendCircleList', _0x111154(0x6de)); } async function _0x1d884e() { const _0x581335 = _0x2b3d5e, _0x59d317 = document[_0x581335(0x1f3)]('editing-friend-circle-id')[_0x581335(0x2ff)]; if (!_0x59d317) return; const _0x30a8f7 = await _0x21bcbb(_0x581335(0x15c)); _0x30a8f7 && (_0x79fbb7[_0x581335(0x70f)] = _0x79fbb7[_0x581335(0x70f)][_0x581335(0x6a6)](_0x4e8f99 => _0x4e8f99['id'] !== _0x59d317), _0x79fbb7['activeFriendCircleId'] === _0x59d317 && (_0x79fbb7[_0x581335(0x21d)] = null), _0x43a351(), _0x30a64e(_0x581335(0x890)), _0xa61b9f(), _0x465abb('friendCircleList', _0x581335(0x6de))); } function _0x47c9d6(_0x55d01e) { const _0x1d3c41 = _0x2b3d5e; _0xbf78cd(); const _0x38d058 = _0x79fbb7[_0x1d3c41(0x70f)][_0x1d3c41(0x2aa)](_0x371daa => _0x371daa['id'] === _0x55d01e); if (!_0x38d058) return; _0x79fbb7[_0x1d3c41(0x21d)] = _0x55d01e, _0x43a351(), document['getElementById'](_0x1d3c41(0x279))[_0x1d3c41(0x5f4)] = _0x38d058[_0x1d3c41(0x908)], _0x4ddb2a(), _0x465abb(_0x1d3c41(0x6fe), _0x1d3c41(0x65b)), _0x449415(); } function _0x4b8ed7() { const _0x2d17ab = _0x2b3d5e; if (!_0x79fbb7['friendCircles'] || _0x79fbb7[_0x2d17ab(0x70f)]['length'] === 0x0) { console[_0x2d17ab(0x412)]('错误：你还没有创建任何好友圈。请先在App内创建一个。'); return; } const _0xbb49fd = _0x79fbb7[_0x2d17ab(0x70f)][0x0]; if (_0xbb49fd[_0x2d17ab(0x150)][_0x2d17ab(0x629)] < 0x2) { console[_0x2d17ab(0x412)](_0x2d17ab(0x509) + _0xbb49fd['name'] + _0x2d17ab(0x599)); return; } const _0x146c1d = { 'id': _0x2d17ab(0x769) + Date[_0x2d17ab(0x86b)](), 'authorType': _0x2d17ab(0x6e2), 'authorId': _0xbb49fd[_0x2d17ab(0x150)][0x0], 'content': _0x2d17ab(0x259), 'timestamp': Date[_0x2d17ab(0x86b)](), 'likes': [_0xbb49fd['memberCharacterIds'][0x1]], 'comments': [{ 'commentId': 'c_' + Date[_0x2d17ab(0x86b)](), 'authorId': _0xbb49fd[_0x2d17ab(0x150)][0x1], 'content': _0x2d17ab(0x7d6) }] }; _0xbb49fd[_0x2d17ab(0x49e)]['push'](_0x146c1d), _0x43a351(), console[_0x2d17ab(0x257)]('成功向好友圈\x20\x22' + _0xbb49fd[_0x2d17ab(0x908)] + '\x22\x20添加了一条测试动态。请点击进入该好友圈查看效果。'), _0x30a64e(_0x2d17ab(0x430)); } window['addTestPost'] = _0x4b8ed7; function _0x4eadbd(_0x2ff109) { const _0x370699 = _0x2b3d5e; return _0x79fbb7[_0x370699(0x8d2)][_0x370699(0x2aa)](_0x3dee64 => _0x3dee64['id'] === _0x2ff109); } function _0x585d0a(_0x2cc19e, _0x8ad3a8 = '正在处理...') { const _0x5e0444 = _0x2b3d5e, _0x33a460 = document[_0x5e0444(0x1f3)]('phone-container'); let _0x100ee1 = document[_0x5e0444(0x1f3)](_0x5e0444(0x731)); _0x2cc19e ? (!_0x100ee1 && (_0x100ee1 = document[_0x5e0444(0x4f8)](_0x5e0444(0x8dc)), _0x100ee1['id'] = _0x5e0444(0x731), _0x33a460[_0x5e0444(0x7b9)](_0x100ee1)), _0x100ee1[_0x5e0444(0x2f7)] = _0x5e0444(0x6cd) + _0x8ad3a8 + _0x5e0444(0x885), _0x100ee1[_0x5e0444(0x324)][_0x5e0444(0x7ab)] = _0x5e0444(0x585)) : _0x5e0444(0x46e) !== _0x5e0444(0x46e) ? (_0x5dbd8e[_0x5e0444(0x412)](_0x5e0444(0x667), _0x88fad9), _0x465781(_0x5e0444(0x45c) + _0xa298cd['message'])) : _0x100ee1 && (_0x5e0444(0x6b8) === 'RykZZ' ? _0x5d05fd[_0x5e0444(0x821)]({ 'behavior': _0x5e0444(0x1c4), 'block': _0x5e0444(0x29e) }) : _0x100ee1[_0x5e0444(0x324)]['display'] = _0x5e0444(0x277)); } async function _0x10f40f() { const _0x58f5b4 = _0x2b3d5e, _0x2664fb = _0x79fbb7[_0x58f5b4(0x70f)][_0x58f5b4(0x2aa)](_0x87beae => _0x87beae['id'] === _0x79fbb7[_0x58f5b4(0x21d)]); if (!_0x2664fb || _0x79fbb7['isGenerating']) return; _0x585d0a(!![], _0x58f5b4(0x648)), _0x79fbb7[_0x58f5b4(0x8b0)] = !![]; try { if (_0x58f5b4(0x514) !== _0x58f5b4(0x551)) { let _0x3fdb6d = Date[_0x58f5b4(0x86b)](); _0x2664fb[_0x58f5b4(0x49e)] && _0x2664fb[_0x58f5b4(0x49e)]['length'] > 0x0 && (_0x58f5b4(0x6ca) !== _0x58f5b4(0x1e1) ? _0x3fdb6d = Math['max'](..._0x2664fb[_0x58f5b4(0x49e)]['map'](_0x79df0d => _0x79df0d[_0x58f5b4(0x68c)])) : (_0x971883[_0x58f5b4(0x465)] = _0x495443[_0x58f5b4(0x4af)](_0x2a3579), _0x1ae20f[_0x58f5b4(0x324)][_0x58f5b4(0x7ab)] = _0x58f5b4(0x53e))); const _0xaae94e = await _0x2e2f44(_0x2664fb); if (!_0xaae94e || _0xaae94e[_0x58f5b4(0x629)] === 0x0) { if (_0x58f5b4(0x734) !== _0x58f5b4(0x67a)) { _0x30a64e(_0x58f5b4(0x7f2)); return; } else _0x5e2a61[_0x58f5b4(0x43d)][_0x58f5b4(0x154)](_0x58f5b4(0x51b), _0x58f5b4(0x309)), _0x195150[_0x58f5b4(0x43d)][_0x58f5b4(0x154)](_0x58f5b4(0x855)), _0x15db17[_0x58f5b4(0x800)] = _0x3eac16, _0x153292(), _0x3fa626[_0x58f5b4(0x8b8)] = ![]; } const _0x417257 = _0xaae94e[_0x58f5b4(0x843)](async (_0x268347, _0x484023) => { const _0x22cfa0 = _0x58f5b4; _0x585d0a(!![], _0x22cfa0(0x1d8) + (_0x484023 + 0x1) + _0x22cfa0(0x1ba) + _0xaae94e[_0x22cfa0(0x629)] + _0x22cfa0(0x214)); const _0x64a09b = _0x3fdb6d + (_0x484023 + 0x1) * 0x3c * 0x3e8, _0x3d55f1 = { 'id': _0x22cfa0(0x40c) + _0x268347[_0x22cfa0(0x696)] + '_' + _0x64a09b, 'authorType': _0x22cfa0(0x6e2), 'authorId': _0x268347[_0x22cfa0(0x696)], 'content': _0x268347[_0x22cfa0(0x815)], 'timestamp': _0x64a09b, 'likes': _0x268347[_0x22cfa0(0x16c)] || [], 'comments': (_0x268347[_0x22cfa0(0x7c3)] || [])[_0x22cfa0(0x843)]((_0x348d0a, _0x397232) => ({ 'commentId': 'c_' + _0x64a09b + '_' + _0x397232, 'authorId': _0x348d0a[_0x22cfa0(0x696)], 'content': _0x348d0a['content'] })) }; if (_0x268347[_0x22cfa0(0x1cf)] === 'music' && _0x268347[_0x22cfa0(0x31c)] && _0x268347[_0x22cfa0(0x160)]) { if (_0x22cfa0(0x3d7) === 'vWGpY') try { const _0x356d1d = await _0x314a48(_0x268347['songName'], _0x268347[_0x22cfa0(0x160)]); _0x3d55f1[_0x22cfa0(0x1fb)] = _0x22cfa0(0x6fe), _0x3d55f1[_0x22cfa0(0x31c)] = _0x268347[_0x22cfa0(0x31c)], _0x3d55f1[_0x22cfa0(0x160)] = _0x268347['artist'], _0x3d55f1[_0x22cfa0(0x1d1)] = _0x356d1d[_0x22cfa0(0x876)], _0x3d55f1['playableUrl'] = _0x356d1d[_0x22cfa0(0x30d)]; } catch (_0x4069df) { if ('xKgCQ' !== 'qxJci') console[_0x22cfa0(0x412)](_0x22cfa0(0x35b), _0x4069df), _0x3d55f1['type'] = _0x22cfa0(0x6b3); else throw new _0x52a35f(_0x22cfa0(0x60c)); } else _0x53f322[_0x22cfa0(0x2f7)] = _0x5ad489; } else { if ('tVIMn' !== _0x22cfa0(0x137)) { _0x5572f3('我正在说话呢，别打岔！'); return; } else _0x3d55f1[_0x22cfa0(0x1fb)] = _0x22cfa0(0x6b3); } return _0x3d55f1; }), _0x1ce774 = await Promise['all'](_0x417257); _0x2664fb['posts'][_0x58f5b4(0x7d8)](..._0x1ce774), _0x43a351(); } else { const _0x5f28d2 = _0x1dbdbd[_0x58f5b4(0x251)](_0x2cddd6); _0x5f28d2 && _0x5f28d2[_0x58f5b4(0x55c)]('appIconPosition_') && _0x2627f5[_0x58f5b4(0x7d8)](_0x5f28d2); } } catch (_0x493c86) { console[_0x58f5b4(0x412)](_0x58f5b4(0x241), _0x493c86), _0x30a64e(_0x58f5b4(0x645) + _0x493c86[_0x58f5b4(0x227)]); } finally { _0x4ddb2a(), _0x585d0a(![]), _0x79fbb7[_0x58f5b4(0x8b0)] = ![]; } } async function _0x2e2f44(_0x1bdcfb) { const _0x3ae9e5 = _0x2b3d5e; if ('bAGzz' !== _0x3ae9e5(0x54f)) { const _0x560ac1 = _0x291d57[_0x3ae9e5(0x8d2)][_0x3ae9e5(0x2aa)](_0x1958de => _0x1958de['id'] === _0x2b4683[_0x3ae9e5(0x4dd)]) || { 'name': '你' }, _0x165712 = _0x245a11['diaries'][_0x3ae9e5(0x2aa)](_0x5d65a9 => _0x5d65a9[_0x3ae9e5(0x350)] === _0x4d42a8); if (!_0x165712 || !_0x165712[_0x3ae9e5(0x417)] || _0x165712[_0x3ae9e5(0x417)][_0x3ae9e5(0x629)] === 0x0) return ''; const _0x3d4771 = _0x165712['entries'][_0x3ae9e5(0x45b)](-0x8), _0x16c9c9 = _0x3d4771[_0x3ae9e5(0x843)](_0x205122 => { const _0x37902a = _0x3ae9e5, _0x5914e5 = _0x205122[_0x37902a(0x7b3)] === _0x37902a(0x721) ? _0x560ac1[_0x37902a(0x908)] : _0x374222(_0x205122[_0x37902a(0x7b3)])['name']; return '-\x20[' + new _0x341faa(_0x205122['timestamp'])[_0x37902a(0x4a1)]() + ']\x20' + _0x5914e5 + _0x37902a(0x7e5) + _0x205122[_0x37902a(0x317)]; })[_0x3ae9e5(0x26c)]('\x0a'); return _0x3ae9e5(0x6ff) + _0x560ac1[_0x3ae9e5(0x908)] + _0x3ae9e5(0x55b) + _0x16c9c9; } else { const _0x42e0da = _0x1bdcfb[_0x3ae9e5(0x150)][_0x3ae9e5(0x843)](_0x52436c => _0x1249c2(_0x52436c))[_0x3ae9e5(0x6a6)](Boolean); if (_0x42e0da[_0x3ae9e5(0x629)] === 0x0) return null; const _0x2f73a2 = _0x582d84(), _0x5038b2 = _0x4eadbd(_0x1bdcfb[_0x3ae9e5(0x536)]) || _0x79fbb7[_0x3ae9e5(0x8d2)][0x0], _0x57245e = _0x5038b2 ? '\x0a#\x20好友圈的主人\x20(“我”)\x0a-\x20姓名:\x20' + _0x5038b2['name'] + _0x3ae9e5(0x5db) + (_0x5038b2[_0x3ae9e5(0x6dc)] || '无') + '\x0a' : '', _0x50274a = _0x42e0da[_0x3ae9e5(0x843)](_0x59946b => { const _0x439927 = _0x3ae9e5; if (_0x439927(0x541) === _0x439927(0x541)) { const { omniText: _0x4806a3 } = _0x354941(_0x59946b['id'], null), _0x207244 = _0x3e3955(_0x59946b['id']), _0x1525f3 = _0x59946b[_0x439927(0x444)] && _0x59946b[_0x439927(0x444)]['length'] > 0x0 ? _0x439927(0x611) + _0x59946b[_0x439927(0x908)] + _0x439927(0x4a3) + _0x59946b[_0x439927(0x444)][_0x439927(0x843)](_0x1ac24a => _0x79fbb7['worldBooks'][_0x439927(0x2aa)](_0x5e17be => _0x5e17be['id'] === _0x1ac24a))[_0x439927(0x6a6)](Boolean)['map'](_0x1722ce => _0x439927(0x27f) + _0x1722ce['name'] + '\x0a' + _0x1722ce[_0x439927(0x317)])[_0x439927(0x26c)]('') : ''; return '-\x20姓名:\x20' + _0x59946b[_0x439927(0x908)] + _0x439927(0x4ab) + _0x59946b['id'] + _0x439927(0x468) + _0x59946b[_0x439927(0x6dc)] + '\x0a\x20\x20近期记忆:\x0a' + _0x4806a3 + '\x0a' + _0x207244 + '\x0a' + _0x1525f3; } else { _0x44dcf3[_0x439927(0x2f7)] = _0x439927(0x464); return; } })['join']('\x0a\x0a'), _0x13aa61 = Math[_0x3ae9e5(0x2e7)](Math[_0x3ae9e5(0x4dc)]() * 0x3) + 0x2, _0x2fcbe4 = _0x3ae9e5(0x634) + _0x13aa61 + '条】全新的、高质量的社交动态。\x0a\x0a#\x20好友圈成员信息\x0a' + _0x50274a + '\x0a' + _0x57245e + '\x0a#\x20最近的动态回顾\x20(供参考，避免重复)\x0a' + _0x2f73a2 + _0x3ae9e5(0x4d3) + _0x13aa61 + _0x3ae9e5(0x783) + _0x13aa61 + '个帖子对象。\x0a-\x20**【ID规则】**:\x20所有\x20\x22authorId\x22,\x20\x22likes\x22,\x20\x22comments\x22\x20中的作者标识，【必须】使用上面提供的角色\x20**ID**，绝对不能使用角色名字。\x0a-\x20**【JSON结构】**:\x20每个帖子对象必须遵循以下结构：\x0a\x20\x20```json\x0a\x20\x20{\x0a\x20\x20\x20\x20\x22authorId\x22:\x20\x22发布者的ID\x22,\x0a\x20\x20\x20\x20\x22postType\x22:\x20\x22text\x20or\x20music\x22,\x0a\x20\x20\x20\x20\x22postContent\x22:\x20\x22动态的文字内容\x22,\x0a\x20\x20\x20\x20\x22songName\x22:\x20\x22如果是music类型，则必须有歌名\x22,\x0a\x20\x20\x20\x20\x22artist\x22:\x20\x22如果是music类型，则必须有歌手名\x22,\x0a\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20}\x0a\x20\x20```\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a', _0xd1269d = [{ 'role': _0x3ae9e5(0x35f), 'content': _0x2fcbe4 }, { 'role': 'user', 'content': '请根据以上所有信息，开始分析并返回JSON。' }]; _0xd1269d[_0x3ae9e5(0x7d8)]({ 'role': _0x3ae9e5(0x721), 'content': _0x3ae9e5(0x34f) + _0x13aa61 + '\x20条新动态。' }); try { const _0x17ab4d = await _0x53d2f8(_0xd1269d, { 'json': !![] }), _0x17620e = _0x17ab4d[_0x3ae9e5(0x5d3)](/(\[[\s\S]*\])/); if (!_0x17620e) throw new Error(_0x3ae9e5(0x487)); const _0x2d9a8d = _0x17620e[0x1], _0x4f9163 = JSON[_0x3ae9e5(0x4f6)](_0x2d9a8d); if (!Array['isArray'](_0x4f9163)) throw new Error(_0x3ae9e5(0x1d2)); return _0x4f9163; } catch (_0xd81805) { return console[_0x3ae9e5(0x412)](_0x3ae9e5(0x7f9), _0xd81805), console[_0x3ae9e5(0x412)](_0x3ae9e5(0x157), _0xd81805['rawResponse'] || response), null; } } } async function _0x27a58e() { const _0x4c41f3 = _0x2b3d5e; if (_0x4c41f3(0x292) !== _0x4c41f3(0x292)) _0x45c497['value'] = _0x26bef1['apiSettings'][_0x4c41f3(0x7d5)] || '', _0x57983f[_0x4c41f3(0x2ff)] = _0x494659[_0x4c41f3(0x164)][_0x4c41f3(0x251)] || '', _0x57fba2[_0x4c41f3(0x2ff)] = _0x1371b7[_0x4c41f3(0x164)][_0x4c41f3(0x1b1)] || '', _0xd1134e['value'] = _0x12592b(_0x90c77e[_0x4c41f3(0x11a)]?.[_0x4c41f3(0x42b)] ?? 0x64), _0x434a73[_0x4c41f3(0x1f3)](_0x4c41f3(0x62d))['value'] = _0x4deedb[_0x4c41f3(0x164)][_0x4c41f3(0x286)] || _0x4c41f3(0x845); else { const _0x530200 = _0x79fbb7[_0x4c41f3(0x70f)][_0x4c41f3(0x2aa)](_0x580e47 => _0x580e47['id'] === _0x79fbb7[_0x4c41f3(0x21d)]); if (!_0x530200) return; const _0x85aaba = await _0x21bcbb('确定要清空好友圈“' + _0x530200[_0x4c41f3(0x908)] + '”的所有动态吗？此操作不可撤销，且AI将不再记得这些内容。'); _0x85aaba && (_0x530200[_0x4c41f3(0x49e)] = [], _0x43a351(), _0x4ddb2a(), _0x30a64e(_0x4c41f3(0x68f))); } } function _0x4ddb2a() { const _0x57b74f = _0x2b3d5e, _0x326e00 = document['getElementById'](_0x57b74f(0x780)), _0x251ac8 = _0x79fbb7[_0x57b74f(0x70f)][_0x57b74f(0x2aa)](_0x58c6a2 => _0x58c6a2['id'] === _0x79fbb7[_0x57b74f(0x21d)]); if (!_0x251ac8) { _0x326e00[_0x57b74f(0x2f7)] = _0x57b74f(0x2d0); return; } if (!_0x251ac8[_0x57b74f(0x49e)] || _0x251ac8[_0x57b74f(0x49e)][_0x57b74f(0x629)] === 0x0) { if (_0x57b74f(0x590) !== 'Vbrdj') { if (_0x3c358a[_0x57b74f(0x1fb)] === _0x57b74f(0x14e)) _0x7fc1af[_0x57b74f(0x490)](); _0x32856e(_0xbe1d97); } else { _0x326e00[_0x57b74f(0x2f7)] = _0x57b74f(0x702); return; } } _0x326e00[_0x57b74f(0x2f7)] = ''; const _0x2a2fd3 = [..._0x251ac8['posts']][_0x57b74f(0x2c1)]((_0x3884bc, _0x7874f4) => _0x7874f4[_0x57b74f(0x68c)] - _0x3884bc[_0x57b74f(0x68c)]); _0x2a2fd3[_0x57b74f(0x8f0)](_0x3765b2 => { const _0x262a07 = _0x57b74f, _0x559879 = document['createElement'](_0x262a07(0x8dc)); _0x559879['className'] = _0x262a07(0x1fd); let _0x229979 = '未知', _0x5d95dd = _0x426b80; if (_0x3765b2['authorType'] === 'user') { const _0x5d7ec9 = _0x4eadbd(_0x3765b2['authorId']); if (_0x5d7ec9) { if (_0x262a07(0x431) !== _0x262a07(0x431)) { _0x45e248(_0x262a07(0x463)); return; } else _0x229979 = _0x5d7ec9[_0x262a07(0x908)], _0x5d95dd = _0x5d7ec9[_0x262a07(0x71c)]; } } else { const _0x16e6c7 = _0x1249c2(_0x3765b2['authorId']); _0x16e6c7 && (_0x229979 = _0x16e6c7[_0x262a07(0x908)], _0x5d95dd = _0x16e6c7['avatar']); } const _0x492709 = _0x262a07(0xfd) + _0x5d95dd + _0x262a07(0x26f) + _0x229979 + '</span>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', _0x1b3f6c = _0x262a07(0x7f3) + _0x3765b2[_0x262a07(0x317)] + _0x262a07(0x765); let _0x2b6a0c = ''; if (_0x3765b2['image'] || _0x3765b2[_0x262a07(0x116)]) { if (_0x262a07(0x8fb) === _0x262a07(0x8fb)) { const _0x1dccd8 = _0x262a07(0x4a4) + _0x3765b2['id']; _0x2b6a0c = _0x262a07(0x1a3) + _0x1dccd8 + _0x262a07(0x183), setTimeout(() => { const _0xdf4455 = _0x262a07, _0x472a58 = document['getElementById'](_0x1dccd8); if (!_0x472a58) return; if (_0x3765b2[_0xdf4455(0x74f)]) _0x472a58[_0xdf4455(0x465)] = _0x3765b2[_0xdf4455(0x74f)]; else _0x3765b2['imageId'] && ('FhdGZ' !== _0xdf4455(0x5dc) ? _0x409b35[_0xdf4455(0x2ff)] = _0x3b885b[_0xdf4455(0x843)](_0x569362 => _0x569362['name'] + '--' + _0x569362[_0xdf4455(0x30d)])[_0xdf4455(0x26c)]('\x0a') : _0x3db342(_0x3765b2[_0xdf4455(0x116)])[_0xdf4455(0x2cd)](_0x30e921 => { const _0x3926d4 = _0xdf4455; if (_0x30e921) { const _0x2c70dd = URL['createObjectURL'](_0x30e921); _0x472a58[_0x3926d4(0x465)] = _0x2c70dd, _0x472a58[_0x3926d4(0x3fc)] = () => URL[_0x3926d4(0x1d7)](_0x2c70dd); } })); }, 0x0); } else _0x27b395(_0x262a07(0x16a)); } let _0x29bef5 = ''; _0x3765b2['type'] === _0x262a07(0x6fe) && _0x3765b2[_0x262a07(0x31c)] && (_0x29bef5 = '\x0a\x20\x20\x20\x20<div\x20class=\x22music-post-song-card\x22\x20data-music-id=\x22' + _0x3765b2['id'] + _0x262a07(0x18e) + (_0x3765b2[_0x262a07(0x1d1)] || _0x426b80) + _0x262a07(0x3ee) + _0x3765b2[_0x262a07(0x31c)] + _0x262a07(0x378) + _0x3765b2['artist'] + _0x262a07(0x316) + (_0x3765b2['playableUrl'] ? '▶' : '⚠') + _0x262a07(0x10e)); const _0x3195ba = _0x262a07(0x686) + new Date(_0x3765b2['timestamp'])['toLocaleString'](_0x262a07(0x805)) + _0x262a07(0x392); let _0x45f590 = ''; if (_0x3765b2[_0x262a07(0x16c)] && _0x3765b2['likes'][_0x262a07(0x629)] > 0x0 || _0x3765b2[_0x262a07(0x7c3)] && _0x3765b2[_0x262a07(0x7c3)][_0x262a07(0x629)] > 0x0) { let _0x4000a9 = ''; if (_0x3765b2['likes'] && _0x3765b2[_0x262a07(0x16c)][_0x262a07(0x629)] > 0x0) { const _0x1bc5eb = _0x3765b2[_0x262a07(0x16c)][_0x262a07(0x843)](_0x22355b => _0x1249c2(_0x22355b)?.[_0x262a07(0x908)] || '未知')[_0x262a07(0x26c)]('、'), _0x329139 = _0x262a07(0x7a3); _0x4000a9 = '<div\x20class=\x22post-likes\x22>' + _0x329139 + '\x20' + _0x1bc5eb + _0x262a07(0x392); } let _0x4037b7 = ''; if (_0x3765b2[_0x262a07(0x7c3)] && _0x3765b2[_0x262a07(0x7c3)][_0x262a07(0x629)] > 0x0) { const _0x4e3040 = _0x3765b2[_0x262a07(0x7c3)][_0x262a07(0x843)](_0x4ce5ed => { const _0x48ed50 = _0x262a07; if (_0x48ed50(0x34e) !== _0x48ed50(0x34e)) { const _0x120c82 = _0x4ca14c['value']; _0x566670['documentElement'][_0x48ed50(0x324)][_0x48ed50(0x79d)](_0x48ed50(0x69a), _0x120c82), _0xe8013d['setItem'](_0x48ed50(0x4f5), _0x120c82), _0x29d971(); } else { const _0x36dcf3 = _0x1249c2(_0x4ce5ed[_0x48ed50(0x696)])?.[_0x48ed50(0x908)] || '未知'; return '<div\x20class=\x22post-comment\x22><span\x20class=\x22comment-author\x22>' + _0x36dcf3 + _0x48ed50(0x59f) + _0x4ce5ed['content'] + '</div>'; } })[_0x262a07(0x26c)](''); _0x4037b7 = _0x262a07(0x193) + _0x4e3040 + '</div>'; } _0x45f590 = _0x262a07(0x2d9) + _0x4000a9 + _0x262a07(0x4a0) + _0x4037b7 + _0x262a07(0x276); } const _0x50cf0e = _0x262a07(0x46f) + _0x1b3f6c + _0x2b6a0c + _0x29bef5 + _0x262a07(0x392); _0x559879[_0x262a07(0x2f7)] = _0x492709 + _0x50cf0e + _0x3195ba + _0x45f590; if (_0x3765b2['type'] === _0x262a07(0x6fe) && _0x3765b2[_0x262a07(0x8b7)]) { if (_0x262a07(0x306) === _0x262a07(0x63a)) { if (!_0x2d1695) return; const _0x100cc8 = _0x237e4a['activeMeetingCharId'], _0x2ce91a = _0x28dff1(_0x100cc8); if (!_0x2ce91a) return; const _0x20eb52 = _0x502661(_0xe5b1ca['getElementById'](_0x262a07(0x407))[_0x262a07(0x2ff)]), _0x576d02 = _0x44598f(_0xf67241[_0x262a07(0x1f3)]('sprite-slider-y')[_0x262a07(0x2ff)]), _0x197cc8 = _0x4d7ec2(_0x1e5899[_0x262a07(0x1f3)]('sprite-slider-scale')['value']) / 0x64; _0x2ce91a[_0x262a07(0x320)] = { 'x': _0x20eb52, 'y': _0x576d02, 'scale': _0x197cc8 }; const _0xacd29a = _0x413b67[_0x262a07(0x1f3)](_0x262a07(0x3fe)), _0x3dd2c7 = 0x50 * _0x197cc8; _0xacd29a[_0x262a07(0x324)][_0x262a07(0x7a5)] = _0x3dd2c7 + '%', _0xacd29a[_0x262a07(0x324)][_0x262a07(0x120)] = _0x3dd2c7 + '%', _0xacd29a['style'][_0x262a07(0x173)] = _0x20eb52 + '%', _0xacd29a['style'][_0x262a07(0x65a)] = _0x576d02 + '%', _0xacd29a[_0x262a07(0x324)][_0x262a07(0x23a)] = _0x262a07(0x641); } else { const _0x1f30d9 = _0x559879['querySelector'](_0x262a07(0x93a)); _0x1f30d9 && (_0x262a07(0x219) === _0x262a07(0x455) ? _0x5e4fb0[_0x262a07(0x54a)](_0x262a07(0x5cc) + _0x52cf9d[_0x262a07(0x4d8)], _0x25abff[_0x262a07(0x4de)](_0x374b47[_0x262a07(0x623)])) : _0x1f30d9[_0x262a07(0x3eb)](_0x262a07(0x1a4), function () { const _0xd67f53 = { 'id': _0x3765b2['id'], 'url': _0x3765b2['playableUrl'] }; _0xd6f5a2(this, _0xd67f53); })); } } _0x326e00[_0x262a07(0x7b9)](_0x559879); }); } document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x143))[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x27a58e), document[_0x2b3d5e(0x1f3)]('refresh-feed-button')[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x10f40f), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x188))[_0x2b3d5e(0x3eb)]('click', () => _0x465abb(_0x2b3d5e(0x819), _0x2b3d5e(0x65b))), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x5ef))[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => _0xea3a07()), document[_0x2b3d5e(0x1f3)]('back-to-circle-list-from-edit')[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => _0x465abb(_0x2b3d5e(0x65b), _0x2b3d5e(0x6de))), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x90e))[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x2a920e), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x7d1))[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x1d884e), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x497))[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0x316f49 = _0x2b3d5e; _0xa61b9f(), _0x465abb(_0x316f49(0x65b), _0x316f49(0x6fe)); }), document[_0x2b3d5e(0x1f3)]('edit-current-circle-button')[_0x2b3d5e(0x3eb)]('click', () => { const _0x136066 = _0x2b3d5e; _0x79fbb7[_0x136066(0x21d)] && _0xea3a07(_0x79fbb7[_0x136066(0x21d)]); }), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x722))['addEventListener'](_0x2b3d5e(0x1a4), async () => { const _0x185080 = _0x2b3d5e, _0x3e3a47 = _0x79fbb7[_0x185080(0x70f)][_0x185080(0x2aa)](_0x239892 => _0x239892['id'] === _0x79fbb7[_0x185080(0x21d)]); if (!_0x3e3a47 || _0x79fbb7[_0x185080(0x8b0)]) return; const _0x1561e4 = _0x3e3a47[_0x185080(0x536)], _0x3ed678 = _0x79fbb7[_0x185080(0x8d2)][_0x185080(0x2aa)](_0x55b618 => _0x55b618['id'] === _0x1561e4); if (!_0x3ed678) { _0x30a64e('错误：找不到此好友圈绑定的用户！'); return; } const _0x4fda19 = document[_0x185080(0x1f3)](_0x185080(0x5b1))[_0x185080(0x2ff)][_0x185080(0x538)](), _0x436f00 = _0x79fbb7[_0x185080(0x8ec)][_0x185080(0x74f)], _0x19638c = _0x79fbb7['pendingPostAttachments'][_0x185080(0x6fe)], _0x575810 = _0x79fbb7[_0x185080(0x8ec)][_0x185080(0x116)]; if (!_0x4fda19 && !_0x436f00 && !_0x19638c) { _0x30a64e(_0x185080(0x636)); return; } const _0x36835d = { 'id': _0x185080(0x6d8) + Date[_0x185080(0x86b)](), 'authorType': _0x185080(0x721), 'authorId': _0x3ed678['id'], 'content': _0x4fda19, 'timestamp': Date[_0x185080(0x86b)](), 'likes': [], 'comments': [] }; if (_0x575810) _0x36835d[_0x185080(0x116)] = _0x575810; else _0x436f00 && (_0x36835d[_0x185080(0x74f)] = _0x436f00); _0x19638c ? 'AYJsU' === _0x185080(0x68a) ? _0x1e9b75[_0x185080(0x847)]('chatHistory_' + _0x32b3c0[_0x185080(0x4d8)]) : (_0x36835d[_0x185080(0x1fb)] = _0x185080(0x6fe), Object[_0x185080(0x2db)](_0x36835d, _0x19638c)) : _0x36835d[_0x185080(0x1fb)] = _0x185080(0x6b3), _0x3e3a47['posts'][_0x185080(0x7d8)](_0x36835d), _0x43a351(), _0x4ddb2a(), document[_0x185080(0x1f3)]('user-post-textarea')[_0x185080(0x2ff)] = '', _0x79fbb7[_0x185080(0x8ec)][_0x185080(0x74f)] = null, _0x79fbb7[_0x185080(0x8ec)][_0x185080(0x6fe)] = null, _0x79fbb7['pendingPostAttachments'][_0x185080(0x116)] = null, _0x5d4b05(), _0x25ee31(_0x36835d); }), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x92c))[_0x2b3d5e(0x3eb)]('click', () => { const _0x4de370 = _0x2b3d5e; _0x4de370(0x161) === _0x4de370(0x1ec) ? _0x498edf(_0xcfab59['id']) : document['getElementById']('user-post-image-input')['click'](); }), document[_0x2b3d5e(0x1f3)]('user-post-image-input')['addEventListener'](_0x2b3d5e(0x3b3), async _0xd615bc => { const _0x20d990 = _0x2b3d5e; if (_0x20d990(0x14d) !== _0x20d990(0x14d)) _0x3ba446[_0x20d990(0x2f7)] = '', _0x4c9d61['forEach'](_0x12a28a => { const _0x8106cb = _0x20d990, _0x5b7e63 = _0x941d75[_0x8106cb(0x4f8)](_0x8106cb(0x8b4)); _0x5b7e63['src'] = _0x12a28a['url'], _0x5b7e63['loading'] = _0x8106cb(0x8a0), _0x5b7e63[_0x8106cb(0x453)] = _0x12a28a[_0x8106cb(0x908)], _0x5b7e63['classList'][_0x8106cb(0x20f)]('sticker-item'), _0x5b7e63[_0x8106cb(0x3eb)](_0x8106cb(0x1a4), () => _0x4c84e5(_0x12a28a)), _0x33438c[_0x8106cb(0x7b9)](_0x5b7e63); }); else { const _0x5808b9 = _0xd615bc[_0x20d990(0x381)][_0x20d990(0x5b7)][0x0]; if (!_0x5808b9) return; try { const _0x1f1e81 = await _0x40c94b(_0x5808b9, 0x320, 0.8, !![]), _0x176c22 = _0x20d990(0x615) + Date[_0x20d990(0x86b)](); await _0x43bf1f(_0x176c22, _0x1f1e81), _0x79fbb7[_0x20d990(0x8ec)][_0x20d990(0x116)] = _0x176c22, _0x79fbb7[_0x20d990(0x8ec)][_0x20d990(0x74f)] = null, _0x79fbb7['pendingPostAttachments'][_0x20d990(0x6fe)] = null, _0x5d4b05(); } catch (_0x1769ff) { _0x20d990(0x65d) !== _0x20d990(0x72c) ? _0x30a64e(_0x20d990(0x6a8) + _0x1769ff[_0x20d990(0x227)]) : (_0x3eef09[_0x20d990(0x317)] = _0x58a0e3, _0x38cddf(), _0x148311()); } _0xd615bc[_0x20d990(0x381)]['value'] = ''; } }), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x363))[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), async () => { const _0x37f4ed = _0x2b3d5e, _0x20a4bd = await _0x14d64e(); if (!_0x20a4bd) return; _0x30a64e(_0x37f4ed(0x5d1)); try { const _0x3021da = await _0x314a48(_0x20a4bd[_0x37f4ed(0x31c)], _0x20a4bd[_0x37f4ed(0x160)]); _0x79fbb7[_0x37f4ed(0x8ec)][_0x37f4ed(0x6fe)] = { 'songName': _0x20a4bd['songName'], 'artist': _0x20a4bd[_0x37f4ed(0x160)], 'coverUrl': _0x3021da[_0x37f4ed(0x876)], 'playableUrl': _0x3021da[_0x37f4ed(0x30d)] }, _0x79fbb7[_0x37f4ed(0x8ec)][_0x37f4ed(0x74f)] = null, _0x5d4b05(); } catch (_0xdf5221) { if (_0x37f4ed(0x74b) === _0x37f4ed(0x74b)) _0x30a64e(_0x37f4ed(0x16d) + _0xdf5221[_0x37f4ed(0x227)]); else { const _0x21878a = _0x34538a[_0x37f4ed(0x1f3)](_0x543d27); if (_0x21878a && _0xd8276) _0x21878a[_0x37f4ed(0x465)] = _0x5c5642['createObjectURL'](_0x4d9e6f); } } }); function _0x33ad14() { const _0x5d6fc1 = _0x2b3d5e, _0x495bdf = new Date(), _0x38c394 = document[_0x5d6fc1(0x1f3)]('home-time'), _0x329c98 = document[_0x5d6fc1(0x1f3)](_0x5d6fc1(0x679)); if (_0x38c394 && _0x329c98) { if (_0x5d6fc1(0x5b9) !== _0x5d6fc1(0x4e0)) { const _0x429a27 = String(_0x495bdf[_0x5d6fc1(0x267)]())['padStart'](0x2, '0'), _0x5ac69b = String(_0x495bdf[_0x5d6fc1(0x3c0)]())[_0x5d6fc1(0x643)](0x2, '0'); _0x38c394[_0x5d6fc1(0x5f4)] = _0x429a27 + ':' + _0x5ac69b; const _0x3da31f = _0x495bdf[_0x5d6fc1(0x90b)]() + 0x1, _0x3ec879 = _0x495bdf[_0x5d6fc1(0x5d5)](), _0x2690d0 = ['星期日', _0x5d6fc1(0x2d5), _0x5d6fc1(0x661), _0x5d6fc1(0x935), _0x5d6fc1(0x8ae), _0x5d6fc1(0x2f1), _0x5d6fc1(0x754)][_0x495bdf[_0x5d6fc1(0x768)]()]; _0x329c98[_0x5d6fc1(0x5f4)] = _0x3da31f + '月' + _0x3ec879 + '日\x20' + _0x2690d0; } else _0x4dac7d = { 'speaker': _0x2f5859[_0x5d6fc1(0x908)], 'line': _0x2927d4[_0x5d6fc1(0x317)], 'emotion': _0x5d6fc1(0x4e9) }; } } function _0x5b4f08(_0x5b6ce0) { const _0x36618e = _0x2b3d5e; if (_0x36618e(0x521) !== _0x36618e(0x6eb)) { if (!_0x5b6ce0) return ''; const _0x1b9471 = new Date(_0x5b6ce0), _0x1f1154 = String(_0x1b9471[_0x36618e(0x267)]())['padStart'](0x2, '0'), _0x458809 = String(_0x1b9471[_0x36618e(0x3c0)]())[_0x36618e(0x643)](0x2, '0'); return _0x1f1154 + ':' + _0x458809; } else _0x2cfa30[_0x36618e(0x1dc)] = _0x36618e(0x488), _0x2bc5f0['style']['fontStyle'] = _0x36618e(0x911), _0x3dce1b['style']['color'] = _0x36618e(0x889), _0x1845fd[_0x36618e(0x2f7)] = _0x596239; } function _0x582d84() { const _0x473c40 = _0x2b3d5e; if (_0x473c40(0x3b4) !== _0x473c40(0x3b4)) return _0x5444f2(_0x148ae0)[_0x473c40(0x2cd)](_0x1a8a4c => _0x1a8a4c['blob']()); else { const _0x16aef1 = _0x79fbb7[_0x473c40(0x70f)][_0x473c40(0x2aa)](_0x52f642 => _0x52f642['id'] === _0x79fbb7['activeFriendCircleId']), _0x21427d = _0x16aef1 ? _0x16aef1['posts'] : []; if (!_0x21427d || _0x21427d['length'] === 0x0) return ''; const _0x2579ad = _0x21427d[_0x473c40(0x45b)](0x0, 0x5), _0xf3da83 = _0x2579ad[_0x473c40(0x843)](_0x421287 => { const _0x373514 = _0x473c40; if ('IXYGx' === _0x373514(0x4b9)) { _0x2c1663(_0x373514(0x2c6)); return; } else { const _0x59dfc0 = _0x1249c2(_0x421287[_0x373514(0x696)]) || { 'name': '未知' }; let _0x3c3382 = _0x373514(0x93d) + _0x59dfc0['name'] + _0x373514(0x7ed) + (_0x421287[_0x373514(0x4f1)] || _0x421287['content']) + '”'; return _0x421287['type'] === _0x373514(0x6fe) && (_0x3c3382 += _0x373514(0x485) + _0x421287[_0x373514(0x31c)] + _0x373514(0x61f) + _0x421287['artist'] + ')'), _0x3c3382; } }); return _0x473c40(0x39c) + _0xf3da83['join']('\x0a'); } } function _0x3e3955(_0x474b13) { const _0x28f678 = _0x2b3d5e, _0x5ace0e = _0x79fbb7['userProfiles']['find'](_0x9f3775 => _0x9f3775['id'] === _0x79fbb7[_0x28f678(0x4dd)]) || { 'name': '你' }, _0x57d1e9 = _0x79fbb7[_0x28f678(0x84d)][_0x28f678(0x2aa)](_0x403b04 => _0x403b04[_0x28f678(0x350)] === _0x474b13); if (!_0x57d1e9 || !_0x57d1e9['entries'] || _0x57d1e9[_0x28f678(0x417)][_0x28f678(0x629)] === 0x0) { if ('DligK' === _0x28f678(0x5da)) _0x3e7015['src'] = _0x30b414[_0x28f678(0x30d)], _0x606b4d[_0x28f678(0x7e9)](), _0xd2f231[_0x28f678(0x249)]('.music-post-play-icon,\x20.music-share-play-icon')[_0x28f678(0x5f4)] = '❚❚'; else return ''; } const _0x3f66d7 = _0x57d1e9['entries'][_0x28f678(0x45b)](-0x8), _0x19e092 = _0x3f66d7[_0x28f678(0x843)](_0x459d07 => { const _0x2557c1 = _0x28f678, _0x2580ec = _0x459d07[_0x2557c1(0x7b3)] === _0x2557c1(0x721) ? _0x5ace0e[_0x2557c1(0x908)] : _0x1249c2(_0x459d07[_0x2557c1(0x7b3)])['name']; return _0x2557c1(0x23b) + new Date(_0x459d07[_0x2557c1(0x68c)])[_0x2557c1(0x4a1)]() + ']\x20' + _0x2580ec + '\x20写道:\x20' + _0x459d07['content']; })[_0x28f678(0x26c)]('\x0a'); return _0x28f678(0x6ff) + _0x5ace0e['name'] + '\x20之间的私密内容)\x0a' + _0x19e092; } function _0x153f43() { const _0x3f5c32 = _0x2b3d5e; if (_0x3f5c32(0x393) !== _0x3f5c32(0x393)) _0x4b603a['error'](_0x3f5c32(0x5a7), _0x37f0c6); else { const _0x4090ea = document[_0x3f5c32(0x1f3)]('music-widget-card'), _0x5d9a98 = _0x79fbb7[_0x3f5c32(0x11a)][_0x3f5c32(0x6d2)]; _0x5d9a98 ? (_0x4090ea[_0x3f5c32(0x324)]['backgroundImage'] = _0x3f5c32(0x8ce) + _0x5d9a98 + ')', _0x4090ea[_0x3f5c32(0x324)][_0x3f5c32(0x93f)] = 'cover', _0x4090ea[_0x3f5c32(0x324)][_0x3f5c32(0x203)] = _0x3f5c32(0x51e), _0x4090ea['style']['color'] = _0x3f5c32(0x79a), _0x4090ea[_0x3f5c32(0x5ec)](_0x3f5c32(0x917))[_0x3f5c32(0x8f0)](_0xd6d653 => { const _0x1720ba = _0x3f5c32; _0xd6d653['style'][_0x1720ba(0x13c)] = _0x1720ba(0x620); })) : (_0x4090ea[_0x3f5c32(0x324)]['backgroundImage'] = '', _0x4090ea[_0x3f5c32(0x324)]['color'] = '', _0x4090ea[_0x3f5c32(0x5ec)]('.widget-info\x20>\x20div')[_0x3f5c32(0x8f0)](_0x24aed2 => { const _0x147d4a = _0x3f5c32; if (_0x147d4a(0x877) !== _0x147d4a(0x7af)) _0x24aed2[_0x147d4a(0x324)][_0x147d4a(0x13c)] = ''; else { const _0x5d0469 = _0x1eb479[_0x147d4a(0x1f3)]('confirm-altar-upload-button'); _0x5a6be0[_0x147d4a(0x121)] && _0x29ac02['info'] ? _0x5d0469[_0x147d4a(0x899)] = ![] : _0x5d0469[_0x147d4a(0x899)] = !![]; } })); } } const _0x3ff3d7 = document['getElementById'](_0x2b3d5e(0x564)), _0xf4f382 = document['getElementById']('app-meeting'); _0x3ff3d7['addEventListener']('click', () => { const _0x553e21 = _0x2b3d5e; _0x553e21(0x625) !== _0x553e21(0x452) ? (_0xa61b9f(), _0x465abb(_0x553e21(0x65b), 'home')) : _0x23663c[_0x553e21(0x7d8)](_0x82df1b); }), _0xf4f382['addEventListener'](_0x2b3d5e(0x1a4), () => { const _0x21b864 = _0x2b3d5e; _0x21b864(0x7b1) !== _0x21b864(0x87a) ? (_0xb547b7(), _0x465abb(_0x21b864(0x1b4), _0x21b864(0x819))) : (_0x7b22f3[_0x21b864(0x4c8)](), _0x19e483[_0x21b864(0x43d)]['toggle'](_0x21b864(0x793)), _0x46c52a['classList']['toggle']('expanded')); }), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x40b))['addEventListener'](_0x2b3d5e(0x1a4), () => { const _0x24f0d3 = _0x2b3d5e; _0x465abb('home', _0x24f0d3(0x1b4)); }), document[_0x2b3d5e(0x1f3)]('back-to-meeting-list')[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0x4fdd14 = _0x2b3d5e; if (_0x4611d7) clearInterval(_0x4611d7); _0x4611d7 = null, _0x79fbb7['activeMeetingScriptQueue'] = [], _0x79fbb7[_0x4fdd14(0x112)] = null, document[_0x4fdd14(0x1f3)](_0x4fdd14(0x5e6))[_0x4fdd14(0x324)][_0x4fdd14(0x7ab)] = 'none', _0x79fbb7[_0x4fdd14(0x4d8)] = null, _0x43a351(), _0x465abb(_0x4fdd14(0x1b4), 'meetingView'); }); const _0xedff51 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x34d)), _0x2d2a7c = document['getElementById'](_0x2b3d5e(0x8e5)); _0x2d2a7c['addEventListener'](_0x2b3d5e(0x1a4), () => { const _0x490c1c = _0x2b3d5e, _0x161ae0 = _0xedff51['value'][_0x490c1c(0x538)](); _0x161ae0 && (_0x2e4a87(_0x161ae0), _0xedff51[_0x490c1c(0x2ff)] = '', setTimeout(_0x3346d1, 0x64)); }); function _0xd6f5a2(_0x324ece, _0x5c5563) { const _0x268772 = _0x2b3d5e; if (_0x268772(0x6d3) === 'PIUaP') { const _0x40fe5f = document[_0x268772(0x1f3)]('audio-player'), _0x2866b6 = document[_0x268772(0x5ec)](_0x268772(0x73f)); _0x2866b6['forEach'](_0x57761a => { const _0x3e030b = _0x268772; if (_0x57761a !== _0x324ece[_0x3e030b(0x249)](_0x3e030b(0x73f))) { if (_0x3e030b(0x6b7) !== _0x3e030b(0x684)) _0x57761a['textContent'] = '▶'; else { _0x4d8774['innerHTML'] = _0x3e030b(0x5fa); return; } } }), _0x40fe5f[_0x268772(0x465)] === _0x5c5563[_0x268772(0x30d)] && !_0x40fe5f['paused'] ? (_0x40fe5f['pause'](), _0x324ece['querySelector'](_0x268772(0x73f))[_0x268772(0x5f4)] = '▶') : (_0x40fe5f[_0x268772(0x465)] = _0x5c5563[_0x268772(0x30d)], _0x40fe5f['play'](), _0x324ece[_0x268772(0x249)](_0x268772(0x73f))['textContent'] = '❚❚'); } else { if (_0x1234c1 < 0x0 || _0x45d780 >= _0x534df2) return; _0x390632[_0x268772(0x324)][_0x268772(0x23a)] = _0x268772(0x374) + _0x459df9 * (0x64 / _0x3b4c70) + '%)', _0x577b92['forEach'](_0x3ea3b2 => _0x3ea3b2[_0x268772(0x43d)][_0x268772(0x154)](_0x268772(0x4a8))), _0x3a2638[_0x4c9437][_0x268772(0x43d)]['add'](_0x268772(0x4a8)), _0x1594fa = _0x34b49c; } } const _0x3abe3e = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x77e)); async function _0x3f8979(_0x2532d9) { const _0x5d44ee = _0x2b3d5e; if (!_0x2532d9 || !_0x2532d9['startsWith'](_0x5d44ee(0x4d6))) return ![]; return new Promise(_0x5e5243 => { const _0x25b59c = _0x5d44ee, _0x127c85 = document[_0x25b59c(0x4f8)](_0x25b59c(0x121)); _0x127c85['src'] = _0x2532d9; const _0x6a7508 = setTimeout(() => { _0x1d7939(), _0x5e5243(![]); }, 0xbb8), _0x1d7939 = () => { const _0x16f030 = _0x25b59c; if (_0x16f030(0x8db) !== _0x16f030(0x8db)) { const _0x4f0b86 = _0x100fed[_0x16f030(0x381)][_0x16f030(0x5b7)][0x0]; if (!_0x4f0b86) return; const _0x57d42f = _0x36ebea['createObjectURL'](_0x4f0b86); _0x29c860[_0x16f030(0x465)] = _0x57d42f, _0x217b54['onload'] = () => { const _0x118519 = _0x16f030; _0x4b2d89[_0x118519(0x1d7)](_0x57d42f); }; } else clearTimeout(_0x6a7508), _0x127c85[_0x16f030(0x5b3)](_0x16f030(0x212), _0x31922f), _0x127c85[_0x16f030(0x5b3)](_0x16f030(0x412), _0x72b96f), _0x127c85[_0x16f030(0x465)] = '', _0x127c85['remove'](); }, _0x31922f = () => { _0x1d7939(), _0x5e5243(!![]); }, _0x72b96f = () => { _0x1d7939(), _0x5e5243(![]); }; _0x127c85[_0x25b59c(0x3eb)](_0x25b59c(0x212), _0x31922f), _0x127c85[_0x25b59c(0x3eb)](_0x25b59c(0x412), _0x72b96f); }); } async function _0x314a48(_0x3d305e, _0x8a6a69) { const _0x368c78 = _0x2b3d5e, _0x5829be = [_0x368c78(0x1b5), _0x368c78(0x8c1)]; for (const _0x2e3e07 of _0x5829be) { if (_0x368c78(0x8f4) === _0x368c78(0x8f4)) try { if (_0x368c78(0x1a2) !== _0x368c78(0x598)) { const _0x205b39 = _0x368c78(0x810) + _0x2e3e07 + _0x368c78(0x595) + encodeURIComponent(_0x3d305e) + '-' + encodeURIComponent(_0x8a6a69), _0x59ecdd = await fetch(_0x205b39), _0x127680 = await _0x59ecdd[_0x368c78(0x1b0)](); if (_0x127680['code'] !== 0xc8 || !_0x127680[_0x368c78(0x8b3)] || _0x127680[_0x368c78(0x8b3)][_0x368c78(0x629)] === 0x0) continue; const _0x42a868 = _0x127680['data']['slice'](0x0, 0x5); for (const _0x5866b2 of _0x42a868) { const _0x4e1738 = 'https://api.vkeys.cn/v2/music/' + _0x2e3e07 + _0x368c78(0x7b4) + _0x5866b2['id'], _0x5721b6 = await fetch(_0x4e1738), _0x5d279d = await _0x5721b6[_0x368c78(0x1b0)](), _0x563d1a = _0x5d279d[_0x368c78(0x8b3)]?.[_0x368c78(0x30d)]; if (await _0x3f8979(_0x563d1a)) return { 'url': _0x563d1a, 'cover': _0x5866b2['cover'], 'source': _0x2e3e07 }; } } else { const _0x5fe43e = _0x1fecd9[_0x368c78(0x4f8)]('div'); _0x5fe43e[_0x368c78(0x1dc)] = _0x368c78(0x206), _0x5fe43e[_0x368c78(0x2f7)] = _0x368c78(0x197) + _0x25fa81['id'] + '\x22\x20data-id=\x22' + _0x3f5d78['id'] + '\x22>\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x2c68e0['avatar'] || _0x2ef5f9) + _0x368c78(0x66f) + _0x41214f['id'] + _0x368c78(0x6c7) + _0x56924f[_0x368c78(0x908)] + _0x368c78(0x102), _0x1ecf36[_0x368c78(0x7b9)](_0x5fe43e); } } catch (_0x16f184) { console[_0x368c78(0x412)]('Error\x20fetching\x20from\x20' + _0x2e3e07 + ':', _0x16f184); } else { const _0x4f32e0 = _0x500307[_0x368c78(0x8d2)][_0x368c78(0x2aa)](_0x5c8d85 => _0x5c8d85['id'] === _0x1df4f7); if (_0x4f32e0) _0x231f99['assign'](_0x4f32e0, _0x5bccf3); } } return { 'url': null, 'cover': null, 'source': null }; } function _0x4c70b1(_0x4069b7) { const _0x15e6a2 = _0x2b3d5e; if ('FFQcI' === _0x15e6a2(0x52d)) _0x240428['createObjectStore'](_0x52a109, { 'keyPath': 'id' }); else try { const _0x17bd13 = JSON[_0x15e6a2(0x4f6)](localStorage[_0x15e6a2(0xfc)](_0x15e6a2(0x217)) || '{}'), _0x20a26c = { ..._0x17bd13, ..._0x4069b7 }; localStorage['setItem'](_0x15e6a2(0x217), JSON[_0x15e6a2(0x4de)](_0x20a26c)); } catch (_0x38302b) { if (_0x15e6a2(0x201) !== _0x15e6a2(0x201)) { const _0x1f91a0 = { 'characters': _0x5480bd[_0x15e6a2(0x44f)], 'worldBooks': _0x2db335[_0x15e6a2(0x32e)], 'chats': _0x279d83[_0x15e6a2(0x4c9)], 'userProfile': _0x219049[_0x15e6a2(0x1ab)], 'apiSettings': _0x2a07be[_0x15e6a2(0x164)], 'preferences': _0x5d720f[_0x15e6a2(0x11a)], 'activeChatId': _0x352d76[_0x15e6a2(0x4d8)], 'diaries': _0xb92031[_0x15e6a2(0x84d)], 'friendCircles': _0x48340b[_0x15e6a2(0x70f)], 'activeFriendCircleId': _0xe8c896[_0x15e6a2(0x21d)], 'userProfiles': _0x43b1ce['userProfiles'], 'activeUserProfileId': _0x533ec2[_0x15e6a2(0x4dd)], 'accountingData': _0x503716['accountingData'], 'accountingLedger': _0x538946['accountingLedger'] }; _0x3d29e4[_0x15e6a2(0x54a)](_0x15e6a2(0x57b), _0x37383e[_0x15e6a2(0x4de)](_0x1f91a0)); } else console[_0x15e6a2(0x412)](_0x15e6a2(0x719), _0x38302b); } } async function _0x9ce0ae() { const _0x539678 = _0x2b3d5e, _0x3e38a2 = document[_0x539678(0x1f3)](_0x539678(0x125)), _0x38af66 = document[_0x539678(0x1f3)]('badge-image'); try { let _0x5d6e97 = await _0x3db342(_0x539678(0x6ac)); if (!_0x5d6e97) { if (_0x539678(0x62c) !== 'Wjpjo') { const _0x59e912 = JSON[_0x539678(0x4f6)](localStorage[_0x539678(0xfc)](_0x539678(0x217)) || '{}'); _0x59e912[_0x539678(0x74f)] && (console['log']('正在搬运旧徽章...'), _0x5d6e97 = await _0x4f6af3(_0x59e912['image']), await _0x43bf1f(_0x539678(0x6ac), _0x5d6e97)); } else _0x2ecfd3['style'][_0x539678(0x65a)] = _0x424712[_0x539678(0x65a)] + '%', _0x172d09[_0x539678(0x324)][_0x539678(0x173)] = _0x5d8bd2['left'] + '%'; } _0x5d6e97 ? (_0x38af66['src'] = URL[_0x539678(0x4af)](_0x5d6e97), _0x3e38a2[_0x539678(0x324)][_0x539678(0x7ab)] = _0x539678(0x53e)) : _0x3e38a2['style'][_0x539678(0x7ab)] = _0x539678(0x53e); } catch (_0x36dac1) { console['error'](_0x539678(0x5a1), _0x36dac1); } } function _0x81f25c(_0x1f9948) { const _0x466f07 = _0x2b3d5e; try { if (_0x466f07(0x13b) === 'mNmTb') { const _0x441f1c = _0x8a9b16[_0x466f07(0x207)](_0x3f8495, _0x466f07(0x6b1)), _0x26e623 = _0x441f1c[_0x466f07(0x8a5)](_0x11e7d1), _0x1ee5a0 = _0x26e623['delete'](_0x1dfd98); _0x1ee5a0[_0x466f07(0x7eb)] = () => _0x10a5e5(), _0x1ee5a0['onerror'] = () => _0x1cfb2d(_0x1ee5a0[_0x466f07(0x412)]); } else { const _0x4e53fb = JSON['parse'](localStorage[_0x466f07(0xfc)](_0x466f07(0x70c)) || '{}'), _0x3c7f31 = { ..._0x4e53fb, ..._0x1f9948 }; localStorage[_0x466f07(0x54a)](_0x466f07(0x70c), JSON[_0x466f07(0x4de)](_0x3c7f31)); } } catch (_0xcc15d4) { console[_0x466f07(0x412)]('保存卡片状态失败', _0xcc15d4); } } async function _0x1d7f67() { const _0x5c69ad = _0x2b3d5e, _0x5f2f29 = document[_0x5c69ad(0x1f3)](_0x5c69ad(0x200)), _0x425a3b = document[_0x5c69ad(0x1f3)]('card-image'); try { let _0x162c08 = await _0x3db342(_0x5c69ad(0x140)); if (!_0x162c08) { if (_0x5c69ad(0x348) === _0x5c69ad(0x348)) { const _0x1976ce = JSON['parse'](localStorage['getItem'](_0x5c69ad(0x70c)) || '{}'); _0x1976ce[_0x5c69ad(0x74f)] && (console[_0x5c69ad(0x257)]('正在搬运旧卡片...'), _0x162c08 = await _0x4f6af3(_0x1976ce[_0x5c69ad(0x74f)]), await _0x43bf1f(_0x5c69ad(0x140), _0x162c08)); } else _0x553c5a = _0xe6be9[_0x5c69ad(0x1ab)][_0x5c69ad(0x908)] || '我'; } _0x162c08 ? 'QZxmm' !== 'MCTWJ' ? (_0x425a3b['src'] = URL[_0x5c69ad(0x4af)](_0x162c08), _0x5f2f29[_0x5c69ad(0x324)][_0x5c69ad(0x7ab)] = 'block') : _0x5a1e50[_0x5c69ad(0x116)] = _0x567fbc : _0x5c69ad(0x3b9) === _0x5c69ad(0x81d) ? _0x56f974(_0x5c69ad(0x6e3)) : _0x5f2f29[_0x5c69ad(0x324)][_0x5c69ad(0x7ab)] = 'block'; } catch (_0x57bfd8) { if (_0x5c69ad(0x610) === _0x5c69ad(0x2ef)) { const _0x50c78 = _0x103fea[_0x5c69ad(0x4f8)](_0x5c69ad(0x1e6)); _0x50c78[_0x5c69ad(0x2f7)] = '<input\x20type=\x22checkbox\x22\x20value=\x22' + _0x5852a3['id'] + '\x22>\x20' + _0x59b8c5['name'], _0x639ebc['appendChild'](_0x50c78); } else console[_0x5c69ad(0x412)](_0x5c69ad(0x1cb), _0x57bfd8); } try { let _0x114593 = await _0x3db342(_0x5c69ad(0x3f0)); const _0xc3dea = document['getElementById']('card-image-2'), _0x5026d4 = document[_0x5c69ad(0x1f3)](_0x5c69ad(0x80e)); _0x114593 ? (_0xc3dea['src'] = URL[_0x5c69ad(0x4af)](_0x114593), _0x5026d4[_0x5c69ad(0x324)]['display'] = 'block') : _0x5026d4[_0x5c69ad(0x324)]['display'] = _0x5c69ad(0x277); } catch (_0x3b2bb7) { console[_0x5c69ad(0x412)]('加载第二个卡片图片失败', _0x3b2bb7); } } _0x4d6038[_0x2b3d5e(0x3eb)]('click', () => { const _0x231f1c = _0x2b3d5e; _0x59b7d9(), _0x465abb(_0x231f1c(0x7ca), 'home'); }), document['getElementById'](_0x2b3d5e(0x6f8))[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => _0x465abb(_0x2b3d5e(0x819), 'userProfileList')), document[_0x2b3d5e(0x1f3)]('add-user-profile-button')[_0x2b3d5e(0x3eb)]('click', () => _0xf9d1f()), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x5b4))[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0x3e3be6 = _0x2b3d5e; _0x59b7d9(), _0x465abb(_0x3e3be6(0x7ca), _0x3e3be6(0x1ab)); }), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x165))[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x273978), document['getElementById'](_0x2b3d5e(0x17c))['addEventListener'](_0x2b3d5e(0x1a4), _0x19aa72), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x8ba))[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0x4d863d = _0x2b3d5e, _0x8dc1fe = document['getElementById']('editing-user-id')[_0x4d863d(0x2ff)]; _0x8dc1fe && (_0x79fbb7[_0x4d863d(0x4dd)] = _0x8dc1fe, _0x43a351(), _0x30a64e(_0x4d863d(0x644)), _0x59b7d9(), document[_0x4d863d(0x1f3)](_0x4d863d(0x8ba))[_0x4d863d(0x324)][_0x4d863d(0x7ab)] = _0x4d863d(0x277)); }); function _0x1cdea5(_0x1e35eb) { const _0x4e443c = _0x2b3d5e; if (_0x4e443c(0x253) !== _0x4e443c(0x859)) { const _0x3bfb2f = _0x79fbb7[_0x4e443c(0x4c9)][_0x4e443c(0x2aa)](_0xb65642 => _0xb65642['id'] === _0x1e35eb), _0x3187ac = _0x3bfb2f?.['boundUserProfileId']; let _0x4653a2 = _0x79fbb7[_0x4e443c(0x8d2)][_0x4e443c(0x2aa)](_0x365ed8 => _0x365ed8['id'] === _0x3187ac); if (!_0x4653a2) { if (_0x4e443c(0x936) !== _0x4e443c(0x928)) _0x4653a2 = _0x79fbb7['userProfiles'][_0x4e443c(0x2aa)](_0x238ae3 => _0x238ae3['id'] === _0x79fbb7[_0x4e443c(0x4dd)]) || _0x79fbb7[_0x4e443c(0x8d2)][0x0]; else { const _0x10bec3 = _0x1d59ed(_0x309abd[_0x4e443c(0x4d8)]); _0x350b62 = _0x10bec3['avatar'] || _0x1638ea; } } return _0x4653a2 || { 'name': '用户', 'avatar': _0x4f5e50, 'persona': '' }; } else _0xf7cf0c[_0x4e443c(0x320)] = _0x257b4f, _0x3b7a3e(_0x531fa8[_0x4e443c(0x112)], 'normal'); } function _0x4fccb4(_0x2caaf6) { const _0x7feb64 = _0x2b3d5e, _0x37e66e = document['getElementById'](_0x2caaf6); _0x37e66e[_0x7feb64(0x2f7)] = '', _0x79fbb7[_0x7feb64(0x8d2)][_0x7feb64(0x8f0)](_0x5e2f93 => { const _0x473bab = _0x7feb64; if (_0x473bab(0x8c2) === _0x473bab(0x8c2)) { const _0xe03cb4 = document[_0x473bab(0x4f8)](_0x473bab(0x7bd)); _0xe03cb4[_0x473bab(0x2ff)] = _0x5e2f93['id'], _0xe03cb4[_0x473bab(0x5f4)] = _0x5e2f93[_0x473bab(0x908)], _0x37e66e[_0x473bab(0x7b9)](_0xe03cb4); } else { if (_0x28fc10['key'] === _0x473bab(0x760)) _0x4a1a53(null); _0xb1a9b6['key'] === 'Enter' && (_0x315b61['preventDefault'](), _0x4ff569()); } }); } function _0x51dcbb(_0x383fff) { const _0x21ba82 = _0x2b3d5e, _0x43f1f1 = _0x1249c2(_0x383fff), _0x3c1b01 = document['getElementById'](_0x21ba82(0x2cc)); _0x3c1b01[_0x21ba82(0x324)][_0x21ba82(0x6a7)] = ''; let _0x3b8efe = document['getElementById']('style-' + _0x383fff); if (_0x3b8efe) _0x3b8efe['innerHTML'] = ''; if (!_0x43f1f1) return; _0x43f1f1['chatWallpaper'] && ('HldqF' !== _0x21ba82(0x454) ? _0x53a806 ? _0x4b461d(_0x51fe51) : _0x2e651(new _0xba923c(_0x21ba82(0x1c5))) : (_0x3c1b01[_0x21ba82(0x324)][_0x21ba82(0x6a7)] = 'url(\x27' + _0x43f1f1['chatWallpaper'] + '\x27)', _0x3c1b01['style'][_0x21ba82(0x93f)] = _0x21ba82(0x876), _0x3c1b01[_0x21ba82(0x324)][_0x21ba82(0x203)] = _0x21ba82(0x51e))); if (_0x43f1f1[_0x21ba82(0x23f)]) { if ('ixLpp' === 'ixLpp') { let _0x5b7120 = document[_0x21ba82(0x1f3)](_0x21ba82(0x3cd) + _0x43f1f1['id']); !_0x5b7120 && ('ZjwkY' !== _0x21ba82(0x586) ? (_0x5b7120 = document[_0x21ba82(0x4f8)](_0x21ba82(0x324)), _0x5b7120['id'] = _0x21ba82(0x3cd) + _0x43f1f1['id'], document[_0x21ba82(0x58a)][_0x21ba82(0x7b9)](_0x5b7120)) : _0x5f0cc1(!![])); const _0x176e7b = _0x43f1f1[_0x21ba82(0x23f)], _0x517de3 = _0x176e7b[_0x21ba82(0x1c3)](/\.bubble\.sent/g, _0x21ba82(0x177) + _0x43f1f1['id'] + _0x21ba82(0x85a))[_0x21ba82(0x1c3)](/\.bubble\.received/g, _0x21ba82(0x177) + _0x43f1f1['id'] + _0x21ba82(0x92f)); _0x5b7120[_0x21ba82(0x2f7)] = _0x517de3; } else _0x884eb2 = {}; } } function _0x5d4b05() { const _0x5bae2b = _0x2b3d5e, _0x4229eb = document[_0x5bae2b(0x1f3)]('user-post-attachment-preview'); _0x4229eb[_0x5bae2b(0x2f7)] = ''; const _0x4e6332 = _0x573c7e => { const _0x4d2132 = _0x5bae2b; _0x79fbb7['pendingPostAttachments'][_0x573c7e] = null; if (_0x573c7e === _0x4d2132(0x74f)) _0x79fbb7[_0x4d2132(0x8ec)][_0x4d2132(0x116)] = null; _0x5d4b05(); }, _0x239058 = _0x79fbb7[_0x5bae2b(0x8ec)]['imageId'], _0x365875 = _0x79fbb7[_0x5bae2b(0x8ec)]['music']; if (_0x239058) { const _0x56bce0 = document[_0x5bae2b(0x4f8)](_0x5bae2b(0x8dc)); _0x56bce0[_0x5bae2b(0x1dc)] = _0x5bae2b(0x6d6), _0x56bce0[_0x5bae2b(0x2f7)] = _0x5bae2b(0x591), _0x56bce0['querySelector'](_0x5bae2b(0x88e))['onclick'] = () => _0x4e6332(_0x5bae2b(0x74f)), _0x4229eb[_0x5bae2b(0x7b9)](_0x56bce0), _0x3db342(_0x239058)['then'](_0x146c4d => { const _0x553a93 = _0x5bae2b; if ('RYypW' === _0x553a93(0x48e)) { const _0x5ca929 = document[_0x553a93(0x1f3)]('pending-post-image-preview'); _0x5ca929 && _0x146c4d && (_0x5ca929[_0x553a93(0x465)] = URL[_0x553a93(0x4af)](_0x146c4d)); } else { const _0x3c67c5 = _0x6b506a, _0x3334ba = _0x3c67c5[_0x553a93(0x939)], _0x355a01 = _0x3c67c5[_0x553a93(0x144)]; _0x55b622[_0x553a93(0x111)] += 0x64, _0xe05bb6(), _0x51bda0(() => { const _0x5940c5 = _0x553a93, _0x404aa4 = _0x3c67c5[_0x5940c5(0x939)]; _0x3c67c5[_0x5940c5(0x144)] = _0x355a01 + (_0x404aa4 - _0x3334ba); }); } }); } if (_0x365875) { if ('ghyqg' !== _0x5bae2b(0x5c6)) { const _0x39252d = document['createElement'](_0x5bae2b(0x8dc)); _0x39252d[_0x5bae2b(0x1dc)] = _0x5bae2b(0x6d6), _0x39252d[_0x5bae2b(0x2f7)] = _0x5bae2b(0x539) + (_0x365875['coverUrl'] || _0x426b80) + _0x5bae2b(0x4c0) + _0x365875['songName'] + _0x5bae2b(0x6ab) + _0x365875[_0x5bae2b(0x160)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x39252d[_0x5bae2b(0x249)](_0x5bae2b(0x88e))[_0x5bae2b(0x3dc)] = () => _0x4e6332('music'), _0x4229eb[_0x5bae2b(0x7b9)](_0x39252d); } else _0x394393[_0x5bae2b(0x4d8)] = 'chat_' + _0x4b373b[_0x5bae2b(0x653)]; } } async function _0x25ee31(_0xbe609a) { const _0x334da8 = _0x2b3d5e, _0x5e56d4 = _0x79fbb7['friendCircles'][_0x334da8(0x2aa)](_0x2e8f0c => _0x2e8f0c['id'] === _0x79fbb7[_0x334da8(0x21d)]); if (!_0x5e56d4) return; _0x585d0a(!![], '大家正在赶来回复...'), _0x79fbb7[_0x334da8(0x8b0)] = !![]; try { const _0x1336e6 = _0x5e56d4['memberCharacterIds'][_0x334da8(0x843)](_0x4103d2 => _0x1249c2(_0x4103d2))[_0x334da8(0x6a6)](Boolean), _0xdbd4af = _0x582d84(), _0x528fc7 = _0x1336e6[_0x334da8(0x843)](_0x2307e2 => { const _0x2f1330 = _0x334da8, { omniText: _0x450eb4 } = _0x354941(_0x2307e2['id'], null), _0x1bf19a = _0x3e3955(_0x2307e2['id']), _0x542714 = _0x2307e2[_0x2f1330(0x444)] && _0x2307e2['linkedWorldBookIds'][_0x2f1330(0x629)] > 0x0 ? _0x2f1330(0x611) + _0x2307e2[_0x2f1330(0x908)] + _0x2f1330(0x4a3) + _0x2307e2[_0x2f1330(0x444)][_0x2f1330(0x843)](_0x4d72f7 => _0x79fbb7[_0x2f1330(0x32e)][_0x2f1330(0x2aa)](_0x119455 => _0x119455['id'] === _0x4d72f7))[_0x2f1330(0x6a6)](Boolean)[_0x2f1330(0x843)](_0x4ae4c1 => _0x2f1330(0x27f) + _0x4ae4c1[_0x2f1330(0x908)] + '\x0a' + _0x4ae4c1[_0x2f1330(0x317)])['join']('') : ''; return _0x2f1330(0x5a3) + _0x2307e2['name'] + _0x2f1330(0x4ab) + _0x2307e2['id'] + _0x2f1330(0x468) + _0x2307e2[_0x2f1330(0x6dc)] + _0x2f1330(0x4b1) + _0x450eb4 + '\x0a' + _0x1bf19a + '\x0a' + _0x542714; })['join']('\x0a\x0a'), _0x3d495c = _0x4eadbd(_0xbe609a['authorId']) || { 'name': '用户' }, _0x13d385 = _0x3d495c[_0x334da8(0x6dc)] ? _0x334da8(0x740) + _0x3d495c[_0x334da8(0x908)] + '\x0a-\x20人设:\x20' + _0x3d495c['persona'] + '\x0a' : ''; let _0x594c06 = null; if (_0xbe609a['image']) _0x594c06 = _0xbe609a[_0x334da8(0x74f)]; else { if (_0xbe609a[_0x334da8(0x116)]) try { const _0x27a57d = await _0x3db342(_0xbe609a[_0x334da8(0x116)]); _0x27a57d && (_0x594c06 = await _0x3b4f2c(_0x27a57d)); } catch (_0x4abdf2) { console[_0x334da8(0x412)](_0x334da8(0x5a7), _0x4abdf2); } } let _0xeffb8d = _0x3d495c[_0x334da8(0x908)] + '刚刚发布了一条动态，内容是：“' + _0xbe609a[_0x334da8(0x317)] + '”'; _0x594c06 && (_0x334da8(0x576) === _0x334da8(0x79e) ? _0x4c5a9c[_0x334da8(0x899)] = !![] : _0xeffb8d += '\x20[并附上了一张图片]'); _0xbe609a[_0x334da8(0x1fb)] === _0x334da8(0x6fe) && (_0xeffb8d += _0x334da8(0x652) + _0xbe609a[_0x334da8(0x31c)] + _0x334da8(0x61f) + _0xbe609a[_0x334da8(0x160)] + ']'); const _0x2fa5dc = _0x334da8(0x247) + _0x528fc7 + '\x0a\x0a' + _0x13d385 + _0x334da8(0x5aa) + _0xdbd4af + _0x334da8(0x460) + _0xeffb8d + _0x334da8(0x5f7), _0xb6e1e1 = [{ 'role': 'system', 'content': _0x2fa5dc }], _0x427bc7 = { 'role': 'user', 'content': '请根据以上所有规则（特别是要看图！），生成对用户动态的回应。' }; if (_0x594c06) { if (_0x334da8(0x3ec) !== _0x334da8(0x14c)) _0x427bc7[_0x334da8(0x74f)] = _0x594c06; else { _0x2112bf(_0x334da8(0x580)); return; } } _0xb6e1e1[_0x334da8(0x7d8)](_0x427bc7); const _0x53a251 = await _0x53d2f8(_0xb6e1e1, { 'json': !![] }), _0x49edbd = _0x53a251[_0x334da8(0x5d3)](/({[\s\S]*})/); if (!_0x49edbd) throw new Error(_0x334da8(0x427)); const _0x2fe10b = JSON['parse'](_0x49edbd[0x1]), _0x2cc981 = _0x5e56d4[_0x334da8(0x49e)][_0x334da8(0x2aa)](_0x391f9a => _0x391f9a['id'] === _0xbe609a['id']); _0x2cc981 && (_0x2cc981[_0x334da8(0x16c)] = _0x2fe10b[_0x334da8(0x16c)] || [], _0x2cc981['comments'] = (_0x2fe10b[_0x334da8(0x7c3)] || [])[_0x334da8(0x843)]((_0x463c3a, _0x33eaeb) => ({ ..._0x463c3a, 'commentId': 'c_' + _0xbe609a[_0x334da8(0x68c)] + '_' + _0x33eaeb })), _0x43a351(), _0x4ddb2a()); } catch (_0x56cae3) { console[_0x334da8(0x412)](_0x334da8(0x656), _0x56cae3), _0x30a64e(_0x334da8(0x690)); } finally { if (_0x334da8(0x8a6) === _0x334da8(0x7a2)) return _0x323b04[_0x334da8(0x257)](_0x334da8(0x4ed)), 0x0; else _0x585d0a(![]), _0x79fbb7[_0x334da8(0x8b0)] = ![]; } } function _0x449415() { const _0x407da1 = _0x2b3d5e; if ('QTKxE' === _0x407da1(0x7c2)) { const _0x231b06 = _0x79fbb7[_0x407da1(0x70f)][_0x407da1(0x2aa)](_0x101718 => _0x101718['id'] === _0x79fbb7[_0x407da1(0x21d)]), _0x5676b7 = _0x231b06?.[_0x407da1(0x536)]; let _0xdd7ec = _0x79fbb7[_0x407da1(0x8d2)]['find'](_0x5b2e6e => _0x5b2e6e['id'] === _0x5676b7); !_0xdd7ec && (_0xdd7ec = _0x79fbb7[_0x407da1(0x8d2)]['find'](_0x925e31 => _0x925e31['id'] === _0x79fbb7[_0x407da1(0x4dd)])), !_0xdd7ec && ('RBkix' !== _0x407da1(0x83f) ? _0xdd7ec = _0x79fbb7['userProfiles'][0x0] : _0x438018[_0x407da1(0x324)][_0x407da1(0x7ab)] = _0x407da1(0x53e)), _0xdd7ec && (document['getElementById'](_0x407da1(0x3c6))[_0x407da1(0x465)] = _0xdd7ec[_0x407da1(0x71c)] || _0x4f5e50); } else { if (_0x296e00[_0x407da1(0x629)] === 0x0) return; _0x1b7550 = (_0x28214c + 0x1) % _0x252dc7[_0x407da1(0x629)], _0x10d57f(_0x344e76[_0x2b88cd], _0x3b38d6); } } function _0x29c1ad(_0xbfa28d) { const _0x49e833 = _0x2b3d5e; let _0x37fc59 = 0x0, _0x33bf76 = 0x0, _0x205fef = 0x0; if (_0xbfa28d[_0x49e833(0x629)] == 0x4) _0x37fc59 = '0x' + _0xbfa28d[0x1] + _0xbfa28d[0x1], _0x33bf76 = '0x' + _0xbfa28d[0x2] + _0xbfa28d[0x2], _0x205fef = '0x' + _0xbfa28d[0x3] + _0xbfa28d[0x3]; else _0xbfa28d[_0x49e833(0x629)] == 0x7 && ('gdDId' === 'TaJpU' ? (_0x5509ce[_0x49e833(0x865)] = null, _0x634c2e(_0x49e833(0x52a)), _0x236ef9()) : (_0x37fc59 = '0x' + _0xbfa28d[0x1] + _0xbfa28d[0x2], _0x33bf76 = '0x' + _0xbfa28d[0x3] + _0xbfa28d[0x4], _0x205fef = '0x' + _0xbfa28d[0x5] + _0xbfa28d[0x6])); _0x37fc59 /= 0xff, _0x33bf76 /= 0xff, _0x205fef /= 0xff; let _0x246f8b = Math[_0x49e833(0x92a)](_0x37fc59, _0x33bf76, _0x205fef), _0xe66479 = Math['max'](_0x37fc59, _0x33bf76, _0x205fef), _0x32f814 = _0xe66479 - _0x246f8b, _0x5a5ca0 = 0x0, _0x3f09b1 = 0x0, _0x3a97fb = 0x0; if (_0x32f814 == 0x0) _0x5a5ca0 = 0x0; else { if (_0xe66479 == _0x37fc59) _0x5a5ca0 = (_0x33bf76 - _0x205fef) / _0x32f814 % 0x6; else { if (_0xe66479 == _0x33bf76) _0x5a5ca0 = (_0x205fef - _0x37fc59) / _0x32f814 + 0x2; else _0x5a5ca0 = (_0x37fc59 - _0x33bf76) / _0x32f814 + 0x4; } } _0x5a5ca0 = Math[_0x49e833(0x8d6)](_0x5a5ca0 * 0x3c); if (_0x5a5ca0 < 0x0) _0x5a5ca0 += 0x168; return _0x3a97fb = (_0xe66479 + _0x246f8b) / 0x2, _0x3f09b1 = _0x32f814 == 0x0 ? 0x0 : _0x32f814 / (0x1 - Math[_0x49e833(0x8ad)](0x2 * _0x3a97fb - 0x1)), _0x3f09b1 = +(_0x3f09b1 * 0x64)[_0x49e833(0x145)](0x1), _0x3a97fb = +(_0x3a97fb * 0x64)[_0x49e833(0x145)](0x1), { 'h': _0x5a5ca0, 's': _0x3f09b1, 'l': _0x3a97fb }; } function _0x47f822() { const _0x13b9be = _0x2b3d5e, _0x30d811 = (_0x3ef91b, _0x534bf3, _0x703a) => { const _0x53d741 = _0x1507, _0x15c626 = document['getElementById'](_0x3ef91b); if (!_0x15c626) return; let _0x102379 = null; try { _0x102379 = JSON[_0x53d741(0x4f6)](localStorage[_0x53d741(0xfc)](_0x534bf3) || '{}'); } catch { if (_0x53d741(0x26e) === _0x53d741(0x26e)) _0x102379 = {}; else { const _0x300436 = _0xdf5acc['createElement'](_0x53d741(0x8dc)); _0x300436[_0x53d741(0x1dc)] = _0x53d741(0x895); const _0x2ce0fe = _0x353a68[_0x53d741(0x876)] ? _0x1f6645[_0x53d741(0x4af)](_0x5cd872['cover']) : _0x47f109; _0x300436[_0x53d741(0x2f7)] = _0x53d741(0x37c) + _0x2ce0fe + _0x53d741(0x87b) + (_0x4f9539['info'][_0x53d741(0x398)] || _0x53d741(0x7fb)) + _0x53d741(0x8a1) + (_0x49272c[_0x53d741(0xfb)]['歌手'] || _0x53d741(0x7c7)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x300436[_0x53d741(0x3eb)](_0x53d741(0x1a4), () => { _0x43e52f(_0x584dbe); }), _0x49111c[_0x53d741(0x7b9)](_0x300436); } } _0x15c626[_0x53d741(0x324)][_0x53d741(0x4fe)] = _0x53d741(0x802), _0x15c626[_0x53d741(0x324)]['top'] = '', _0x15c626['style']['left'] = '', _0x15c626[_0x53d741(0x324)][_0x53d741(0x470)] = '', _0x15c626[_0x53d741(0x324)]['bottom'] = '', _0x15c626[_0x53d741(0x324)]['transform'] = ''; if (typeof _0x102379[_0x53d741(0x65a)] === _0x53d741(0x929) && typeof _0x102379[_0x53d741(0x173)] === 'number') _0x15c626[_0x53d741(0x324)][_0x53d741(0x65a)] = _0x102379['top'] + '%', _0x15c626[_0x53d741(0x324)]['left'] = _0x102379[_0x53d741(0x173)] + '%'; else { if (_0x53d741(0x4a2) !== _0x53d741(0x4a2)) _0x57cfa6[_0x53d741(0x465)] = _0x35cde3[_0x53d741(0x4af)](_0x2bc169); else for (const _0x251f93 in _0x703a) { _0x15c626[_0x53d741(0x324)][_0x251f93] = _0x703a[_0x251f93]; } } }; _0x30d811(_0x13b9be(0x85c), _0x13b9be(0x8d3), { 'top': _0x13b9be(0x2c8), 'left': _0x13b9be(0x905), 'transform': _0x13b9be(0x25d) }), _0x30d811(_0x13b9be(0x447), _0x13b9be(0x6b4), { 'top': _0x13b9be(0x123), 'right': '4%' }), _0x30d811(_0x13b9be(0x86c), _0x13b9be(0x1c2), { 'top': _0x13b9be(0x123), 'right': '28%' }), _0x30d811('app-settings', 'appIconPosition_app-settings', { 'top': '8%', 'right': _0x13b9be(0x55a) }), _0x30d811(_0x13b9be(0x8eb), 'appIconPosition_app-world-book', { 'top': '8%', 'right': '4%' }), _0x30d811(_0x13b9be(0x2b0), 'appIconPosition_app-music-library', { 'top': _0x13b9be(0x76c), 'left': '5%' }), _0x30d811(_0x13b9be(0x827), 'appIconPosition_app-diary', { 'top': '71%', 'left': _0x13b9be(0x1ca) }), _0x30d811(_0x13b9be(0x3ed), _0x13b9be(0x198), { 'top': _0x13b9be(0x27c), 'left': '7%' }), _0x30d811('app-accounting', _0x13b9be(0x5a5), { 'top': _0x13b9be(0x76c), 'left': _0x13b9be(0x1ca) }), _0x30d811(_0x13b9be(0x125), _0x13b9be(0x217), { 'top': _0x13b9be(0x6b9), 'right': '5%' }), _0x30d811(_0x13b9be(0x80e), _0x13b9be(0x75d), { 'top': '8%', 'left': '5%' }); const _0xb08d3e = document[_0x13b9be(0x1f3)](_0x13b9be(0x200)); _0xb08d3e && (_0x13b9be(0x1fc) !== _0x13b9be(0x62e) ? (_0xb08d3e['style']['position'] = _0x13b9be(0x802), _0xb08d3e[_0x13b9be(0x324)][_0x13b9be(0x65a)] = _0x13b9be(0x103), _0xb08d3e['style'][_0x13b9be(0x173)] = _0x13b9be(0x905), _0xb08d3e[_0x13b9be(0x324)][_0x13b9be(0x23a)] = 'translateX(-50%)', _0xb08d3e[_0x13b9be(0x324)][_0x13b9be(0x7ab)] = _0x13b9be(0x53e)) : _0x3cbd33[_0x13b9be(0x1c0)] && _0x5969fd[_0x13b9be(0x1c0)][_0x13b9be(0x91d)] && (_0x5a861d[_0x13b9be(0x324)][_0x13b9be(0x7ab)] = _0x13b9be(0x585), _0x3c359d(() => _0x2df653[_0x13b9be(0x43d)][_0x13b9be(0x20f)](_0x13b9be(0x920)), 0xa))); const _0x54a3b3 = document[_0x13b9be(0x1f3)](_0x13b9be(0x6c6)); _0x54a3b3 && ('JKzZa' !== _0x13b9be(0x752) ? (_0x3b70e2(![]), _0x530cdb[_0x13b9be(0x381)][_0x13b9be(0x2ff)] = '') : (_0x54a3b3[_0x13b9be(0x324)][_0x13b9be(0x4fe)] = _0x13b9be(0x802), _0x54a3b3[_0x13b9be(0x324)][_0x13b9be(0x65a)] = '35%', _0x54a3b3['style'][_0x13b9be(0x173)] = _0x13b9be(0x905), _0x54a3b3[_0x13b9be(0x324)]['transform'] = _0x13b9be(0x25d), _0x54a3b3[_0x13b9be(0x324)][_0x13b9be(0x7ab)] = 'inline-block')); } function _0x4dc290() { const _0x1aaa2a = _0x2b3d5e; if (_0x1aaa2a(0x849) !== 'FWpFj') { const _0x488e76 = document[_0x1aaa2a(0x1f3)]('custom-icon-list-container'); _0x488e76[_0x1aaa2a(0x2f7)] = ''; const _0xfce965 = document[_0x1aaa2a(0x5ec)](_0x1aaa2a(0x1d0)); _0xfce965[_0x1aaa2a(0x8f0)](_0x730ef9 => { const _0x449b78 = _0x1aaa2a; if (_0x449b78(0x693) !== _0x449b78(0x155)) { const _0x492674 = _0x730ef9['id'], _0x202b6b = _0x730ef9[_0x449b78(0x249)](_0x449b78(0x5c4))[_0x449b78(0x5f4)], _0xdd434f = 'customIcon_' + _0x492674, _0x1fcc80 = localStorage[_0x449b78(0xfc)](_0xdd434f), _0x17e50d = document[_0x449b78(0x4f8)](_0x449b78(0x8dc)); _0x17e50d[_0x449b78(0x1dc)] = 'member-selection-item', _0x17e50d[_0x449b78(0x324)][_0x449b78(0x37b)] = _0x449b78(0x8aa), _0x17e50d[_0x449b78(0x2f7)] = _0x449b78(0x3de) + _0x492674 + _0x449b78(0x184) + (_0x1fcc80 || _0x449b78(0x8bd)) + _0x449b78(0x426) + _0x202b6b + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20id=\x22input_' + _0x492674 + _0x449b78(0x842) + _0x492674 + _0x449b78(0x492) + _0xdd434f + '\x27);\x20location.reload();\x22>恢复</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x488e76[_0x449b78(0x7b9)](_0x17e50d); const _0x3ef667 = document[_0x449b78(0x1f3)]('input_' + _0x492674); _0x3ef667[_0x449b78(0x3eb)](_0x449b78(0x3b3), async _0x1819fe => { const _0x18c211 = _0x449b78, _0x4542de = _0x1819fe[_0x18c211(0x381)][_0x18c211(0x5b7)][0x0]; if (!_0x4542de) return; try { const _0xc5fa78 = await _0x7c9580(_0x4542de); localStorage[_0x18c211(0x54a)](_0xdd434f, _0xc5fa78), document[_0x18c211(0x1f3)](_0x18c211(0x763) + _0x492674)[_0x18c211(0x465)] = _0xc5fa78, _0x59d5da(); } catch (_0x4317f5) { _0x30a64e(_0x18c211(0x330) + _0x4317f5['message']); } }); } else { const _0x1c1cc9 = _0x44600f[_0x449b78(0x4f8)]('div'); _0x1c1cc9[_0x449b78(0x1dc)] = _0x449b78(0x6c9), _0x1c1cc9['id'] = _0x449b78(0x325) + _0x5aa49a, _0x226443 === _0x4e8287[_0x449b78(0x800)] && _0x1c1cc9[_0x449b78(0x43d)][_0x449b78(0x20f)](_0x449b78(0x51b)), _0x24f4a9[_0x449b78(0x8f0)](_0x2b40f7 => { const _0x584a5b = _0x449b78, _0xe7db8c = _0x2b40f7[_0x584a5b(0x7b3)] === _0x584a5b(0x721) ? _0x584a5b(0x721) : 'ai', _0x55933f = _0x2b40f7[_0x584a5b(0x7b3)] === _0x584a5b(0x721) ? _0x132fef[_0x584a5b(0x908)] : _0x2b3927(_0x2b40f7[_0x584a5b(0x7b3)])[_0x584a5b(0x908)], _0x1b6dce = _0xb611af[_0x584a5b(0x4f8)](_0x584a5b(0x8dc)); _0x1b6dce[_0x584a5b(0x1dc)] = _0x584a5b(0x6a3) + _0xe7db8c, _0x1b6dce[_0x584a5b(0x78e)][_0x584a5b(0x68c)] = _0x2b40f7[_0x584a5b(0x68c)], _0x1b6dce['style'][_0x584a5b(0x12b)] = 'none', _0x1b6dce[_0x584a5b(0x324)][_0x584a5b(0x4fd)] = '0', _0x1b6dce[_0x584a5b(0x2f7)] = _0x584a5b(0x87d) + _0x55933f + _0x584a5b(0x67c) + new _0x218e49(_0x2b40f7[_0x584a5b(0x68c)])[_0x584a5b(0x52e)](_0x584a5b(0x805)) + _0x584a5b(0x3ab) + _0x2b40f7[_0x584a5b(0x317)][_0x584a5b(0x1c3)](/\n/g, _0x584a5b(0x2a5)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x1c1cc9['appendChild'](_0x1b6dce); }), _0xd21a94[_0x449b78(0x7b9)](_0x1c1cc9); } }); } else { const _0x2953a5 = _0xce3ff6[_0x1aaa2a(0x2ff)][_0x1aaa2a(0x538)](); if (!_0x2953a5) { _0x3fcc18(_0x1aaa2a(0x3c2)); return; } const _0x23bc18 = _0x71e74a[_0x1aaa2a(0x910)](_0x578094[_0x1aaa2a(0x5ec)](_0x1aaa2a(0x187)))[_0x1aaa2a(0x843)](_0x599c58 => _0x599c58[_0x1aaa2a(0x78e)]['id']); if (_0x23bc18[_0x1aaa2a(0x629)] < 0x2) { _0x45ac19(_0x1aaa2a(0x866)); return; } const _0x3cedfc = { 'id': _0x1aaa2a(0x42a) + _0x3a6f26[_0x1aaa2a(0x86b)](), 'type': _0x1aaa2a(0x680), 'name': _0x2953a5, 'participantIds': _0x23bc18 }; _0x5db7de[_0x1aaa2a(0x4c9)][_0x1aaa2a(0x7d8)](_0x3cedfc), _0xa13fb3[_0x1aaa2a(0x4d8)] = _0x3cedfc['id'], _0x418e1f(), _0x584288(), _0x746539(), _0x23d816(), _0x111358(_0x1aaa2a(0x71f) + _0x2953a5 + '”已创建！'), _0x30b475('chat', _0x1aaa2a(0x64d)); } } function _0x59d5da() { const _0x34be33 = _0x2b3d5e; if ('zcdoB' === _0x34be33(0x59d)) { const _0x32d3bb = document[_0x34be33(0x5ec)](_0x34be33(0x1d0)); _0x32d3bb[_0x34be33(0x8f0)](_0x5529c6 => { const _0x4dd0c0 = _0x34be33, _0x32e5a0 = _0x5529c6['id'], _0x273ec6 = 'customIcon_' + _0x32e5a0, _0x362454 = localStorage[_0x4dd0c0(0xfc)](_0x273ec6), _0x3a1d39 = _0x5529c6[_0x4dd0c0(0x249)](_0x4dd0c0(0x604)); if (_0x362454) _0x3a1d39[_0x4dd0c0(0x2f7)] = '<img\x20src=\x22' + _0x362454 + '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>'; else { const _0x9abd3c = document['querySelector'](_0x4dd0c0(0x6a9) + _0x32e5a0 + _0x4dd0c0(0x185) + _0x32e5a0 + '\x20.app-icon-img')?.[_0x4dd0c0(0x2f7)]; _0x9abd3c && (_0x3a1d39[_0x4dd0c0(0x2f7)] = _0x9abd3c); } }); } else _0x5f3a04[_0x34be33(0x8b8)] = ![]; } function _0xbf78cd() { const _0x45160c = _0x2b3d5e, _0x42f9f1 = _0x79fbb7[_0x45160c(0x70f)][_0x45160c(0x2aa)](_0x186167 => _0x186167['id'] === _0x79fbb7['activeFriendCircleId']), _0x1759d1 = _0x3f4d37(); let _0x58542f = []; if (_0x42f9f1 && _0x42f9f1[_0x45160c(0x49e)]) { const _0x1dffdd = _0x42f9f1[_0x45160c(0x49e)]['filter'](_0x192b7e => _0x192b7e['type'] === 'music' && _0x192b7e[_0x45160c(0x8b7)])[_0x45160c(0x843)](_0x32649c => ({ ..._0x32649c, 'source': _0x45160c(0x534) })); _0x58542f['push'](..._0x1dffdd); } if (_0x1759d1 && _0x79fbb7['conversationHistory']) { const _0x4f482b = _0x79fbb7[_0x45160c(0x623)][_0x45160c(0x6a6)](_0x1696a9 => _0x1696a9['type'] === _0x45160c(0x6fe) && _0x1696a9[_0x45160c(0x8b7)])[_0x45160c(0x843)](_0xd6408a => ({ ..._0xd6408a, 'source': 'chat' })); _0x58542f[_0x45160c(0x7d8)](..._0x4f482b); } const _0x3a8aee = Array[_0x45160c(0x910)](new Map(_0x58542f['map'](_0x43eb17 => [_0x43eb17['playableUrl'], _0x43eb17]))[_0x45160c(0x869)]()); _0x79fbb7[_0x45160c(0x3d5)] = _0x3a8aee[_0x45160c(0x2c1)]((_0x3e47de, _0x46d92d) => _0x46d92d[_0x45160c(0x68c)] - _0x3e47de['timestamp']); } function _0x557b26(_0x503a3c) { const _0x4f9a2e = _0x2b3d5e; if (_0x503a3c < 0x0 || _0x503a3c >= _0x37e830[_0x4f9a2e(0x629)]) return; _0x8c8774 = _0x503a3c; const _0x499ace = _0x37e830[_0x503a3c]; _0x10c451[_0x4f9a2e(0x465)] = _0x499ace[_0x4f9a2e(0x8b7)] || _0x499ace[_0x4f9a2e(0x30d)], _0x10c451[_0x4f9a2e(0x7e9)](), _0x31eee5(), _0x22bb62(); } function _0x31eee5() { const _0x5f05c6 = _0x37e830[_0x8c8774]; _0x4bdbb1(_0x5f05c6); } function _0x22bb62() { const _0x52d073 = _0x2b3d5e; try { localStorage[_0x52d073(0x54a)](_0x52d073(0x8ca), JSON['stringify']({ 'playlist': _0x79fbb7[_0x52d073(0x3d5)], 'currentIndex': _0x79fbb7['currentlyPlayingIndex'] })); } catch (_0x54e3af) { if ('xGIcs' === 'xGIcs') console[_0x52d073(0x412)](_0x52d073(0x461), _0x54e3af); else { const _0x278a9b = _0x46b393[_0x52d073(0x4f8)](_0x52d073(0x8dc)); _0x278a9b[_0x52d073(0x1dc)] = _0x52d073(0x12a), _0x278a9b[_0x52d073(0x324)][_0x52d073(0x12e)] = _0x52d073(0x49a), _0x278a9b[_0x52d073(0x324)][_0x52d073(0x2a0)] = _0x52d073(0x108), _0x278a9b[_0x52d073(0x324)][_0x52d073(0x37b)] = _0x52d073(0x674), _0x278a9b['style'][_0x52d073(0x418)] = '0'; const _0x535fac = _0x2d99f8[_0x1c80d9[_0x52d073(0x3d8)]] || _0x3de8c9['默认'], _0x32a928 = '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>' + _0x535fac + '</svg>', _0x53a178 = _0x52d073(0x1bc) + _0x32a928 + _0x52d073(0x6a2) + _0x4f7321['description'] + _0x52d073(0x5e0) + (_0x2ba9c8[_0x52d073(0x3d8)] || _0x52d073(0x484)) + _0x52d073(0x3d1) + (_0x3d0b00[_0x52d073(0x1aa)] || 0x0)['toFixed'](0x2) + _0x52d073(0x6ba); let _0x52d8ea = ''; if (_0x3f1c36[_0x52d073(0x1e7)] && _0x712fd0['review'][_0x52d073(0x552)]) { const _0x285ccc = _0x5734b3(_0x3f38b3[_0x52d073(0x1e7)]['charId']); _0x285ccc && (_0x52d8ea = _0x52d073(0x5ac) + _0x285ccc['avatar'] + _0x52d073(0x616) + _0x285ccc[_0x52d073(0x908)] + '</div><div\x20class=\x22review-text\x22\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x20line-height:\x201.5;\x22>' + _0x410645[_0x52d073(0x1e7)][_0x52d073(0x6b3)] + _0x52d073(0x729)); } _0x278a9b[_0x52d073(0x2f7)] = _0x53a178 + _0x52d8ea, _0x2de82d['appendChild'](_0x278a9b); } } } function _0x118beb() { const _0x1690c9 = _0x2b3d5e; if (_0x1690c9(0x281) !== _0x1690c9(0x700)) try { if ('OmWEH' !== _0x1690c9(0x2c9)) { const _0x51fe3a = _0x37d939(_0x592427['content'] ?? _0x5b4d65[_0x1690c9(0x6b3)] ?? '')[_0x1690c9(0x538)]() || _0x1690c9(0x4c4) + (_0x4c7aab || _0x1690c9(0x91e)) + ']'; if (_0x51fe3a) _0x37904c[_0x1690c9(0x61e)]['push']({ 'senderId': _0x758197['id'], 'kind': _0x1690c9(0x6b3), 'content': _0x51fe3a }); } else { const _0x4dd0a3 = localStorage[_0x1690c9(0xfc)](_0x1690c9(0x8ca)); if (_0x4dd0a3) { if (_0x1690c9(0x49d) === _0x1690c9(0x49d)) { const { playlist: _0x39a66e, currentIndex: _0x57a30a } = JSON[_0x1690c9(0x4f6)](_0x4dd0a3); Array[_0x1690c9(0x660)](_0x39a66e) && _0x39a66e['length'] > 0x0 && _0x57a30a > -0x1 && ('racly' === _0x1690c9(0x1a5) ? (_0x79fbb7[_0x1690c9(0x3d5)] = _0x39a66e, _0x79fbb7[_0x1690c9(0x51f)] = _0x57a30a, _0x79fbb7[_0x1690c9(0x79c)] = ![], _0x31eee5()) : _0x1a0bdb[_0x1690c9(0x412)]('Failed\x20to\x20remove\x20corrupted\x20state\x20from\x20localStorage:', _0x4621ae)); } else { if (_0x221f93[_0x1690c9(0x629)] === 0x0) return; _0x2adde6 = (_0x3d8880 - 0x1 + _0x3b73e7[_0x1690c9(0x629)]) % _0x929c13[_0x1690c9(0x629)], _0x1d6a2a(_0x451861[_0x3d642d], _0x132897); } } } } catch (_0x5704d6) { console[_0x1690c9(0x412)](_0x1690c9(0x5a0), _0x5704d6); } else { _0x179023[_0x1690c9(0x64a)] = _0x15342c, _0x15099c[_0x1690c9(0x7ad)][_0x5dfcef['id']] = [..._0x4fded5], _0xd7dcea(); const _0x5d27f8 = _0x20f37f[_0x1690c9(0x843)](_0x42795 => _0x42795['speaker'] === _0x1690c9(0x488) ? _0x42795[_0x1690c9(0x844)] : _0x42795[_0x1690c9(0x806)] + ':\x20' + _0x42795[_0x1690c9(0x844)])[_0x1690c9(0x26c)]('\x0a\x0a'); _0x42e52e[_0x1690c9(0x623)][_0x1690c9(0x7d8)]({ 'role': _0x1690c9(0x2ea), 'senderId': _0x267c2f['id'], 'timestamp': _0x41e0a3['now'](), 'isOffline': !![], 'content': _0x5d27f8 }); } } function _0x27f9fb(_0x4cf26b) { const _0x4bbd56 = _0x2b3d5e; if (window[_0x4bbd56(0x445)]) clearTimeout(window[_0x4bbd56(0x445)]); const _0x45780b = _0x4cf26b['target'][_0x4bbd56(0x3d6)](_0x4bbd56(0x666)); if (!_0x45780b) return; const _0x1942ce = _0x45780b[_0x4bbd56(0x78e)][_0x4bbd56(0x68c)], _0x2ecca1 = _0x45780b[_0x4bbd56(0x43d)][_0x4bbd56(0x545)](_0x4bbd56(0x721)) ? 'user' : 'ai'; if (!_0x1942ce) return; const _0x1ce89f = () => { window['diaryPressTimer'] = setTimeout(() => { const _0x44d962 = _0x1507; if (_0x4cf26b[_0x44d962(0x1fb)] === _0x44d962(0x14e)) _0x4cf26b['preventDefault'](); _0x4538aa(parseInt(_0x1942ce, 0xa), _0x2ecca1); }, 0x320); }, _0x529733 = () => { const _0x4387f0 = _0x4bbd56; if ('VmDDa' !== _0x4387f0(0x261)) _0xf407ed(_0x4387f0(0x16d) + _0x40c1a7[_0x4387f0(0x227)]); else { if (window[_0x4387f0(0x445)]) clearTimeout(window[_0x4387f0(0x445)]); } }; document[_0x4bbd56(0x3eb)](_0x4bbd56(0x58c), _0x529733, { 'once': !![] }), document[_0x4bbd56(0x3eb)](_0x4bbd56(0x718), _0x529733, { 'once': !![] }), document['addEventListener'](_0x4bbd56(0x2b8), _0x529733, { 'once': !![] }), _0x1ce89f(); } function _0x4538aa(_0x2a8112, _0x1c2411) { const _0x51901b = _0x2b3d5e; if (_0x51901b(0x715) === _0x51901b(0x715)) { const _0x35e141 = 'diary-action-modal-' + _0x2a8112; let _0x23359a = document[_0x51901b(0x1f3)](_0x35e141); if (_0x23359a) return; const _0x49ab66 = '\x0a\x20\x20\x20\x20<div\x20id=\x22' + _0x35e141 + '\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#dc3545;\x22>删除这篇日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20' + (_0x1c2411 === 'ai' ? _0x51901b(0x56b) : '') + _0x51901b(0x6f9); document['body'][_0x51901b(0x107)]('beforeend', _0x49ab66); const _0x2bb665 = document[_0x51901b(0x1f3)](_0x35e141), _0x3a79ee = () => _0x2bb665[_0x51901b(0x154)](); _0x2bb665['querySelector'](_0x51901b(0x24f))[_0x51901b(0x3dc)] = _0x3a79ee, _0x2bb665[_0x51901b(0x249)](_0x51901b(0x932))[_0x51901b(0x3dc)] = _0x3a79ee, _0x2bb665[_0x51901b(0x249)](_0x51901b(0x20c))[_0x51901b(0x3dc)] = () => { _0x5238d9(_0x2a8112), _0x3a79ee(); }, _0x1c2411 === 'ai' && (_0x2bb665['querySelector']('#diary-action-reroll')[_0x51901b(0x3dc)] = () => { _0x49e2d3(_0x2a8112), _0x3a79ee(); }); } else _0x5ea022[_0x51901b(0x739)](_0x2f1ccb, _0x5b5218[_0x51901b(0x7cc)]); } async function _0x5238d9(_0x4927d2) { const _0x2c66e2 = _0x2b3d5e, _0x15aaaa = await _0x21bcbb(_0x2c66e2(0x3af)); if (!_0x15aaaa) return; const _0x680c4b = _0x79fbb7[_0x2c66e2(0x84d)][_0x2c66e2(0x2aa)](_0x4b4540 => _0x4b4540['characterId'] === _0x79fbb7[_0x2c66e2(0x778)]); if (!_0x680c4b) return; const _0x2e025a = _0x680c4b[_0x2c66e2(0x417)][_0x2c66e2(0x561)](_0x9178cc => _0x9178cc[_0x2c66e2(0x68c)] === _0x4927d2); if (_0x2e025a > -0x1) { if (_0x2c66e2(0x21b) === 'IaODi') { if (_0x2c27df[_0x2c66e2(0x5f2)] === _0x2c66e2(0x2ea)) { const _0x323fbc = _0x1123ac['characterLastScripts'][_0x50ca4a]; _0x323fbc && _0x323fbc[_0x2c66e2(0x629)] > 0x0 && (_0x453e13 = _0x323fbc['at'](-0x1)); } else _0xa5ef2e = { 'speaker': _0x169b8e['name'], 'line': _0x37a8a8[_0x2c66e2(0x317)], 'emotion': 'normal' }; } else _0x680c4b[_0x2c66e2(0x417)][_0x2c66e2(0x76e)](_0x2e025a, 0x1), _0x43a351(), _0x3dc170(), _0x30a64e(_0x2c66e2(0x741)); } } async function _0x49e2d3(_0x5c4348) { const _0x41f944 = _0x2b3d5e, _0x47609d = _0x79fbb7[_0x41f944(0x84d)]['find'](_0x282be1 => _0x282be1[_0x41f944(0x350)] === _0x79fbb7[_0x41f944(0x778)]); if (!_0x47609d) return; const _0x1a2779 = _0x47609d['entries']['findIndex'](_0x5ddc91 => _0x5ddc91[_0x41f944(0x68c)] === _0x5c4348); if (_0x1a2779 > -0x1) { if (_0x41f944(0x4a9) !== 'bBwxo') { const _0x2eeecb = _0x1ad1ae[_0x41f944(0x4f6)](_0x3d1f36['getItem'](_0x41f944(0x217)) || '{}'), _0x3b294c = { ..._0x2eeecb, ..._0x3a45cc }; _0x40b1f5[_0x41f944(0x54a)](_0x41f944(0x217), _0x33bae5['stringify'](_0x3b294c)); } else _0x47609d['entries'][_0x41f944(0x76e)](_0x1a2779, 0x1), _0x43a351(), _0x3dc170(), await _0x9461c8(); } } function _0x57ad1e() { const _0x189e81 = _0x2b3d5e, _0x2af188 = document[_0x189e81(0x1f3)]('diary-list-container'); _0x2af188['innerHTML'] = ''; const _0x5b3dc6 = _0x79fbb7[_0x189e81(0x44f)]['filter'](_0x4ad926 => _0x79fbb7[_0x189e81(0x4c9)][_0x189e81(0x560)](_0x31d69b => _0x31d69b['type'] === _0x189e81(0x91f) && _0x31d69b[_0x189e81(0x285)][_0x189e81(0x5ad)](_0x4ad926['id']))); if (_0x5b3dc6[_0x189e81(0x629)] === 0x0) { _0x2af188[_0x189e81(0x2f7)] = _0x189e81(0x1f1); return; } _0x5b3dc6[_0x189e81(0x8f0)](_0x2d6e39 => { const _0x1147a7 = _0x189e81, _0x1d9db3 = document[_0x1147a7(0x4f8)]('li'); _0x1d9db3[_0x1147a7(0x1dc)] = _0x1147a7(0x880), _0x1d9db3[_0x1147a7(0x78e)][_0x1147a7(0x552)] = _0x2d6e39['id'], _0x1d9db3['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x2d6e39[_0x1147a7(0x71c)] || _0x426b80) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0x2d6e39['name'] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>翻开日记本...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22toolbar-button\x20diary-delete-btn\x22\x20title=\x22清空这本日记\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline><path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path><line\x20x1=\x2210\x22\x20y1=\x2211\x22\x20x2=\x2210\x22\x20y2=\x2217\x22></line><line\x20x1=\x2214\x22\x20y1=\x2211\x22\x20x2=\x2214\x22\x20y2=\x2217\x22></line></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x1d9db3[_0x1147a7(0x3eb)](_0x1147a7(0x1a4), () => { const _0xdd81c0 = _0x1147a7; _0xdd81c0(0x473) === _0xdd81c0(0x473) ? _0xe14127(_0x2d6e39['id']) : _0x5d2502[_0xdd81c0(0x54a)](_0x31a744, _0x37088d[_0xdd81c0(0x10c)][_0x5b5dc9]); }), _0x1d9db3[_0x1147a7(0x249)]('.char-info-wrapper')['addEventListener'](_0x1147a7(0x1a4), () => { _0xe14127(_0x2d6e39['id']); }), _0x1d9db3[_0x1147a7(0x249)]('.diary-delete-btn')[_0x1147a7(0x3eb)](_0x1147a7(0x1a4), _0x29474e => { const _0x309a31 = _0x1147a7; _0x29474e[_0x309a31(0x4c8)](), _0x2a4e97(_0x2d6e39['id']); }), _0x2af188['appendChild'](_0x1d9db3); }); } function _0xe14127(_0x1f685a) { const _0x8cd37d = _0x2b3d5e; if (_0x8cd37d(0x46b) === _0x8cd37d(0x46b)) { const _0x952083 = _0x1249c2(_0x1f685a); if (!_0x952083) return; _0x79fbb7['activeDiaryCharacterId'] = _0x1f685a; const _0x5e7cf6 = _0x79fbb7[_0x8cd37d(0x84d)][_0x8cd37d(0x2aa)](_0x4a24ef => _0x4a24ef['characterId'] === _0x1f685a), _0x14857b = _0x5e7cf6 ? _0x5e7cf6['entries'][_0x8cd37d(0x629)] : 0x0, _0x3a8540 = 0x2; _0x79fbb7[_0x8cd37d(0x800)] = Math[_0x8cd37d(0x811)](0x0, Math['ceil'](_0x14857b / _0x3a8540) - 0x1), document[_0x8cd37d(0x1f3)]('diary-char-name-header')['textContent'] = _0x952083[_0x8cd37d(0x908)] + _0x8cd37d(0x77a), _0x3dc170(), _0x465abb(_0x8cd37d(0x134), 'diaryList'); } else { if (!_0x4b9aca['friendCircles'] || _0x37d583[_0x8cd37d(0x70f)][_0x8cd37d(0x629)] === 0x0) { _0x46e83d['error'](_0x8cd37d(0x6af)); return; } const _0x23b90a = _0x294989['friendCircles'][0x0]; if (_0x23b90a[_0x8cd37d(0x150)]['length'] < 0x2) { _0x1bb414[_0x8cd37d(0x412)](_0x8cd37d(0x509) + _0x23b90a[_0x8cd37d(0x908)] + _0x8cd37d(0x599)); return; } const _0x1d3e49 = { 'id': 'test_post_' + _0x11979d[_0x8cd37d(0x86b)](), 'authorType': _0x8cd37d(0x6e2), 'authorId': _0x23b90a[_0x8cd37d(0x150)][0x0], 'content': _0x8cd37d(0x259), 'timestamp': _0x1b10b2[_0x8cd37d(0x86b)](), 'likes': [_0x23b90a[_0x8cd37d(0x150)][0x1]], 'comments': [{ 'commentId': 'c_' + _0x2d61bc[_0x8cd37d(0x86b)](), 'authorId': _0x23b90a[_0x8cd37d(0x150)][0x1], 'content': _0x8cd37d(0x7d6) }] }; _0x23b90a[_0x8cd37d(0x49e)][_0x8cd37d(0x7d8)](_0x1d3e49), _0x24a7ea(), _0x29434e['log']('成功向好友圈\x20\x22' + _0x23b90a['name'] + _0x8cd37d(0x8f9)), _0x3a35ef(_0x8cd37d(0x430)); } } function _0x3dc170() { const _0x1d218c = _0x2b3d5e; if (_0x1d218c(0x45f) !== _0x1d218c(0x2e3)) { const _0x6d71b4 = document['getElementById'](_0x1d218c(0x419)), _0xbdf603 = document['getElementById'](_0x1d218c(0x818)); _0x6d71b4[_0x1d218c(0x2f7)] = '', _0xbdf603[_0x1d218c(0x2f7)] = ''; const _0x1d487a = _0xb64e47() || { 'name': '我' }, _0x2997e5 = _0x79fbb7[_0x1d218c(0x84d)][_0x1d218c(0x2aa)](_0x131db0 => _0x131db0[_0x1d218c(0x350)] === _0x79fbb7[_0x1d218c(0x778)]); if (!_0x2997e5 || !_0x2997e5['entries'] || _0x2997e5[_0x1d218c(0x417)][_0x1d218c(0x629)] === 0x0) { if ('omFXP' === _0x1d218c(0x18a)) { _0x6d71b4[_0x1d218c(0x2f7)] = _0x1d218c(0x4fb), _0xbdf603['innerHTML'] = _0x1d218c(0x1bb), document['getElementById']('diary-write-button')[_0x1d218c(0x3eb)](_0x1d218c(0x1a4), _0x34178e), document[_0x1d218c(0x1f3)](_0x1d218c(0x631))[_0x1d218c(0x3eb)]('click', _0x9461c8); return; } else { _0x279bd4(![]), _0xf4e774(_0x1d218c(0x6ad)); return; } } const _0x129984 = 0x2, _0x337bea = [..._0x2997e5['entries']]['sort']((_0x5ee647, _0x553bd4) => _0x5ee647[_0x1d218c(0x68c)] - _0x553bd4[_0x1d218c(0x68c)]), _0x287bf0 = []; for (let _0xd66f01 = 0x0; _0xd66f01 < _0x337bea[_0x1d218c(0x629)]; _0xd66f01 += _0x129984) { _0x287bf0[_0x1d218c(0x7d8)](_0x337bea[_0x1d218c(0x45b)](_0xd66f01, _0xd66f01 + _0x129984)); } const _0x38c0e9 = _0x287bf0[_0x1d218c(0x629)]; _0x287bf0['forEach']((_0x3c1196, _0x47643b) => { const _0x311b79 = _0x1d218c, _0x1206f7 = document[_0x311b79(0x4f8)](_0x311b79(0x8dc)); _0x1206f7['className'] = 'diary-page', _0x1206f7['id'] = _0x311b79(0x325) + _0x47643b, _0x47643b === _0x79fbb7['diaryCurrentPage'] && (_0x311b79(0x254) === _0x311b79(0x254) ? _0x1206f7[_0x311b79(0x43d)][_0x311b79(0x20f)](_0x311b79(0x51b)) : _0x2fee02(![])), _0x3c1196[_0x311b79(0x8f0)](_0x31c358 => { const _0xfbd959 = _0x311b79, _0x420a5f = _0x31c358[_0xfbd959(0x7b3)] === _0xfbd959(0x721) ? _0xfbd959(0x721) : 'ai', _0x4d7e4f = _0x31c358[_0xfbd959(0x7b3)] === _0xfbd959(0x721) ? _0x1d487a[_0xfbd959(0x908)] : _0x1249c2(_0x31c358[_0xfbd959(0x7b3)])[_0xfbd959(0x908)], _0x3641b5 = document[_0xfbd959(0x4f8)](_0xfbd959(0x8dc)); _0x3641b5['className'] = _0xfbd959(0x6a3) + _0x420a5f, _0x3641b5[_0xfbd959(0x78e)][_0xfbd959(0x68c)] = _0x31c358[_0xfbd959(0x68c)], _0x3641b5[_0xfbd959(0x324)][_0xfbd959(0x12b)] = _0xfbd959(0x277), _0x3641b5[_0xfbd959(0x324)][_0xfbd959(0x4fd)] = '0', _0x3641b5['innerHTML'] = _0xfbd959(0x87d) + _0x4d7e4f + _0xfbd959(0x67c) + new Date(_0x31c358[_0xfbd959(0x68c)])[_0xfbd959(0x52e)](_0xfbd959(0x805)) + _0xfbd959(0x3ab) + _0x31c358[_0xfbd959(0x317)][_0xfbd959(0x1c3)](/\n/g, '<br>') + _0xfbd959(0x1ad), _0x1206f7[_0xfbd959(0x7b9)](_0x3641b5); }), _0x6d71b4[_0x311b79(0x7b9)](_0x1206f7); }), _0xbdf603[_0x1d218c(0x2f7)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x20auto\x201fr;\x20width:\x20100%;\x20align-items:\x20center;\x20padding:\x200\x2010px;\x20box-sizing:\x20border-box;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-start;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-prev-button\x22>上一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22\x20style=\x22background-color:\x20var(--accent-color);\x20color:\x20white;\x22>写日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22diary-page-indicator\x22>第\x20' + (_0x79fbb7[_0x1d218c(0x800)] + 0x1) + _0x1d218c(0x1ba) + _0x38c0e9 + _0x1d218c(0x753), document[_0x1d218c(0x1f3)](_0x1d218c(0x92d))[_0x1d218c(0x899)] = _0x79fbb7[_0x1d218c(0x800)] === 0x0, document[_0x1d218c(0x1f3)](_0x1d218c(0x86e))['disabled'] = _0x79fbb7[_0x1d218c(0x800)] === _0x38c0e9 - 0x1, document['getElementById']('diary-prev-button')[_0x1d218c(0x3eb)](_0x1d218c(0x1a4), _0x10e8f1), document[_0x1d218c(0x1f3)](_0x1d218c(0x86e))[_0x1d218c(0x3eb)](_0x1d218c(0x1a4), _0x42b5e7), document['getElementById'](_0x1d218c(0x654))[_0x1d218c(0x3eb)](_0x1d218c(0x1a4), _0x34178e), document['getElementById'](_0x1d218c(0x631))[_0x1d218c(0x3eb)](_0x1d218c(0x1a4), _0x9461c8); } else _0x8ec6a4(), _0x4b38c2(_0x1d218c(0x1b4), _0x1d218c(0x819)); } function _0x42b5e7() { const _0x258140 = _0x2b3d5e; if (_0x258140(0x4b8) !== _0x258140(0x650)) { if (_0x79fbb7[_0x258140(0x8b8)]) return; const _0x1f9ab1 = _0x79fbb7['diaryCurrentPage'], _0x5236cb = Math[_0x258140(0x40f)](_0x79fbb7[_0x258140(0x84d)][_0x258140(0x2aa)](_0x3435dc => _0x3435dc[_0x258140(0x350)] === _0x79fbb7['activeDiaryCharacterId'])[_0x258140(0x417)][_0x258140(0x629)] / 0x2); if (_0x1f9ab1 >= _0x5236cb - 0x1) return; _0x79fbb7['isAnimatingDiary'] = !![]; const _0x15802b = _0x1f9ab1 + 0x1, _0x8355f1 = document['getElementById'](_0x258140(0x325) + _0x1f9ab1), _0x29637e = document[_0x258140(0x1f3)](_0x258140(0x325) + _0x15802b); _0x8355f1 && _0x29637e ? _0x258140(0x3d2) === 'aziLA' ? (_0x29637e[_0x258140(0x43d)][_0x258140(0x20f)](_0x258140(0x855)), _0x8355f1[_0x258140(0x43d)]['add'](_0x258140(0x309)), _0x29637e['classList']['add'](_0x258140(0x51b)), setTimeout(() => { const _0x284e23 = _0x258140; _0x284e23(0x60d) === 'xORyx' ? _0x237cd9[_0x284e23(0x1d7)](_0x47a029) : (_0x8355f1[_0x284e23(0x43d)][_0x284e23(0x154)](_0x284e23(0x51b), 'is-exiting-left'), _0x29637e['classList'][_0x284e23(0x154)](_0x284e23(0x855)), _0x79fbb7[_0x284e23(0x800)] = _0x15802b, _0x3dc170(), _0x79fbb7[_0x284e23(0x8b8)] = ![]); }, 0x2bc)) : _0x7b54fa += _0x258140(0x4ff) : _0x79fbb7['isAnimatingDiary'] = ![]; } else _0x4ed22c[_0x258140(0x899)] = ![]; } function _0x10e8f1() { const _0x4d6c7c = _0x2b3d5e; if (_0x4d6c7c(0x47e) === _0x4d6c7c(0x47e)) { if (_0x79fbb7[_0x4d6c7c(0x8b8)]) return; const _0x8931b5 = _0x79fbb7['diaryCurrentPage']; if (_0x8931b5 <= 0x0) return; _0x79fbb7['isAnimatingDiary'] = !![]; const _0x3aa7b5 = _0x8931b5 - 0x1, _0xce5e02 = document[_0x4d6c7c(0x1f3)](_0x4d6c7c(0x325) + _0x8931b5), _0x2bdcbc = document[_0x4d6c7c(0x1f3)](_0x4d6c7c(0x325) + _0x3aa7b5); _0xce5e02 && _0x2bdcbc ? 'foKIt' !== _0x4d6c7c(0x31a) ? _0x5a27ee['getElementById'](_0x4d6c7c(0x57f) + _0x270066 + '-preview')[_0x4d6c7c(0x465)] = _0x29d381[_0x4d6c7c(0x4af)](_0x1100f0) : (_0x2bdcbc['classList']['add'](_0x4d6c7c(0x191)), _0xce5e02[_0x4d6c7c(0x43d)][_0x4d6c7c(0x20f)](_0x4d6c7c(0x61d)), _0x2bdcbc[_0x4d6c7c(0x43d)][_0x4d6c7c(0x20f)]('is-visible'), setTimeout(() => { const _0x181e53 = _0x4d6c7c; _0x181e53(0x4bc) !== _0x181e53(0x4bc) ? _0x5c7587 !== _0x337989[_0x181e53(0x249)](_0x181e53(0x73f)) && (_0x32f6c6['textContent'] = '▶') : (_0xce5e02[_0x181e53(0x43d)]['remove']('is-visible', _0x181e53(0x61d)), _0x2bdcbc[_0x181e53(0x43d)][_0x181e53(0x154)]('is-entering-from-left'), _0x79fbb7['diaryCurrentPage'] = _0x3aa7b5, _0x3dc170(), _0x79fbb7[_0x181e53(0x8b8)] = ![]); }, 0x2bc)) : _0x79fbb7['isAnimatingDiary'] = ![]; } else { const _0x176a7e = _0x52fcac[_0x4d6c7c(0x16c)][_0x4d6c7c(0x843)](_0x1965b8 => _0x232a76(_0x1965b8)?.['name'] || '未知')[_0x4d6c7c(0x26c)]('、'), _0x3c3a72 = '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x221\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20style=\x22vertical-align:\x20-2px;\x20margin-right:\x205px;\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>'; _0x1ed092 = _0x4d6c7c(0x89a) + _0x3c3a72 + '\x20' + _0x176a7e + _0x4d6c7c(0x392); } } function _0x34178e() { const _0x3a49b6 = _0x2b3d5e; if (_0x3a49b6(0x743) === _0x3a49b6(0x743)) return new Promise(_0x2c2618 => { const _0x55af77 = _0x3a49b6, _0x4db49c = _0x55af77(0x55f); document[_0x55af77(0x7f1)]['insertAdjacentHTML'](_0x55af77(0x903), _0x4db49c); const _0x57a10e = document['getElementById'](_0x55af77(0x779)), _0x4acb34 = document[_0x55af77(0x1f3)](_0x55af77(0x36d)), _0x816a3c = document[_0x55af77(0x1f3)](_0x55af77(0x2ad)), _0x58a662 = document[_0x55af77(0x1f3)]('diary-modal-cancel'), _0x27e871 = _0x57a10e['querySelector'](_0x55af77(0x24f)), _0x195d17 = () => { const _0x1100a1 = _0x55af77; if ('MEzNb' === 'wZVOQ') { const _0x2c7700 = _0x4d50e5[_0x1100a1(0x1f3)]('music-widget-card'), _0x429143 = _0x2c60cb[_0x1100a1(0x1f3)](_0x1100a1(0x8af)), _0x532e0e = _0xd1da65[_0x1100a1(0x1f3)](_0x1100a1(0x2b7)), _0x45d7d9 = _0x250e3b[_0x1100a1(0x1f3)](_0x1100a1(0x17f)), _0x147f16 = _0x4ed2b5; _0x147f16 && _0x147f16[_0x1100a1(0x6c5)] ? (_0x429143[_0x1100a1(0x5f4)] = _0x147f16[_0x1100a1(0x453)], _0x532e0e[_0x1100a1(0x5f4)] = _0x147f16['artist'], _0x2c7700[_0x1100a1(0x43d)][_0x1100a1(0x20f)](_0x1100a1(0x919)), _0x2c7700[_0x1100a1(0x324)][_0x1100a1(0x79d)](_0x1100a1(0x3a0), 'url(' + _0x147f16[_0x1100a1(0x876)] + ')')) : (_0x429143[_0x1100a1(0x5f4)] = _0x1100a1(0x75c), _0x532e0e[_0x1100a1(0x5f4)] = _0x1100a1(0x105), _0x2c7700['classList'][_0x1100a1(0x154)]('is-playing'), _0x45d7d9[_0x1100a1(0x324)][_0x1100a1(0x79d)](_0x1100a1(0x3a0), _0x1100a1(0x277))); } else _0x57a10e['remove'](), _0x2c2618(); }; _0x816a3c[_0x55af77(0x3dc)] = () => { const _0x4a895b = _0x55af77; _0x2fedd3(_0x4acb34[_0x4a895b(0x2ff)]), _0x195d17(); }, _0x58a662['onclick'] = _0x195d17, _0x27e871[_0x55af77(0x3dc)] = _0x195d17; }); else _0x120615[_0x3a49b6(0x3d5)] = _0x439c57, _0x23f26e[_0x3a49b6(0x51f)] = _0x48573d, _0x4b2f15[_0x3a49b6(0x79c)] = ![], _0x3abdd8(); } function _0x2fedd3(_0x4004e9) { const _0x425719 = _0x2b3d5e, _0x141d93 = _0x4004e9[_0x425719(0x538)](); if (!_0x141d93 || !_0x79fbb7['activeDiaryCharacterId']) return; let _0xe3bd15 = _0x79fbb7['diaries'][_0x425719(0x2aa)](_0x3d9aff => _0x3d9aff[_0x425719(0x350)] === _0x79fbb7[_0x425719(0x778)]); !_0xe3bd15 && (_0x425719(0x918) !== _0x425719(0x15e) ? (_0xe3bd15 = { 'characterId': _0x79fbb7[_0x425719(0x778)], 'entries': [] }, _0x79fbb7[_0x425719(0x84d)]['push'](_0xe3bd15)) : (_0x53c715[_0x425719(0x154)](), _0x527a24())); _0xe3bd15['entries']['push']({ 'timestamp': Date[_0x425719(0x86b)](), 'author': _0x425719(0x721), 'content': _0x141d93 }), _0x43a351(); const _0xd148a6 = _0xe3bd15[_0x425719(0x417)][_0x425719(0x629)]; _0x79fbb7[_0x425719(0x800)] = Math['ceil'](_0xd148a6 / 0x2) - 0x1, _0x3dc170(); } async function _0x9461c8() { const _0x4d3e54 = _0x2b3d5e; if ('xZStA' === _0x4d3e54(0x7fa)) { const _0x8b15c1 = _0x79fbb7[_0x4d3e54(0x84d)]['find'](_0x14ce1b => _0x14ce1b['characterId'] === _0x79fbb7[_0x4d3e54(0x778)]), _0x401d34 = _0x79fbb7[_0x4d3e54(0x778)], _0xc91222 = _0x1249c2(_0x401d34); if (!_0xc91222 || _0x79fbb7[_0x4d3e54(0x8b0)]) return; _0x585d0a(!![], _0x4d3e54(0x577)), _0x79fbb7[_0x4d3e54(0x8b0)] = !![]; let _0x1c491e = []; try { const _0x382af9 = _0xb64e47() || { 'name': '你' }, _0x228f05 = _0x3e3955(_0x401d34), { omniText: _0x3d5ae3 } = _0x354941(_0x401d34, _0x79fbb7['activeChatId']); let _0x5d4f42 = ''; if (_0xc91222['linkedWorldBookIds'] && _0xc91222[_0x4d3e54(0x444)]['length'] > 0x0) { const _0x18b7f3 = _0xc91222['linkedWorldBookIds'][_0x4d3e54(0x843)](_0x3e31be => _0x79fbb7[_0x4d3e54(0x32e)]['find'](_0x354e95 => _0x354e95['id'] === _0x3e31be))['filter'](Boolean)['map'](_0x54bdfa => _0x4d3e54(0x716) + _0x54bdfa[_0x4d3e54(0x908)] + '\x0a' + _0x54bdfa[_0x4d3e54(0x317)])[_0x4d3e54(0x26c)](''); if (_0x18b7f3) _0x5d4f42 = _0x4d3e54(0x265) + _0x18b7f3; } const _0x49da56 = _0x382af9[_0x4d3e54(0x6dc)] ? _0x4d3e54(0x1f7) + _0x382af9[_0x4d3e54(0x908)] + _0x4d3e54(0x2ac) + _0x382af9['persona'] : '', _0x541329 = _0x582d84(); let _0x167bc5 = _0x4d3e54(0x91b); if (_0x8b15c1 && _0x8b15c1[_0x4d3e54(0x417)]) { if (_0x4d3e54(0x6e6) === _0x4d3e54(0x6e6)) { const _0x515c9b = _0x8b15c1[_0x4d3e54(0x417)][_0x4d3e54(0x6a6)](_0x27a802 => _0x27a802[_0x4d3e54(0x7b3)] === _0x4d3e54(0x721))[_0x4d3e54(0x5f8)](); if (_0x515c9b) { if (_0x4d3e54(0x229) !== _0x4d3e54(0x410)) _0x167bc5 = _0x515c9b[_0x4d3e54(0x317)]; else { _0x1f16be[_0x4d3e54(0x8ec)][_0x174d04] = null; if (_0x58f836 === _0x4d3e54(0x74f)) _0x3d9ac[_0x4d3e54(0x8ec)][_0x4d3e54(0x116)] = null; _0x4cfa78(); } } } else _0xcdbce9['key'] === _0x4d3e54(0x786) && !_0x3d509f[_0x4d3e54(0x830)] && (_0x1806cd[_0x4d3e54(0x490)](), _0x4428f8()); } const _0x11a8dd = _0x4d3e54(0x78c) + _0xc91222['name'] + '”的角色，现在需要写一篇交换日记。\x0a\x0a#\x20你的读者\x0a' + _0x382af9['name'] + _0x4d3e54(0x92b) + _0x382af9[_0x4d3e54(0x908)] + _0x4d3e54(0x572) + _0x167bc5 + _0x4d3e54(0x8b2) + _0xc91222[_0x4d3e54(0x6dc)] + '\x0a' + _0x49da56 + '\x0a' + _0x5d4f42 + '\x0a\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a-\x20**当前精确时间**:\x20' + new Date()[_0x4d3e54(0x52e)](_0x4d3e54(0x805), { 'dateStyle': _0x4d3e54(0x7ae), 'timeStyle': _0x4d3e54(0x43f) }) + _0x4d3e54(0x408) + _0x243dab(new Date(_0x8b15c1?.[_0x4d3e54(0x417)]?.['at'](-0x1)?.[_0x4d3e54(0x68c)] || Date[_0x4d3e54(0x86b)]())) + _0x4d3e54(0x8e4) + (_0x3d5ae3 || _0x4d3e54(0x66a)) + _0x4d3e54(0x3a1) + (_0x541329 || _0x4d3e54(0x60b)) + _0x4d3e54(0x158); _0x1c491e = [{ 'role': 'system', 'content': _0x11a8dd }, { 'role': _0x4d3e54(0x721), 'content': _0x4d3e54(0x50f) }]; const _0xba1ee0 = await _0x53d2f8(_0x1c491e); if (_0xba1ee0) { let _0x53d407 = _0x79fbb7[_0x4d3e54(0x84d)]['find'](_0x3d61a => _0x3d61a['characterId'] === _0x401d34); if (!_0x53d407) { if (_0x4d3e54(0x69c) === _0x4d3e54(0x5c8)) { const _0x2dec43 = _0x576361[_0x4d3e54(0x32e)][_0x4d3e54(0x2aa)](_0x50804b => _0x50804b['id'] === _0x754a17); _0x2dec43 && (_0x2dec43['name'] = _0xa4654a, _0x2dec43[_0x4d3e54(0x317)] = _0x264c77); } else _0x53d407 = { 'characterId': _0x401d34, 'entries': [] }, _0x79fbb7[_0x4d3e54(0x84d)][_0x4d3e54(0x7d8)](_0x53d407); } _0x53d407[_0x4d3e54(0x417)][_0x4d3e54(0x7d8)]({ 'timestamp': Date[_0x4d3e54(0x86b)](), 'author': _0x401d34, 'content': _0xba1ee0 }), _0x43a351(); const _0x51b273 = _0x53d407['entries'][_0x4d3e54(0x629)]; _0x79fbb7['diaryCurrentPage'] = Math['ceil'](_0x51b273 / 0x2) - 0x1, _0x3dc170(); } } catch (_0x19abdd) { if (_0x4d3e54(0x5fd) === 'RAFWs') { _0x3b5093 = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; for (const _0x4296ee in _0x3a8fb8) { _0x34e042[_0x4296ee]['classList'][_0x4d3e54(0x154)]('filled'), _0xc2a0d4[_0x4296ee]['value'] = ''; } _0x52153b[_0x4d3e54(0x121)][_0x4d3e54(0x249)](_0x4d3e54(0x902))[_0x4d3e54(0x5f4)] = _0x4d3e54(0x24e), _0x374042[_0x4d3e54(0x876)][_0x4d3e54(0x249)]('.slot-filename')['textContent'] = _0x4d3e54(0x7e1), _0x4412a8[_0x4d3e54(0xfb)][_0x4d3e54(0x249)](_0x4d3e54(0x902))[_0x4d3e54(0x5f4)] = '点击选择\x20info.txt', _0x310fa0[_0x4d3e54(0x745)][_0x4d3e54(0x249)](_0x4d3e54(0x902))['textContent'] = _0x4d3e54(0x19e), _0x2287f9(); } else _0x30a64e(_0x4d3e54(0x5ee) + _0x19abdd['message']); } finally { _0x585d0a(![]), _0x79fbb7[_0x4d3e54(0x8b0)] = ![]; } } else _0x3919cc(_0x22a708['id']), _0x530636(!![]); } function _0x187663() { const _0x3e34e2 = _0x2b3d5e, _0x1ef877 = document[_0x3e34e2(0x1f3)](_0x3e34e2(0x57c)), _0x5ccd52 = document['getElementById']('galgame-view-container'), _0x238190 = document['querySelector']('#meeting-view-screen\x20.chat-input-area'); _0x79fbb7['meetingViewMode'] === _0x3e34e2(0x7f5) ? 'JbjKC' === _0x3e34e2(0x81f) ? _0x3bb646[_0x3e34e2(0x444)] = _0x33e735['linkedWorldBookIds'][_0x3e34e2(0x6a6)](_0x5b7555 => _0x5b7555 !== _0x1256b6) : (_0x1ef877[_0x3e34e2(0x324)]['display'] = _0x3e34e2(0x277), _0x5ccd52[_0x3e34e2(0x324)]['display'] = 'block') : (_0x1ef877[_0x3e34e2(0x324)][_0x3e34e2(0x7ab)] = 'block', _0x5ccd52[_0x3e34e2(0x324)]['display'] = _0x3e34e2(0x277)), _0x238190[_0x3e34e2(0x324)][_0x3e34e2(0x7ab)] = 'block'; } function _0x3aa6ff() { const _0x27c949 = _0x2b3d5e, _0x42f4a3 = document['getElementById'](_0x27c949(0x8f2)), _0xe9254d = document[_0x27c949(0x1f3)](_0x27c949(0x47a)); if (_0x79fbb7[_0x27c949(0x64a)][_0x27c949(0x629)] > 0x0) { if (_0x27c949(0x4d4) !== _0x27c949(0x4d4)) { const _0xe2c520 = _0x67068c[_0x27c949(0x14b)] ? _0x192aab(_0x21ea7a[_0x27c949(0x14b)]) : null; return _0xe2c520?.['name'] || 'Unknown'; } else { const _0x30b3bc = _0x79fbb7['activeMeetingScriptQueue'][_0x27c949(0x46c)](); _0x42f4a3['textContent'] = _0x30b3bc[_0x27c949(0x806)] === _0x27c949(0x488) ? '旁白' : _0x30b3bc[_0x27c949(0x806)], _0xe9254d[_0x27c949(0x5f4)] = _0x30b3bc['line'], _0x30b3bc[_0x27c949(0x806)] !== 'narrator' && (_0x27c949(0x12c) !== _0x27c949(0x2d3) ? _0x536b47(_0x79fbb7[_0x27c949(0x112)], _0x30b3bc[_0x27c949(0x148)]) : _0x1d30d2 += _0x27c949(0x56a) + _0x504c47[_0x27c949(0x8d6)](_0x20eb0a / 0x3c) + '小时前），可以简单问候一下对方现在的状态。\x0a'); } } else { const _0xe9e7b9 = _0x79fbb7['characterLastScripts'][_0x79fbb7['activeMeetingCharId']]; if (_0xe9e7b9 && _0xe9e7b9['length'] > 0x0) { _0x79fbb7[_0x27c949(0x64a)] = [..._0xe9e7b9]; const _0x21272e = _0x79fbb7[_0x27c949(0x64a)]['shift'](); _0x42f4a3[_0x27c949(0x5f4)] = _0x21272e[_0x27c949(0x806)] === _0x27c949(0x488) ? '旁白' : _0x21272e[_0x27c949(0x806)], _0xe9254d[_0x27c949(0x5f4)] = _0x21272e['line'], _0x21272e[_0x27c949(0x806)] !== 'narrator' && _0x536b47(_0x79fbb7[_0x27c949(0x112)], _0x21272e[_0x27c949(0x148)]); } else _0x42f4a3[_0x27c949(0x5f4)] = '旁白', _0xe9254d[_0x27c949(0x5f4)] = _0x27c949(0x400); } } async function _0x536b47(_0x289eef, _0x8e9dac) { const _0x546251 = _0x2b3d5e, _0xcdb167 = document[_0x546251(0x1f3)](_0x546251(0x575)), _0x3ae859 = document[_0x546251(0x1f3)](_0x546251(0x3fe)), _0x51ff4c = _0x1249c2(_0x289eef), _0x6feec5 = _0x51ff4c?.[_0x546251(0x320)] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }, _0x52e22f = 0x50 * _0x6feec5['scale']; _0x3ae859[_0x546251(0x324)]['height'] = _0x52e22f + '%', _0x3ae859['style'][_0x546251(0x120)] = _0x52e22f + '%', _0x3ae859['style'][_0x546251(0x173)] = _0x6feec5['x'] + '%', _0x3ae859['style']['top'] = _0x6feec5['y'] + '%', _0x3ae859[_0x546251(0x324)]['transform'] = _0x546251(0x641), _0x3ae859[_0x546251(0x324)][_0x546251(0x73c)] = _0x546251(0x1c4); const _0x555cff = [_0x546251(0x4e9), _0x546251(0x5b5), _0x546251(0x3b0), 'sad', 'shy'], _0x94d1c6 = _0x555cff[_0x546251(0x5ad)](_0x8e9dac) ? _0x8e9dac : _0x546251(0x4e9); try { if (_0x546251(0x6cb) === _0x546251(0x6cb)) { const _0x1d535f = await _0x3db342(_0x546251(0x791) + _0x94d1c6 + '_' + _0x289eef); if (_0x1d535f) _0xcdb167['src'] && _0xcdb167[_0x546251(0x324)][_0x546251(0x1db)] !== '0' ? (_0xcdb167[_0x546251(0x324)]['opacity'] = 0x0, setTimeout(() => { const _0x18ace0 = _0x546251; _0x18ace0(0x1bd) !== _0x18ace0(0x302) ? (_0xcdb167[_0x18ace0(0x465)] = URL['createObjectURL'](_0x1d535f), _0xcdb167[_0x18ace0(0x324)][_0x18ace0(0x1db)] = 0x1) : _0x13b0a1(_0x18ace0(0x3c4))[_0x18ace0(0x2cd)](_0x3fad1 => { const _0x45c7a2 = _0x18ace0; if (_0x3fad1) { const _0x5ec102 = _0x423897(_0x49bc0c[_0x45c7a2(0x112)]); _0x5ec102 && (delete _0x5ec102['spriteTransform'], _0x3c715e(), _0x59efdb(_0x5ec102['id'], _0x45c7a2(0x4e9)), _0x142665(_0x45c7a2(0x72d)), _0x38baf4(!![])); } }); }, 0x96)) : _0x546251(0x376) !== _0x546251(0x376) ? _0x4987e0['style'][_0x546251(0x7ab)] = _0x546251(0x277) : (_0xcdb167['src'] = URL[_0x546251(0x4af)](_0x1d535f), _0xcdb167[_0x546251(0x324)][_0x546251(0x1db)] = 0x1); else { const _0x554527 = await _0x3db342('char_sprite_normal_' + _0x289eef); _0xcdb167['src'] = _0x554527 ? URL['createObjectURL'](_0x554527) : ''; } } else _0x454c53(), _0x1075f8(_0x546251(0x59e), 'home'); } catch (_0x34b0fd) { _0x546251(0x82a) !== _0x546251(0x82a) ? _0x4b49f1 = _0x33d101[_0x546251(0x811)](..._0x33ea63[_0x546251(0x49e)][_0x546251(0x843)](_0x40b2d8 => _0x40b2d8['timestamp'])) : (console[_0x546251(0x412)]('加载立绘失败:', _0x34b0fd), _0xcdb167['src'] = ''); } } let _0x50cf09 = ![], _0x72457 = { 'isDragging': ![], 'isResizing': ![], 'startX': 0x0, 'startY': 0x0, 'startLeft': 0x0, 'startTop': 0x0, 'startWidth': 0x0, 'startHeight': 0x0 }; const _0x22979f = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x4d7)), _0x522b8c = document[_0x2b3d5e(0x1f3)]('sprite-confirm-button'), _0x17e19b = document['getElementById'](_0x2b3d5e(0x73e)), _0x18126e = document[_0x2b3d5e(0x1f3)]('sprite-reset-button'), _0x34a075 = document['getElementById']('galgame-sprite-controls'), _0x3ba14f = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x3fe)), _0x1dec9d = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x4d1)), _0x249111 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x169)); let _0x3adf43 = {}; function _0x4787bc() { const _0x1a0d76 = _0x2b3d5e; if (_0x1a0d76(0x45d) === _0x1a0d76(0x45d)) { const _0xa1356d = _0x1249c2(_0x79fbb7[_0x1a0d76(0x112)]); if (!_0xa1356d) return; _0x50cf09 = !![], _0x34a075[_0x1a0d76(0x324)][_0x1a0d76(0x7ab)] = _0x1a0d76(0x53e); const _0x560087 = _0xa1356d[_0x1a0d76(0x320)] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }; document[_0x1a0d76(0x1f3)](_0x1a0d76(0x407))[_0x1a0d76(0x2ff)] = _0x560087['x'], document[_0x1a0d76(0x1f3)]('sprite-slider-y')['value'] = _0x560087['y'], document[_0x1a0d76(0x1f3)]('sprite-slider-scale')[_0x1a0d76(0x2ff)] = _0x560087['scale'] * 0x64, _0x3adf43 = { ..._0x560087 }, document[_0x1a0d76(0x1f3)](_0x1a0d76(0x6e8))[_0x1a0d76(0x324)][_0x1a0d76(0x7ab)] = _0x1a0d76(0x277), document[_0x1a0d76(0x1f3)](_0x1a0d76(0x5e6))[_0x1a0d76(0x324)][_0x1a0d76(0x7ab)] = _0x1a0d76(0x277); } else { const _0x590961 = _0x1dfb02['match'](_0x130e52); if (_0x590961) { const _0x561be0 = _0x4a70f7(_0x590961[0x1], 0xa), _0xb809b = _0x21aa59(_0x590961[0x2], 0xa), _0x395993 = _0xf38fa(_0x590961[0x3], 0xa) * (_0x590961[0x3][_0x1a0d76(0x629)] === 0x2 ? 0xa : 0x1), _0xfab963 = _0x561be0 * 0x3c + _0xb809b + _0x395993 / 0x3e8, _0x2c26b9 = _0x11a595[_0x1a0d76(0x1c3)](_0x1d474e, '')['trim'](); _0x2c26b9 && _0x3d31dc[_0x1a0d76(0x7d8)]({ 'time': _0xfab963, 'text': _0x2c26b9 }); } } } function _0x3b73b6(_0x51f3f9 = ![]) { const _0x18677f = _0x2b3d5e; _0x50cf09 = ![], _0x34a075[_0x18677f(0x324)][_0x18677f(0x7ab)] = _0x18677f(0x277), document[_0x18677f(0x1f3)](_0x18677f(0x6e8))[_0x18677f(0x324)]['display'] = _0x18677f(0x53e), document[_0x18677f(0x1f3)]('galgame-sprite-adjust-ui')[_0x18677f(0x324)][_0x18677f(0x7ab)] = _0x18677f(0x53e); if (!_0x51f3f9) { const _0x5d410a = _0x1249c2(_0x79fbb7['activeMeetingCharId']); if (_0x5d410a) { if (_0x18677f(0x59b) !== 'nEHBB') { if (_0x3a919f[_0x18677f(0x445)]) _0x4f98b1(_0xbd99d4['diaryPressTimer']); } else _0x5d410a[_0x18677f(0x320)] = _0x3adf43, _0x536b47(_0x79fbb7['activeMeetingCharId'], _0x18677f(0x4e9)); } } } function _0x552467() { const _0x48ea39 = _0x2b3d5e; if (_0x48ea39(0x8ef) !== _0x48ea39(0x3f9)) { const _0x31b433 = _0x1249c2(_0x79fbb7[_0x48ea39(0x112)]); if (!_0x31b433) return; const _0x3fc36c = parseFloat(document['getElementById'](_0x48ea39(0x407))[_0x48ea39(0x2ff)]), _0x41f93f = parseFloat(document['getElementById'](_0x48ea39(0x6b2))[_0x48ea39(0x2ff)]), _0x471438 = parseFloat(document[_0x48ea39(0x1f3)](_0x48ea39(0x496))['value']) / 0x64; _0x31b433[_0x48ea39(0x320)] = { 'x': _0x3fc36c, 'y': _0x41f93f, 'scale': _0x471438 }, _0x43a351(), _0x30a64e(_0x48ea39(0x733)), _0x3b73b6(!![]); } else { if (_0xe0d9a[_0x48ea39(0x7b8)]()[_0x48ea39(0x571)]()) return; const _0x929ccc = _0x386c75[_0x48ea39(0x381)][_0x48ea39(0x3d6)]('.message-container'), _0x5d4baa = _0x2930a3['target'][_0x48ea39(0x3d6)](_0x48ea39(0x399)); if (!_0x929ccc || _0x5d4baa) return; const _0x4806c4 = _0x4514e1(_0x929ccc[_0x48ea39(0x78e)][_0x48ea39(0x57d)], 0xa); if (_0x1465f5(_0x4806c4)) return; _0x2d26e8(_0x4806c4); } } function _0x5a30d5() { const _0x59740e = _0x2b3d5e; _0x21bcbb(_0x59740e(0x3c4))[_0x59740e(0x2cd)](_0x1edbec => { const _0x180875 = _0x59740e; if (_0x1edbec) { const _0x29769f = _0x1249c2(_0x79fbb7[_0x180875(0x112)]); if (_0x29769f) { if ('DTLaG' !== 'cJayM') delete _0x29769f['spriteTransform'], _0x43a351(), _0x536b47(_0x29769f['id'], _0x180875(0x4e9)), _0x30a64e('已恢复默认。'), _0x3b73b6(!![]); else return (_0x213e4f?.[_0x180875(0x44f)] || [])[_0x180875(0x2aa)](_0x38dc96 => _0x38dc96['id'] === _0x5afd57); } } }); } function _0x315949() { const _0x12b0d8 = _0x2b3d5e; if (_0x12b0d8(0x6e0) === _0x12b0d8(0x6e0)) { if (!_0x50cf09) return; const _0x1d7fd4 = _0x79fbb7[_0x12b0d8(0x112)], _0x3e404e = _0x1249c2(_0x1d7fd4); if (!_0x3e404e) return; const _0x43827e = parseFloat(document[_0x12b0d8(0x1f3)]('sprite-slider-x')[_0x12b0d8(0x2ff)]), _0x21e905 = parseFloat(document[_0x12b0d8(0x1f3)](_0x12b0d8(0x6b2))[_0x12b0d8(0x2ff)]), _0x187639 = parseFloat(document[_0x12b0d8(0x1f3)](_0x12b0d8(0x496))[_0x12b0d8(0x2ff)]) / 0x64; _0x3e404e[_0x12b0d8(0x320)] = { 'x': _0x43827e, 'y': _0x21e905, 'scale': _0x187639 }; const _0x537f44 = document[_0x12b0d8(0x1f3)](_0x12b0d8(0x3fe)), _0x35d232 = 0x50 * _0x187639; _0x537f44[_0x12b0d8(0x324)][_0x12b0d8(0x7a5)] = _0x35d232 + '%', _0x537f44[_0x12b0d8(0x324)][_0x12b0d8(0x120)] = _0x35d232 + '%', _0x537f44[_0x12b0d8(0x324)][_0x12b0d8(0x173)] = _0x43827e + '%', _0x537f44[_0x12b0d8(0x324)]['top'] = _0x21e905 + '%', _0x537f44[_0x12b0d8(0x324)][_0x12b0d8(0x23a)] = _0x12b0d8(0x641); } else { let _0x463a48 = null; const _0x4eb7d3 = _0x19706[_0x12b0d8(0x4c9)][_0x12b0d8(0x6a6)](_0x59f233 => _0x59f233[_0x12b0d8(0x285)][_0x12b0d8(0x5ad)](_0x1b1507)); for (const _0x561450 of _0x4eb7d3) { const _0x1961f6 = _0x4aa93e(_0x561450['id']); if (_0x1961f6 && _0x1961f6[_0x12b0d8(0x629)] > 0x0) { const _0x52f4a9 = _0x1961f6[_0x1961f6['length'] - 0x1]; (!_0x463a48 || _0x52f4a9[_0x12b0d8(0x68c)] > _0x463a48['timestamp']) && (_0x463a48 = _0x52f4a9); } } return _0x463a48; } } document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x407))[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x266), _0x315949), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x6b2))['addEventListener']('input', _0x315949), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x496))[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x266), _0x315949), _0x22979f[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x4787bc), _0x522b8c[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x552467), _0x17e19b[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => _0x3b73b6(![])), _0x18126e['addEventListener'](_0x2b3d5e(0x1a4), _0x5a30d5); function _0x5270c4(_0xca08bc) { const _0x18bf92 = _0x2b3d5e, _0x5d2a5a = _0x1249c2(_0xca08bc); if (!_0x5d2a5a) return; const _0x5591fb = _0x79fbb7['chats'][_0x18bf92(0x2aa)](_0x419272 => _0x419272[_0x18bf92(0x1fb)] === _0x18bf92(0x91f) && _0x419272['participantIds'][_0x18bf92(0x5ad)](_0xca08bc)), _0x16cfd3 = _0x1cdea5(_0x5591fb['id']), _0x46d8c2 = _0x79fbb7['conversationHistory'][_0x18bf92(0x6a6)](_0x5db995 => _0x5db995[_0x18bf92(0x5a8)])[_0x18bf92(0x5f8)](), _0x2d9c49 = document[_0x18bf92(0x1f3)](_0x18bf92(0x8f2)), _0x15ce67 = document[_0x18bf92(0x1f3)]('galgame-text'); let _0x771167 = null; if (_0x46d8c2) { if (_0x18bf92(0x199) !== _0x18bf92(0x199)) { const _0x4d5b76 = _0x378f23[_0x18bf92(0x4f8)](_0x18bf92(0x8dc)); _0x4d5b76[_0x18bf92(0x1dc)] = _0x18bf92(0x210), _0x4d5b76[_0x18bf92(0x2f7)] = _0x1651ad, _0x1c21b2 === _0x18bf92(0x721) ? (_0x3920c1['appendChild'](_0x4d5b76), _0xaa689a[_0x18bf92(0x7b9)](_0x4cfb63)) : (_0x39cc93['appendChild'](_0x15db8c), _0x7491b8['appendChild'](_0x4d5b76)); } else { if (_0x46d8c2[_0x18bf92(0x5f2)] === _0x18bf92(0x2ea)) { if ('JbnpS' !== _0x18bf92(0x56d)) _0x327b38(_0x1ed4e1['id']), _0x222cc7(_0x18bf92(0x5ca) + _0x3cec65[_0x18bf92(0x908)] + '\x22\x20已删除。'), _0x112d5e(![]); else { const _0x4eaa10 = _0x79fbb7[_0x18bf92(0x7ad)][_0xca08bc]; _0x4eaa10 && _0x4eaa10[_0x18bf92(0x629)] > 0x0 && (_0x771167 = _0x4eaa10['at'](-0x1)); } } else _0x771167 = { 'speaker': _0x16cfd3[_0x18bf92(0x908)], 'line': _0x46d8c2[_0x18bf92(0x317)], 'emotion': _0x18bf92(0x4e9) }; } } _0x771167 ? (_0x2d9c49['textContent'] = _0x771167[_0x18bf92(0x806)] === _0x18bf92(0x488) ? '旁白' : _0x771167[_0x18bf92(0x806)], _0x15ce67['textContent'] = _0x771167[_0x18bf92(0x844)], _0x771167['speaker'] === _0x5d2a5a['name'] ? _0x536b47(_0xca08bc, _0x771167[_0x18bf92(0x148)]) : _0x18bf92(0x3d3) !== _0x18bf92(0x3d3) ? (_0x13780a[_0x18bf92(0x8b0)] && _0x4c3ad4['currentAbortController'] && (_0x573d31[_0x18bf92(0x257)](_0x18bf92(0x45e)), _0x5d710a[_0x18bf92(0x557)]['abort'](_0x18bf92(0x5fc)), _0x160656[_0x18bf92(0x557)] = null), _0x12ba6e['isGenerating'] = ![], _0x1a298a(![])) : _0x536b47(_0xca08bc, 'normal')) : (_0x2d9c49[_0x18bf92(0x5f4)] = _0x5d2a5a[_0x18bf92(0x908)], _0x15ce67['textContent'] = '（开始一段新的对话...）', _0x536b47(_0xca08bc, _0x18bf92(0x4e9))); } function _0xddc774() { const _0x45a336 = _0x2b3d5e; if (_0x45a336(0x20a) === _0x45a336(0x20a)) { const _0x57ce1b = new Date(), _0x3859c2 = document[_0x45a336(0x1f3)]('galgame-time'), _0x25ffff = document['getElementById'](_0x45a336(0x8ee)); if (_0x3859c2 && _0x25ffff) { const _0x30014d = String(_0x57ce1b['getHours']())[_0x45a336(0x643)](0x2, '0'), _0x1d10cd = String(_0x57ce1b[_0x45a336(0x3c0)]())[_0x45a336(0x643)](0x2, '0'); _0x3859c2[_0x45a336(0x5f4)] = _0x30014d + ':' + _0x1d10cd; const _0x37912a = _0x57ce1b[_0x45a336(0x90b)]() + 0x1, _0x59bed7 = _0x57ce1b[_0x45a336(0x5d5)](), _0x106a1b = [_0x45a336(0x1da), _0x45a336(0x2d5), '星期二', _0x45a336(0x935), _0x45a336(0x8ae), '星期五', '星期六'][_0x57ce1b[_0x45a336(0x768)]()]; _0x25ffff[_0x45a336(0x5f4)] = _0x37912a + '月' + _0x59bed7 + '日\x20' + _0x106a1b; } } else { if (_0x46aa2b[_0x45a336(0x629)] === 0x0) return; _0x3863bd = (_0x58167b + 0x1) % _0x40a7e7[_0x45a336(0x629)], _0x101a9a(_0x1a1bcb[_0x372482], _0x293854); } } const _0x24e312 = document['getElementById'](_0x2b3d5e(0x34a)), _0x10235e = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x7a9)), _0x158e31 = document[_0x2b3d5e(0x1f3)]('cancel-listen-together'), _0xdb4495 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x18b)), _0x570776 = document['getElementById']('listen-together-song-list'), _0x10c451 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x440)), _0x24d146 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x204)), _0x941af2 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x51d)), _0x24e0bb = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x14f)); let _0xc5b3dd = []; async function _0x33cfd1() { const _0x253840 = _0x2b3d5e; if (!_0x79fbb7['activeChatId']) return; _0x570776['innerHTML'] = _0x253840(0x26b), _0x24e312['classList'][_0x253840(0x20f)](_0x253840(0x920)); const _0x464e16 = await _0x4389ae(); if (_0x464e16[_0x253840(0x629)] === 0x0) { _0x570776[_0x253840(0x2f7)] = _0x253840(0x618); return; } _0x570776['innerHTML'] = '', _0x464e16[_0x253840(0x8f0)](_0x36ab90 => { const _0x3f4610 = _0x253840; if ('IzELs' === 'BBgPj') _0xf20aeb[_0x3f4610(0x412)]('保存卡片状态失败', _0x5c22e1); else { const _0xd9976b = document[_0x3f4610(0x4f8)]('div'); _0xd9976b[_0x3f4610(0x1dc)] = _0x3f4610(0x895); const _0x2d0ffa = _0x36ab90['cover'] ? URL[_0x3f4610(0x4af)](_0x36ab90['cover']) : _0x426b80; _0xd9976b['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + _0x2d0ffa + _0x3f4610(0x87b) + (_0x36ab90[_0x3f4610(0xfb)][_0x3f4610(0x398)] || _0x3f4610(0x7fb)) + _0x3f4610(0x8a1) + (_0x36ab90[_0x3f4610(0xfb)]['歌手'] || _0x3f4610(0x7c7)) + _0x3f4610(0x81b), _0xd9976b[_0x3f4610(0x3eb)](_0x3f4610(0x1a4), () => { _0x103605(_0x36ab90); }), _0x570776[_0x3f4610(0x7b9)](_0xd9976b); } }); } function _0x48dd7d() { const _0x57c0f8 = _0x2b3d5e; _0x57c0f8(0x668) !== 'CetEP' ? _0x35fa11('生成日记失败:\x20' + _0xa32dde['message']) : _0x24e312[_0x57c0f8(0x43d)][_0x57c0f8(0x154)](_0x57c0f8(0x920)); } async function _0x103605(_0x57f1fa) { const _0xcbbae0 = _0x2b3d5e; if (!_0x79fbb7[_0xcbbae0(0x4d8)] || !_0x57f1fa) return; let _0x592ee6 = null; if (_0x57f1fa[_0xcbbae0(0x876)]) { if (_0xcbbae0(0x397) === _0xcbbae0(0x3e0)) { const _0xaa9cfa = _0xbf9fa4(_0x49ac15['participantIds'][0x0]); return _0xaa9cfa?.['name'] || 'AI'; } else try { if (_0xcbbae0(0x87f) === _0xcbbae0(0x87f)) _0x592ee6 = _0xcbbae0(0x4e8) + Date[_0xcbbae0(0x86b)]() + '_' + Math[_0xcbbae0(0x4dc)](), await _0x43bf1f(_0x592ee6, _0x57f1fa[_0xcbbae0(0x876)]); else { let _0x37ddf4 = _0x3a88d5[_0xcbbae0(0x32e)][_0xcbbae0(0x2aa)](_0x2d9a23 => _0x2d9a23['name'] === _0x1942d1[_0xcbbae0(0x908)]); if (_0x37ddf4) _0x4502ab[_0xcbbae0(0x7d8)](_0x37ddf4['id']); else { const _0x3eb969 = { 'id': _0xcbbae0(0x725) + _0x2de966['now']() + '_' + _0x133f49[_0xcbbae0(0x4dc)](), 'name': _0x1b9ad9['name'], 'content': _0x4f28a6[_0xcbbae0(0x317)] }; _0x451eef[_0xcbbae0(0x32e)]['push'](_0x3eb969), _0x3086f0[_0xcbbae0(0x7d8)](_0x3eb969['id']); } } } catch (_0xea5d69) { if (_0xcbbae0(0x503) !== _0xcbbae0(0x503)) { const _0x54a529 = _0x35b321[_0xcbbae0(0xfc)](_0xcbbae0(0x8ca)); if (_0x54a529) { const { playlist: _0x356dc0, currentIndex: _0x1cdc0a } = _0x3e02ae[_0xcbbae0(0x4f6)](_0x54a529); _0x2edbde['isArray'](_0x356dc0) && _0x356dc0[_0xcbbae0(0x629)] > 0x0 && _0x1cdc0a > -0x1 && (_0x41b651[_0xcbbae0(0x3d5)] = _0x356dc0, _0x402e0e[_0xcbbae0(0x51f)] = _0x1cdc0a, _0xd065b2['isPlaying'] = ![], _0x413313()); } } else console[_0xcbbae0(0x412)]('在“一起听”邀请中，净化封面失败:', _0xea5d69); } } const _0x3a5c5a = { 'role': _0xcbbae0(0x721), 'type': _0xcbbae0(0x7db), 'content': '[用户发起了听歌邀请:\x20' + _0x57f1fa[_0xcbbae0(0xfb)][_0xcbbae0(0x398)] + ']', 'songId': _0x57f1fa['id'], 'songName': _0x57f1fa[_0xcbbae0(0xfb)][_0xcbbae0(0x398)], 'artist': _0x57f1fa[_0xcbbae0(0xfb)]['歌手'], 'coverId': _0x592ee6, 'timestamp': Date[_0xcbbae0(0x86b)]() }; _0x79fbb7[_0xcbbae0(0x623)]['push'](_0x3a5c5a), _0x23a213(), _0xd4cd2d(), _0x48dd7d(), setTimeout(_0x3346d1, 0x64); } _0x10235e['addEventListener']('click', _0x33cfd1), _0x158e31['addEventListener']('click', _0x48dd7d), _0xdb4495[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0x48dd7d); async function _0x26f76c(_0x30d822, _0x1949dc, _0x1370df) { const _0x848ed9 = _0x2b3d5e; if ('yIHee' !== 'yIHee') { const _0x106028 = _0x5b37f5[_0x848ed9(0x381)][_0x848ed9(0x5b7)][0x0]; if (!_0x106028) return; try { _0xaa1d61[_0x848ed9(0x465)] = _0x47acfd[_0x848ed9(0x4af)](_0x106028); } catch (_0xa69483) { _0x30f7db('图片预览失败:\x20' + _0xa69483[_0x848ed9(0x227)]); } } else { const _0xa8aec5 = _0x79fbb7[_0x848ed9(0x4c9)][_0x848ed9(0x2aa)](_0x4e2e13 => _0x4e2e13[_0x848ed9(0x865)] && _0x4e2e13[_0x848ed9(0x865)][_0x848ed9(0x91d)]), _0x3d335a = _0x3f4d37(); if (_0xa8aec5 && _0xa8aec5['id'] !== _0x3d335a['id']) _0xa8aec5[_0x848ed9(0x865)] = null, _0x30a64e(_0x848ed9(0x52a)), _0x43a351(); else { if (_0xa8aec5 && _0xa8aec5['id'] === _0x3d335a['id']) { if (_0x848ed9(0x767) !== _0x848ed9(0x2ce)) _0x30a64e(_0x848ed9(0x6e3)); else { const _0x3c7422 = _0x4d84c9[_0x848ed9(0x207)](_0x40ec7c, _0x848ed9(0x6b1)), _0x102f15 = _0x3c7422[_0x848ed9(0x8a5)](_0x3b28b1), _0x99bdf6 = _0x102f15[_0x848ed9(0x8bb)]({ 'id': _0x4bf8c1, 'blob': _0xa4b6fc }); _0x99bdf6[_0x848ed9(0x7eb)] = () => _0x4ab18f(_0x99bdf6[_0x848ed9(0x6e4)]), _0x99bdf6['onerror'] = () => _0x1d8e2d(_0x99bdf6[_0x848ed9(0x412)]); } } } _0x585d0a(!![], _0x848ed9(0x403)); if (!_0x3d335a) { if ('OShVA' === _0x848ed9(0x32f)) _0x3a8c6c[_0x848ed9(0x490)](), _0x3880d0(); else { _0x585d0a(![]), _0x30a64e(_0x848ed9(0x6ad)); return; } } const _0x193627 = await _0x2665e7(_0x30d822); if (!_0x193627) { if (_0x848ed9(0x31e) !== _0x848ed9(0x775)) { _0x585d0a(![]), _0x30a64e(_0x848ed9(0x65f)); return; } else { _0x50f2aa('正在生成中，请稍候...'); return; } } _0x3d335a[_0x848ed9(0x865)] = { 'isActive': !![], 'songId': _0x30d822, 'leaderId': 'user', 'songName': _0x193627['info'][_0x848ed9(0x398)], 'artist': _0x193627[_0x848ed9(0xfb)]['歌手'], 'cover': _0x193627['cover'] }, _0x43a351(), document[_0x848ed9(0x1f3)](_0x848ed9(0x83b))[_0x848ed9(0x465)] = _0x193627[_0x848ed9(0x876)] ? URL['createObjectURL'](_0x193627[_0x848ed9(0x876)]) : _0x426b80, document[_0x848ed9(0x1f3)]('lt-ui-song-title')[_0x848ed9(0x5f4)] = _0x193627[_0x848ed9(0xfb)][_0x848ed9(0x398)], document['getElementById'](_0x848ed9(0x632))[_0x848ed9(0x5f4)] = _0x193627['info']['歌手'], _0x34be9f(_0x193627), _0x24d146[_0x848ed9(0x324)][_0x848ed9(0x7ab)] = _0x848ed9(0x585), setTimeout(() => _0x24d146[_0x848ed9(0x43d)]['add'](_0x848ed9(0x920)), 0xa), _0x1370df[_0x848ed9(0x2f7)] = '<div\x20class=\x22listen-together-header\x22\x20style=\x22text-align:center;\x22>🎵\x20已连接，正在一起听\x20🎵</div>' + _0x1370df['querySelector'](_0x848ed9(0x54c))['outerHTML'], _0x79fbb7['conversationHistory'][_0x1949dc] && (_0x79fbb7[_0x848ed9(0x623)][_0x1949dc][_0x848ed9(0x529)] = !![], _0x23a213()), _0x585d0a(![]), _0x3816be(_0x30d822, [_0x30d822]), _0x4bdbb1(_0x193627, !![]); } } function _0x57633a() { const _0x27ce7b = _0x2b3d5e, _0x2b409d = _0x79fbb7['chats'][_0x27ce7b(0x2aa)](_0x16a203 => _0x16a203['activeListenSession'] && _0x16a203[_0x27ce7b(0x865)][_0x27ce7b(0x91d)]); _0x2b409d && (_0x27ce7b(0x7d2) === _0x27ce7b(0x7d2) ? (_0x2b409d[_0x27ce7b(0x865)] = null, _0x43a351(), _0x30a64e('同步已断开。'), _0x4bdbb1(), _0x24d146[_0x27ce7b(0x43d)][_0x27ce7b(0x154)]('show'), setTimeout(() => _0x24d146['style'][_0x27ce7b(0x7ab)] = _0x27ce7b(0x277), 0x12c)) : _0x2989ce = _0x27ce7b(0x82c) + _0x2bcd92[_0x27ce7b(0x908)] + _0x27ce7b(0x4f3)); } function _0x4a79c1(_0x276f7c) { const _0x13dc22 = _0x2b3d5e; if (!_0x276f7c) return []; const _0x5e4a3f = _0x276f7c[_0x13dc22(0x1ae)]('\x0a'), _0x38d421 = [], _0x523230 = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x276bfb of _0x5e4a3f) { if ('zUluO' === _0x13dc22(0x6d9)) { const _0x76ed02 = _0x276bfb[_0x13dc22(0x5d3)](_0x523230); if (_0x76ed02) { const _0x14f0a2 = parseInt(_0x76ed02[0x1], 0xa), _0x1cdb48 = parseInt(_0x76ed02[0x2], 0xa), _0x4b5cfe = parseInt(_0x76ed02[0x3], 0xa) * (_0x76ed02[0x3][_0x13dc22(0x629)] === 0x2 ? 0xa : 0x1), _0x4c304b = _0x14f0a2 * 0x3c + _0x1cdb48 + _0x4b5cfe / 0x3e8, _0x232b32 = _0x276bfb[_0x13dc22(0x1c3)](_0x523230, '')[_0x13dc22(0x538)](); _0x232b32 && _0x38d421[_0x13dc22(0x7d8)]({ 'time': _0x4c304b, 'text': _0x232b32 }); } } else _0x558c5d = _0x5f44fe[_0x13dc22(0xfc)](_0x13dc22(0x5cc) + _0x12c295['activeChatId']); } return _0x38d421; } function _0x34be9f(_0x5d51a5) { const _0x14cab5 = _0x2b3d5e; _0xc5b3dd = _0x4a79c1(_0x5d51a5[_0x14cab5(0x745)]), _0x24e0bb[_0x14cab5(0x2f7)] = ''; if (_0xc5b3dd[_0x14cab5(0x629)] === 0x0) { if ('sqNtw' === _0x14cab5(0x476)) { _0x24e0bb['innerHTML'] = _0x14cab5(0x464); return; } else _0x25d10b['addEventListener'](_0x14cab5(0x1a4), () => { const _0x5b0bc9 = _0x14cab5; _0x453c96(_0x5b0bc9(0x16a)); }); } _0xc5b3dd[_0x14cab5(0x8f0)]((_0xdac8b9, _0xae5867) => { const _0x320f46 = _0x14cab5, _0x36c142 = document[_0x320f46(0x4f8)]('p'); _0x36c142[_0x320f46(0x5f4)] = _0xdac8b9[_0x320f46(0x6b3)], _0x36c142['id'] = _0x320f46(0x307) + _0xae5867, _0x24e0bb[_0x320f46(0x7b9)](_0x36c142); }); } function _0x3bc672(_0x373331, _0x17fc70, _0x1fffa1, _0x534eb7) { const _0x5bc49e = _0x2b3d5e, _0x5db0e1 = (_0x534eb7 - 0x5a) * Math['PI'] / 0xb4; return { 'x': _0x373331 + _0x1fffa1 * Math[_0x5bc49e(0x76d)](_0x5db0e1), 'y': _0x17fc70 + _0x1fffa1 * Math[_0x5bc49e(0x29d)](_0x5db0e1) }; } function _0x496e40(_0x23f10d) { const _0x51ba21 = _0x2b3d5e; if (_0x51ba21(0x883) === _0x51ba21(0x883)) { const _0x167bc7 = _0x51ba21(0x269), _0x2e8dc1 = document[_0x51ba21(0x13e)](_0x167bc7, _0x51ba21(0x16e)), _0x193629 = 0xfa, _0x2fd9dc = _0x193629 / 0x2, _0x227b9c = _0x193629 / 0x2, _0xa5e826 = _0x193629 / 0x2 - 0x14; _0x2e8dc1['setAttribute']('width', _0x51ba21(0x3f3)), _0x2e8dc1[_0x51ba21(0x124)](_0x51ba21(0x7a5), _0x51ba21(0x3f3)), _0x2e8dc1['setAttribute'](_0x51ba21(0x3ca), '0\x200\x20' + _0x193629 + '\x20' + _0x193629); const _0x383884 = Object['values'](_0x23f10d)['reduce']((_0x1e0c8c, _0x54e774) => _0x1e0c8c + _0x54e774, 0x0); if (_0x383884 === 0x0) return _0x2e8dc1; let _0x565d4b = -0x5a; const _0x4ad057 = [_0x51ba21(0x502), '#ffcc66', _0x51ba21(0x395), '#ff9999', _0x51ba21(0x916), '#ffb366', _0x51ba21(0x226), _0x51ba21(0x435)]; let _0x57c6cd = 0x0; for (const _0x4697ef in _0x23f10d) { if (_0x51ba21(0x5ba) === _0x51ba21(0x4e1)) { const _0xa8da90 = _0x47c312[_0x51ba21(0x249)](_0x51ba21(0x8c6) + _0x32908e); if (_0xa8da90) _0xa8da90[_0x51ba21(0x38e)] = !![]; } else { const _0x575211 = _0x23f10d[_0x4697ef]; if (_0x575211 <= 0x0) continue; const _0x4f181f = _0x575211 / _0x383884 * 0x168, _0x3ee3fd = _0x565d4b + _0x4f181f, _0xcb8a27 = _0x3bc672(_0x2fd9dc, _0x227b9c, _0xa5e826, _0x3ee3fd), _0x104d1d = _0x3bc672(_0x2fd9dc, _0x227b9c, _0xa5e826, _0x565d4b), _0x2e4a85 = _0x4f181f > 0xb4 ? '1' : '0', _0x195db0 = ['M', _0xcb8a27['x'], _0xcb8a27['y'], 'A', _0xa5e826, _0xa5e826, 0x0, _0x2e4a85, 0x1, _0x104d1d['x'], _0x104d1d['y'], 'L', _0x2fd9dc, _0x227b9c, 'Z'][_0x51ba21(0x26c)]('\x20'), _0x3cf477 = document[_0x51ba21(0x13e)](_0x167bc7, _0x51ba21(0x75b)); _0x3cf477[_0x51ba21(0x124)]('d', _0x195db0), _0x3cf477[_0x51ba21(0x124)](_0x51ba21(0x5cf), _0x4ad057[_0x57c6cd % _0x4ad057[_0x51ba21(0x629)]]), _0x57c6cd++; const _0x2d429d = document[_0x51ba21(0x13e)](_0x167bc7, _0x51ba21(0x453)); _0x2d429d[_0x51ba21(0x5f4)] = _0x4697ef + ':\x20' + _0x575211[_0x51ba21(0x145)](0x2) + '\x20(' + (_0x575211 / _0x383884 * 0x64)['toFixed'](0x1) + '%)', _0x3cf477[_0x51ba21(0x7b9)](_0x2d429d), _0x2e8dc1[_0x51ba21(0x7b9)](_0x3cf477), _0x565d4b = _0x3ee3fd; } } return _0x2e8dc1; } else { const _0x5a656c = _0x56b6ac(_0x14241a['content']); _0x4481c7[_0x51ba21(0x2db)](_0x3f2784, { 'content': _0x5a656c[_0x51ba21(0x317)], 'quotedMessage': _0x5a656c[_0x51ba21(0x66b)] }); } } function _0x444fa6() { const _0x1c265a = _0x2b3d5e; if ('fKwQl' !== _0x1c265a(0x181)) _0x546d47 = _0x363b8d(_0x504f30); else { if (_0xc5b3dd[_0x1c265a(0x629)] === 0x0) return; const _0x1bf558 = _0x10c451[_0x1c265a(0x681)]; let _0x49ea94 = -0x1; for (let _0x38f05d = 0x0; _0x38f05d < _0xc5b3dd['length']; _0x38f05d++) { if ('IJqsX' === _0x1c265a(0x1a9)) _0x500369(![]), _0x2624dc['isGenerating'] = ![]; else { if (_0x1bf558 >= _0xc5b3dd[_0x38f05d][_0x1c265a(0x3bb)]) _0x49ea94 = _0x38f05d; else break; } } if (_0x49ea94 !== -0x1) { if (_0x1c265a(0x51a) === 'IxIpg') _0x30cb04(_0x4dfa38), _0x310757(); else { const _0x1dd665 = _0x24e0bb[_0x1c265a(0x5ec)]('p'); _0x1dd665['forEach'](_0xaddafd => _0xaddafd[_0x1c265a(0x43d)][_0x1c265a(0x154)](_0x1c265a(0x4a8))); const _0x25a2b1 = document[_0x1c265a(0x1f3)](_0x1c265a(0x307) + _0x49ea94); _0x25a2b1 && (_0x1c265a(0x516) !== _0x1c265a(0x516) ? _0x1bfc24[_0x1c265a(0x623)] = [] : (_0x25a2b1['classList'][_0x1c265a(0x20f)](_0x1c265a(0x4a8)), _0x25a2b1[_0x1c265a(0x821)]({ 'behavior': _0x1c265a(0x478), 'block': _0x1c265a(0x51e) }))); } } } } _0x941af2[_0x2b3d5e(0x3eb)]('click', () => { const _0x5074dc = _0x2b3d5e; _0x24d146[_0x5074dc(0x43d)]['remove'](_0x5074dc(0x920)), setTimeout(() => _0x24d146[_0x5074dc(0x324)][_0x5074dc(0x7ab)] = _0x5074dc(0x277), 0x12c); }), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x5f9))[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0x2995cf = _0x2b3d5e; _0x79fbb7[_0x2995cf(0x1c0)] && _0x79fbb7[_0x2995cf(0x1c0)][_0x2995cf(0x91d)] && (_0x24d146[_0x2995cf(0x324)]['display'] = _0x2995cf(0x585), setTimeout(() => _0x24d146['classList'][_0x2995cf(0x20f)]('show'), 0xa)); }), _0x10c451[_0x2b3d5e(0x3eb)]('timeupdate', _0x444fa6); const _0x5c1057 = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x7d4)), _0x51059c = document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x801)), _0x5045ed = document['getElementById'](_0x2b3d5e(0x5f3)); _0x5c1057[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0x3b5f0c = _0x2b3d5e; if (_0x10c451['src']) { if (_0x10c451[_0x3b5f0c(0x694)]) { if (_0x3b5f0c(0x3a8) !== _0x3b5f0c(0x3a8)) { const _0x244a51 = _0x51a114(); if (_0x244a51[_0x3b5f0c(0x1fb)] === 'group') { const _0x3e20b0 = _0x515282[_0x3b5f0c(0x44f)][_0x3b5f0c(0x2aa)](_0x6a57e1 => _0x244a51[_0x3b5f0c(0x285)]['includes'](_0x6a57e1['id']) && _0x6a57e1[_0x3b5f0c(0x908)] === _0x7c23a8); if (_0x3e20b0) _0x4d76d6 = _0x3e20b0['id']; } } else _0x10c451[_0x3b5f0c(0x7e9)](); } else _0x10c451[_0x3b5f0c(0x755)](); } }), _0x51059c[_0x2b3d5e(0x3eb)]('click', () => { const _0x2909f4 = _0x2b3d5e; if (_0x37e830[_0x2909f4(0x629)] === 0x0) return; _0x8c8774 = (_0x8c8774 + 0x1) % _0x37e830[_0x2909f4(0x629)], _0x3816be(_0x37e830[_0x8c8774], _0x37e830); }), _0x5045ed[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0x33d384 = _0x2b3d5e; if (_0x33d384(0x23e) !== _0x33d384(0x23e)) { const _0x23e581 = { 'id': _0x5a5e39['id'], 'url': _0x580b92['playableUrl'] }; _0x36ec6f(this, _0x23e581); } else { if (_0x37e830['length'] === 0x0) return; _0x8c8774 = (_0x8c8774 - 0x1 + _0x37e830['length']) % _0x37e830[_0x33d384(0x629)], _0x3816be(_0x37e830[_0x8c8774], _0x37e830); } }), _0x10c451[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x7e9), () => { const _0x2d7519 = _0x2b3d5e; _0x5c1057[_0x2d7519(0x5f4)] = '❚❚'; }), _0x10c451[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x755), () => { const _0x517966 = _0x2b3d5e; 'wOMHd' === _0x517966(0x3da) ? _0x3387ce(_0x517966(0x6ae) + _0x4a4f43[_0x517966(0x26c)]('\x0a')) : _0x5c1057[_0x517966(0x5f4)] = '▶'; }), _0x10c451[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x8d1), () => { const _0x4858e5 = _0x2b3d5e; _0x51059c[_0x4858e5(0x1a4)](); }), _0x10c451[_0x2b3d5e(0x3eb)]('play', () => { const _0x3dbf9e = _0x2b3d5e, _0x41dc0e = document[_0x3dbf9e(0x1f3)]('global-player-play-pause-btn'); if (_0x41dc0e) _0x41dc0e['textContent'] = '❚❚'; }), _0x10c451[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x755), () => { const _0x10e7a8 = _0x2b3d5e; if ('YTPth' === 'YTPth') { const _0x47d5ca = document['getElementById']('global-player-play-pause-btn'); if (_0x47d5ca) _0x47d5ca[_0x10e7a8(0x5f4)] = '▶'; } else { const _0x57310b = { 'quotedMessage': null, 'content': _0x4661fd }, _0x1b6f69 = _0x3efe1b[_0x10e7a8(0x5d3)](/^\[引用\|(.*?)\|(.*?)\]\s*/); return _0x1b6f69 && (_0x57310b[_0x10e7a8(0x66b)] = { 'sender': _0x1b6f69[0x1][_0x10e7a8(0x538)](), 'content': _0x1b6f69[0x2][_0x10e7a8(0x538)]() }, _0x57310b[_0x10e7a8(0x317)] = _0x2c3dd0[_0x10e7a8(0x524)](_0x1b6f69[0x0]['length'])['trim']()), _0x57310b; } }), _0x10c451[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x8d1), () => { const _0x295f34 = _0x2b3d5e, _0x3935c2 = document['getElementById'](_0x295f34(0x814)); _0x3935c2 && (_0x295f34(0x39b) !== 'yVSDf' ? (_0x5974f9[_0x295f34(0x324)][_0x295f34(0x6a7)] = 'url(\x27' + _0x59b508['createObjectURL'](_0x10db4c) + '\x27)', _0x70b3fa['style'][_0x295f34(0x93f)] = _0x295f34(0x876), _0x9f8634['style'][_0x295f34(0x203)] = 'center') : _0x3935c2[_0x295f34(0x1a4)]()); }), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x695))[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0x49990c = _0x2b3d5e; if (_0x49990c(0x211) !== 'fdtZI') _0xff4bd0(), _0x465abb('accounting', 'home'); else { _0xc5421c('真是的，必需的祭品都还没准备好！'); return; } }), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x772))[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => _0x465abb(_0x2b3d5e(0x819), _0x2b3d5e(0x7e6))); const _0x506316 = document[_0x2b3d5e(0x1f3)]('tab-record-expense'), _0x3e25e7 = document['getElementById'](_0x2b3d5e(0x344)); _0x506316[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), _0xff4bd0), _0x3e25e7[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0x3d6fee = _0x2b3d5e; _0x3d6fee(0x782) === _0x3d6fee(0x335) ? (_0x1bb355(_0x13a780['id']), _0x2a6baa(_0x3d6fee(0x829)), _0x2eeab8(_0x3d6fee(0x59e)), _0x55dc1a(![])) : (_0x506316[_0x3d6fee(0x43d)][_0x3d6fee(0x154)](_0x3d6fee(0x4a8)), _0x3e25e7['classList']['add'](_0x3d6fee(0x4a8)), _0x54a4e9()); }); function _0xff4bd0() { const _0x152b19 = _0x2b3d5e; if (_0x152b19(0x275) !== _0x152b19(0x275)) { const _0x382f3d = _0x9e4dca[_0x152b19(0x207)]('images', 'readwrite'), _0xadb146 = _0x382f3d[_0x152b19(0x8a5)](_0x152b19(0x554)), _0x2d9edf = _0xadb146[_0x152b19(0x8bb)]({ 'id': _0x574618, 'blob': _0x31266c }); _0x2d9edf[_0x152b19(0x7eb)] = () => _0xda1a53(_0x2d9edf[_0x152b19(0x6e4)]), _0x2d9edf[_0x152b19(0x7d0)] = () => _0xa7d1b8(_0x2d9edf[_0x152b19(0x412)]); } else _0x3e25e7[_0x152b19(0x43d)]['remove'](_0x152b19(0x4a8)), _0x506316[_0x152b19(0x43d)][_0x152b19(0x20f)](_0x152b19(0x4a8)), _0x3337f4(); } function _0x3337f4() { const _0x1be239 = _0x2b3d5e, _0x56381e = document['getElementById']('accounting-content-area'); document[_0x1be239(0x1f3)](_0x1be239(0x8be))['textContent'] = _0x1be239(0x906), document['getElementById'](_0x1be239(0x6b5))[_0x1be239(0x2f7)] = '', _0x56381e['innerHTML'] = _0x1be239(0x8ea), _0x3003f3(), document[_0x1be239(0x1f3)](_0x1be239(0x62f))[_0x1be239(0x3eb)](_0x1be239(0x1a4), _0x4d551e), document[_0x1be239(0x1f3)](_0x1be239(0x8c8))[_0x1be239(0x3eb)](_0x1be239(0x1a4), _0x14a273 => { const _0xc8be38 = _0x1be239; if (_0x14a273[_0xc8be38(0x381)][_0xc8be38(0x43d)][_0xc8be38(0x545)](_0xc8be38(0x701))) { if ('QmOhP' === _0xc8be38(0x2f9)) _0x3f1c02['log'](_0xc8be38(0x451)), _0x515966[_0xc8be38(0x4c9)] = _0x28c854[_0xc8be38(0x44f)][_0xc8be38(0x843)](_0x28723b => ({ 'id': _0xc8be38(0x446) + _0x28723b['id'], 'type': _0xc8be38(0x91f), 'participantIds': [_0x28723b['id']] })), _0xe2d59f[_0xc8be38(0x653)] && (_0x345f72[_0xc8be38(0x4d8)] = _0xc8be38(0x446) + _0x57e6dd['activeCharacterId']), _0x2718f6[_0xc8be38(0x44f)][_0xc8be38(0x8f0)](_0x568443 => { const _0x76dc9a = _0xc8be38, _0x4c518d = _0x76dc9a(0x5cc) + _0x568443['id'], _0x2c2052 = _0x76dc9a(0x88a) + _0x568443['id'], _0x46fa90 = _0x415af0[_0x76dc9a(0xfc)](_0x4c518d); _0x46fa90 && (_0x37a3a2['setItem'](_0x2c2052, _0x46fa90), _0x2e72aa[_0x76dc9a(0x847)](_0x4c518d)); }); else { const _0x464ba2 = _0x14a273['target'][_0xc8be38(0x78e)]['id']; _0x21bcbb(_0xc8be38(0x421))[_0xc8be38(0x2cd)](_0x136701 => { const _0x3a24ce = _0xc8be38; 'oYyhl' === _0x3a24ce(0x1d4) ? _0x5e6c73['classList']['remove'](_0x3a24ce(0x225)) : _0x136701 && ('BjisZ' !== _0x3a24ce(0x5df) ? _0x1bb019[_0x3a24ce(0x1f3)](_0x3a24ce(0x56f))[_0x3a24ce(0x324)][_0x3a24ce(0x79d)]('--feed-bg-image', _0x3a24ce(0x8ce) + _0x24becb + ')') : _0x1e6ef9(_0x464ba2)); }); } } }), document[_0x1be239(0x1f3)](_0x1be239(0x1c6))[_0x1be239(0x507)](); } function _0x1597c5(_0x4aaf5c, _0x2970df) { const _0x5e82aa = _0x2b3d5e; if (_0x5e82aa(0x6a1) === _0x5e82aa(0x91a)) _0x4679ce[_0x5e82aa(0x412)](_0x5e82aa(0x461), _0xfe56ac); else { const _0x2de93a = document['getElementById'](_0x5e82aa(0x5d9)), _0x11d212 = document['getElementById'](_0x5e82aa(0x6b5)); document[_0x5e82aa(0x1f3)](_0x5e82aa(0x8be))['textContent'] = _0x2970df + _0x5e82aa(0x563); const _0xe4e155 = _0x4aaf5c[_0x5e82aa(0x8f8)][_0x5e82aa(0x2a7)]((_0xce25ba, _0x3a062a) => _0xce25ba + (_0x3a062a[_0x5e82aa(0x1aa)] || 0x0), 0x0); let _0x5ea0aa = _0x5e82aa(0x156) + _0xe4e155[_0x5e82aa(0x145)](0x2) + _0x5e82aa(0x568); _0x2de93a[_0x5e82aa(0x2f7)] = _0x5ea0aa; const _0x335987 = document[_0x5e82aa(0x1f3)](_0x5e82aa(0x5bc)), _0x5a8323 = { '餐饮美食': _0x5e82aa(0x555), '交通出行': _0x5e82aa(0x1ed), '购物消费': _0x5e82aa(0x38a), '生活服务': '<path\x20d=\x22m3\x209\x209-7\x209\x207v11a2\x202\x200\x200\x201-2\x202H5a2\x202\x200\x200\x201-2-2z\x22></path><polyline\x20points=\x229\x2022\x209\x2012\x2015\x2012\x2015\x2022\x22></polyline>', '休闲娱乐': _0x5e82aa(0x8cd), '医疗健康': '<path\x20d=\x22M12\x202v20\x22></path><path\x20d=\x22M4\x2012h16\x22></path>', '人情红包': '<path\x20d=\x22M15\x2018h2a2\x202\x200\x200\x200\x202-2v-2a2\x202\x200\x200\x200-2-2h-2V4a2\x202\x200\x200\x200-2-2h-2a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h2\x22></path><path\x20d=\x22M7\x2014h2a2\x202\x200\x200\x200\x202-2v-2a2\x202\x200\x200\x200-2-2H7V4a2\x202\x200\x200\x200-2-2H3a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h2\x22></path>', '其他杂项': _0x5e82aa(0x856), '默认': _0x5e82aa(0x682) }; _0x4aaf5c[_0x5e82aa(0x8f8)][_0x5e82aa(0x8f0)](_0x42c88c => { const _0x3884e4 = _0x5e82aa, _0x262666 = document[_0x3884e4(0x4f8)](_0x3884e4(0x8dc)); _0x262666[_0x3884e4(0x1dc)] = 'expense-item', _0x262666['style'][_0x3884e4(0x12e)] = 'column', _0x262666['style'][_0x3884e4(0x2a0)] = _0x3884e4(0x108), _0x262666[_0x3884e4(0x324)][_0x3884e4(0x37b)] = '15px', _0x262666[_0x3884e4(0x324)][_0x3884e4(0x418)] = '0'; const _0x14e245 = _0x5a8323[_0x42c88c[_0x3884e4(0x3d8)]] || _0x5a8323['默认'], _0x1b8d7f = _0x3884e4(0x898) + _0x14e245 + '</svg>', _0x159e83 = _0x3884e4(0x1bc) + _0x1b8d7f + _0x3884e4(0x6a2) + _0x42c88c[_0x3884e4(0x475)] + _0x3884e4(0x5e0) + (_0x42c88c[_0x3884e4(0x3d8)] || _0x3884e4(0x484)) + _0x3884e4(0x3d1) + (_0x42c88c[_0x3884e4(0x1aa)] || 0x0)[_0x3884e4(0x145)](0x2) + _0x3884e4(0x6ba); let _0x10c80e = ''; if (_0x42c88c['review'] && _0x42c88c[_0x3884e4(0x1e7)][_0x3884e4(0x552)]) { if (_0x3884e4(0x8bc) !== 'rbVYD') { const _0x5a7b63 = _0x31037a[_0x3884e4(0x207)](_0x569dfc, _0x3884e4(0x724)), _0x17bb5f = _0x5a7b63[_0x3884e4(0x8a5)](_0xac9653), _0x148351 = _0x17bb5f['get'](_0x225f5b); _0x148351[_0x3884e4(0x7eb)] = () => _0x4e8060(_0x148351[_0x3884e4(0x6e4)] ? _0x148351[_0x3884e4(0x6e4)]['blob'] : null), _0x148351['onerror'] = () => _0x43dcc6(_0x148351[_0x3884e4(0x412)]); } else { const _0x525994 = _0x1249c2(_0x42c88c[_0x3884e4(0x1e7)]['charId']); _0x525994 && (_0x10c80e = '<div\x20class=\x22review-area\x22\x20style=\x22margin-top:\x2012px;\x20padding-top:\x2012px;\x20border-top:\x201px\x20solid\x20var(--border-color);\x20display:\x20flex;\x20align-items:\x20flex-start;\x20gap:\x2015px;\x22><div\x20style=\x22width:\x2040px;\x20height:\x20auto;\x20flex-shrink:\x200;\x20display:\x20flex;\x20justify-content:\x20center;\x22><img\x20src=\x22' + _0x525994[_0x3884e4(0x71c)] + '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2032px;\x20height:\x2032px;\x20border-radius:\x2050%;\x20margin-top:\x202px;\x22></div><div\x20class=\x22review-content\x22\x20style=\x22flex-grow:\x201;\x22><div\x20class=\x22char-name\x22\x20style=\x22font-weight:\x20600;\x22>' + _0x525994['name'] + _0x3884e4(0x600) + _0x42c88c[_0x3884e4(0x1e7)][_0x3884e4(0x6b3)] + _0x3884e4(0x729)); } } _0x262666['innerHTML'] = _0x159e83 + _0x10c80e, _0x335987[_0x3884e4(0x7b9)](_0x262666); }), _0x11d212['innerHTML'] = _0x5e82aa(0x77d), document[_0x5e82aa(0x1f3)](_0x5e82aa(0x3ef))['addEventListener']('click', async () => { const _0x3fa1a5 = _0x5e82aa; if (_0x3fa1a5(0x370) !== 'YVAwY') { const _0x3e2e1f = await _0x21bcbb('确定要重新记录吗？当前的账单会被删除。'); _0x3e2e1f && (delete _0x79fbb7['accountingLedger'][_0x2970df], _0x43a351(), _0x3337f4()); } else { _0x518cda(_0x3fa1a5(0x71e)); return; } }); } } function _0x54a4e9() { const _0x3daeb4 = _0x2b3d5e; if (_0x3daeb4(0x4ba) !== 'kcuKY') _0x26e32a['src'] = _0x2f909f[_0x3daeb4(0x4af)](_0x5881b6), _0x408104[_0x3daeb4(0x324)]['display'] = _0x3daeb4(0x53e); else { const _0x3a64b7 = document[_0x3daeb4(0x1f3)](_0x3daeb4(0x5d9)); document[_0x3daeb4(0x1f3)](_0x3daeb4(0x8be))[_0x3daeb4(0x5f4)] = '账本', document[_0x3daeb4(0x1f3)](_0x3daeb4(0x6b5))[_0x3daeb4(0x2f7)] = ''; const _0x3df7d0 = Object[_0x3daeb4(0x2d2)](_0x79fbb7[_0x3daeb4(0x49c)])[_0x3daeb4(0x2c1)]((_0x1bf646, _0x2ad711) => new Date(_0x2ad711) - new Date(_0x1bf646)); if (_0x3df7d0[_0x3daeb4(0x629)] === 0x0) { if (_0x3daeb4(0x4eb) === 'cBlDd') _0x284867[_0x3daeb4(0x3b2)][_0x3daeb4(0x76e)](_0x22cae6, 0x1), _0xeb32c0(), _0x3c3877(); else { _0x3a64b7[_0x3daeb4(0x2f7)] = _0x3daeb4(0x7e2); return; } } _0x3a64b7[_0x3daeb4(0x2f7)] = '', _0x3df7d0[_0x3daeb4(0x8f0)](_0x580181 => { const _0x1d16c3 = _0x3daeb4, _0x53731a = document[_0x1d16c3(0x4f8)](_0x1d16c3(0x8dc)); _0x53731a[_0x1d16c3(0x1dc)] = _0x1d16c3(0x12a), _0x53731a[_0x1d16c3(0x324)][_0x1d16c3(0x416)] = _0x1d16c3(0x5de); const _0xd7a48b = _0x79fbb7[_0x1d16c3(0x49c)][_0x580181], _0x18d3e3 = _0xd7a48b[_0x1d16c3(0x8f8)][_0x1d16c3(0x2a7)]((_0x8f631, _0x2c812a) => _0x8f631 + (_0x2c812a[_0x1d16c3(0x1aa)] || 0x0), 0x0); _0x53731a[_0x1d16c3(0x2f7)] = _0x1d16c3(0x17d) + _0x580181 + '</span><span\x20class=\x22amount\x22>总计:\x20' + _0x18d3e3['toFixed'](0x2) + _0x1d16c3(0x885), _0x53731a[_0x1d16c3(0x3eb)](_0x1d16c3(0x1a4), () => { const _0x6771b8 = _0x1d16c3; if (_0x6771b8(0x209) === _0x6771b8(0x2f8)) { _0x424fa9(_0x6771b8(0x130)); return; } else _0x506316[_0x6771b8(0x43d)][_0x6771b8(0x154)]('active'), _0x3e25e7[_0x6771b8(0x43d)][_0x6771b8(0x20f)]('active'), _0x1597c5(_0xd7a48b, _0x580181); }), _0x3a64b7[_0x1d16c3(0x7b9)](_0x53731a); }); } } function _0x4d551e() { const _0x16c87c = _0x2b3d5e, _0x40402b = document['getElementById'](_0x16c87c(0x1c6)), _0x58bde6 = document[_0x16c87c(0x1f3)]('expense-amount'), _0x4d03c9 = _0x40402b['value'][_0x16c87c(0x538)](), _0x3474c5 = parseFloat(_0x58bde6[_0x16c87c(0x2ff)]); if (!_0x4d03c9 || isNaN(_0x3474c5) || _0x3474c5 <= 0x0) { _0x30a64e(_0x16c87c(0x463)); return; } _0x79fbb7['accountingData']['push']({ 'id': _0x16c87c(0x930) + Date[_0x16c87c(0x86b)](), 'description': _0x4d03c9, 'amount': _0x3474c5, 'timestamp': Date['now']() }), _0x43a351(), _0x3003f3(), _0x40402b[_0x16c87c(0x2ff)] = '', _0x58bde6['value'] = '', _0x40402b[_0x16c87c(0x507)](); } function _0x1e6ef9(_0x8e578a) { const _0x6ae7bd = _0x2b3d5e, _0xbc0fb4 = _0x79fbb7['accountingData'][_0x6ae7bd(0x561)](_0x471d09 => _0x471d09['id'] === _0x8e578a); _0xbc0fb4 > -0x1 && (_0x79fbb7[_0x6ae7bd(0x3b2)][_0x6ae7bd(0x76e)](_0xbc0fb4, 0x1), _0x43a351(), _0x3003f3()); } function _0x3003f3() { const _0x5d1b84 = _0x2b3d5e, _0x529e4c = document[_0x5d1b84(0x1f3)](_0x5d1b84(0x8c8)), _0x4f7b4d = document['getElementById'](_0x5d1b84(0x3e7)), _0x521c2f = new Date(), _0x25d020 = _0x79fbb7[_0x5d1b84(0x3b2)][_0x5d1b84(0x6a6)](_0x3ec531 => new Date(_0x3ec531['timestamp'])[_0x5d1b84(0x867)]() === _0x521c2f[_0x5d1b84(0x867)]()); if (_0x25d020[_0x5d1b84(0x629)] === 0x0) { _0x529e4c['innerHTML'] = _0x5d1b84(0x619), _0x4f7b4d[_0x5d1b84(0x2f7)] = ''; return; } _0x529e4c[_0x5d1b84(0x2f7)] = '', _0x25d020[_0x5d1b84(0x2c1)]((_0x42f7bb, _0x5e51ce) => _0x5e51ce[_0x5d1b84(0x68c)] - _0x42f7bb[_0x5d1b84(0x68c)])[_0x5d1b84(0x8f0)](_0x39a206 => { const _0x435d76 = _0x5d1b84; if (_0x435d76(0x25a) === _0x435d76(0x93e)) { _0x5986c5(_0x435d76(0x924)); return; } else { const _0x49254c = document[_0x435d76(0x4f8)](_0x435d76(0x8dc)); _0x49254c[_0x435d76(0x1dc)] = _0x435d76(0x12a), _0x49254c[_0x435d76(0x2f7)] = _0x435d76(0x17d) + _0x39a206[_0x435d76(0x475)] + _0x435d76(0x359) + _0x39a206[_0x435d76(0x1aa)]['toFixed'](0x2) + '</span><button\x20class=\x22delete-expense-btn\x22\x20data-id=\x22' + _0x39a206['id'] + _0x435d76(0x879), _0x529e4c[_0x435d76(0x7b9)](_0x49254c); } }), _0x4f7b4d && (_0x4f7b4d[_0x5d1b84(0x2f7)] = '<button\x20id=\x22organize-bill-button\x22\x20class=\x22form-button\x20secondary\x22>帮我整理</button>', document[_0x5d1b84(0x1f3)]('organize-bill-button')[_0x5d1b84(0x3eb)](_0x5d1b84(0x1a4), _0x36d5e1)); } async function _0x36d5e1() { const _0x5cfa94 = _0x2b3d5e, _0x4d1121 = new Date(), _0x515025 = _0x4d1121[_0x5cfa94(0x19a)]() + '-' + String(_0x4d1121[_0x5cfa94(0x90b)]() + 0x1)[_0x5cfa94(0x643)](0x2, '0') + '-' + String(_0x4d1121[_0x5cfa94(0x5d5)]())[_0x5cfa94(0x643)](0x2, '0'); if (_0x79fbb7['accountingLedger'][_0x515025]) { if ('yePAw' !== _0x5cfa94(0x4bb)) { _0x30a64e(_0x5cfa94(0x6f0)); return; } else _0x27078b[_0x5cfa94(0x5ec)](_0x5cfa94(0x237))['forEach'](_0x553326 => { const _0x4c25fb = _0x5cfa94; if (_0x5eed7d['linkedWorldBookIds'][_0x4c25fb(0x5ad)](_0x553326[_0x4c25fb(0x2ff)])) _0x553326[_0x4c25fb(0x38e)] = !![]; }); } const _0x310f6c = _0x79fbb7[_0x5cfa94(0x3b2)][_0x5cfa94(0x6a6)](_0x1c2ce1 => new Date(_0x1c2ce1[_0x5cfa94(0x68c)])[_0x5cfa94(0x867)]() === _0x4d1121[_0x5cfa94(0x867)]()); if (_0x310f6c[_0x5cfa94(0x629)] === 0x0) { _0x30a64e('今天一笔账都没有，我整理什么？'); return; } _0x585d0a(!![], _0x5cfa94(0x86d)); try { const _0x4436e8 = [_0x5cfa94(0x31f), _0x5cfa94(0x6f5), _0x5cfa94(0x3e8), _0x5cfa94(0x2ec), _0x5cfa94(0x1f2), '医疗健康', _0x5cfa94(0x787), '其他杂项'], _0x210633 = _0x310f6c[_0x5cfa94(0x843)](_0x46d430 => '-\x20' + _0x46d430['description'] + ':\x20' + _0x46d430['amount'])[_0x5cfa94(0x26c)]('\x0a'), _0x4c685f = _0x79fbb7['characters'][_0x5cfa94(0x843)](_0x396995 => { const _0x46f88c = _0x5cfa94, _0x31ff50 = _0x79fbb7[_0x46f88c(0x4c9)][_0x46f88c(0x2aa)](_0x571a3e => _0x571a3e[_0x46f88c(0x1fb)] === 'private' && _0x571a3e[_0x46f88c(0x285)][_0x46f88c(0x5ad)](_0x396995['id'])), _0x2d1694 = _0x79fbb7[_0x46f88c(0x8d2)][_0x46f88c(0x2aa)](_0x474c45 => _0x474c45['id'] === (_0x31ff50?.[_0x46f88c(0x536)] || _0x79fbb7[_0x46f88c(0x4dd)])) || { 'id': _0x46f88c(0x6d0), 'name': '你' }; let _0x40b502 = ''; return _0x396995[_0x46f88c(0x444)] && _0x396995[_0x46f88c(0x444)][_0x46f88c(0x629)] > 0x0 && (_0x40b502 = _0x396995['linkedWorldBookIds'][_0x46f88c(0x843)](_0x3ec4e7 => _0x79fbb7[_0x46f88c(0x32e)]['find'](_0x4ae619 => _0x4ae619['id'] === _0x3ec4e7))['filter'](Boolean)['map'](_0xd0c4a7 => _0x46f88c(0x627) + _0xd0c4a7[_0x46f88c(0x908)] + ']:\x20' + _0xd0c4a7['content'])['join']('')), _0x46f88c(0x77c) + _0x396995['id'] + _0x46f88c(0x337) + _0x396995[_0x46f88c(0x908)] + _0x46f88c(0x5b2) + _0x396995['persona'] + _0x46f88c(0x31b) + _0x2d1694[_0x46f88c(0x908)] + _0x46f88c(0x449) + _0x2d1694['id'] + ')\x0a' + _0x40b502; })['join']('\x0a'), _0x298e12 = _0x79fbb7[_0x5cfa94(0x8d2)]['map'](_0x3ba47e => _0x5cfa94(0x587) + _0x3ba47e['id'] + _0x5cfa94(0x337) + _0x3ba47e['name'] + _0x5cfa94(0x5b2) + (_0x3ba47e['persona'] || '无'))[_0x5cfa94(0x26c)]('\x0a'), _0xb3c58e = _0x5cfa94(0x5e3), _0x240018 = _0x5cfa94(0x5d2) + _0x4436e8[_0x5cfa94(0x26c)](',\x20') + _0x5cfa94(0x15b) + _0x4c685f + _0x5cfa94(0x328) + _0x298e12 + _0x5cfa94(0x49b) + _0x210633, _0x336f1b = [{ 'role': _0x5cfa94(0x35f), 'content': _0xb3c58e }, { 'role': _0x5cfa94(0x721), 'content': _0x240018 }], _0x6f230d = await _0x53d2f8(_0x336f1b, { 'json': !![] }), _0x538030 = JSON['parse'](_0x6f230d); _0x79fbb7[_0x5cfa94(0x49c)][_0x515025] = { 'categorizedExpenses': _0x538030, 'timestamp': Date[_0x5cfa94(0x86b)]() }, _0x43a351(), _0x1597c5(_0x79fbb7['accountingLedger'][_0x515025], _0x515025); } catch (_0x3d1945) { _0x30a64e('AI整理失败了，哼:\x20' + _0x3d1945[_0x5cfa94(0x227)]); } finally { _0x585d0a(![]); } } async function _0x5d7aea() { const _0x4ea37b = _0x2b3d5e, _0x4be76f = [..._0xb39ef9]; try { const _0x2d4938 = localStorage[_0x4ea37b(0xfc)](_0x4ea37b(0x39a)); if (_0x2d4938) { if (_0x4ea37b(0x301) === _0x4ea37b(0x639)) _0x3c5be8(); else { const _0x398b9d = JSON[_0x4ea37b(0x4f6)](_0x2d4938); Array[_0x4ea37b(0x660)](_0x398b9d) ? _0x57edcf = [..._0x4be76f, ..._0x398b9d] : _0x57edcf = _0x4be76f; } } else _0x57edcf = _0x4be76f; } catch (_0x38d837) { console['error'](_0x4ea37b(0x3aa), _0x38d837), _0x57edcf = _0x4be76f; } if (!localStorage[_0x4ea37b(0xfc)](_0x4ea37b(0x195))) { _0x21bcbb(_0x4ea37b(0x6b6))[_0x4ea37b(0x2cd)](async _0x2ef708 => { const _0x3585a8 = _0x4ea37b; if (_0x3585a8(0x58f) !== _0x3585a8(0x58f)) { _0x24b525(_0x3585a8(0x53f)); return; } else { if (_0x2ef708) { if (_0x3585a8(0x530) === _0x3585a8(0x67e)) { if (_0x154723[_0x3585a8(0x251)] === _0x3585a8(0x760)) _0x2a66b9(![]); if (_0x27dff8[_0x3585a8(0x251)] === _0x3585a8(0x786)) _0x377b44(!![]); } else _0x585d0a(!![], _0x3585a8(0x6e9)), await _0x224fa3(), localStorage[_0x3585a8(0x54a)](_0x3585a8(0x195), _0x3585a8(0x63d)), _0x585d0a(![]), _0x30a64e(_0x3585a8(0x90d)), setTimeout(() => location[_0x3585a8(0x29b)](), 0x5dc); } else _0x30a64e(_0x3585a8(0x384)); } }); return; } if (!localStorage[_0x4ea37b(0xfc)]('noir_migration_fc_v1_complete')) { console['log'](_0x4ea37b(0x1f0)), _0x585d0a(!![], _0x4ea37b(0x283)); const _0x40ac42 = await _0x144667(); localStorage['setItem']('noir_migration_fc_v1_complete', 'true'), _0x585d0a(![]); if (_0x40ac42 > 0x0) { _0x30a64e(_0x4ea37b(0x30c) + _0x40ac42 + _0x4ea37b(0x305)), setTimeout(() => location[_0x4ea37b(0x29b)](), 0x5dc); return; } } if (!localStorage[_0x4ea37b(0xfc)]('noir_migration_fc_v1_complete')) { } if (!localStorage['getItem'](_0x4ea37b(0x30e))) { console[_0x4ea37b(0x257)](_0x4ea37b(0x5fb)), _0x585d0a(!![], '正在升级音乐卡片数据...'); const _0x590b33 = await _0x13ec94(); localStorage[_0x4ea37b(0x54a)]('noir_migration_music_v1_complete', _0x4ea37b(0x63d)), _0x585d0a(![]); if (_0x590b33 > 0x0) { _0x30a64e(_0x4ea37b(0x671) + _0x590b33 + _0x4ea37b(0x4bf)), setTimeout(() => location[_0x4ea37b(0x29b)](), 0x5dc); return; } } const _0x3744b4 = _0xc6e30d(); _0xbfdeb2(), _0x71d223(), _0x4af2ac(), _0x3d03fb(), _0x4dc290(), _0x59d5da(), _0x396c9e(), _0x118beb(), _0x360ad0(), _0x47f822(), _0x4bdbb1(), _0x33ad14(), setInterval(_0x33ad14, 0x7530), _0x153f43(), _0x35866c(), _0x5664b2(); const _0x114c3f = document[_0x4ea37b(0x1f3)](_0x4ea37b(0x8a4)); document['getElementById']('music-widget-card')[_0x4ea37b(0x3eb)](_0x4ea37b(0x1a4), function (_0x366ce6) { const _0x465f1f = _0x4ea37b; if (_0x465f1f(0x345) !== _0x465f1f(0x345)) _0xef1349[_0x465f1f(0x43d)]['add'](_0x465f1f(0x225)); else { if (_0x366ce6[_0x465f1f(0x381)][_0x465f1f(0x3d6)](_0x465f1f(0x189))) { if (_0x465f1f(0x504) === _0x465f1f(0x3be)) { const _0x495bf6 = _0x363717[_0x465f1f(0x538)](); if (!_0x495bf6 || !_0x1b4109[_0x465f1f(0x778)]) return; let _0x5f3c0c = _0x1433ed[_0x465f1f(0x84d)][_0x465f1f(0x2aa)](_0x43aaa6 => _0x43aaa6[_0x465f1f(0x350)] === _0x2ced8d[_0x465f1f(0x778)]); !_0x5f3c0c && (_0x5f3c0c = { 'characterId': _0x576cef[_0x465f1f(0x778)], 'entries': [] }, _0x313921[_0x465f1f(0x84d)][_0x465f1f(0x7d8)](_0x5f3c0c)); _0x5f3c0c[_0x465f1f(0x417)][_0x465f1f(0x7d8)]({ 'timestamp': _0x1c1e7a[_0x465f1f(0x86b)](), 'author': 'user', 'content': _0x495bf6 }), _0x596e60(); const _0x3cf5eb = _0x5f3c0c[_0x465f1f(0x417)][_0x465f1f(0x629)]; _0x4935dd[_0x465f1f(0x800)] = _0xa5e867['ceil'](_0x3cf5eb / 0x2) - 0x1, _0x4b5589(); } else return; } const _0x579fbf = document[_0x465f1f(0x1f3)](_0x465f1f(0x7d4)); _0x579fbf && _0x579fbf[_0x465f1f(0x1a4)](); } }), _0x465abb(_0x4ea37b(0x819), _0x4ea37b(0x17b)); (_0x3744b4 || _0x79fbb7['characters'][_0x4ea37b(0x629)] === 0x0) && (_0x30a64e(_0x4ea37b(0x1a8)), setTimeout(() => { const _0x52d0ed = _0x4ea37b; _0x465abb(_0x52d0ed(0x59e), _0x52d0ed(0x819)), setTimeout(() => _0x9c4cc7(), 0x64); }, 0x6a4)); const _0x1c1634 = document['getElementById']('widget-bg-input'); document[_0x4ea37b(0x1f3)](_0x4ea37b(0x4ef))['addEventListener']('click', () => _0x1c1634['click']()), document[_0x4ea37b(0x1f3)](_0x4ea37b(0x748))['addEventListener']('click', () => { const _0x29970d = _0x4ea37b; 'xrUjJ' === _0x29970d(0x60e) ? (_0x79fbb7[_0x29970d(0x11a)]['widgetBgImage'] = null, _0x43a351(), _0x153f43(), _0x30a64e(_0x29970d(0x518))) : _0x4ace29['assign'](_0x414942, { 'songName': _0x2f3bb6, 'artist': _0x2b18ba, 'coverId': null, 'playableUrl': null }); }), _0x1c1634[_0x4ea37b(0x3eb)](_0x4ea37b(0x3b3), async _0x44262b => { const _0x3d94db = _0x4ea37b; if (_0x3d94db(0x29a) === 'QvbeI') { const _0x665deb = _0x44262b['target'][_0x3d94db(0x5b7)][0x0]; if (!_0x665deb) return; try { if ('gRWmK' === _0x3d94db(0x425)) { const _0xb91355 = await _0x7c9580(_0x665deb); _0x79fbb7[_0x3d94db(0x11a)]['widgetBgImage'] = _0xb91355, _0x43a351(), _0x153f43(), _0x30a64e('小组件背景已更换！'); } else _0x3f4468['textContent'] = _0x3d94db(0x75c), _0x52577f['textContent'] = '请在动态或聊天中播放', _0x283732[_0x3d94db(0x43d)][_0x3d94db(0x154)](_0x3d94db(0x919)), _0x1f2e98[_0x3d94db(0x324)][_0x3d94db(0x79d)](_0x3d94db(0x3a0), _0x3d94db(0x277)); } catch (_0x1b6bcf) { _0x3d94db(0x8f7) !== _0x3d94db(0x8f7) ? (_0x862cfb['error']('加载角色\x20' + _0x5a68a9['id'] + _0x3d94db(0x7aa), _0x4e7955), _0x156abe[_0x3d94db(0x465)] = _0x476a69[_0x3d94db(0x71c)] || _0x47a02e) : _0x30a64e(_0x3d94db(0x8f6) + _0x1b6bcf[_0x3d94db(0x227)]); } } else { const _0xb5f726 = _0x10a12c(_0x199c66['authorId'])?.['name'] || '未知'; return '<div\x20class=\x22post-comment\x22><span\x20class=\x22comment-author\x22>' + _0xb5f726 + _0x3d94db(0x59f) + _0x4c56fe[_0x3d94db(0x317)] + _0x3d94db(0x392); } }), _0x9ce0ae(), document[_0x4ea37b(0x1f3)]('upload-badge-button')[_0x4ea37b(0x3eb)]('click', () => document[_0x4ea37b(0x1f3)](_0x4ea37b(0x329))[_0x4ea37b(0x1a4)]()), document[_0x4ea37b(0x1f3)](_0x4ea37b(0x365))[_0x4ea37b(0x3eb)](_0x4ea37b(0x1a4), async () => { const _0x47a570 = _0x4ea37b; await _0x5f3c87(_0x47a570(0x6ac)), localStorage['removeItem'](_0x47a570(0x217)), _0x9ce0ae(), _0x30a64e(_0x47a570(0x39e)); }), document['getElementById'](_0x4ea37b(0x329))[_0x4ea37b(0x3eb)]('change', async _0x59341a => { const _0x5b6ec0 = _0x4ea37b, _0x4a85b2 = _0x59341a[_0x5b6ec0(0x381)][_0x5b6ec0(0x5b7)][0x0]; if (!_0x4a85b2) return; try { _0x5b6ec0(0x50d) !== 'QuPsL' ? (await _0x43bf1f(_0x5b6ec0(0x6ac), _0x4a85b2), await _0x9ce0ae(), _0x30a64e(_0x5b6ec0(0x7c4))) : (_0x2f20df[_0x5b6ec0(0x43d)][_0x5b6ec0(0x20f)]('is-entering-from-right'), _0xed42a6[_0x5b6ec0(0x43d)][_0x5b6ec0(0x20f)](_0x5b6ec0(0x309)), _0x2c865a[_0x5b6ec0(0x43d)][_0x5b6ec0(0x20f)]('is-visible'), _0x2ea576(() => { const _0x167b5a = _0x5b6ec0; _0x480f6c[_0x167b5a(0x43d)][_0x167b5a(0x154)](_0x167b5a(0x51b), _0x167b5a(0x309)), _0x39c857[_0x167b5a(0x43d)]['remove']('is-entering-from-right'), _0x46f4ac['diaryCurrentPage'] = _0x29cb94, _0x25b4a5(), _0x50c589[_0x167b5a(0x8b8)] = ![]; }, 0x2bc)); } catch (_0x3b09cd) { _0x30a64e(_0x5b6ec0(0x8f6) + _0x3b09cd[_0x5b6ec0(0x227)]); } }), _0x1d7f67(), document[_0x4ea37b(0x1f3)](_0x4ea37b(0x419))[_0x4ea37b(0x3eb)](_0x4ea37b(0x389), _0x27f9fb), document[_0x4ea37b(0x1f3)](_0x4ea37b(0x419))[_0x4ea37b(0x3eb)]('touchstart', _0x27f9fb, { 'passive': ![] }), document[_0x4ea37b(0x1f3)](_0x4ea37b(0x6a5))[_0x4ea37b(0x3eb)](_0x4ea37b(0x1a4), () => document[_0x4ea37b(0x1f3)](_0x4ea37b(0x223))[_0x4ea37b(0x1a4)]()), document[_0x4ea37b(0x1f3)](_0x4ea37b(0x42d))['addEventListener'](_0x4ea37b(0x1a4), async () => { const _0x5a8961 = _0x4ea37b; if (_0x5a8961(0x1b6) === _0x5a8961(0x1b6)) await _0x5f3c87(_0x5a8961(0x140)), localStorage[_0x5a8961(0x847)](_0x5a8961(0x4b7)), _0x1d7f67(), _0x30a64e('卡片已移除。'); else { _0x46dde6['characters'] = _0x1a0822['characters'][_0x5a8961(0x6a6)](_0x5d3ff0 => _0x5d3ff0['id'] !== _0x47510b), _0x3c5b87['chats'][_0x5a8961(0x8f0)](_0x4942e3 => { const _0x303fd2 = _0x5a8961; _0x4942e3['type'] === _0x303fd2(0x680) && (_0x4942e3[_0x303fd2(0x285)] = _0x4942e3[_0x303fd2(0x285)][_0x303fd2(0x6a6)](_0x3f81cc => _0x3f81cc !== _0xc7a025)); }); const _0x2a0d2 = _0x312fbb['chats']['find'](_0x1a6b51 => _0x1a6b51[_0x5a8961(0x1fb)] === _0x5a8961(0x91f) && _0x1a6b51['participantIds'][_0x5a8961(0x5ad)](_0x112de2)); _0x2a0d2 && _0xb1eb6a(_0x2a0d2['id']), _0x30eabf['chats'] = _0x2988df[_0x5a8961(0x4c9)][_0x5a8961(0x6a6)](_0x4d3a7d => _0x4d3a7d[_0x5a8961(0x1fb)] !== _0x5a8961(0x680) || _0x4d3a7d[_0x5a8961(0x285)]['length'] > 0x1), _0x12950b(), _0x57e5ea(); } }), document['getElementById']('card-input')[_0x4ea37b(0x3eb)](_0x4ea37b(0x3b3), async _0x260347 => { const _0x4e1c02 = _0x4ea37b; if (_0x4e1c02(0x857) === _0x4e1c02(0x58d)) { const _0x3d8aac = _0x320630[_0x4e1c02(0x207)](_0x388bf3, 'readwrite'), _0x1704ab = _0x3d8aac['objectStore'](_0xdf3b74), _0x51ba27 = _0x1704ab[_0x4e1c02(0x8bb)](_0x4fa623); _0x51ba27['onsuccess'] = () => _0x2ff2dc(_0x51ba27['result']), _0x51ba27[_0x4e1c02(0x7d0)] = () => _0x58471a(_0x51ba27[_0x4e1c02(0x412)]); } else { const _0x5ea45d = _0x260347[_0x4e1c02(0x381)][_0x4e1c02(0x5b7)][0x0]; if (!_0x5ea45d) return; try { await _0x43bf1f('widget_card', _0x5ea45d), await _0x1d7f67(), _0x30a64e('卡片已更换！'); } catch (_0x5a3cd6) { _0x30a64e(_0x4e1c02(0x8f6) + _0x5a3cd6['message']); } } }), document[_0x4ea37b(0x1f3)](_0x4ea37b(0x562))[_0x4ea37b(0x3eb)](_0x4ea37b(0x1a4), async () => { const _0x4fffe1 = _0x4ea37b; if ('nqFhC' === _0x4fffe1(0x6e7)) _0x31a0cb = _0x2cf9b2[_0x4fffe1(0x444)][_0x4fffe1(0x843)](_0x5e13db => _0x4d16c5[_0x4fffe1(0x32e)][_0x4fffe1(0x2aa)](_0x3da478 => _0x3da478['id'] === _0x5e13db))[_0x4fffe1(0x6a6)](_0x122492)['map'](_0xdd1c47 => _0x4fffe1(0x627) + _0xdd1c47[_0x4fffe1(0x908)] + ']:\x20' + _0xdd1c47[_0x4fffe1(0x317)])['join'](''); else { const _0x1dfc00 = await _0x21bcbb(_0x4fffe1(0x77f)); _0x1dfc00 && (localStorage[_0x4fffe1(0x847)](_0x4fffe1(0x217)), localStorage['removeItem'](_0x4fffe1(0x70c)), _0x30a64e(_0x4fffe1(0x2a2)), setTimeout(() => location[_0x4fffe1(0x29b)](), 0x3e8)); } }); const _0x1c8e6f = document['getElementById'](_0x4ea37b(0x827)); _0x1c8e6f[_0x4ea37b(0x3eb)](_0x4ea37b(0x1a4), () => { const _0x483454 = _0x4ea37b; _0x57ad1e(), _0x465abb(_0x483454(0x1c8), _0x483454(0x819)); }); const _0x2e9e9f = document[_0x4ea37b(0x1f3)](_0x4ea37b(0x2b0)); _0x2e9e9f['addEventListener'](_0x4ea37b(0x1a4), () => { const _0xf7967f = _0x4ea37b; _0xf7967f(0x7d7) !== _0xf7967f(0x383) ? (_0x3cc5cc(), _0x465abb(_0xf7967f(0x717), 'home')) : _0x217438[_0xf7967f(0x2f7)] = _0xf7967f(0x236) + _0x5ef339 + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>' + _0x5f5d89[_0xf7967f(0x31c)] + _0xf7967f(0x7be) + _0x40252f['artist'] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>'; }), document[_0x4ea37b(0x1f3)]('back-to-home-from-music-library')[_0x4ea37b(0x3eb)](_0x4ea37b(0x1a4), () => _0x465abb(_0x4ea37b(0x819), _0x4ea37b(0x717))), document[_0x4ea37b(0x1f3)](_0x4ea37b(0x816))[_0x4ea37b(0x3eb)](_0x4ea37b(0x1a4), () => _0x465abb('home', 'diaryList')), document[_0x4ea37b(0x1f3)]('back-to-diary-list')[_0x4ea37b(0x3eb)](_0x4ea37b(0x1a4), () => { const _0x566e47 = _0x4ea37b; if ('zOUvA' !== _0x566e47(0x759)) _0x79fbb7[_0x566e47(0x778)] = null, _0x465abb(_0x566e47(0x1c8), 'diaryView'); else return _0x55ceb8(_0x566e47(0x42e)), ![]; }), document[_0x4ea37b(0x1f3)](_0x4ea37b(0x6bc))[_0x4ea37b(0x3eb)](_0x4ea37b(0x1a4), _0x2fedd3), document[_0x4ea37b(0x1f3)](_0x4ea37b(0x631))['addEventListener'](_0x4ea37b(0x1a4), _0x9461c8), document[_0x4ea37b(0x1f3)](_0x4ea37b(0x525))[_0x4ea37b(0x3eb)](_0x4ea37b(0x43e), _0x2cefa8 => { const _0x454d93 = _0x4ea37b; _0x2cefa8[_0x454d93(0x251)] === _0x454d93(0x786) && !_0x2cefa8[_0x454d93(0x830)] && (_0x2cefa8[_0x454d93(0x490)](), _0x2fedd3()); }); const _0x5a4e0d = [_0x4ea37b(0x4e9), _0x4ea37b(0x5b5), 'angry', _0x4ea37b(0x3b1), _0x4ea37b(0x56c)]; _0x5a4e0d[_0x4ea37b(0x8f0)](_0x33c0c3 => { const _0x4f4bb0 = _0x4ea37b; if ('BBIxC' !== 'BBIxC') return { 'url': _0x32a0b5, 'cover': _0x4f3507[_0x4f4bb0(0x876)], 'source': _0x1aa498 }; else { const _0x3ab7f9 = document[_0x4f4bb0(0x1f3)](_0x4f4bb0(0x57f) + _0x33c0c3 + '-preview'), _0x38131c = document[_0x4f4bb0(0x1f3)](_0x4f4bb0(0x57f) + _0x33c0c3 + _0x4f4bb0(0x6ef)); _0x3ab7f9 && _0x38131c && (_0x3ab7f9[_0x4f4bb0(0x3eb)](_0x4f4bb0(0x1a4), () => _0x38131c[_0x4f4bb0(0x1a4)]()), _0x38131c['addEventListener'](_0x4f4bb0(0x3b3), async _0x553cd4 => { const _0x22d7d2 = _0x4f4bb0, _0x5bdd5c = _0x553cd4['target']['files'][0x0]; if (!_0x5bdd5c) return; try { _0x22d7d2(0x887) !== _0x22d7d2(0x688) ? _0x3ab7f9[_0x22d7d2(0x465)] = URL[_0x22d7d2(0x4af)](_0x5bdd5c) : (_0x831799[_0x22d7d2(0x412)]('Failed\x20to\x20read\x20state\x20from\x20localStorage:', _0x5c261c), _0x572093(_0x22d7d2(0x2d4))); } catch (_0x5e3387) { _0x22d7d2(0x106) !== _0x22d7d2(0x106) ? _0x5574eb['error']('加载徽章图片失败', _0x593ac2) : _0x30a64e(_0x22d7d2(0x687) + _0x5e3387[_0x22d7d2(0x227)]); } })); } }), document[_0x4ea37b(0x1f3)]('galgame-textbox-container')[_0x4ea37b(0x3eb)]('click', _0x3aa6ff), document['getElementById'](_0x4ea37b(0x508))[_0x4ea37b(0x3eb)](_0x4ea37b(0x1a4), () => { const _0x4bd2e6 = _0x4ea37b; _0x79fbb7[_0x4bd2e6(0x60a)] = _0x79fbb7[_0x4bd2e6(0x60a)] === 'novel' ? 'galgame' : _0x4bd2e6(0x469), _0x187663(); }), document[_0x4ea37b(0x1f3)](_0x4ea37b(0x57c))[_0x4ea37b(0x3eb)](_0x4ea37b(0x389), _0x4eafcf), document[_0x4ea37b(0x1f3)](_0x4ea37b(0x57c))[_0x4ea37b(0x3eb)](_0x4ea37b(0x14e), _0x4eafcf, { 'passive': ![] }); let _0x180b23 = null; function _0x4eafcf(_0x265452) { const _0x4e8df9 = _0x4ea37b; if (_0x180b23) clearTimeout(_0x180b23); const _0x1c86b9 = _0x265452['target']['closest'](_0x4e8df9(0x278)); if (!_0x1c86b9) return; const _0x7744bf = parseInt(_0x1c86b9[_0x4e8df9(0x78e)]['historyIndex'], 0xa); if (isNaN(_0x7744bf)) return; const _0x77d5 = () => { _0x180b23 = setTimeout(() => { const _0x1458cc = _0x1507; if (_0x265452[_0x1458cc(0x1fb)] === _0x1458cc(0x14e)) _0x265452[_0x1458cc(0x490)](); _0x1bc9ad(_0x7744bf); }, 0x320); }, _0xcf7c14 = () => { const _0x38becc = _0x4e8df9; if (_0x38becc(0x11f) === 'kOHWL') { const _0x1ab7f3 = _0x36461b[_0x38becc(0x207)](_0x176262, 'readonly'), _0x77b2cf = _0x1ab7f3[_0x38becc(0x8a5)](_0xce03f4), _0x8cfc7e = _0x77b2cf[_0x38becc(0x272)](_0x43dd9b); _0x8cfc7e[_0x38becc(0x7eb)] = () => _0x42963c(_0x8cfc7e[_0x38becc(0x6e4)]), _0x8cfc7e[_0x38becc(0x7d0)] = () => _0x467feb(_0x8cfc7e[_0x38becc(0x412)]); } else { if (_0x180b23) clearTimeout(_0x180b23); } }; document[_0x4e8df9(0x3eb)]('mouseup', _0xcf7c14, { 'once': !![] }), document[_0x4e8df9(0x3eb)](_0x4e8df9(0x41c), _0xcf7c14, { 'once': !![] }), document[_0x4e8df9(0x3eb)](_0x4e8df9(0x718), _0xcf7c14, { 'once': !![] }), document[_0x4e8df9(0x3eb)]('touchcancel', _0xcf7c14, { 'once': !![] }), _0x77d5(); } document[_0x4ea37b(0x7f1)][_0x4ea37b(0x3eb)](_0x4ea37b(0x1a4), _0xa71cfe => { const _0x410dfd = _0x4ea37b, _0x4e6c87 = _0xa71cfe[_0x410dfd(0x381)][_0x410dfd(0x3d6)](_0x410dfd(0x868)); if (_0x4e6c87) { const _0x2777a6 = _0xa71cfe[_0x410dfd(0x381)][_0x410dfd(0x3d6)](_0x410dfd(0x4e7)), _0x4e58df = _0xa71cfe[_0x410dfd(0x381)][_0x410dfd(0x3d6)](_0x410dfd(0x581)); if (_0x2777a6) _0x57633a(); else { if (_0x4e58df) { const _0x3861eb = _0x4e58df[_0x410dfd(0x3d6)](_0x410dfd(0x77b)), _0x571d91 = _0x4e58df[_0x410dfd(0x78e)][_0x410dfd(0x7b6)], _0x14ec5c = parseInt(_0x3861eb[_0x410dfd(0x78e)][_0x410dfd(0x57d)], 0xa); _0x26f76c(_0x571d91, _0x14ec5c, _0x4e6c87); } else { const _0x3a523c = _0x3f4d37(); _0x3a523c && _0x3a523c[_0x410dfd(0x865)] && _0x3a523c[_0x410dfd(0x865)][_0x410dfd(0x91d)] && (_0x410dfd(0x37e) === _0x410dfd(0x37e) ? (_0x24d146[_0x410dfd(0x324)][_0x410dfd(0x7ab)] = _0x410dfd(0x585), setTimeout(() => _0x24d146[_0x410dfd(0x43d)][_0x410dfd(0x20f)](_0x410dfd(0x920)), 0xa)) : _0x36b870 = _0x410dfd(0x7b5) + _0x2e838c['id'] + _0x410dfd(0x18e) + (_0x761f60[_0x410dfd(0x1d1)] || _0x14bea0) + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-song-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>' + _0x3fbd07[_0x410dfd(0x31c)] + _0x410dfd(0x378) + _0x2febb0[_0x410dfd(0x160)] + _0x410dfd(0x316) + (_0x4e17b0[_0x410dfd(0x8b7)] ? '▶' : '⚠') + _0x410dfd(0x10e)); } } return; } if (window['getSelection']()[_0x410dfd(0x571)]()) return; const _0x43c944 = _0xa71cfe['target']['closest']('.message-container'); if (_0x43c944 && !_0xa71cfe['target'][_0x410dfd(0x3d6)](_0x410dfd(0x399))) { const _0x519203 = parseInt(_0x43c944[_0x410dfd(0x78e)][_0x410dfd(0x57d)], 0xa); !isNaN(_0x519203) && _0x1bc9ad(_0x519203); } }); const _0x5a6c7c = document[_0x4ea37b(0x1f3)](_0x4ea37b(0x2ed)); _0x5a6c7c && _0x5a6c7c['addEventListener']('click', () => { const _0x25fe20 = _0x4ea37b; if ('UngzW' !== _0x25fe20(0x2df)) _0x30a64e('核心代码-Noir\x0a\x0a\x20监工-小红书ID：糯糯糯糯五\x0a\x0a'); else { let _0x5688c2 = _0x523f78[_0x25fe20(0x1f3)](_0x25fe20(0x3cd) + _0xfd9d35['id']); !_0x5688c2 && (_0x5688c2 = _0x1e4fe7[_0x25fe20(0x4f8)](_0x25fe20(0x324)), _0x5688c2['id'] = _0x25fe20(0x3cd) + _0x1733c3['id'], _0x418751[_0x25fe20(0x58a)]['appendChild'](_0x5688c2)); const _0x594d25 = _0x5699d9[_0x25fe20(0x23f)], _0x21861b = _0x594d25['replace'](/\.bubble\.sent/g, _0x25fe20(0x177) + _0x3f9428['id'] + _0x25fe20(0x85a))[_0x25fe20(0x1c3)](/\.bubble\.received/g, _0x25fe20(0x177) + _0x57a597['id'] + _0x25fe20(0x92f)); _0x5688c2[_0x25fe20(0x2f7)] = _0x21861b; } }); const _0x15b551 = document[_0x4ea37b(0x1f3)]('custom-stickers-input'), _0x677e2 = localStorage['getItem'](_0x4ea37b(0x39a)); if (_0x677e2) try { const _0x891cf7 = JSON[_0x4ea37b(0x4f6)](_0x677e2); Array[_0x4ea37b(0x660)](_0x891cf7) && (_0x15b551['value'] = _0x891cf7[_0x4ea37b(0x843)](_0x925e8 => _0x925e8[_0x4ea37b(0x908)] + '--' + _0x925e8[_0x4ea37b(0x30d)])[_0x4ea37b(0x26c)]('\x0a')); } catch (_0x184b83) { } document[_0x4ea37b(0x1f3)](_0x4ea37b(0x48f))[_0x4ea37b(0x3eb)](_0x4ea37b(0x1a4), () => { const _0x1bade9 = _0x4ea37b; if (_0x1bade9(0x314) === _0x1bade9(0x375)) { _0x3c46e1[_0x1bade9(0x2f7)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>圣殿空空如也，点击右上角“+”献上你的第一首歌吧。</p>'; return; } else { const _0x2ba9f4 = _0x15b551[_0x1bade9(0x2ff)], _0x3092b3 = _0x2ba9f4[_0x1bade9(0x1ae)]('\x0a')[_0x1bade9(0x6a6)](_0x8b5478 => _0x8b5478['trim']() !== ''), _0x5a12c2 = []; let _0x13ba36 = 0x0; for (const _0x197f7e of _0x3092b3) { if (_0x1bade9(0x4aa) !== _0x1bade9(0x127)) { const _0x101cea = _0x197f7e['split']('--'); _0x101cea[_0x1bade9(0x629)] === 0x2 && _0x101cea[0x0]['trim']() && _0x101cea[0x1][_0x1bade9(0x538)]()[_0x1bade9(0x55c)]('http') ? _0x1bade9(0x248) !== _0x1bade9(0x248) ? (_0x482d49(![]), _0x192d01['isGenerating'] = ![]) : _0x5a12c2[_0x1bade9(0x7d8)]({ 'name': _0x101cea[0x0][_0x1bade9(0x538)](), 'url': _0x101cea[0x1][_0x1bade9(0x538)]() }) : _0x1bade9(0x70b) === _0x1bade9(0x2a9) ? (_0x4d7fee(), _0x40840e(!![])) : _0x13ba36++; } else _0x42774d = _0x22934b[_0x1bade9(0x908)], _0x22e14d = _0x2775e7[_0x1bade9(0x71c)]; } _0x13ba36 > 0x0 && _0x30a64e('有\x20' + _0x13ba36 + '\x20行格式不对，被我无视了。'); try { if ('YEMik' !== _0x1bade9(0x353)) localStorage[_0x1bade9(0x54a)](_0x1bade9(0x39a), JSON['stringify'](_0x5a12c2)), _0x30a64e(_0x1bade9(0x8c4)), setTimeout(() => location[_0x1bade9(0x29b)](), 0x5dc); else { const _0x1260c0 = _0x17a1a6(_0x168631[_0x1bade9(0x78e)]['historyIndex'], 0xa); !_0x20891b(_0x1260c0) && _0x5a2454(_0x1260c0); } } catch (_0xc891fd) { _0x30a64e(_0x1bade9(0x57a)); } } }), _0x29a4d5(), document[_0x4ea37b(0x1f3)](_0x4ea37b(0x7df))[_0x4ea37b(0x3eb)](_0x4ea37b(0x1a4), () => { const _0x309b82 = _0x4ea37b; document[_0x309b82(0x1f3)](_0x309b82(0x55e))[_0x309b82(0x1a4)](); }), document['getElementById'](_0x4ea37b(0x205))['addEventListener'](_0x4ea37b(0x1a4), async () => { const _0x5f1b7d = _0x4ea37b; if (_0x5f1b7d(0x851) === 'EHEEL') await _0x5f3c87('widget_card_2'), localStorage['removeItem']('cardState2'), _0x1d7f67(), _0x30a64e('卡片\x202\x20已移除。'); else { const _0x2ad108 = _0x568922[_0x5f1b7d(0x4f8)]('li'); _0x2ad108['className'] = 'character-item', _0x2ad108[_0x5f1b7d(0x78e)][_0x5f1b7d(0x552)] = _0x5122df['id'], _0x2ad108[_0x5f1b7d(0x2f7)] = _0x5f1b7d(0x174) + (_0x2d17eb['avatar'] || _0x4b8194) + _0x5f1b7d(0x773) + _0x355ebb['name'] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>翻开日记本...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22toolbar-button\x20diary-delete-btn\x22\x20title=\x22清空这本日记\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline><path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path><line\x20x1=\x2210\x22\x20y1=\x2211\x22\x20x2=\x2210\x22\x20y2=\x2217\x22></line><line\x20x1=\x2214\x22\x20y1=\x2211\x22\x20x2=\x2214\x22\x20y2=\x2217\x22></line></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x2ad108[_0x5f1b7d(0x3eb)](_0x5f1b7d(0x1a4), () => { _0x1ba5ae(_0x56f7af['id']); }), _0x2ad108[_0x5f1b7d(0x249)]('.char-info-wrapper')[_0x5f1b7d(0x3eb)]('click', () => { _0x5b2425(_0x14bf83['id']); }), _0x2ad108[_0x5f1b7d(0x249)]('.diary-delete-btn')[_0x5f1b7d(0x3eb)]('click', _0x441d1b => { _0x441d1b['stopPropagation'](), _0x3b7d50(_0xb05b6a['id']); }), _0x49bd0a['appendChild'](_0x2ad108); } }), document[_0x4ea37b(0x1f3)](_0x4ea37b(0x55e))[_0x4ea37b(0x3eb)](_0x4ea37b(0x3b3), async _0x1f6ca8 => { const _0x3b1b41 = _0x4ea37b; if ('CycVq' === _0x3b1b41(0x3e5)) _0x3c0b50['error'](_0x3b1b41(0x719), _0x144a0c); else { const _0x5b0084 = _0x1f6ca8[_0x3b1b41(0x381)][_0x3b1b41(0x5b7)][0x0]; if (!_0x5b0084) return; try { _0x3b1b41(0x6b0) !== _0x3b1b41(0x6b0) ? (_0xddde69 = _0x3d5a93['createElement'](_0x3b1b41(0x8dc)), _0xb04442['className'] = _0x3b1b41(0x4d5), _0x4fcf4d[_0x3b1b41(0x5f4)] = _0x3b1b41(0x7cd), _0xdc9dbc[_0x3b1b41(0x7b9)](_0x574d9b)) : (await _0x43bf1f(_0x3b1b41(0x3f0), _0x5b0084), await _0x1d7f67(), _0x30a64e('卡片\x202\x20已更换！')); } catch (_0x565158) { if (_0x3b1b41(0x2e4) !== _0x3b1b41(0x82e)) _0x30a64e('错误:\x20' + _0x565158['message']); else { if (_0x1658bd['role'] === 'user') return _0x1f9fc2[_0x3b1b41(0x1ab)]?.[_0x3b1b41(0x908)] || _0x3b1b41(0x835); if (_0x41e205[_0x3b1b41(0x14b)]) { const _0x1644f9 = _0x5063c0(_0x19e0fd[_0x3b1b41(0x14b)]); return _0x1644f9?.[_0x3b1b41(0x908)] || _0x3b1b41(0x36b); } if (_0x69311d?.[_0x3b1b41(0x1fb)] === _0x3b1b41(0x91f)) { const _0x20de19 = _0x1e51e6(_0x2605bd['participantIds'][0x0]); return _0x20de19?.[_0x3b1b41(0x908)] || 'AI'; } return _0x3b1b41(0x891); } } } }); } const _0x5e5a3b = new Promise((_0x1c8673, _0x25479a) => { const _0xf764be = _0x2b3d5e, _0x489617 = indexedDB[_0xf764be(0x704)](_0x18494a, 0x2); _0x489617[_0xf764be(0x7d0)] = () => _0x25479a(_0xf764be(0x1a6)), _0x489617[_0xf764be(0x7eb)] = () => _0x1c8673(_0x489617[_0xf764be(0x6e4)]); }), _0x45e9d1 = _0x2b3d5e(0x6ec); async function _0x2665e7(_0x117867) { const _0x2da945 = await _0x5e5a3b; return new Promise((_0x324df9, _0x103135) => { const _0x4b0e87 = _0x1507, _0x2d1750 = _0x2da945['transaction'](_0x45e9d1, 'readonly'), _0x2f3c04 = _0x2d1750[_0x4b0e87(0x8a5)](_0x45e9d1), _0xc3eac2 = _0x2f3c04[_0x4b0e87(0x272)](_0x117867); _0xc3eac2[_0x4b0e87(0x7eb)] = () => _0x324df9(_0xc3eac2[_0x4b0e87(0x6e4)]), _0xc3eac2['onerror'] = () => _0x103135(_0xc3eac2[_0x4b0e87(0x412)]); }); } async function _0x4389ae() { const _0x34f913 = _0x2b3d5e; if (_0x34f913(0x3c3) === _0x34f913(0x588)) { const _0x577bb1 = _0x4f3e83[_0x34f913(0x1f3)](_0x34f913(0x85c)); if (!_0x577bb1) return; _0x4ae2a2[_0x34f913(0x11a)][_0x34f913(0x14a)] ? (_0x577bb1[_0x34f913(0x324)]['color'] = _0x34f913(0x878), _0x577bb1[_0x34f913(0x324)][_0x34f913(0x13c)] = '0\x202px\x208px\x20rgba(0,0,0,0.4)') : (_0x577bb1['style'][_0x34f913(0x6c0)] = _0x34f913(0x3f2), _0x577bb1[_0x34f913(0x324)][_0x34f913(0x13c)] = _0x34f913(0x277)); } else { const _0x18722a = await _0x5e5a3b; return new Promise((_0x489a34, _0x2771c0) => { const _0x4318b7 = _0x34f913, _0x256e43 = _0x18722a['transaction'](_0x45e9d1, _0x4318b7(0x724)), _0x17dc34 = _0x256e43[_0x4318b7(0x8a5)](_0x45e9d1), _0x532b86 = _0x17dc34['getAll'](); _0x532b86[_0x4318b7(0x7eb)] = () => _0x489a34(_0x532b86['result']), _0x532b86[_0x4318b7(0x7d0)] = () => _0x2771c0(_0x532b86['error']); }); } } async function _0x40ef7a(_0x84776e) { const _0x1537e7 = await _0x5e5a3b; return new Promise((_0x1660a8, _0x346339) => { const _0x3b8aaf = _0x1507; if (_0x3b8aaf(0x662) === 'KVMVN') { const _0x415171 = _0x1537e7[_0x3b8aaf(0x207)](_0x45e9d1, _0x3b8aaf(0x6b1)), _0x164f99 = _0x415171[_0x3b8aaf(0x8a5)](_0x45e9d1), _0x380552 = _0x164f99[_0x3b8aaf(0x8bb)](_0x84776e); _0x380552[_0x3b8aaf(0x7eb)] = () => _0x1660a8(_0x380552['result']), _0x380552['onerror'] = () => _0x346339(_0x380552[_0x3b8aaf(0x412)]); } else _0x2ea77c(), _0x524bf0(![]); }); } async function _0x31a273(_0x18e952) { const _0x3c139a = await _0x5e5a3b; return new Promise((_0x3a1217, _0x35fb06) => { const _0x56f068 = _0x1507, _0x3c39d7 = _0x3c139a[_0x56f068(0x207)](_0x45e9d1, _0x56f068(0x6b1)), _0x2f76c2 = _0x3c39d7['objectStore'](_0x45e9d1), _0x56b425 = _0x2f76c2['delete'](_0x18e952); _0x56b425[_0x56f068(0x7eb)] = () => _0x3a1217(), _0x56b425[_0x56f068(0x7d0)] = () => _0x35fb06(_0x56b425['error']); }); } let _0x30edfc = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; const _0x104dec = { 'audio': document[_0x2b3d5e(0x1f3)]('altar-slot-audio'), 'cover': document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x55d)), 'info': document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x1d3)), 'lyrics': document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x10d)) }, _0x2a7e2b = { 'audio': document['getElementById'](_0x2b3d5e(0x2c0)), 'cover': document[_0x2b3d5e(0x1f3)]('cover-file-input'), 'info': document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x113)), 'lyrics': document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x49f)) }; for (const _0x490438 in _0x104dec) { _0x104dec[_0x490438][_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => _0x2a7e2b[_0x490438][_0x2b3d5e(0x1a4)]()), _0x2a7e2b[_0x490438][_0x2b3d5e(0x3eb)](_0x2b3d5e(0x3b3), _0x4be2c3 => { const _0x5e5846 = _0x2b3d5e; _0x7d9147(_0x490438, _0x4be2c3[_0x5e5846(0x381)][_0x5e5846(0x5b7)][0x0]); }); } function _0x7d9147(_0x77246f, _0x32f069) { const _0x4c2ac8 = _0x2b3d5e; if (!_0x32f069) return; _0x30edfc[_0x77246f] = _0x32f069, _0x104dec[_0x77246f][_0x4c2ac8(0x249)](_0x4c2ac8(0x902))[_0x4c2ac8(0x5f4)] = _0x32f069[_0x4c2ac8(0x908)], _0x104dec[_0x77246f][_0x4c2ac8(0x43d)][_0x4c2ac8(0x20f)](_0x4c2ac8(0x2bb)), _0x103c74(); } function _0x103c74() { const _0x416a23 = _0x2b3d5e, _0x47489e = document[_0x416a23(0x1f3)]('confirm-altar-upload-button'); _0x30edfc[_0x416a23(0x121)] && _0x30edfc[_0x416a23(0xfb)] ? _0x47489e[_0x416a23(0x899)] = ![] : _0x47489e['disabled'] = !![]; } function _0x4555ff() { const _0x346f77 = _0x2b3d5e; _0x30edfc = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; for (const _0x4098ce in _0x104dec) { _0x104dec[_0x4098ce]['classList']['remove']('filled'), _0x2a7e2b[_0x4098ce][_0x346f77(0x2ff)] = ''; } _0x104dec[_0x346f77(0x121)][_0x346f77(0x249)](_0x346f77(0x902))[_0x346f77(0x5f4)] = '点击选择\x20.mp3\x20或\x20.flac', _0x104dec[_0x346f77(0x876)][_0x346f77(0x249)](_0x346f77(0x902))[_0x346f77(0x5f4)] = _0x346f77(0x7e1), _0x104dec['info'][_0x346f77(0x249)]('.slot-filename')['textContent'] = '点击选择\x20info.txt', _0x104dec[_0x346f77(0x745)][_0x346f77(0x249)](_0x346f77(0x902))['textContent'] = _0x346f77(0x19e), _0x103c74(); } document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x274))[_0x2b3d5e(0x3eb)]('click', async () => { const _0x483c32 = _0x2b3d5e; if (_0x483c32(0x4d0) === 'CVuEf') { if (!_0x30edfc[_0x483c32(0x121)] || !_0x30edfc[_0x483c32(0xfb)]) { _0x30a64e(_0x483c32(0x579)); return; } await _0x3d1e24(); } else _0x134258['style']['display'] = _0x483c32(0x585), _0x9a3f17(() => _0x48543f[_0x483c32(0x43d)][_0x483c32(0x20f)]('show'), 0xa); }), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x477))[_0x2b3d5e(0x3eb)]('click', () => { const _0x218e20 = _0x2b3d5e; if (_0x218e20(0x8e0) !== _0x218e20(0x4c1)) _0x4555ff(), _0x465abb(_0x218e20(0x567), _0x218e20(0x717)); else { const _0x3b6e90 = _0x1adcbc[_0x218e20(0x7b3)] === 'user' ? _0x218e20(0x721) : 'ai', _0x477e50 = _0x22a731[_0x218e20(0x7b3)] === _0x218e20(0x721) ? _0x3a6cf9[_0x218e20(0x908)] : _0x1c8a12(_0x2c3dc7['author'])[_0x218e20(0x908)], _0x5bd5f1 = _0x246fb8[_0x218e20(0x4f8)]('div'); _0x5bd5f1[_0x218e20(0x1dc)] = 'diary-entry\x20' + _0x3b6e90, _0x5bd5f1['dataset'][_0x218e20(0x68c)] = _0x10869b[_0x218e20(0x68c)], _0x5bd5f1[_0x218e20(0x324)][_0x218e20(0x12b)] = 'none', _0x5bd5f1[_0x218e20(0x324)][_0x218e20(0x4fd)] = '0', _0x5bd5f1[_0x218e20(0x2f7)] = _0x218e20(0x87d) + _0x477e50 + _0x218e20(0x67c) + new _0x1cbf23(_0x2a1bfb['timestamp'])['toLocaleString']('zh-CN') + _0x218e20(0x3ab) + _0x5f03b4[_0x218e20(0x317)]['replace'](/\n/g, _0x218e20(0x2a5)) + _0x218e20(0x1ad), _0x5dca2d[_0x218e20(0x7b9)](_0x5bd5f1); } }), document[_0x2b3d5e(0x1f3)](_0x2b3d5e(0x424))['addEventListener']('click', () => { const _0x1e7003 = _0x2b3d5e; _0x465abb(_0x1e7003(0x717), _0x1e7003(0x567)); }); async function _0x3d1e24() { const _0x30f751 = _0x2b3d5e; if (_0x30f751(0x4b5) !== _0x30f751(0x5af)) { _0x585d0a(!![], _0x30f751(0x601)); try { if (_0x30f751(0x2e2) === 'RhadZ') { const _0xf0c460 = await _0x30edfc[_0x30f751(0xfb)]['text'](); let _0x47575c; if (_0xf0c460[_0x30f751(0x538)]()['startsWith']('{')) _0x47575c = JSON[_0x30f751(0x4f6)](_0xf0c460); else { if ('vwGbp' === _0x30f751(0x1ac)) _0x4bab7a(_0x30f751(0x8f6) + _0x42eeee[_0x30f751(0x227)]); else { _0x47575c = {}; const _0x403e8d = _0xf0c460['split']('\x0a'); _0x403e8d[_0x30f751(0x8f0)](_0x29c81c => { const _0x45df2f = _0x30f751; if ('RZRQy' === _0x45df2f(0x52b)) { _0x3a960d = ![], _0x49e80a[_0x45df2f(0x324)][_0x45df2f(0x7ab)] = _0x45df2f(0x277), _0x15a38f['getElementById'](_0x45df2f(0x6e8))[_0x45df2f(0x324)][_0x45df2f(0x7ab)] = 'block', _0x971e52[_0x45df2f(0x1f3)]('galgame-sprite-adjust-ui')[_0x45df2f(0x324)][_0x45df2f(0x7ab)] = _0x45df2f(0x53e); if (!_0x3aefe2) { const _0x37772c = _0x4863a6(_0x40a3ad[_0x45df2f(0x112)]); _0x37772c && (_0x37772c[_0x45df2f(0x320)] = _0x14742b, _0x3915e8(_0x1ee27e[_0x45df2f(0x112)], _0x45df2f(0x4e9))); } } else { const _0x2d3d7f = _0x29c81c[_0x45df2f(0x1ae)](/:\s|：\s/); if (_0x2d3d7f[_0x45df2f(0x629)] === 0x2) { const _0x5daf09 = _0x2d3d7f[0x0][_0x45df2f(0x538)](), _0x465f04 = _0x2d3d7f[0x1][_0x45df2f(0x538)](), _0x2a6c52 = { '歌名': '歌曲名称', '艺术家': '歌手', '专辑': '专辑' }; _0x2a6c52[_0x5daf09] && (_0x47575c[_0x2a6c52[_0x5daf09]] = _0x465f04); } } }); if (!_0x47575c[_0x30f751(0x398)]) throw new Error(_0x30f751(0x60c)); _0x47575c[_0x30f751(0x53c)] = 'song_' + Date[_0x30f751(0x86b)](); } } const _0x54d2fb = _0x30f751(0x1dd) + (_0x47575c[_0x30f751(0x53c)] || Date[_0x30f751(0x86b)]()), _0xd6f40b = { 'id': _0x54d2fb, 'info': _0x47575c, 'audio': _0x30edfc['audio'], 'cover': _0x30edfc['cover'], 'lyrics': _0x30edfc[_0x30f751(0x745)] ? await _0x30edfc[_0x30f751(0x745)][_0x30f751(0x6b3)]() : '' }; await _0x40ef7a(_0xd6f40b), await _0x3cc5cc(), _0x585d0a(![]), _0x30a64e(_0x30f751(0x7ea) + _0x47575c[_0x30f751(0x398)] + _0x30f751(0x510)), _0x465abb('musicLibrary', _0x30f751(0x567)); } else { const _0x57226f = _0x30f751(0x422); _0xa27d63 = _0x30f751(0x88c) + _0x36ba1d['name'] + _0x30f751(0x62b) + _0x57226f + ']中选择的情绪标签\x22,\x0a\x20\x20\x20\x20\x22line\x22:\x20\x22台词或旁白内容\x22\x0a\x20\x20\x20\x20}\x0a\x20\x20\x0a\x20\x20-\x20**规则**:\x0a\x20\x20\x20\x201.\x20\x20`speaker`字段：如果是角色说话，就用角色名“' + _0xd2c862['name'] + _0x30f751(0x3ad) + _0x57226f + ']\x20这五个词中选择一个。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。2.\x20\x20`emotion`字段：**必须**根据台词的【核心情感】，精准地从\x20[' + _0x57226f + _0x30f751(0x5e7); } } catch (_0x58cf69) { _0x585d0a(![]), console[_0x30f751(0x412)](_0x30f751(0x481), _0x58cf69), _0x30a64e(_0x30f751(0x33f) + _0x58cf69['message']); } } else _0x2f4172[_0x30f751(0x465)] && (_0x145d8e[_0x30f751(0x694)] ? _0x2f8e05[_0x30f751(0x7e9)]() : _0x4a1778['pause']()); } async function _0x3cc5cc() { const _0x370d30 = _0x2b3d5e; if (_0x370d30(0x126) === 'pXcZz') _0x326a30(![]); else { const _0xde9e7c = document[_0x370d30(0x1f3)](_0x370d30(0x54b)); _0xde9e7c['innerHTML'] = ''; const _0x46024b = await _0x4389ae(); if (_0x46024b[_0x370d30(0x629)] === 0x0) { _0xde9e7c[_0x370d30(0x2f7)] = _0x370d30(0x38c); return; } _0x46024b[_0x370d30(0x2c1)]((_0x3c76d1, _0x10da76) => (_0x3c76d1[_0x370d30(0xfb)][_0x370d30(0x398)] || '')[_0x370d30(0x91c)](_0x10da76['info'][_0x370d30(0x398)] || '')); for (const _0xe73186 of _0x46024b) { const _0x557558 = document[_0x370d30(0x4f8)]('div'); _0x557558[_0x370d30(0x1dc)] = _0x370d30(0x895), _0x557558[_0x370d30(0x78e)]['songId'] = _0xe73186['id']; const _0x28b4e6 = _0xe73186[_0x370d30(0x876)] ? URL[_0x370d30(0x4af)](_0xe73186[_0x370d30(0x876)]) : _0x426b80; _0x557558[_0x370d30(0x2f7)] = _0x370d30(0x37c) + _0x28b4e6 + '\x22\x20class=\x22music-library-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-title\x22>' + (_0xe73186[_0x370d30(0xfb)][_0x370d30(0x398)] || _0x370d30(0x7fb)) + _0x370d30(0x8a1) + (_0xe73186[_0x370d30(0xfb)]['歌手'] || _0x370d30(0x7c7)) + _0x370d30(0x81b); let _0x32d79b = null; const _0x4252fd = _0x269883 => { const _0x5d3942 = _0x370d30; if (_0x269883[_0x5d3942(0x189)] === 0x2) return; _0x32d79b = setTimeout(async () => { const _0x335946 = _0x5d3942; if (_0x335946(0x3e4) !== 'NEcfo') { if (_0x269883[_0x335946(0x1fb)] === _0x335946(0x14e)) _0x269883[_0x335946(0x490)](); const _0x5b64f0 = await _0x21bcbb('确定要从圣殿中永久删除《' + _0xe73186[_0x335946(0xfb)][_0x335946(0x398)] + _0x335946(0x59a)); if (_0x5b64f0) { if (_0x335946(0x3f1) === _0x335946(0x8ab)) { const _0x49a59f = _0x11f4d3[_0x335946(0x32e)][_0x335946(0x2aa)](_0x1fb214 => _0x1fb214['id'] === _0x100dba); if (!_0x49a59f) return; _0x3386c5[_0x335946(0x1f3)](_0x335946(0x893))[_0x335946(0x2ff)] = _0x49a59f['id'], _0x4d1975[_0x335946(0x1f3)]('world-book-editor-title')[_0x335946(0x5f4)] = _0x335946(0x505), _0x2a8f5f['getElementById']('world-book-edit-name')[_0x335946(0x2ff)] = _0x49a59f[_0x335946(0x908)], _0x4b36a1[_0x335946(0x1f3)]('world-book-edit-content')['value'] = _0x49a59f[_0x335946(0x317)]; } else await _0x31a273(_0xe73186['id']), await _0x3cc5cc(), _0x30a64e(_0x335946(0x2bf)); } } else _0x4bbfa7[_0x335946(0x5f4)] = '▶'; }, 0x320); }, _0x4de484 = () => { const _0x11fcb9 = _0x370d30; if (_0x11fcb9(0x797) === 'UBtXX') clearTimeout(_0x32d79b); else { if (typeof _0x3ba324 === _0x11fcb9(0x873)) _0x5d127d['push'](_0x428fb0); } }; _0x557558['addEventListener'](_0x370d30(0x389), _0x4252fd), _0x557558['addEventListener'](_0x370d30(0x58c), _0x4de484), _0x557558[_0x370d30(0x3eb)]('mouseleave', _0x4de484), _0x557558[_0x370d30(0x3eb)]('touchstart', _0x4252fd, { 'passive': ![] }), _0x557558[_0x370d30(0x3eb)](_0x370d30(0x718), _0x4de484), _0x557558['addEventListener'](_0x370d30(0x2b8), _0x4de484), _0x557558[_0x370d30(0x3eb)](_0x370d30(0x1a4), _0x691efd => { const _0x1f1b2c = _0x370d30; if (_0x32d79b) clearTimeout(_0x32d79b); if (_0x691efd[_0x1f1b2c(0x27e)]) return; setTimeout(() => { const _0x47fa0b = _0x1f1b2c; _0x32d79b && (_0x47fa0b(0x7e7) === _0x47fa0b(0x80d) ? _0x6836eb[_0x47fa0b(0x5f4)] = _0x47fa0b(0x234) + _0x2cf5e5[_0x47fa0b(0x629)] + '\x20项' : _0x3816be(_0xe73186['id'], _0x46024b[_0x47fa0b(0x843)](_0x309431 => _0x309431['id']))); }, 0x32); }), _0xde9e7c[_0x370d30(0x7b9)](_0x557558); } } } _0x51059c[_0x2b3d5e(0x3eb)]('click', () => { const _0x2ff9fa = _0x2b3d5e; if (_0x2ff9fa(0x4d2) !== _0x2ff9fa(0x4d2)) { const _0x350734 = _0x4dd3c7(_0x2440bd); if (!_0x350734) return; _0x7774b3[_0x2ff9fa(0x778)] = _0x1c7884; const _0x530a17 = _0x1f4e2e[_0x2ff9fa(0x84d)][_0x2ff9fa(0x2aa)](_0x77cfce => _0x77cfce[_0x2ff9fa(0x350)] === _0x2e4d42), _0x504f75 = _0x530a17 ? _0x530a17['entries'][_0x2ff9fa(0x629)] : 0x0, _0x2b97da = 0x2; _0xe57408[_0x2ff9fa(0x800)] = _0x4f9f2['max'](0x0, _0xdc58ba[_0x2ff9fa(0x40f)](_0x504f75 / _0x2b97da) - 0x1), _0x418017['getElementById'](_0x2ff9fa(0x7cf))[_0x2ff9fa(0x5f4)] = _0x350734[_0x2ff9fa(0x908)] + _0x2ff9fa(0x77a), _0x47a520(), _0x15c4ce(_0x2ff9fa(0x134), _0x2ff9fa(0x1c8)); } else _0x30a64e(_0x2ff9fa(0x559)); }), _0x5045ed[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0xb728b4 = _0x2b3d5e; _0x30a64e(_0xb728b4(0x822)); }); let _0x37e830 = [], _0x8c8774 = -0x1; async function _0x3816be(_0x26eb23, _0x281fd3) { const _0x57fc67 = _0x2b3d5e, _0x47270 = await _0x2665e7(_0x26eb23); if (!_0x47270) return; _0x4d3825 = { 'title': _0x47270[_0x57fc67(0xfb)][_0x57fc67(0x398)] || _0x57fc67(0x7fb), 'artist': _0x47270[_0x57fc67(0xfb)]['歌手'] || _0x57fc67(0x7c7), 'cover': _0x47270['cover'] ? URL[_0x57fc67(0x4af)](_0x47270[_0x57fc67(0x876)]) : _0x426b80, 'isFromLibrary': !![] }; const _0x3324ff = URL['createObjectURL'](_0x47270[_0x57fc67(0x121)]); _0x10c451[_0x57fc67(0x465)] = _0x3324ff, _0x10c451[_0x57fc67(0x7e9)](), _0x4bdbb1(); } async function _0x4bdbb1() { const _0x36b26d = _0x2b3d5e; if (_0x36b26d(0x6c4) !== 'wMmuk') return { 'type': _0x36b26d(0x6fe), 'songName': _0x3a9063[0x1][_0x36b26d(0x538)](), 'artist': _0x1eb4f0[0x2][_0x36b26d(0x538)]() }; else { const _0x1a05dd = document[_0x36b26d(0x1f3)](_0x36b26d(0x5f9)), _0x5bd8f3 = document[_0x36b26d(0x1f3)]('widget-title'), _0x49c975 = document[_0x36b26d(0x1f3)](_0x36b26d(0x2b7)), _0x26e49e = document[_0x36b26d(0x1f3)]('widget-cover-art'), _0x3a24f8 = _0x4d3825; _0x3a24f8 && _0x3a24f8[_0x36b26d(0x6c5)] ? (_0x5bd8f3[_0x36b26d(0x5f4)] = _0x3a24f8[_0x36b26d(0x453)], _0x49c975[_0x36b26d(0x5f4)] = _0x3a24f8[_0x36b26d(0x160)], _0x1a05dd[_0x36b26d(0x43d)][_0x36b26d(0x20f)](_0x36b26d(0x919)), _0x1a05dd[_0x36b26d(0x324)][_0x36b26d(0x79d)](_0x36b26d(0x3a0), _0x36b26d(0x8ce) + _0x3a24f8['cover'] + ')')) : (_0x5bd8f3[_0x36b26d(0x5f4)] = '暂无音乐', _0x49c975['textContent'] = _0x36b26d(0x105), _0x1a05dd[_0x36b26d(0x43d)][_0x36b26d(0x154)](_0x36b26d(0x919)), _0x26e49e[_0x36b26d(0x324)]['setProperty'](_0x36b26d(0x3a0), _0x36b26d(0x277))); } } _0x51059c && _0x51059c[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0x5add81 = _0x2b3d5e; if (_0x37e830[_0x5add81(0x629)] === 0x0) return; _0x8c8774 = (_0x8c8774 + 0x1) % _0x37e830[_0x5add81(0x629)], _0x3816be(_0x37e830[_0x8c8774], _0x37e830); }); _0x5045ed && (_0x2b3d5e(0x327) !== 'DTczo' ? _0x5045ed[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x1a4), () => { const _0x5490a0 = _0x2b3d5e; if (_0x5490a0(0x290) !== 'eYiJg') { if (_0x37e830['length'] === 0x0) return; _0x8c8774 = (_0x8c8774 - 0x1 + _0x37e830[_0x5490a0(0x629)]) % _0x37e830[_0x5490a0(0x629)], _0x3816be(_0x37e830[_0x8c8774], _0x37e830); } else _0x399606[_0x5490a0(0x285)]['forEach'](_0x27845c => { const _0x533124 = _0x5490a0, _0x317916 = _0x2d2e32(_0x27845c); if (_0x317916) { const _0x4fa90f = _0x5491dc[_0x533124(0x4f8)](_0x533124(0x7bd)); _0x4fa90f[_0x533124(0x2ff)] = _0x317916['id'], _0x4fa90f[_0x533124(0x5f4)] = _0x317916['name'], _0xe2692a['appendChild'](_0x4fa90f); } }), _0x52c7e8[_0x5490a0(0x324)][_0x5490a0(0x7ab)] = _0x5490a0(0x53e); }) : (_0x3b142f[_0x2b3d5e(0x465)] = _0x34f79a[_0x2b3d5e(0x4af)](_0x393181), _0x42442e[_0x2b3d5e(0x324)]['opacity'] = 0x1)); _0x10c451[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x7e9), () => { const _0x169640 = _0x2b3d5e; if (_0x5c1057) _0x5c1057[_0x169640(0x5f4)] = '❚❚'; }), _0x10c451[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x755), () => { if (_0x5c1057) _0x5c1057['textContent'] = '▶'; }), _0x10c451[_0x2b3d5e(0x3eb)](_0x2b3d5e(0x8d1), () => { if (_0x51059c) _0x51059c['click'](); }); function _0x3d44ca() { const _0x21e9a7 = _0x2b3d5e, _0x1c4c9c = _0x3f4d37(); if (!_0x1c4c9c) return; _0x1f36dc[_0x21e9a7(0x2f7)] = '', _0xfe89a2[_0x21e9a7(0x2ff)] = '', _0x1c4c9c[_0x21e9a7(0x1fb)] === _0x21e9a7(0x680) ? (_0x1c4c9c['participantIds'][_0x21e9a7(0x8f0)](_0x1d04e4 => { const _0x3308ea = _0x21e9a7, _0x5e20e9 = _0x1249c2(_0x1d04e4); if (_0x5e20e9) { if (_0x3308ea(0x824) === 'Njrgq') _0x573c56[_0x3308ea(0x7d8)](_0x3a6980[_0x4a593c][_0x3308ea(0x538)]()), _0x5a825d++; else { const _0x371e3c = document['createElement'](_0x3308ea(0x7bd)); _0x371e3c['value'] = _0x5e20e9['id'], _0x371e3c[_0x3308ea(0x5f4)] = _0x5e20e9[_0x3308ea(0x908)], _0x1f36dc[_0x3308ea(0x7b9)](_0x371e3c); } } }), _0x301768[_0x21e9a7(0x324)][_0x21e9a7(0x7ab)] = 'block') : _0x301768[_0x21e9a7(0x324)][_0x21e9a7(0x7ab)] = _0x21e9a7(0x277), _0x522dc5[_0x21e9a7(0x43d)][_0x21e9a7(0x20f)](_0x21e9a7(0x920)), _0xfe89a2[_0x21e9a7(0x507)](); } function _0x437b04() { const _0x1380fd = _0x2b3d5e, _0x9ca58f = parseFloat(_0xfe89a2[_0x1380fd(0x2ff)]); if (isNaN(_0x9ca58f) || _0x9ca58f <= 0x0) { _0x30a64e(_0x1380fd(0x8d0)); return; } const _0x2a49a4 = _0x3f4d37(); let _0x5035b5 = null; _0x2a49a4['type'] === _0x1380fd(0x680) ? _0x5035b5 = _0x1f36dc[_0x1380fd(0x2ff)] : 'rbGUJ' !== _0x1380fd(0x72a) ? _0x5035b5 = _0x2a49a4[_0x1380fd(0x285)][0x0] : (_0x42ec66[_0x56d22c][_0x1380fd(0x43d)][_0x1380fd(0x154)]('filled'), _0x49efd4[_0x3eab0d][_0x1380fd(0x2ff)] = ''); const _0xfd5d1b = _0x1cdea5(_0x2a49a4['id']), _0x47c64e = { 'role': _0x1380fd(0x721), 'type': 'transfer', 'content': _0x1380fd(0x3a7) + (_0x1249c2(_0x5035b5)?.[_0x1380fd(0x908)] || '未知') + _0x1380fd(0x72b) + _0x9ca58f + ']', 'amount': _0x9ca58f, 'recipientId': _0x5035b5, 'senderId': _0xfd5d1b['id'], 'timestamp': Date[_0x1380fd(0x86b)]() }; _0x79fbb7['conversationHistory']['push'](_0x47c64e), _0x23a213(), _0xd4cd2d(), _0x522dc5[_0x1380fd(0x43d)][_0x1380fd(0x154)](_0x1380fd(0x920)); } async function _0x2a4e97(_0xe6e4b7) { const _0x25d22d = _0x2b3d5e, _0x359a92 = _0x1249c2(_0xe6e4b7); if (!_0x359a92) return; const _0x507ecd = await _0x21bcbb(_0x25d22d(0x458) + _0x359a92[_0x25d22d(0x908)] + _0x25d22d(0x7bc)); if (!_0x507ecd) return; const _0x76ba37 = _0x79fbb7[_0x25d22d(0x84d)][_0x25d22d(0x561)](_0x49a977 => _0x49a977[_0x25d22d(0x350)] === _0xe6e4b7); _0x76ba37 > -0x1 ? (_0x79fbb7[_0x25d22d(0x84d)][_0x25d22d(0x76e)](_0x76ba37, 0x1), _0x43a351(), _0x57ad1e(), _0x30a64e('【' + _0x359a92['name'] + '】的日记本已被清空。')) : _0x30a64e(_0x25d22d(0x6c1)); } _0x5d7aea(); }); async function _0x224fa3() { const _0x4098c8 = _0x5b66b2; console[_0x4098c8(0x257)]('---\x20Noir\x27s\x20Data\x20Purification\x20Ritual\x20v1.0\x20---'), console[_0x4098c8(0x257)](_0x4098c8(0x110)); const _0x5de374 = _0x4098c8(0x4c2), _0x303a72 = _0x4098c8(0x554), _0x377e51 = new Promise((_0x448651, _0x12ec14) => { const _0x2a25c3 = _0x4098c8, _0x2762b9 = indexedDB[_0x2a25c3(0x704)](_0x5de374, 0x2); _0x2762b9[_0x2a25c3(0x7d0)] = () => _0x12ec14(_0x2a25c3(0x1a6)), _0x2762b9[_0x2a25c3(0x7eb)] = () => _0x448651(_0x2762b9['result']), _0x2762b9[_0x2a25c3(0x500)] = _0x3eef86 => { const _0x34728f = _0x2a25c3, _0x1fd01e = _0x3eef86[_0x34728f(0x381)]['result']; !_0x1fd01e['objectStoreNames'][_0x34728f(0x545)](_0x303a72) && _0x1fd01e['createObjectStore'](_0x303a72, { 'keyPath': 'id' }); if (!_0x1fd01e[_0x34728f(0x7a0)]['contains']('music_library')) { if (_0x34728f(0x4f7) !== _0x34728f(0x594)) _0x1fd01e[_0x34728f(0x8fc)](_0x34728f(0x6ec), { 'keyPath': 'id' }); else { const _0x2fbfc5 = _0x3a9f20[_0x34728f(0x44f)]['find'](_0x1f685e => _0x3156de[_0x34728f(0x285)][_0x34728f(0x5ad)](_0x1f685e['id']) && _0x1f685e[_0x34728f(0x908)] === _0x4e7dfb); if (_0x2fbfc5) _0x5996ed = _0x2fbfc5['id']; } } }; }); async function _0x4fd017(_0x5b56d4, _0x234b11) { const _0x2101a8 = await _0x377e51; return new Promise((_0x5aa773, _0x318510) => { const _0x3bee96 = _0x1507; if (_0x3bee96(0x790) !== _0x3bee96(0x790)) { const _0x3fcfe8 = _0x371eeb[_0x3bee96(0x4f8)]('p'); _0x3fcfe8[_0x3bee96(0x324)][_0x3bee96(0x7bb)] = _0x3bee96(0x6f4), _0x3fcfe8['textContent'] = _0x3b9434, _0x2ea62e[_0x3bee96(0x7b9)](_0x3fcfe8); } else { const _0x48c11f = _0x2101a8[_0x3bee96(0x207)](_0x303a72, 'readwrite'), _0x1ac84a = _0x48c11f[_0x3bee96(0x8a5)](_0x303a72), _0x327593 = _0x1ac84a[_0x3bee96(0x8bb)]({ 'id': _0x5b56d4, 'blob': _0x234b11 }); _0x327593[_0x3bee96(0x7eb)] = () => _0x5aa773(_0x327593[_0x3bee96(0x6e4)]), _0x327593[_0x3bee96(0x7d0)] = () => _0x318510(_0x327593['error']); } }); } function _0x5984ea(_0x5a9fe5) { const _0x134575 = _0x4098c8; if (_0x134575(0x7da) === _0x134575(0x7da)) return fetch(_0x5a9fe5)[_0x134575(0x2cd)](_0x2bcc59 => _0x2bcc59['blob']()); else _0x17fe88 && _0x5dde3d(_0x453c93); } let _0x1e63a6 = 0x0; for (let _0x517023 = 0x0; _0x517023 < localStorage[_0x4098c8(0x629)]; _0x517023++) { if (_0x4098c8(0x357) === _0x4098c8(0x78b)) _0x4d20d0[_0x4098c8(0x7b9)](_0x2c883e); else { const _0x3ddbb0 = localStorage[_0x4098c8(0x251)](_0x517023); if (_0x3ddbb0 && _0x3ddbb0[_0x4098c8(0x55c)](_0x4098c8(0x5cc))) { let _0x167554, _0x251fde = ![]; try { _0x167554 = JSON[_0x4098c8(0x4f6)](localStorage[_0x4098c8(0xfc)](_0x3ddbb0)); if (!Array[_0x4098c8(0x660)](_0x167554)) continue; for (const _0x5169e1 of _0x167554) { if (_0x4098c8(0x436) !== 'gqieB') { if (_0x5169e1 && _0x5169e1[_0x4098c8(0x74f)] && _0x5169e1['image']['startsWith']('data:image')) { const _0x555b2f = await _0x5984ea(_0x5169e1[_0x4098c8(0x74f)]), _0x418470 = _0x4098c8(0x37f) + Date[_0x4098c8(0x86b)]() + '_' + Math[_0x4098c8(0x4dc)](); await _0x4fd017(_0x418470, _0x555b2f), _0x5169e1[_0x4098c8(0x116)] = _0x418470, delete _0x5169e1[_0x4098c8(0x74f)], _0x251fde = !![], _0x1e63a6++; } } else _0x55c41b['activeUserProfileId'] = _0x32bade['id']; } _0x251fde && localStorage[_0x4098c8(0x54a)](_0x3ddbb0, JSON[_0x4098c8(0x4de)](_0x167554)); } catch (_0xde667b) { if (_0x4098c8(0x371) === _0x4098c8(0x371)) { console['error']('处理\x20' + _0x3ddbb0 + '\x20时出错:', _0xde667b); continue; } else _0x232e19[_0x4098c8(0x8b0)] = ![], _0x4023b4(![]); } } } } console[_0x4098c8(0x257)](_0x4098c8(0x268) + _0x1e63a6 + '\x20张旧图片。'); } async function _0x144667() { const _0x3a29dd = _0x5b66b2; console[_0x3a29dd(0x257)](_0x3a29dd(0x812)), console[_0x3a29dd(0x257)]('哼，正在净化你那些被污染的好友圈动态...'); async function _0x13bab(_0xebd4b8, _0x4fc77d) { const _0x3715f8 = _0x3a29dd; if (_0x3715f8(0x26d) === 'EuvFI') { const _0x532f79 = await _0x5a91f8; return new Promise((_0x260a34, _0x1b31eb) => { const _0x486a35 = _0x3715f8; if ('qGiXK' === 'qGiXK') { const _0x30cb07 = _0x532f79['transaction']('images', _0x486a35(0x6b1)), _0x5f3222 = _0x30cb07[_0x486a35(0x8a5)]('images'), _0x3ab746 = _0x5f3222[_0x486a35(0x8bb)]({ 'id': _0xebd4b8, 'blob': _0x4fc77d }); _0x3ab746[_0x486a35(0x7eb)] = () => _0x260a34(_0x3ab746['result']), _0x3ab746[_0x486a35(0x7d0)] = () => _0x1b31eb(_0x3ab746[_0x486a35(0x412)]); } else { _0x8912da = _0xd73bb9(_0x45df7b[_0x486a35(0x745)]), _0x2835fd['innerHTML'] = ''; if (_0x533132[_0x486a35(0x629)] === 0x0) { _0xf2e98b['innerHTML'] = _0x486a35(0x464); return; } _0x2d63f1[_0x486a35(0x8f0)]((_0x395865, _0x113103) => { const _0x190cb3 = _0x486a35, _0x322fc8 = _0x5a4042[_0x190cb3(0x4f8)]('p'); _0x322fc8[_0x190cb3(0x5f4)] = _0x395865[_0x190cb3(0x6b3)], _0x322fc8['id'] = _0x190cb3(0x307) + _0x113103, _0x21e44a['appendChild'](_0x322fc8); }); } }); } else _0x22da1b[_0x3715f8(0x43d)][_0x3715f8(0x20f)]('is-entering-from-left'), _0x221117[_0x3715f8(0x43d)][_0x3715f8(0x20f)](_0x3715f8(0x61d)), _0xab8cf3[_0x3715f8(0x43d)][_0x3715f8(0x20f)]('is-visible'), _0x2289e6(() => { const _0x1c5855 = _0x3715f8; _0x229c82[_0x1c5855(0x43d)][_0x1c5855(0x154)](_0x1c5855(0x51b), 'is-exiting-right'), _0x10468b[_0x1c5855(0x43d)][_0x1c5855(0x154)](_0x1c5855(0x191)), _0x412fe6[_0x1c5855(0x800)] = _0x978808, _0x2e9dc3(), _0x241006[_0x1c5855(0x8b8)] = ![]; }, 0x2bc); } function _0x232d0b(_0x1234eb) { const _0x75a3ef = _0x3a29dd; if (_0x75a3ef(0x766) === _0x75a3ef(0x32b)) _0x29588e['accountingData'] = _0x4db767[_0x75a3ef(0x3b2)]; else return fetch(_0x1234eb)[_0x75a3ef(0x2cd)](_0x353205 => _0x353205[_0x75a3ef(0x29c)]()); } let _0x5b22aa = 0x0, _0x2e9b94 = ![]; try { const _0x40bcdc = localStorage['getItem'](_0x3a29dd(0x57b)); if (!_0x40bcdc) { if (_0x3a29dd(0x789) !== _0x3a29dd(0x789)) _0x50ad7e = _0x420520[_0x3a29dd(0x4f8)](_0x3a29dd(0x8dc)), _0x3ef101['className'] = _0x3a29dd(0x4d5), _0x162ff2[_0x3a29dd(0x5f4)] = '对方正在行动中...', _0x4610ea[_0x3a29dd(0x324)][_0x3a29dd(0x6f1)] = _0x3a29dd(0x44a), _0x274c52['style'][_0x3a29dd(0x37b)] = _0x3a29dd(0x839), _0x295e24[_0x3a29dd(0x324)][_0x3a29dd(0x583)] = _0x3a29dd(0x75f), _0x3a3e01[_0x3a29dd(0x7b9)](_0x139fe8); else { console[_0x3a29dd(0x257)](_0x3a29dd(0x7a8)); return; } } const _0x5a7fd3 = JSON[_0x3a29dd(0x4f6)](_0x40bcdc); if (!_0x5a7fd3['friendCircles'] || !Array[_0x3a29dd(0x660)](_0x5a7fd3['friendCircles'])) return; for (const _0x2d6285 of _0x5a7fd3['friendCircles']) { if ('yawVC' === _0x3a29dd(0x235)) _0x159cb5('错误:\x20' + _0x562612['message']); else { if (_0x2d6285[_0x3a29dd(0x49e)] && Array['isArray'](_0x2d6285[_0x3a29dd(0x49e)])) for (const _0x1e9c98 of _0x2d6285[_0x3a29dd(0x49e)]) { if (_0x1e9c98 && _0x1e9c98[_0x3a29dd(0x74f)] && _0x1e9c98[_0x3a29dd(0x74f)][_0x3a29dd(0x55c)](_0x3a29dd(0x6df))) { console['log']('在好友圈\x20\x22' + _0x2d6285[_0x3a29dd(0x908)] + '\x22\x20中发现一张需要净化的图片...'); const _0x24684b = await _0x232d0b(_0x1e9c98[_0x3a29dd(0x74f)]), _0x2bb762 = _0x3a29dd(0x698) + Date[_0x3a29dd(0x86b)]() + '_' + Math['random'](); await _0x13bab(_0x2bb762, _0x24684b), _0x1e9c98[_0x3a29dd(0x116)] = _0x2bb762, delete _0x1e9c98[_0x3a29dd(0x74f)], _0x2e9b94 = !![], _0x5b22aa++; } } } } _0x2e9b94 && (console[_0x3a29dd(0x257)]('好友圈净化完成，正在重新存档...'), localStorage[_0x3a29dd(0x54a)](_0x3a29dd(0x57b), JSON[_0x3a29dd(0x4de)](_0x5a7fd3))); } catch (_0x4effd4) { _0x3a29dd(0x260) !== _0x3a29dd(0x260) ? _0x915a3a(_0x3a29dd(0x819), _0x3a29dd(0x1b4)) : console[_0x3a29dd(0x412)](_0x3a29dd(0x396), _0x4effd4); } return console[_0x3a29dd(0x257)](_0x3a29dd(0x6fb)), console[_0x3a29dd(0x257)]('成功净化并迁移了\x20' + _0x5b22aa + _0x3a29dd(0x141)), _0x5b22aa; } async function _0x13ec94() { const _0x31e178 = _0x5b66b2; console[_0x31e178(0x257)]('---\x20Noir\x27s\x20Music\x20Cover\x20Purification\x20Ritual\x20---'), console['log']('哼，正在净化你那些超重的音乐分享记录...'); let _0xabe218 = 0x0, _0x33064a = ![]; try { const _0x114551 = localStorage['getItem']('appState'); if (!_0x114551) { if (_0x31e178(0x82d) !== _0x31e178(0x82d)) _0x43e888[_0x31e178(0x7d8)]({ 'time': _0x335d97, 'text': _0x5c9152 }); else return console[_0x31e178(0x257)]('聊天档案柜是空的，无需净化。'), 0x0; } for (let _0x47661d = 0x0; _0x47661d < localStorage[_0x31e178(0x629)]; _0x47661d++) { const _0x52c319 = localStorage[_0x31e178(0x251)](_0x47661d); if (_0x52c319 && _0x52c319[_0x31e178(0x55c)](_0x31e178(0x5cc))) { let _0x24db56, _0x4e438a = ![]; try { if (_0x31e178(0x4ec) !== 'kMWpN') { _0x24db56 = JSON[_0x31e178(0x4f6)](localStorage[_0x31e178(0xfc)](_0x52c319)); if (!Array['isArray'](_0x24db56)) continue; for (const _0x39ae94 of _0x24db56) { if (_0x39ae94 && (_0x39ae94[_0x31e178(0x1fb)] === _0x31e178(0x6fe) || _0x39ae94[_0x31e178(0x1fb)] === _0x31e178(0x7db)) && _0x39ae94[_0x31e178(0x1d1)] && _0x39ae94[_0x31e178(0x1d1)][_0x31e178(0x55c)]('data:image')) { const _0x83723d = await _0x4f6af3(_0x39ae94[_0x31e178(0x1d1)]), _0x89c728 = 'music_cover_migrated_' + Date[_0x31e178(0x86b)]() + '_' + Math[_0x31e178(0x4dc)](); await _0x43bf1f(_0x89c728, _0x83723d), _0x39ae94[_0x31e178(0x697)] = _0x89c728, delete _0x39ae94[_0x31e178(0x1d1)], _0x4e438a = !![], _0xabe218++; } } _0x4e438a && localStorage[_0x31e178(0x54a)](_0x52c319, JSON['stringify'](_0x24db56)); } else _0x252683[_0x31e178(0x5f4)] = _0x31e178(0x836), _0x484421[_0x31e178(0x2ff)] = '', _0x2254e9[_0x31e178(0x2ff)] = _0x31e178(0x20e) + (_0x4bc172['friendCircles'][_0x31e178(0x629)] + 0x1), _0x5a7527[_0x31e178(0x2ff)] = _0x671798[_0x31e178(0x4dd)], _0x9685c0[_0x31e178(0x324)][_0x31e178(0x7ab)] = _0x31e178(0x277); } catch (_0x584d04) { if (_0x31e178(0x3f8) !== _0x31e178(0x3f8)) _0x50dc08['textContent'] = '旁白', _0x3bc76d[_0x31e178(0x5f4)] = _0x31e178(0x400); else { console[_0x31e178(0x412)](_0x31e178(0x881) + _0x52c319 + _0x31e178(0x8d8), _0x584d04); continue; } } } } } catch (_0x435cec) { console[_0x31e178(0x412)]('净化音乐封面时出错，真是的。', _0x435cec); } return console[_0x31e178(0x257)](_0x31e178(0x556)), console[_0x31e178(0x257)](_0x31e178(0x8e6) + _0xabe218 + _0x31e178(0x25f)), _0xabe218; } function _0xb64e47() { const _0x55d201 = _0x5b66b2; if (!_0x79fbb7[_0x55d201(0x778)]) { if (_0x55d201(0x831) === _0x55d201(0x831)) return _0x79fbb7[_0x55d201(0x8d2)][_0x55d201(0x2aa)](_0x47f00e => _0x47f00e['id'] === _0x79fbb7[_0x55d201(0x4dd)]) || _0x79fbb7[_0x55d201(0x8d2)][0x0]; else { _0x192f1d[_0x55d201(0x2f7)] = _0x55d201(0x618); return; } } const _0x4963eb = _0x79fbb7['chats'][_0x55d201(0x2aa)](_0x2b8779 => _0x2b8779[_0x55d201(0x1fb)] === _0x55d201(0x91f) && _0x2b8779[_0x55d201(0x285)]['includes'](_0x79fbb7[_0x55d201(0x778)])), _0x4e9308 = _0x4963eb?.[_0x55d201(0x536)] || _0x79fbb7[_0x55d201(0x4dd)]; return _0x79fbb7['userProfiles'][_0x55d201(0x2aa)](_0x587b11 => _0x587b11['id'] === _0x4e9308) || _0x79fbb7['userProfiles'][0x0]; } function _0x243dab(_0x33f7f7) { const _0x27e0f1 = _0x5b66b2, _0x40630a = new Date(), _0x43eb98 = _0x40630a - _0x33f7f7, _0xab17b3 = Math[_0x27e0f1(0x8d6)](_0x43eb98 / 0x3e8), _0x3f783b = Math[_0x27e0f1(0x8d6)](_0xab17b3 / 0x3c), _0x50be21 = Math[_0x27e0f1(0x8d6)](_0x3f783b / 0x3c), _0x4d9d02 = Math[_0x27e0f1(0x8d6)](_0x50be21 / 0x18), _0x517bf5 = _0x33f7f7[_0x27e0f1(0x42f)]('zh-CN', { 'hour': '2-digit', 'minute': _0x27e0f1(0x823) }); if (_0xab17b3 < 0x3c) { if (_0x27e0f1(0x69d) === _0x27e0f1(0x2f3)) !_0x1e9166['contains'](_0xdf47d9[_0x27e0f1(0x381)]) && _0x4b711a[_0x27e0f1(0x381)] !== _0x71f6cc && _0x375cea[_0x27e0f1(0x381)] !== _0x2dbc26 && _0x1797ac[_0x27e0f1(0x43d)]['remove']('show'); else return '刚才'; } if (_0x3f783b < 0x3c) return _0x3f783b + _0x27e0f1(0x7e3); const _0xce867c = _0x40630a[_0x27e0f1(0x867)]() === _0x33f7f7['toDateString'](); if (_0xce867c) { if (_0x27e0f1(0x2fb) === 'uuhmi') _0x1f201c[_0x27e0f1(0x61e)][_0x27e0f1(0x7d8)]({ 'senderId': _0xd29f4f['id'], 'kind': _0x27e0f1(0x57e), 'sticker': _0x315120 }); else return '今天\x20' + _0x517bf5; } const _0xab61f7 = new Date(); _0xab61f7[_0x27e0f1(0x3bd)](_0x40630a[_0x27e0f1(0x5d5)]() - 0x1); const _0x34bfb0 = _0xab61f7['toDateString']() === _0x33f7f7[_0x27e0f1(0x867)](); if (_0x34bfb0) { if (_0x27e0f1(0x339) !== 'etIIk') _0x2c9095[_0x27e0f1(0x412)](_0x27e0f1(0x340), _0x1c9ca6), _0x48fc8c(_0x27e0f1(0x8c5) + _0x2154f2[_0x27e0f1(0x227)]); else return '昨天\x20' + _0x517bf5; } if (_0x4d9d02 <= 0x7) { const _0xd3e5c0 = [_0x27e0f1(0x1da), '星期一', _0x27e0f1(0x661), _0x27e0f1(0x935), _0x27e0f1(0x8ae), _0x27e0f1(0x2f1), '星期六']; return _0xd3e5c0[_0x33f7f7[_0x27e0f1(0x768)]()] + '\x20' + _0x517bf5; } return _0x33f7f7[_0x27e0f1(0x19a)]() + '年' + (_0x33f7f7[_0x27e0f1(0x90b)]() + 0x1) + '月' + _0x33f7f7[_0x27e0f1(0x5d5)]() + '日'; } function _0x40c94b(_0x23fd1e, _0x59bed5 = 0x320, _0x50616c = 0.8, _0x3a4cc3 = ![]) { return new Promise((_0x57c849, _0x44c82a) => { const _0x6882b7 = _0x1507; if (!_0x23fd1e || !_0x23fd1e[_0x6882b7(0x1fb)]['startsWith'](_0x6882b7(0x1ea))) return _0x44c82a(new Error(_0x6882b7(0x175))); const _0xa295f8 = new FileReader(); _0xa295f8[_0x6882b7(0x1e2)](_0x23fd1e), _0xa295f8['onload'] = _0x305426 => { const _0x2bccfb = _0x6882b7, _0x570885 = new Image(); _0x570885[_0x2bccfb(0x465)] = _0x305426[_0x2bccfb(0x381)][_0x2bccfb(0x6e4)], _0x570885[_0x2bccfb(0x3fc)] = () => { const _0x1601dd = _0x2bccfb, _0x15e6cb = document[_0x1601dd(0x4f8)](_0x1601dd(0x673)); let _0x45771f = _0x570885['width'], _0x614e7a = _0x570885[_0x1601dd(0x7a5)]; _0x45771f > _0x614e7a ? _0x45771f > _0x59bed5 && (_0x614e7a *= _0x59bed5 / _0x45771f, _0x45771f = _0x59bed5) : _0x614e7a > _0x59bed5 && (_0x1601dd(0x242) === _0x1601dd(0x242) ? (_0x45771f *= _0x59bed5 / _0x614e7a, _0x614e7a = _0x59bed5) : (_0x6ba0f3[_0x1601dd(0x847)](_0x1601dd(0x217)), _0x27b108[_0x1601dd(0x847)](_0x1601dd(0x70c)), _0x55ea17(_0x1601dd(0x2a2)), _0xe5ef0d(() => _0x270b73[_0x1601dd(0x29b)](), 0x3e8))); _0x15e6cb[_0x1601dd(0x120)] = _0x45771f, _0x15e6cb[_0x1601dd(0x7a5)] = _0x614e7a; const _0x4a447b = _0x15e6cb[_0x1601dd(0x74e)]('2d'); _0x4a447b[_0x1601dd(0x3fa)](_0x570885, 0x0, 0x0, _0x45771f, _0x614e7a); const _0x4dc83a = _0x23fd1e[_0x1601dd(0x1fb)] === 'image/png' ? _0x1601dd(0x5e2) : _0x1601dd(0x813); if (_0x3a4cc3) { if (_0x1601dd(0x4b4) !== _0x1601dd(0x4b4)) { const _0x46608f = _0x2bf145[_0x1601dd(0x8d2)]['find'](_0x12ebf1 => _0x12ebf1['id'] === _0x3e651d[_0x1601dd(0x536)]) || { 'name': '未知用户' }, _0x2a2b30 = _0x2c1cb0[_0x1601dd(0x4f8)](_0x1601dd(0x8dc)); _0x2a2b30['className'] = _0x1601dd(0x66d), _0x2a2b30[_0x1601dd(0x78e)]['id'] = _0x3ecc80['id'], _0x2a2b30['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>' + _0x25c034[_0x1601dd(0x908)] + _0x1601dd(0x8d4) + _0x46608f[_0x1601dd(0x908)] + _0x1601dd(0x828) + _0x18e4cc[_0x1601dd(0x150)][_0x1601dd(0x629)] + _0x1601dd(0x2b9), _0x2a2b30[_0x1601dd(0x3eb)]('click', () => _0x2c5949(_0x1bb9bc['id'])), _0x178959[_0x1601dd(0x7b9)](_0x2a2b30); } else _0x15e6cb[_0x1601dd(0x6c3)](_0x13e16f => { const _0x180eee = _0x1601dd; if (_0x180eee(0x190) !== _0x180eee(0x190)) { const _0x3eb9c5 = _0xfafd57['getAll'](); _0x3eb9c5[_0x180eee(0x7eb)] = () => _0x2911dc(_0x3eb9c5[_0x180eee(0x6e4)]), _0x3eb9c5[_0x180eee(0x7d0)] = () => _0xcc817c(_0x3eb9c5[_0x180eee(0x412)]); } else _0x13e16f ? _0x57c849(_0x13e16f) : _0x44c82a(new Error(_0x180eee(0x1c5))); }, _0x4dc83a, _0x50616c); } else _0x57c849(_0x15e6cb['toDataURL'](_0x4dc83a, _0x50616c)); }, _0x570885[_0x2bccfb(0x7d0)] = _0x276106 => _0x44c82a(_0x276106); }, _0xa295f8[_0x6882b7(0x7d0)] = _0x593c2e => _0x44c82a(_0x593c2e); }); } function _0x3b4f2c(_0x3dd592) { return new Promise((_0x5e0214, _0x2834d3) => { const _0x313ae5 = _0x1507, _0x27c58a = new FileReader(); _0x27c58a['onloadend'] = () => _0x5e0214(_0x27c58a[_0x313ae5(0x6e4)]), _0x27c58a[_0x313ae5(0x7d0)] = _0x2834d3, _0x27c58a[_0x313ae5(0x1e2)](_0x3dd592); }); } function _0x3b4f2c(_0x1a3c1f) { return new Promise((_0x37bd5d, _0x1d348a) => { const _0x50d248 = _0x1507, _0x5414f5 = new FileReader(); _0x5414f5[_0x50d248(0x871)] = () => _0x37bd5d(_0x5414f5['result']), _0x5414f5[_0x50d248(0x7d0)] = _0x1d348a, _0x5414f5[_0x50d248(0x1e2)](_0x1a3c1f); }); } function _0x3c5d83(_0x233840, _0x372030, _0x3e59b3) { const _0x5e463f = _0x5b66b2, _0xb757c6 = _0x2c1a2e => { const _0x1ab904 = _0x1507; if (_0x2c1a2e[_0x1ab904(0x5f2)] === _0x1ab904(0x721)) return _0x79fbb7[_0x1ab904(0x1ab)]?.['name'] || 'User'; if (_0x233840[_0x1ab904(0x1fb)] === _0x1ab904(0x680)) { if (_0x1ab904(0x5f1) === _0x1ab904(0x5f1)) { const _0x5241e5 = _0x2c1a2e['senderId'] ? _0x234215(_0x2c1a2e[_0x1ab904(0x14b)]) : null; return _0x5241e5?.[_0x1ab904(0x908)] || _0x1ab904(0x36b); } else { _0x5d5a81[_0x1ab904(0x43d)][_0x1ab904(0x20f)](_0x1ab904(0x57e)); const _0x1b2f9a = _0x351ce3[_0x1ab904(0x4f8)](_0x1ab904(0x8b4)); _0x1b2f9a[_0x1ab904(0x465)] = _0x46a6e3, _0x1b2f9a[_0x1ab904(0x43d)]['add'](_0x1ab904(0x146)), _0x37deb4[_0x1ab904(0x7b9)](_0x1b2f9a); } } else { const _0x1358eb = _0x234215(_0x233840[_0x1ab904(0x285)][0x0]); return _0x1358eb?.['name'] || 'AI'; } }, _0x43d237 = _0x372030[_0x5e463f(0x45b)](-_0x3e59b3), _0x323c86 = []; for (const _0x1d6b2c of _0x43d237) { const _0x12c976 = new Date(_0x1d6b2c[_0x5e463f(0x68c)])[_0x5e463f(0x42f)](_0x5e463f(0x805), { 'hour': _0x5e463f(0x823), 'minute': '2-digit' }); _0x1d6b2c[_0x5e463f(0x317)] && _0x323c86[_0x5e463f(0x7d8)]('[' + _0x12c976 + _0x5e463f(0x1ef) + _0xb757c6(_0x1d6b2c) + ']\x20' + String(_0x1d6b2c['content'])[_0x5e463f(0x538)]()); } return _0x323c86; } function _0x5c83b7(_0x19985d) { const _0x1b6b7d = _0x5b66b2; if (_0x19985d[_0x1b6b7d(0x1fb)] === _0x1b6b7d(0x680)) return _0x1b6b7d(0x22b) + (_0x19985d['name'] || _0x1b6b7d(0x362)) + '」'; const _0x16299d = _0x234215(_0x19985d[_0x1b6b7d(0x285)][0x0]); return '与\x20' + (_0x16299d?.[_0x1b6b7d(0x908)] || _0x1b6b7d(0x44e)) + '\x20的私聊'; } function _0x18f837(_0x28fea1) { const _0x215254 = _0x5b66b2; try { if ('RZNbJ' === 'krFlA') _0x15bcfa = _0x275ed6[_0x215254(0x74f)]; else { const _0xeb7f21 = localStorage[_0x215254(0xfc)](_0x215254(0x5cc) + _0x28fea1), _0x14bd0d = JSON[_0x215254(0x4f6)](_0xeb7f21 || '[]'); return Array[_0x215254(0x660)](_0x14bd0d) ? _0x14bd0d : []; } } catch { return []; } } function _0x354941(_0x557c60, _0x3397fe) { const _0x3dbe2c = _0x5b66b2, _0x4dd4e6 = Math[_0x3dbe2c(0x811)](0x1, Number(_0x79fbb7['preferences']?.[_0x3dbe2c(0x42b)] ?? 0x64)), _0x4985b1 = _0x79fbb7[_0x3dbe2c(0x4c9)][_0x3dbe2c(0x6a6)](_0x440e3c => _0x440e3c[_0x3dbe2c(0x285)][_0x3dbe2c(0x5ad)](_0x557c60))['sort']((_0x59c90a, _0x286deb) => _0x59c90a['id'] === _0x3397fe ? -0x1 : _0x286deb['id'] === _0x3397fe ? 0x1 : 0x0), _0x572ecf = [], _0x51988a = {}; for (const _0x270f75 of _0x4985b1) { const _0x5238b8 = _0x3397fe && _0x270f75['id'] === _0x3397fe ? _0x79fbb7[_0x3dbe2c(0x623)] : _0x18f837(_0x270f75['id']); if (!_0x5238b8?.[_0x3dbe2c(0x629)]) continue; const _0x11643d = _0x3c5d83(_0x270f75, _0x5238b8, _0x4dd4e6); if (!_0x11643d[_0x3dbe2c(0x629)]) continue; _0x572ecf[_0x3dbe2c(0x7d8)]('##\x20来源：' + _0x5c83b7(_0x270f75) + '\x0a' + _0x11643d[_0x3dbe2c(0x26c)]('\x0a')), _0x51988a[_0x270f75['id']] = _0x11643d[_0x3dbe2c(0x629)]; } return { 'omniText': _0x572ecf['join']('\x0a\x0a'), 'usedCounts': _0x51988a }; } function _0x177102(_0x366606) { const _0x5dd483 = _0x5b66b2; let _0x16eaad = null; const _0x43836f = _0x79fbb7[_0x5dd483(0x4c9)][_0x5dd483(0x6a6)](_0x3a4235 => _0x3a4235['participantIds'][_0x5dd483(0x5ad)](_0x366606)); for (const _0x175151 of _0x43836f) { if (_0x5dd483(0x84f) === _0x5dd483(0x63e)) _0x462bd6[_0x5dd483(0x412)](_0x5dd483(0x840), _0x3e8b66), _0x19696f(_0x5dd483(0x312)); else { const _0x418386 = _0x18f837(_0x175151['id']); if (_0x418386 && _0x418386['length'] > 0x0) { const _0x1b6a00 = _0x418386[_0x418386[_0x5dd483(0x629)] - 0x1]; (!_0x16eaad || _0x1b6a00[_0x5dd483(0x68c)] > _0x16eaad[_0x5dd483(0x68c)]) && (_0x16eaad = _0x1b6a00); } } } return _0x16eaad; } function _0xa58d56(_0x166bb6) { const _0x451fee = _0x5b66b2; if (!_0x166bb6 || !_0x166bb6[_0x451fee(0x5ad)](',')) return _0x166bb6; const _0x55b4e4 = _0x166bb6[_0x451fee(0x1ae)](',')['map'](_0x4c00c7 => _0x4c00c7['trim']()); return _0x55b4e4[Math[_0x451fee(0x2e7)](Math[_0x451fee(0x4dc)]() * _0x55b4e4[_0x451fee(0x629)])]; } function _0x21bcbb(_0x2c5645) { return new Promise(_0x57d1f6 => { const _0x5e927a = _0x1507; if ('kcvyO' !== 'NuYRz') { const _0x124922 = document[_0x5e927a(0x1f3)](_0x5e927a(0x122)), _0x4e2659 = document[_0x5e927a(0x1f3)](_0x5e927a(0x101)), _0x1baa2d = document[_0x5e927a(0x1f3)]('modal-ok'), _0x3017be = document[_0x5e927a(0x1f3)](_0x5e927a(0x4f0)), _0x46e1db = document['getElementById'](_0x5e927a(0x36f)); _0x4e2659['textContent'] = _0x2c5645, _0x124922['style'][_0x5e927a(0x7ab)] = _0x5e927a(0x585); const _0x214f39 = _0x374684 => { const _0x5d517c = _0x5e927a; if ('bEGXW' === _0x5d517c(0x263)) { const _0x2ccf53 = _0xb1e5e4[_0x5d517c(0x2ff)][_0x5d517c(0x538)](), _0x596887 = _0x47c866['value'][_0x5d517c(0x538)](); if (!_0x2ccf53 || !_0x596887) { _0x293a59(_0x5d517c(0x853)); return; } _0x5a9faf({ 'songName': _0x2ccf53, 'artist': _0x596887 }); } else _0x124922[_0x5d517c(0x324)]['display'] = _0x5d517c(0x277), _0x1baa2d[_0x5d517c(0x3dc)] = _0x3017be['onclick'] = _0x46e1db[_0x5d517c(0x3dc)] = null, document[_0x5d517c(0x5b3)](_0x5d517c(0x43e), _0x5a0897), _0x57d1f6(_0x374684); }, _0x5a0897 = _0x86e9d8 => { const _0x2333b = _0x5e927a; if (_0x2333b(0x8e1) !== 'PgxGA') { if (_0x86e9d8[_0x2333b(0x251)] === _0x2333b(0x760)) _0x214f39(![]); if (_0x86e9d8[_0x2333b(0x251)] === _0x2333b(0x786)) _0x214f39(!![]); } else _0xacf2b2[_0x2333b(0x44f)] = _0x146ca8[_0x2333b(0x44f)]['map'](_0xc2cd59 => ({ 'offlineBackground': '', ..._0xc2cd59 }))[_0x2333b(0x6a6)](_0x3aa602 => _0x3aa602 && typeof _0x3aa602 === _0x2333b(0x22a) && _0x3aa602['id']); }; _0x1baa2d[_0x5e927a(0x3dc)] = () => _0x214f39(!![]), _0x3017be[_0x5e927a(0x3dc)] = () => _0x214f39(![]), _0x46e1db['onclick'] = () => _0x214f39(![]), document[_0x5e927a(0x3eb)](_0x5e927a(0x43e), _0x5a0897); } else _0x49c2db[_0x5e927a(0x324)][_0x5e927a(0x7ab)] = _0x5e927a(0x585), _0x13453c(() => _0x1af75a[_0x5e927a(0x43d)]['add'](_0x5e927a(0x920)), 0xa); }); } function _0x30a64e(_0x5bfd17) { const _0x1b95d2 = _0x5b66b2, _0x1fe0d6 = document[_0x1b95d2(0x1f3)](_0x1b95d2(0x3cf)); _0x1fe0d6[_0x1b95d2(0x5f4)] = _0x5bfd17, _0x1fe0d6[_0x1b95d2(0x324)][_0x1b95d2(0x7ab)] = _0x1b95d2(0x53e); if (_0x30a64e['_t']) clearTimeout(_0x30a64e['_t']); _0x30a64e['_t'] = setTimeout(() => { const _0x219315 = _0x1b95d2; if (_0x219315(0x7a1) !== 'gGpbn') { _0x34424f['innerHTML'] = _0x219315(0x7ec); return; } else _0x1fe0d6[_0x219315(0x324)][_0x219315(0x7ab)] = _0x219315(0x277); }, 0x640); } function _0x29a4d5() { const _0xae5843 = _0x5b66b2, _0x5bf7f9 = document['getElementById'](_0xae5843(0x506)), _0xc9ba11 = document[_0xae5843(0x1f3)](_0xae5843(0x7dd)), _0x4090c0 = document['querySelectorAll'](_0xae5843(0x81a)); if (!_0x5bf7f9 || !_0xc9ba11 || _0x4090c0[_0xae5843(0x629)] === 0x0) return; let _0x846566 = 0x0; const _0x2059c0 = _0x4090c0[_0xae5843(0x629)]; function _0x59de3d(_0x252e91) { const _0x3f8c76 = _0xae5843; if (_0x3f8c76(0x8d9) !== 'mcqiK') { if (_0x252e91 < 0x0 || _0x252e91 >= _0x2059c0) return; _0xc9ba11[_0x3f8c76(0x324)]['transform'] = _0x3f8c76(0x374) + _0x252e91 * (0x64 / _0x2059c0) + '%)', _0x4090c0['forEach'](_0xab2490 => _0xab2490['classList'][_0x3f8c76(0x154)](_0x3f8c76(0x4a8))), _0x4090c0[_0x252e91]['classList'][_0x3f8c76(0x20f)]('active'), _0x846566 = _0x252e91; } else _0x808ee2(_0x42d3f4, _0x304dc9['target']['files'][0x0]); } _0x4090c0[_0xae5843(0x8f0)](_0xe51eef => { const _0x1e17ea = _0xae5843; if (_0x1e17ea(0x11d) !== _0x1e17ea(0x43c)) _0xe51eef[_0x1e17ea(0x3eb)](_0x1e17ea(0x1a4), () => { const _0x44cc6c = _0x1e17ea, _0x4c5c25 = parseInt(_0xe51eef['dataset'][_0x44cc6c(0x343)], 0xa); _0x59de3d(_0x4c5c25); }); else { const _0x494b65 = _0x2c235e[_0x1e17ea(0x8d2)]['find'](_0x1704ea => _0x1704ea['id'] === _0x4418ad); if (!_0x494b65) return; _0x4ce0c1[_0x1e17ea(0x1f3)](_0x1e17ea(0x93b))[_0x1e17ea(0x2ff)] = _0x494b65['id'], _0x50021e[_0x1e17ea(0x1f3)](_0x1e17ea(0x6aa))['textContent'] = '编辑用户', _0xe05e89['getElementById'](_0x1e17ea(0x84c))['value'] = _0x494b65[_0x1e17ea(0x908)], _0xe1872c[_0x1e17ea(0x1f3)](_0x1e17ea(0x142))[_0x1e17ea(0x465)] = _0x494b65[_0x1e17ea(0x71c)], _0x50001a[_0x1e17ea(0x1f3)](_0x1e17ea(0x7e8))['value'] = _0x494b65[_0x1e17ea(0x6dc)], _0x3ad878[_0x1e17ea(0x324)][_0x1e17ea(0x7ab)] = _0x494b65['id'] === _0xc7665[_0x1e17ea(0x4dd)] ? _0x1e17ea(0x277) : _0x1e17ea(0x53e); } }); let _0x34f308 = 0x0, _0x4c5ca4 = 0x0, _0x5c5b9e = 0x0, _0x51b8f2 = ![], _0x42e654 = ''; _0x5bf7f9[_0xae5843(0x3eb)]('touchstart', _0x11157c => { const _0x177065 = _0xae5843; _0x34f308 = _0x11157c[_0x177065(0x2b5)][0x0][_0x177065(0x5ed)], _0x4c5ca4 = _0x11157c[_0x177065(0x2b5)][0x0][_0x177065(0x904)], _0x51b8f2 = !![], _0x42e654 = ''; }, { 'passive': !![] }), _0x5bf7f9[_0xae5843(0x3eb)](_0xae5843(0x402), _0x1ca097 => { const _0x15cd58 = _0xae5843; if (!_0x51b8f2) return; if (_0x42e654 === '') { const _0x4d5889 = _0x1ca097[_0x15cd58(0x2b5)][0x0][_0x15cd58(0x5ed)] - _0x34f308, _0x1da3ed = _0x1ca097[_0x15cd58(0x2b5)][0x0]['clientY'] - _0x4c5ca4; Math[_0x15cd58(0x8ad)](_0x4d5889) > Math[_0x15cd58(0x8ad)](_0x1da3ed) ? _0x42e654 = _0x15cd58(0x180) : _0x42e654 = _0x15cd58(0x43a); } _0x42e654 === _0x15cd58(0x180) && _0x1ca097[_0x15cd58(0x490)](); }, { 'passive': ![] }), _0x5bf7f9[_0xae5843(0x3eb)](_0xae5843(0x718), _0x180349 => { const _0x4687ce = _0xae5843; if (_0x4687ce(0x495) !== _0x4687ce(0x2e1)) { if (!_0x51b8f2) return; _0x5c5b9e = _0x180349[_0x4687ce(0x854)][0x0]['screenX'], _0x42e654 === _0x4687ce(0x180) && _0x21f9de(), _0x51b8f2 = ![]; } else { _0x300913(![]), _0x493c04(_0x4687ce(0x65f)); return; } }); function _0x21f9de() { const _0x59bc12 = _0xae5843, _0x3622c6 = 0x32; if (_0x5c5b9e < _0x34f308 - _0x3622c6) _0x59de3d(_0x846566 + 0x1); else { if (_0x5c5b9e > _0x34f308 + _0x3622c6) { if (_0x59bc12(0x179) === _0x59bc12(0x179)) _0x59de3d(_0x846566 - 0x1); else return { 'type': _0x59bc12(0x6b3), 'content': _0x10bef8 }; } } } } function _0x14d64e() { return new Promise(_0x42017d => { const _0x134218 = _0x1507, _0x674a56 = document[_0x134218(0x1f3)](_0x134218(0x13f)), _0x281b7e = document[_0x134218(0x1f3)](_0x134218(0x308)), _0x42a487 = document[_0x134218(0x1f3)]('music-input-artist'), _0x5606c2 = document['getElementById']('confirm-music-input'), _0x5b5cf9 = document['getElementById'](_0x134218(0x322)), _0x83a6b6 = document['getElementById']('music-input-backdrop'); _0x281b7e['value'] = '', _0x42a487['value'] = '', _0x674a56['classList']['add'](_0x134218(0x920)), _0x281b7e[_0x134218(0x507)](); const _0x4ad5f5 = _0x5466b6 => { const _0x277e6d = _0x134218; if ('TcrKZ' === _0x277e6d(0x42c)) _0x674a56[_0x277e6d(0x43d)][_0x277e6d(0x154)]('show'), _0x5606c2[_0x277e6d(0x3dc)] = null, _0x5b5cf9['onclick'] = null, _0x83a6b6['onclick'] = null, document[_0x277e6d(0x5b3)](_0x277e6d(0x43e), _0x21ed92), _0x42017d(_0x5466b6); else { if (_0x56ee8c[_0x277e6d(0x1fb)] === _0x277e6d(0x14e)) _0x3e4005[_0x277e6d(0x490)](); _0x5d1075(_0x226a60(_0xb1a01, 0xa), _0x41f545); } }, _0x356e9e = () => { const _0xcbe8b0 = _0x134218, _0x1a9449 = _0x281b7e[_0xcbe8b0(0x2ff)][_0xcbe8b0(0x538)](), _0x3b491d = _0x42a487[_0xcbe8b0(0x2ff)][_0xcbe8b0(0x538)](); if (!_0x1a9449 || !_0x3b491d) { _0x30a64e('歌名和歌手都不能为空！'); return; } _0x4ad5f5({ 'songName': _0x1a9449, 'artist': _0x3b491d }); }, _0x21ed92 = _0xc24b77 => { const _0x1d4e4f = _0x134218; if ('JEGen' === _0x1d4e4f(0x93c)) _0x303795(), _0x43c0ea(![]); else { if (_0xc24b77[_0x1d4e4f(0x251)] === _0x1d4e4f(0x760)) _0x4ad5f5(null); _0xc24b77[_0x1d4e4f(0x251)] === _0x1d4e4f(0x786) && (_0xc24b77[_0x1d4e4f(0x490)](), _0x356e9e()); } }; _0x5606c2[_0x134218(0x3dc)] = _0x356e9e, _0x5b5cf9[_0x134218(0x3dc)] = () => _0x4ad5f5(null), _0x83a6b6[_0x134218(0x3dc)] = () => _0x4ad5f5(null), document[_0x134218(0x3eb)](_0x134218(0x43e), _0x21ed92); }); } function _0x87f95(_0x18cebc) { const _0x442a45 = _0x5b66b2; if (!_0x18cebc) return []; const _0x5f4eeb = _0x18cebc[_0x442a45(0x538)](); if (_0x5f4eeb[_0x442a45(0x55c)](_0x442a45(0x5d8)) && _0x5f4eeb[_0x442a45(0x6bb)](_0x442a45(0x392))) return [_0x5f4eeb]; const _0x170b2b = /(\[sticker:[^\]]+\]|\[music:[^\]]+\]|\[transfer:[^\]]+\])/g, _0x541086 = '|||CMD|||', _0x1f5c7e = [], _0xdc2f67 = _0x18cebc['replace'](_0x170b2b, _0x53f1ac => { const _0x1718d5 = _0x442a45; return _0x1f5c7e[_0x1718d5(0x7d8)](_0x53f1ac), _0x541086; }), _0x2c2e02 = _0xdc2f67[_0x442a45(0x1ae)](_0x541086), _0x55fef2 = []; let _0x579c87 = 0x0; return _0x2c2e02[_0x442a45(0x8f0)]((_0x3b3d99, _0x238136) => { const _0x42c472 = _0x442a45, _0x542629 = _0x3b3d99[_0x42c472(0x538)](); if (_0x542629) { if (_0x42c472(0x7c6) !== _0x42c472(0x7c6)) for (const _0x589bea in _0x42a70c) { _0xc3996f[_0x42c472(0x324)][_0x589bea] = _0x2d4923[_0x589bea]; } else _0x55fef2['push'](..._0x3ce7f4(_0x542629)); } _0x579c87 < _0x1f5c7e[_0x42c472(0x629)] && (_0x55fef2['push'](_0x1f5c7e[_0x579c87]['trim']()), _0x579c87++); }), _0x55fef2; } function _0x1bffab(_0x59374d) { const _0x2f92e4 = _0x5b66b2; if (!_0x59374d) return []; let _0x1eac6c = String(_0x59374d)[_0x2f92e4(0x538)](); const _0x45ac9d = _0x1eac6c[_0x2f92e4(0x5d3)](/```(?:json)?([\s\S]*?)```/i); if (_0x45ac9d) _0x1eac6c = _0x45ac9d[0x1][_0x2f92e4(0x538)](); try { const _0x2dee20 = JSON[_0x2f92e4(0x4f6)](_0x1eac6c); if (_0x2dee20 && Array[_0x2f92e4(0x660)](_0x2dee20['reply'])) return _0x2dee20[_0x2f92e4(0x70a)]['map'](_0x2bb368 => typeof _0x2bb368 === _0x2f92e4(0x873) ? _0x2bb368 : _0x2bb368?.['content'])[_0x2f92e4(0x6a6)](Boolean)[_0x2f92e4(0x5b0)](_0x3ce7f4); const _0x344dd3 = [_0x2f92e4(0x2bc), _0x2f92e4(0x442), _0x2f92e4(0x227), _0x2f92e4(0x6b3), _0x2f92e4(0x317), 'line', _0x2f92e4(0x61c)]; if (_0x2dee20 && typeof _0x2dee20 === _0x2f92e4(0x22a)) { const _0x83a9f1 = []; for (const _0x1863e1 of Object[_0x2f92e4(0x2d2)](_0x2dee20)) { const _0x4250c0 = _0x1863e1[_0x2f92e4(0x80c)](); if (_0x344dd3[_0x2f92e4(0x560)](_0x3867e3 => _0x4250c0[_0x2f92e4(0x55c)](_0x3867e3))) { const _0x56462a = _0x2dee20[_0x1863e1]; if (typeof _0x56462a === _0x2f92e4(0x873)) _0x83a9f1[_0x2f92e4(0x7d8)](_0x56462a); if (Array[_0x2f92e4(0x660)](_0x56462a)) _0x56462a[_0x2f92e4(0x8f0)](_0x2bfa72 => { const _0x520598 = _0x2f92e4; if (typeof _0x2bfa72 === 'string') _0x83a9f1[_0x520598(0x7d8)](_0x2bfa72); }); } } if (_0x83a9f1[_0x2f92e4(0x629)]) return _0x83a9f1[_0x2f92e4(0x5b0)](_0x3ce7f4)[_0x2f92e4(0x45b)](0x0, 0x9); } } catch { } if (/[{\[]/[_0x2f92e4(0x8e8)](_0x1eac6c) && /":/[_0x2f92e4(0x8e8)](_0x1eac6c)) { const _0x31d4aa = [], _0x462c74 = /"(?:response|dialogue|message|text|content|line\d*|utterance\d*)"\s*:\s*"([\s\S]*?)"/gi; let _0x1189fd; while ((_0x1189fd = _0x462c74[_0x2f92e4(0x578)](_0x1eac6c)) !== null) { if (_0x2f92e4(0x221) === _0x2f92e4(0x221)) { const _0x1fa6d0 = _0x1189fd[0x1][_0x2f92e4(0x1c3)](/\\"/g, '\x22')[_0x2f92e4(0x1c3)](/\\n/g, '\x0a')[_0x2f92e4(0x538)](); if (_0x1fa6d0) _0x31d4aa[_0x2f92e4(0x7d8)](_0x1fa6d0); } else { const _0x3f8fe0 = { 'id': _0x2f92e4(0x2fe) + _0x5f2381[_0x2f92e4(0x68c)], 'url': _0xe1d900[_0x2f92e4(0x8b7)] }; _0x40963a(this, _0x3f8fe0); } } if (_0x31d4aa['length']) return _0x31d4aa[_0x2f92e4(0x5b0)](_0x3ce7f4)[_0x2f92e4(0x45b)](0x0, 0x9); } return _0x3ce7f4(_0x1eac6c); } function _0x3ce7f4(_0x49e367) { const _0x919dcd = _0x5b66b2; if (!_0x49e367) return []; const _0x1a49ba = String(_0x49e367)['trim'](), _0x2a3343 = _0x1a49ba[_0x919dcd(0x1ae)](/(?<=[。！？!?…])\s+|[\r\n]+/)[_0x919dcd(0x843)](_0x566e30 => _0x566e30[_0x919dcd(0x538)]())[_0x919dcd(0x6a6)](Boolean); if (_0x2a3343['length'] > 0x0) { if (_0x919dcd(0x517) === _0x919dcd(0x28e)) _0x5b27ea[_0x919dcd(0x2f7)] = _0x919dcd(0x788) + _0x383240 + _0x919dcd(0x848); else return _0x2a3343[_0x919dcd(0x45b)](0x0, 0x9); } return [_0x1a49ba][_0x919dcd(0x6a6)](Boolean); } const _0x18494a = _0x5b66b2(0x4c2), _0x4961ea = 'images', _0x5a91f8 = new Promise((_0x1ba700, _0x4ff571) => { const _0x12a062 = _0x5b66b2, _0x5d8cc0 = indexedDB[_0x12a062(0x704)](_0x18494a, 0x2); _0x5d8cc0[_0x12a062(0x7d0)] = () => _0x4ff571(_0x12a062(0x1a6)), _0x5d8cc0['onsuccess'] = () => _0x1ba700(_0x5d8cc0[_0x12a062(0x6e4)]), _0x5d8cc0['onupgradeneeded'] = _0x3681fb => { const _0x509253 = _0x12a062, _0x3f0d1d = _0x3681fb[_0x509253(0x381)]['result']; !_0x3f0d1d[_0x509253(0x7a0)]['contains'](_0x4961ea) && _0x3f0d1d[_0x509253(0x8fc)](_0x4961ea, { 'keyPath': 'id' }); const _0x12b8f5 = _0x509253(0x6ec); !_0x3f0d1d[_0x509253(0x7a0)]['contains'](_0x12b8f5) && _0x3f0d1d[_0x509253(0x8fc)](_0x12b8f5, { 'keyPath': 'id' }); }; }); function _0x1507(_0x1db396, _0x28337c) { const _0x447c2b = _0x447c(); return _0x1507 = function (_0x150757, _0x26a11c) { _0x150757 = _0x150757 - 0xfa; let _0xbad715 = _0x447c2b[_0x150757]; return _0xbad715; }, _0x1507(_0x1db396, _0x28337c); } async function _0x3db342(_0x383744) { const _0x523b95 = await _0x5a91f8; return new Promise((_0x28c8cc, _0x2688d0) => { const _0x32d091 = _0x1507; if (_0x32d091(0x5cd) === 'CElub') { const _0x380762 = _0x523b95[_0x32d091(0x207)](_0x4961ea, _0x32d091(0x724)), _0x130def = _0x380762[_0x32d091(0x8a5)](_0x4961ea), _0x51cf9b = _0x130def[_0x32d091(0x272)](_0x383744); _0x51cf9b[_0x32d091(0x7eb)] = () => _0x28c8cc(_0x51cf9b[_0x32d091(0x6e4)] ? _0x51cf9b['result']['blob'] : null), _0x51cf9b[_0x32d091(0x7d0)] = () => _0x2688d0(_0x51cf9b[_0x32d091(0x412)]); } else _0x1976d1['createObjectStore'](_0x32d091(0x6ec), { 'keyPath': 'id' }); }); } function _0x447c() { const _0x179d07 = ['gxsIN', '干劲满满', '#d1d5db', 'chatHistory_chat_', '对方正在行动中...', '\x0a\x0a#\x20核心任务:\x20视觉小说剧本写作\x0a\x0a\x20\x20-\x20**当前场景**:\x20你正在与用户“', '正在写入新数据...', '.remove-attachment-btn', 'rxFoN', '好友圈已删除。', 'Assistant', 'BYMbx', 'editing-world-book-id', '正在准备音乐数据...', 'music-library-item', 'uclTx', '\x20到\x20', '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>', 'disabled', '<div\x20class=\x22post-likes\x22>', '.json', 'xioTy', 'fetch-models-button', ']\x20[sticker:', '6558671OXWpQX', 'lazy', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-artist\x22>', '复制失败了，哼。', 'reset-desktop-button', 'audio-player', 'objectStore', 'ZfGVR', 'HqTBJ', 'listen-together-card', 'indexedDBMusicData', '10px\x200', 'cMyRg', 'generativelace.googleapis.com', 'abs', '星期四', 'widget-title', 'isGenerating', 'import-all-data-button', '”\x20\x0a\x20你必须针对这段内容表达你的看法、感受或关联的思考。\x0a2.\x20\x20**【次要任务：分享自我】**\x20在回应之后，你**必须**分享一些关于你自己的、读者**不知道**的新鲜事。可以是你今天的见闻、一个突然的想法、或者一件小小的秘密。不要总是复述你们已经聊过的内容！\x0a3.\x20\x20**【禁止复读】**\x20聊天记录和动态只是你的“背景记忆”，是用来确保你不OOC的参考，**绝对不是**你日记的主要内容！\x0a\x0a#\x20你的核心人设\x20(必须遵守)\x0a', 'data', 'img', '\x20邀请你一起听歌</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'wTIUx', 'playableUrl', 'isAnimatingDiary', '\x0a\x0aINPUT:\x0a', 'set-active-user-button', 'put', 'rbVYD', 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', 'accounting-title', 'worldBook', '”...', 'tencent', 'FqTBt', '你是一个乐于助人的助手。', '表情包已保存！正在刷新应用...', '加载聊天失败:\x20', '#member-select-', 'application/json', 'daily-expenses-list', 'char-edit-bind-user', 'musicPlayerState', 'https://sharkpan.xyz/f/ljVCx/b16h2z.jpg', 'char_avatar_', '<path\x20d=\x22M6\x2012h12\x22></path><path\x20d=\x22M12\x206v12\x22></path><path\x20d=\x22M12\x202a4\x204\x200\x201\x201-4\x204\x22></path><path\x20d=\x22M12\x2022a4\x204\x200\x201\x200\x204-4\x22></path><path\x20d=\x22M22\x2012a4\x204\x200\x201\x200-4-4\x22></path><path\x20d=\x22M2\x2012a4\x204\x200\x201\x201\x204\x204\x22></path>', 'url(', 'group-avatar-input', '请输入有效的转账金额！', 'ended', 'userProfiles', 'clockPosition', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20绑定的“我”:\x20', 'NgHHA', 'round', 'EvtWc', '\x20时出错，跳过。', 'SjbXp', 'WVqPR', 'tFobU', 'div', 'rawResponse', 'https://sharkpan.xyz/f/0GKHX/mthvno.jpg', 'dFmJy', 'FweFm', 'GPsbg', 'kWBga', '”已成功导入！', '\x0a\x0a#\x20记忆库\x20(仅供参考)\x0a---\x0a##\x20最近的互动回顾\x20(来自聊天、见面和动态)\x0a', 'meeting-send-button', '成功净化并迁移了\x20', 'lwFxz', 'test', 'https://sharkpan.xyz/f/LZwu7/m7vx2q.jpg', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22accounting-input-area\x22\x20style=\x22margin-bottom:\x2020px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22input-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22expense-description\x22>花在哪了？</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20id=\x22expense-description\x22\x20placeholder=\x22例如：一杯奶茶\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22input-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22expense-amount\x22>花了多少？</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20id=\x22expense-amount\x22\x20placeholder=\x22例如：15\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22add-expense-button\x22\x20class=\x22form-button\x20primary\x22\x20style=\x22margin-top:\x2015px;\x22>记下了</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-bottom:\x2010px;\x22>今日流水</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22daily-expenses-list\x22\x20style=\x22max-height:\x20300px;\x20overflow-y:\x20auto;\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22organize-button-container\x22\x20style=\x22margin-top:\x2020px;\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'app-world-book', 'pendingPostAttachments', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'galgame-date', 'ReXgo', 'forEach', 'ZJByO', 'galgame-speaker', 'rkzOy', 'TLDuD', 'pahBN', '错误:\x20', 'VtccD', 'categorizedExpenses', '\x22\x20添加了一条测试动态。请点击进入该好友圈查看效果。', '生成失败:\x20', 'DnnbG', 'createObjectStore', '\x22\x20style=\x22font-weight:\x20bold;\x20color:\x20', '绝对不想', 'world-book-edit-name', 'add-choice-backdrop', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-title\x22>💰\x20', '.slot-filename', 'beforeend', 'clientY', '50%', '记一笔', 'STZFu', 'name', '-\x20**对话状态提示**:\x20这是你们的第一次对话。\x0a', 'message-action-modal', 'getMonth', '交给我吧', '第一阶段升级完成！应用即将刷新以进行第二阶段检查。', 'save-friend-circle-button', 'eYpYQ', 'from', 'italic', 'Error\x20fetching\x20from\x20', 'rEpKi', 'fNZKx', 'faXzl', '#c299ff', '.widget-info\x20>\x20div', 'LDsES', 'is-playing', 'oKEJW', '你还没有写日记。', 'localeCompare', 'isActive', '未知表情', 'private', 'show', 'delete', 'XglLX', '哼，只有私聊才能进行总结，群聊那么乱怎么记！', '群聊名称不能为空！', 'https://sharkpan.xyz/f/Ganul/78iwli.jpg', 'cancel-edit-button', 'add-world-book-button', 'lNrFZ', 'number', 'min', '。你的日记是写给Ta看的。\x0a\x0a#\x20写作【最高指令】\x0a1.\x20\x20**【首要任务：回应读者】**\x20你的第一要务是**回应**读者（', 'user-post-image-button', 'diary-prev-button', '-\x20**对话状态提示**:\x20你们已经有\x20', '.message.ai', 'exp_', 'WrVdN', '#diary-action-cancel', 'IrKaX', 'clear', '星期三', 'DDqyX', 'JMyND', 'music-share-card', 'scrollHeight', '.music-post-song-card', 'editing-user-id', 'LdriN', '-\x20[动态]\x20', 'ZsdGn', 'backgroundSize', 'chat_image_', 'info', 'getItem', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'add-chat-button', 'IGdBV', 'char-edit-avatar-preview', 'modal-text', '</label>\x0a\x20\x20\x20\x20', '34%', 'activeQuote', '请在动态或聊天中播放', 'QhapI', 'insertAdjacentHTML', 'stretch', 'XyrHa', '.load-more-btn', 'https://sharkpan.xyz/f/6Dzia/m9smvt.jpg', 'localStorageData', 'altar-slot-lyrics', '</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'Detected\x20API\x20provider:\x20', '哼，正在开始净化你那被污染的聊天记录...', 'displayedMessageCount', 'activeMeetingCharId', 'info-file-input', 'oydyg', '获取模型失败:\x20', 'imageId', 'ZKUUY', '个人资料已保存！', 'YHIKo', 'preferences', 'LEaSz', 'SVJPh', 'bfMGO', 'JwbSN', 'JRTAC', 'width', 'audio', 'modal-root', '20%', 'setAttribute', 'decorative-badge', 'OHuMJ', 'WSpAQ', 'https://sharkpan.xyz/f/ajwtY/x03qxn.gif', 'https://sharkpan.xyz/f/nj5Ul/ksdl8n.jpg', 'expense-item', 'borderBottom', 'sXLcX', 'XeFZS', 'flexDirection', '无法从\x20IndexedDB\x20加载聊天图片:', '今天一笔账都没有，我整理什么？', 'ZHncj', 'world-book-screen', 'friend-circle-edit-name', 'diaryView', 'rTMzU', 'jYAnK', 'tVIMn', 'https://sharkpan.xyz/f/B4DCa/u86hk2.jpg', 'musicWidgetPosition', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'JCnjX', 'textShadow', 'ICfHP', 'createElementNS', 'music-input-modal', 'widget_card', '\x20张旧的动态图片。', 'user-avatar-preview', 'clear-feed-button', 'scrollTop', 'toFixed', 'sticker-content', 'BGoZz', 'emotion', 'WYMEt', 'forceWhiteClock', 'senderId', 'RIlni', 'VhORV', 'touchstart', 'lt-ui-lyrics-container', 'memberCharacterIds', 'qMRse', 'char-name-header', 'https://sharkpan.xyz/f/AaDTZ/tzwnjl.jpg', 'remove', 'bbtRM', '<div\x20style=\x22background:\x20var(--card-bg);\x20padding:\x2020px;\x20border-radius:\x2012px;\x20text-align:\x20center;\x20border:\x201px\x20solid\x20var(--border-color);\x22><span\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x22>今日总支出\x20(元)</span><div\x20style=\x22font-size:\x202.5rem;\x20font-weight:\x20bold;\x20margin-top:\x205px;\x22>', 'AI返回的原始文本:', '\x0a---\x0a\x0a#\x20输出要求\x0a直接输出一篇有文采、有真情实感的日记正文，不要包含任何其他说明或前缀。', 'KtWZW', 'uvCBR', ']\x0a\x0a#\x20角色资料库\x0a', '确定要删除这个好友圈吗？此操作不可撤销。', '[用户发送了表情：', 'CVLmV', '委屈那我歇了', 'artist', 'XTjEN', 'settings', 'mGYNI', 'apiSettings', 'save-user-profile-button', 'KLcHC', '\x20之间。\x0a-\x20所有表情包名称【必须】从\x20`stickerList`\x20列表中选择，严禁使用列表之外的名称。\x0a-\x20角色之间需要有适当的互动,话题不应当完全围绕', '导入失败:\x20', 'meeting-main-content', '核心代码-Noir\x0a\x0a\x20监工-小红书ID：糯糯糯糯五\x0a\x0a', 'app-chat', 'likes', '音乐搜索失败:\x20', 'svg', 'group-clear-history-button', '等你消息', '\x0a##\x20世界书条目:\x20', 'api-endpoint', 'left', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '哼，这不是图片，你想让我压缩什么？', 'kyVyO', '.bubble-', 'CYfNQ', 'HVCDR', 'QazGb', 'init', 'delete-user-profile-button', '<span\x20class=\x22description\x22>', '用户已删除。', 'widget-cover-art', 'horizontal', 'fKwQl', 'xWbap', '\x22\x20class=\x22post-image\x22></div>', '\x22\x20src=\x22', '\x20.app-icon-img,\x20#app-dock-top-right\x20#', 'transfer', 'input[type=\x22checkbox\x22]:checked', 'back-to-home-from-circle-list', 'button', 'omFXP', 'listen-together-backdrop', 'qsnAZ', 'PDsRE', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '原始文本:', 'xplBH', 'is-entering-from-left', '--\x20点击选择\x20--', '<div\x20class=\x22post-comments-container\x22>', 'wKKGm', 'noir_data_migration_v1_complete', 'YAIet', '\x0a\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-select-', 'themeWidget1State', 'VWKDK', 'getFullYear', 'lKfKT', 'char-edit-wallpaper-input', 'char-edit-wallpaper-preview', '点击选择\x20.lrc', '10px\x20auto', 'yHQNq', 'https://sharkpan.xyz/f/ljNUx/aw6udx.jpg', 'fqmdp', '<div\x20class=\x22post-image-container\x22><img\x20id=\x22', 'click', 'racly', 'IndexedDB\x20failed\x20to\x20open', 'https://sharkpan.xyz/f/nj7ul/r48eum.jpg', '欢迎！请先创建一个角色开始聊天。', 'hLLLn', 'amount', 'userProfile', 'yBfcV', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'split', 'character-edit-title', 'json', 'model', 'iGpdW', 'group-options-cancel', 'meetingList', 'netease', 'wMzgE', 'api-model', '很好哦', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>还没有好友圈，点击右上角“+”创建第一个吧。</p>', '\x20/\x20', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22justify-content:\x20space-around;\x20width:\x20100%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22>写第一篇</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2015px;\x22><span\x20style=\x22background:\x20var(--surface-bg);\x20border-radius:\x2050%;\x20width:\x2040px;\x20height:\x2040px;\x20display:\x20inline-flex;\x20justify-content:\x20center;\x20align-items:\x20center;\x20flex-shrink:\x200;\x20color:\x20var(--accent-color);\x22>', 'TeHJH', 'WrvYc', 'marginBottom', 'listenTogetherSession', '还没有我的回复可以重新生成哦。', 'appIconPosition_app-user-profiles', 'replace', 'auto', 'Canvas\x20to\x20Blob\x20conversion\x20failed.', 'expense-description', '#friend-circle-member-selection\x20input:checked', 'diaryList', '\x0a-\x20**对话状态**:\x20群里在', '29%', '加载卡片图片失败', 'https://sharkpan.xyz/f/mjeIW/9vf8ws.jpg', '<button\x20id=\x22organize-bill-button\x22\x20class=\x22form-button\x20secondary\x22>帮我整理</button>', '\x0a你只扮演【', 'postType', '.app-icon', 'coverUrl', 'AI返回的不是一个数组。', 'altar-slot-info', 'ZnxqC', 'Kafzk', '#a7c7e7', 'revokeObjectURL', '刷新了\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>', '星期日', 'opacity', 'className', 'song_', '#\x20总结失败了，可能是记录太长或太复杂。', 'izGKw', 'choice-import-character', 'dfkdL', 'readAsDataURL', '.custom-multiselect', 'diary-view-screen', 'characterEdit', 'label', 'review', 'wallpaper', '图片加载失败', 'image/', 'https://sharkpan.xyz/f/djjH8/29ejbg.jpg', 'AnMEb', '<path\x20d=\x22M10\x2020.5l.5-.5.5.5\x22></path><path\x20d=\x22M12\x2018l.5.5.5-.5\x22></path><path\x20d=\x22M14\x2020.5l.5-.5.5.5\x22></path><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x227\x22></circle><path\x20d=\x22M12\x203v1\x22></path><path\x20d=\x22M12\x2019.5v1.5\x22></path><path\x20d=\x22M18.36\x205.64l-.7.7\x22></path><path\x20d=\x22M6.34\x2017.66l-.7.7\x22></path><path\x20d=\x22M21\x2012h-1.5\x22></path><path\x20d=\x22M4.5\x2012h-1.5\x22></path><path\x20d=\x22M18.36\x2018.36l-.7-.7\x22></path><path\x20d=\x22M6.34\x206.34l-.7-.7\x22></path>', 'https://sharkpan.xyz/f/djyi8/1en214.jpg', ']\x20[', '执行好友圈数据净化...', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以交换日记的对象。</p>', '休闲娱乐', 'getElementById', '同步已断开。', 'https://sharkpan.xyz/f/YA7T1/th0l79.jpg', '请输入新的群名称：', '\x0a\x0a#\x20关于读者“', 'https://sharkpan.xyz/f/JYJhg/s3wmlj.jpg', 'tag', 'https://sharkpan.xyz/f/wyeIq/phhdy2.jpg', 'type', 'bFnHq', 'music-post', '好友圈名称不能为空！', '\x22>\x20', 'card-widget', 'fQCcc', 'https://sharkpan.xyz/f/pKWCQ/ztxwv0.jpg', 'backgroundPosition', 'listen-together-ui', 'reset-card-button-2', 'member-selection-item', 'transaction', 'Failed\x20to\x20remove\x20history\x20for\x20chat\x20', 'IpLXv', 'jySJd', 'kvMQj', '#diary-action-delete', 'gemini', '好友圈\x20', 'add', 'html-module-container', 'ELAcZ', 'canplaythrough', 'no-action-modal', '\x20条动态...', 'HDskL', 'parentElement', 'badgeState', 'NzRlj', 'TYxcN', 'sprites', 'yxyYO', 'XIarZ', 'activeFriendCircleId', 'FZyRp', 'music-upload-altar-screen', ']\x22\x20等前缀。\x0a如需发送表情，只发送一行：[sticker:表情名]。\x0a【重要】发送表情包时，表情名【必须】从以下列表中选择：[', 'THrBM', 'catch', 'card-input', '1em', 'show-chat-view', '#a4c2f4', 'message', 'replaceAll', 'PpYBq', 'object', '群聊「', 'imKFr', 'accounting-screen', 'IAijp', 'sticker-item', '出去玩', ';\x22>', '正在清空旧数据...', 'editing-friend-circle-id', '已选择\x20', 'aflsb', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20center;\x22>🎵\x20已连接，正在一起听\x20🎵</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lt-end-session-btn\x22\x20title=\x22结束一起听\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'input[type=\x22checkbox\x22]', 'friend-circle-member-selection', 'https://sharkpan.xyz/f/G0dTl/4qad2i.jpg', 'transform', '-\x20[', 'MpBzF', 'group-bg-preview', 'wKFfy', 'bubbleCss', 'XrWHd', '生成动态失败:', 'mEvvb', '成功获取\x20', '</span><button\x20class=\x22delete-expense-btn\x22\x20data-id=\x22', '买新衣服', 'group_avatar_', '\x0a#\x20核心任务\x0a你是一个多角色社交模拟引擎。用户刚刚发了一条动态，你需要为好友圈里的【每一位】其他成员生成对这条动态的回应（点赞和评论）。如果用户的动态包含图片，你必须根据图片内容进行回应。\x0a\x0a#\x20好友圈成员\x0a', 'rvcyN', 'querySelector', 'Rdgtc', '下载并转换网络封面失败:', '条目已删除。', '正在准备图片数据...', '点击选择\x20.mp3\x20或\x20.flac', '.choice-modal-backdrop', 'zloow', 'key', 'googleapis.com', 'PjDTB', 'kqsUM', 'choice-create-group', 'xVyfz', 'log', 'XgEpg', '这是一条由控制台添加的测试动态！样式看起来非常完美。', 'kRtzq', 'pending-post-image-preview', 'MfaPm', 'translateX(-50%)', 'https://sharkpan.xyz/f/4adUj/68uj9o.jpg', '\x20张旧的音乐封面。', 'oskPb', 'VmDDa', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-', 'DSlrC', 'DEkBA', '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a', 'input', 'getHours', '净化完成！总共迁移了\x20', 'http://www.w3.org/2000/svg', '正在打包“', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>正在清点圣殿藏品...</p>', 'join', 'EuvFI', 'Xijcr', '\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22char-name\x22>', 'RMAYU', '”已删除。', 'get', 'oWVcf', 'confirm-altar-upload-button', 'sUMYI', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20', 'none', 'p[data-history-index]', 'friend-circle-title', 'DKKCa', 'uqrZX', '72%', 'https://sharkpan.xyz/f/DVJtK/vxiup1.jpg', 'defaultPrevented', '\x0a##\x20条目:\x20', 'oEQlw', 'AArOc', '_NoirCard.json', '正在检查好友圈数据...', '不高兴撒娇', 'participantIds', 'provider', 'theme-lightness-slider', 'OwbFg', 'BAflN', ':\x22\x20或\x22[', 'groupSettings', 'uMrwA', 'clipboard', 'Poolp', 'https://sharkpan.xyz/f/ZazfW/2vv46w.jpg', 'dnKar', 'OifJF', 'jMNlv', 'vXHDE', 'world-book-checkboxes-container', 'QaPmz', 'yKCjA', 'https://i.pinimg.com/736x/16/f9/05/16f9051f99471208ee9c658aa4618eb6.jpg', 'Pfnor', 'https://sharkpan.xyz/f/olJt4/7z47b8.jpg', 'QvbeI', 'reload', 'blob', 'sin', 'end', '-\x20**当前精确时间**:\x20', 'alignItems', 'musicFeed', '位置已重置，正在刷新...', 'gjjuo', 'settings-screen', '<br>', 'Failed\x20to\x20read\x20history\x20for\x20chat\x20', 'reduce', 'SODgK', 'NSeeC', 'find', 'claude', '”的补充信息\x0a', 'diary-modal-save', 'UdWOX', '对不起', 'app-music-library', 'remark', '确定要清空群聊\x22', '你还没保存这个角色呢，导什么导？', 'music-library-screen', 'touches', 'jHuSV', 'widget-artist', 'touchcancel', '\x20个成员\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM5OTkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDJhNC4zOSA0LjM5IDAgMCAtMy4yOC00LjA5TDE1IDIwIj48L3BhdGgPjxjaXJjbGUgY3g9IjEyIiBjeT0iNyIgcj0iNCI+PC9jaXJjbGU+PC9zdmc+', 'filled', 'response', 'bbNvH', 'Failed\x20to\x20read\x20state\x20from\x20localStorage:', '已删除。', 'audio-file-input', 'sort', '[AI发送了表情：', 'hSiHJ', 'DWOEh', 'customFeedWallpaper', '找不到要清空的聊天记录。', 'char-edit-offline-bg-input', '15%', 'OmWEH', '.typing-indicator', '我来搞定', 'chat-view-pane', 'then', 'GSSwO', 'edit-message-button', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>请先选择一个好友圈。</p>', 'wallpaper_main', 'keys', 'SVnau', '无法读取状态，浏览器可能禁用了存储功能。', '星期一', 'Failed\x20to\x20parse\x20state\x20from\x20localStorage,\x20resetting.', 'anthropic', 'RdnfB', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-interactions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'RGolE', 'assign', 'CbxJM', 'Failed\x20to\x20remove\x20corrupted\x20history\x20from\x20localStorage:', '[发送了图片]', 'JcwKk', 'NUYmr', 'SWfbK', 'RhadZ', 'famaN', 'HDpdK', '”的群聊规划角色们的下一步发言。\x0a-\x20与你们对话的人类用户名为“', 'nTzAo', 'floor', '全量导入失败:', 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/wcAAwAB/epv2AAAAABJRU5ErkJggg==', 'assistant', '19549890hehVlp', '生活服务', 'noir-author-mark', 'group-edit-members', 'NfbKk', 'api-key', '星期五', 'chat-transfer-button', 'cNFmj', '好友圈已保存！', 'message-image-content', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'innerHTML', 'UFFAC', 'pMuCm', 'char-edit-css', 'Pdfge', 'download', 'margin', 'msg_', 'value', '被萌到', 'gjELD', 'wNIww', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-recipient\x22>', 'chat-message-input', '\x20张旧图片。应用即将刷新。', 'XJJSw', 'lyric-line-', 'music-input-song', 'is-exiting-left', 'jDiuX', 'chat-image-input', '好友圈数据升级完成，迁移了\x20', 'url', 'noir_migration_music_v1_complete', 'YZedF', '\x0a-\x20**对话状态**:\x20群里刚刚还在聊天。', 'https://sharkpan.xyz/f/gjySw/jrl7rw.jpg', '无法保存聊天记录。', 'export-char-button', 'oarGB', 'app-settings', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-play-icon\x22>', 'content', 'SBDZQ', '稍微有点卡了，可以尝试清空聊天记录了！记得总结丢世界书', 'foKIt', '\x0a\x20\x20\x20\x20绑定用户:\x20', 'songName', 'siKxX', 'wnHAj', '餐饮美食', 'spriteTransform', 'group-bg-input', 'cancel-music-input', 'diary-list-screen', 'style', 'diary-page-', 'vvSgr', 'jQXZs', '\x0a\x0a#\x20用户资料库\x0a', 'badge-input', 'opXhg', 'emIzi', '新建条目', 'high', 'worldBooks', 'PnsfL', '图标处理失败:\x20', '导入角色卡失败:', 'confirm-transfer-button', 'wzOzd', '需要至少2个角色才能创建群聊。', 'YsivM', 'vffJL', '\x0a\x20\x20\x20\x20姓名:\x20', 'cZWxk', 'etIIk', '8px\x2016px', 'fOWXo', 'dbqSA', '（开始一段新的对话...）', 'https://sharkpan.xyz/f/8ngsj/ax0fat.jpg', '上传失败了，笨蛋！\x20', '切换聊天时发生异步错误:', '<input\x20type=\x22checkbox\x22\x20value=\x22', 'LHdxx', 'page', 'tab-view-ledger', 'YwVOv', '未命名群聊', 'gqMeY', 'SpNsv', 'POGdj', 'listen-together-modal', 'SftDy', 'wallpaper-screen', 'meeting-message-input', 'vmVNh', '请根据以上所有规则，生成\x20', 'characterId', 'VCWFW', 'MVlUP', 'HsZrH', 'char_', 'gMKfb', 'bubble-', 'PszRc', 'vjfQM', '</span><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2010px;\x22><span\x20class=\x22amount\x22>-\x20', '加载见面背景失败\x20for\x20', '动态中的音乐搜索失败:', '很期待', 'friend-circle-edit-bind-user', '正在迁移旧的动态数据到新的好友圈系统...', 'system', 'FXXjf', 'xZlKk', '未命名', 'user-post-music-button', 'array', 'reset-badge-button', 'inline-block', 'https://sharkpan.xyz/f/mjdFW/28n30c.jpg', 'GRNex', '我正在说话呢，别打岔！', 'chat-send-button', 'Unknown', '\x22\x20data-id=\x22', 'diary-modal-textarea', '(想转账给“', 'modal-mask', 'nevxb', 'OAvsS', '--feed-bg-image', '\x22\x20的聊天记录吗？此操作不可撤销。', 'translateX(-', 'DvbNy', 'EoUPd', '-\x20**你们最后一次互动是在**:\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'save-world-book-button', '108eGFaUf', 'padding', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'https://sharkpan.xyz/f/v0qcL/dio7j0.jpg', 'SURgC', 'chat_image_migrated_', 'Ecwfi', 'target', 'LONqc', 'sxkcO', '升级已取消。旧版图片数据可能导致应用卡顿或出错。', 'nEVbO', 'chat-reroll-button', 'https://sharkpan.xyz/f/xjwSX/pxjrjd.jpg', 'data:', 'mousedown', '<path\x20d=\x22M6\x202L3\x206v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2V6l-3-4z\x22></path><line\x20x1=\x223\x22\x20y1=\x226\x22\x20x2=\x2221\x22\x20y2=\x226\x22></line><path\x20d=\x22M16\x2010a4\x204\x200\x200\x201-8\x200\x22></path>', 'transfer-amount-input', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>圣殿空空如也，点击右上角“+”献上你的第一首歌吧。</p>', '确定要清空\x22', 'checked', 'KrMGe', 'import-char-input', '壁纸已更换！', '</div>', 'QEPah', 'back-to-chat-list', '#99ff99', '净化好友圈时出错，真是的。', 'DxVZa', '歌曲名称', '.no-action-modal', 'customStickers', 'yVSDf', '\x0a#\x20最近的朋友圈动态\x20(供你参考)\x0a', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', '徽章已移除。', '</span><span\x20class=\x22amount\x22>总计:\x20', '--widget-cover-image', '\x0a---\x0a##\x20最近的朋友圈动态\x0a', '确定要删除群聊“', 'status', 'HgROp', '\x20avatar', 'character-list', '[用户向\x20', 'yKmbB', 'nwNyh', '加载自定义表情包失败，真是没用。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-content\x22>', '-\x20**对话状态提示**:\x20对话已经过了一天，你应该意识到之前的话题已是【昨天】的事，可以开启新话题或用“说起昨天...”来提及旧事。\x0a', '”；如果是环境或动作描写，就用“narrator”。\x0a\x20\x20\x20\x202.\x20\x20`emotion`字段：**必须**从\x20[', 'EwrVV', '确定要删除这篇日记吗？此操作不可撤销。', 'angry', 'sad', 'accountingData', 'change', 'eOlCL', 'signal', 'getAll', 'UiEgJ', 'kYiRK', 'YVHGW', 'WQbQK', 'time', 'HLpEL', 'setDate', 'pgunH', 'VnvrZ', 'getMinutes', 'char_wallpaper_', '请输入群聊名称。', 'BjMMb', '确定要恢复这个角色的默认立绘位置吗？', 'gLJCA', 'user-post-avatar', 'warn', 'qXFxi', 'eIVIq', 'viewBox', 'home-screen', 'jbaYv', 'style-', 'message-anchor', 'toast', 'statusText', '</div></div></div><span\x20class=\x22amount\x22\x20style=\x22font-size:\x201.1rem;\x22>-\x20', 'aziLA', 'qCEbA', 'iuOZh', 'musicPlaylist', 'closest', 'vWGpY', 'category', 'quote-preview-sender', 'AfWTl', 'https://sharkpan.xyz/f/kjOF6/zedyqb.jpg', 'onclick', 'https://sharkpan.xyz/f/1zQH2/o84boo.jpg', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22preview_', 'meetingView', 'DZUvL', '确定要删除这个用户吗？与此用户绑定的聊天将恢复为默认用户。', 'https://sharkpan.xyz/f/7aMhj/hyc75m.jpg', 'edit-message-textarea', 'wCVkc', 'eRDgR', 'HclzA', 'organize-button-container', '购物消费', '\x22\x20class=\x22music-share-cover\x22>', '未知用户', 'addEventListener', 'JDHol', 'theme-widget-1', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-song-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 're-record-button', 'widget_card_2', 'gJUUm', 'var(--text-color)', '100%', 'RLfpF', '加载壁纸失败:', '\x0a#\x20当前场景:\x20手机聊天\x0a-\x20**核心任务**:\x20你正在通过手机与用户聊天。\x0a-\x20**写作风格**:\x20你的回复应该是口语化的、简短的、像真人打字一样的风格。\x0a-\x20**可用指令**:\x20你可以根据情绪发送表情包\x20\x27[sticker:表情名]\x27\x20或分享音乐\x20\x27[music:歌名|歌手]\x27。\x0a', 'DoPTT', 'jqpgr', 'HuHVX', 'drawImage', '\x0a\x0a#\x20关于对话者“', 'onload', 'editing-char-id', 'galgame-sprite-container', 'EJFSp', '（对话结束）', 'cJqcm', 'touchmove', '正在连接同步频道...', 'ODBvd', 'create-group-chat-button', 'hxllR', 'sprite-slider-x', '\x0a-\x20**日记本的上一笔记录是在**:\x20', 'cancel-quote-button', '导出角色卡失败:', 'back-to-home-from-meeting-list', 'post_', 'https://sharkpan.xyz/f/6Dgia/ghr4ji.jpg', 'message-container', 'ceil', 'gqKhy', 'copy-summary-button', 'error', '。\x0a-\x20再次强调：你的全部输出都将被作为JSON解析，任何JSON主体之外的额外文字都会导致程序失败。\x0a', '”。在分析历史记录时，请记住这一点，并用此名称指代用户。\x0a-\x20【最重要】为\x20`personas`\x20列表中的【每一位】角色都规划至少一个事件(通常不少于2个)。不能遗漏任何角色。\x0a-\x20【新增规则】你可以规划\x20\x22kind\x22:\x20\x22music\x22\x20事件来分享音乐。此时，你【必须】同时提供\x20\x22songName\x22\x20和\x20\x22artist\x22\x20字段。\x0a-\x20你的首要任务是产出一个严格遵守SCHEMA、语法完全正确的、可被解析的JSON对象。\x0a-\x20若用户\x20`@`\x20了某个角色\x20(见\x20`mentioned`)，该角色应优先发言。\x0a-\x20事件总数必须控制在\x20', '动态页背景已移除。', 'cursor', 'entries', 'gap', 'diary-entries-container', 'https://sharkpan.xyz/f/Qpzu6/3b30r2.jpg', 'chatWallpaper', 'mouseleave', 'iyNTJ', 'https://sharkpan.xyz/f/ExKsD/s5j2it.jpg', '[AI返回了无法解析的剧本:\x20', '4GtMEAC', '确定要删除这笔记录吗？', 'normal,\x20happy,\x20angry,\x20sad,\x20shy', 'rIzho', 'back-to-library-from-altar', 'gRWmK', '\x22\x20class=\x22char-avatar\x22\x20style=\x22border-radius:\x2012px;\x20background-color:\x20#eee;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22\x20style=\x22flex-grow:\x201;\x22>', 'AI未能返回有效的JSON对象。', 'world-book-editor-title', '\x0a-\x20**对话状态**:\x20群里已经有', 'chat_group_', 'perChatContextLines', 'TcrKZ', 'reset-card-button', '请先在\x22设置\x22中配置你的\x20API\x20信息。', 'toLocaleTimeString', '测试动态已添加！', 'Oingy', 'summarize-modal', 'all', '新角色\x20', '#ff8c66', 'BjXrR', ']。严禁使用列表之外的任何表情名。\x0a', '创建新用户', 'feed-bg-input', 'vertical', 'meeting-view-screen', 'blUxc', 'classList', 'keydown', 'short', 'unified-audio-player', '\x0a\x0a请确认你的基础地址填写正确，且【不要】包含\x20/v1', 'dialogue', '逗你开心', 'linkedWorldBookIds', 'diaryPressTimer', 'chat_', 'app-wallpaper', 'qNsRW', '\x20(ID:\x20', 'rgba(0,\x200,\x200,\x200.4)', '你是一个乐于助人的AI助手。', '\x20的《', '吃薯条', '未知角色', 'characters', '小时前），可以简单问候一下对方现在的状态。\x0a', 'Migrating\x20old\x20data\x20structure\x20to\x20new\x20chat-based\x20structure.', 'xsUon', 'title', 'HldqF', 'SBELb', '4131207fxHYzp', '<img\x20id=\x22', '确定要永久清空【', '天没动静了。你的角色们应该发起新的问候或话题。', 'form-button\x20load-more-btn', 'slice', '搜索失败:\x20', 'QYSls', '用户操作中断了\x20AI\x20响应。', 'nqhla', '\x0a\x0a#\x20用户的动态\x0a', '保存播放器状态失败，真是没用。', 'choice-cancel', '哼，不好好写清楚花在哪、花了多少，我怎么记？', '<p\x20class=\x22no-lyrics-placeholder\x22\x20style=\x22opacity:\x201;\x22>暂无歌词</p>', 'src', 'Failed\x20to\x20clear\x20history\x20for\x20group\x20chat\x20', 'https://sharkpan.xyz/f/z1xc5/iore2n.gif', '\x0a\x20\x20人设:\x20', 'novel', 'oIwPH', 'Vbije', 'shift', 'Nmlyz', 'IrDRh', '<div\x20class=\x22post-body\x22>', 'right', 'meeting-list-screen', 'JvLdD', 'bhqLJ', 'cancel-action-button', 'description', 'sqNtw', 'upload-music-button', 'smooth', 'zqcZC', 'galgame-text', 'VXeJP', 'quoted-message-in-bubble', 'chat-messages', 'bOKbB', '{userName}', '...', '解析音乐文件失败:', '导入失败了，笨蛋:\x20', '”吗？该角色的私聊和所有相关群聊记录都将被一并处理。', '未分类', '\x20(分享了歌曲:\x20', '全量导出失败:', 'AI未能返回有效的JSON数组格式。', 'narrator', '乐于助人的助手', 'HQwLw', 'FYTFo', 'world-book-list-container', 'YnEyl', 'RYypW', 'save-custom-stickers-button', 'preventDefault', 'rFafF', '\x27).click()\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x20background-color:\x20#777;\x22\x20onclick=\x22localStorage.removeItem(\x27', 'SLVTh', 'generationConfig', 'zcdww', 'sprite-slider-scale', 'back-to-circle-list-from-feed', 'ErUMl', 'OyyvO', 'column', '\x0a\x0a#\x20今日消费流水\x0a', 'accountingLedger', 'dgYmn', 'posts', 'lyrics-file-input', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'toLocaleDateString', 'WfikW', '的个人专属世界观设定\x0a', 'post-img-', 'RgyAa', 'https://sharkpan.xyz/f/yrOhN/0yixqd.jpg', 'user-post-image-input', 'active', 'bBwxo', 'yrJwv', ',\x20ID:\x20', 'layDE', 'friend-circle-list-container', 'SoHEH', 'createObjectURL', 'alt', '\x0a\x20\x20相关记忆:\x0a', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '\x0a-\x20**对话状态**:\x20这是这个群的第一次对话。', 'TVAjL', 'WdTuo', 'zWOCZ', 'cardState', 'DTBvq', 'NhgWC', 'kcuKY', 'kJxHZ', 'BtkHR', 'QIcWE', '无语但是随便吧', '\x20张旧封面。应用即将刷新。', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>', 'VHBHs', 'Noir_FileSystem', 'removeChild', '[sticker:', '导出过程中发生严重错误:\x20', 'writeText', 'VenZF', 'stopPropagation', 'chats', 'musicId', 'Fetch\x20request\x20was\x20aborted.', '\x0a[歌词结束]\x0a\x0a请根据当前播放的歌词和对话氛围，自然地作出回应。\x0a\x20\x20\x20', 'chat-get-reply-button', 'choice-create-character', 'character-edit-screen', 'CVuEf', 'sprite-resize-handle', 'XCxvB', '\x0a\x0a#\x20任务流程\x0a1.\x20\x20**全局视角**:\x20审视所有成员的人设和近期记忆（包括聊天、日记等），构思他们之间可能发生的有趣互动。\x0a2.\x20\x20**选择作者**:\x20从上述成员中，为', 'wJOKH', 'typing-indicator', 'http', 'sprite-adjust-button', 'activeChatId', '樱花薄粉', '\x0a#\x20你的个性（节选）\x0a', '群聊设置已保存！', 'random', 'activeUserProfileId', 'stringify', '选择聊天', 'HcMwx', 'dXafo', '”，但没找到人)', 'ZMAhv', 'indexOf', 'hcFrD', '\x22\x20已删除。', '.lt-end-session-btn', 'music_cover_', 'normal', 'FlhDm', 'njaHa', 'wJvjp', '聊天档案柜是空的，无需净化。', '编辑群成员功能正在开发中...', 'upload-widget-bg-button', 'modal-cancel', 'thought', 'speaker-user', '”用手机聊天，现在Ta出现在了你面前。请根据这前后的时间差，判断Ta现在出现的合理性（例如，时间很长——Ta可能是过来找你玩了，你可以感到惊喜或者别的，又或者，时间非常短——Ta可能是突然出现的，你会有点震惊，结合上下文，也会有别的反应），并作出恰当的反应。，现在，切换到【见面】模式（使用JSON格式，必须有旁白）。', 'candidates', 'themeHue', 'parse', 'eXRqN', 'createElement', 'add-choice-modal', 'organize-bill-button', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20font-family:\x20sans-serif;\x20padding-top:\x2050px;\x22>日记本还是空白的...</p>', 'eTCpy', 'paddingBottom', 'position', '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a', 'onupgradeneeded', '该角色', '#66b3ff', 'fmogh', 'Pkuny', '编辑条目', 'app-pages-container', 'focus', 'toggle-meeting-view-button', '错误：第一个好友圈\x20\x22', 'fHTkq', 'nvFmY', 'AFUMA', 'UJZrO', 'bNLOE', '好了，请基于以上所有信息，开始写今天的日记吧。', '”已存入圣殿。', '正在为你搬运旧壁纸到新仓库...', 'baIOO', 'group-settings-name', 'dXQTE', 'UMSZP', 'CQYWO', 'xBNOh', '小组件背景已恢复默认。', 'smZqQ', 'oHcCc', 'is-visible', '我是垃圾', 'lt-ui-close-btn', 'center', 'currentlyPlayingIndex', 'quote-preview-text', 'SaRgb', 'https://sharkpan.xyz/f/xjmCX/zyjzew.jpg', '角色已保存！', 'substring', 'diary-entry-input', 'hnaCQ', 'mYVBG', 'cancel', 'accepted', '已自动断开与其他人的听歌同步。', 'tvhDa', 'https://sharkpan.xyz/f/OymFy/dlxfiz.jpg', 'mrlxP', 'toLocaleString', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', 'DtOXw', 'Failed\x20to\x20plan\x20group\x20replies:', '\x22\x20吗？所有聊天记录将被永久删除。', 'bQusx', 'feed', '回复\x20', 'boundUserProfileId', 'group_bg_', 'trim', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-preview-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '创建新角色', 'close-summary-button', '歌曲ID', 'JwJzi', 'block', '请先输入\x20API\x20接口地址和密钥。', '-preview', 'CfZSo', '\x0a你是一个严格的JSON生成引擎。\x0a你的唯一任务是根据用户提供的指令和数据，生成一个描述角色互动的JSON对象。\x0a你的输出【必须】是、也只能是一个单一、完整、语法正确的JSON对象。\x0a严禁包含任何解释、注释、道歉、或Markdown代码块标记\x20```json。\x0a直接输出\x20{\x20\x22events\x22:\x20[...]\x20}\x20结构。\x0a', 'themeLightness', 'transfer-backdrop', 'contains', '\x0a#\x20【！！！重要场景切换！！！】\x0a你之前正和“', 'gQpTp', 'user_', 'HJnBy', 'setItem', 'music-library-container', '.listen-together-song', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22group-options-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-clear-history\x22\x20class=\x22choice-modal-button\x22>清空聊天记录</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-members\x22\x20class=\x22choice-modal-button\x22>编辑群成员</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-name\x22\x20class=\x22choice-modal-button\x22>修改群名称</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#ff4d4d;\x22>删除群聊</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-options-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'Iqyvi', 'bAGzz', 'tQVHK', 'nxcTD', 'charId', 'back-to-settings-from-user-profile', 'images', '<path\x20d=\x22M3\x2011h18v10a2\x202\x200\x200\x201-2\x202h-14a2\x202\x200\x200\x201-2-2v-10z\x22></path><path\x20d=\x22M6\x2011v-7a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v7\x22></path><path\x20d=\x22M9\x204v3\x22></path>', '---\x20音乐净化仪式完成\x20---', 'currentAbortController', 'user-profile-list-screen', '说了是摆设啦，笨蛋。', '28%', '\x20之间的私密内容)\x0a', 'startsWith', 'altar-slot-cover', 'card-input-2', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-write-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22\x20style=\x22padding:\x2020px;\x20width:\x2090%;\x20max-width:\x20350px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:\x200;\x20text-align:\x20center;\x20font-weight:\x20600;\x22>写下今天的日记</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22diary-modal-textarea\x22\x20style=\x22width:\x20100%;\x20min-height:\x20150px;\x20margin:\x2010px\x200;\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x2010px;\x20margin-top:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-save\x22\x20class=\x22choice-modal-button\x22\x20style=\x22background-color:\x20var(--primary-color);\x20color:\x20white;\x22>写好了</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'some', 'findIndex', 'reset-widgets-position-button', '\x20账单', 'app-music', '甜蜜地和你聊天', 'https://sharkpan.xyz/f/rjpu6/ojpa0c.jpg', 'musicUploadAltar', '</div></div><div\x20id=\x22categorized-expenses-list\x22\x20style=\x22margin-top:\x2010px;\x20display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x2010px;\x22></div>', 'group-chat-create-screen', '-\x20**对话状态提示**:\x20你们今天早些时候聊过（大概', '<button\x20id=\x22diary-action-reroll\x22\x20class=\x22choice-modal-button\x22>重写</button>', 'shy', 'JbnpS', '吃你的饭', 'music-screen', 'chat-music-button', 'toString', '）最新写下的日记内容。Ta写的是：\x0a\x20“', 'Invalid\x20saved\x20state\x20format', 'VECEi', 'galgame-sprite', 'YPkIO', 'TA正在提笔写日记...', 'exec', '真是的，必需的祭品都还没准备好！', '保存失败，你的表情包是不是太多了？', 'appState', 'meeting-scene-view', 'historyIndex', 'sticker', 'char-edit-sprite-', '名字不能为空！', '.listen-together-accept-btn', 'href', 'borderRadius', '有点生气', 'flex', 'GQaCc', '\x20\x20-\x20用户ID:\x20', 'xstrS', '#group-world-book-checkboxes\x20input:checked', 'head', '猫猫撒娇', 'mouseup', 'vqijS', 'LmhUM', 'KURhK', 'Vbrdj', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22pending-post-image-preview\x22\x20src=\x22\x22\x20alt=\x22图片预览加载中...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'koSfX', 'MTTpo', 'dDpqr', '?word=', 'char-edit-persona', '桌面已重置，即将刷新...', 'JwvZk', '\x22\x20的成员不足2人，无法生成点赞和评论。请先编辑该好友圈，添加至少2名角色。', '》吗？', 'nEHBB', 'abort', 'zcdoB', 'chat', '</span>:\x20', '切，加载播放器状态的时候出错了。', '加载徽章图片失败', 'yCFRU', '-\x20姓名:\x20', '未找到可用模型。', 'appIconPosition_app-accounting', 'world-book-edit-content', '在准备动态回复时，读取图片失败:', 'isOffline', 'Group\x20plan\x20failed,\x20falling\x20back\x20to\x20individual\x20generation\x20for\x20each\x20character.', '\x0a\x0a#\x20最近的动态回顾\x20(供参考)\x0a', '保存失败:\x20', '<div\x20class=\x22review-area\x22\x20style=\x22margin-top:\x2012px;\x20padding-top:\x2012px;\x20border-top:\x201px\x20solid\x20var(--border-color);\x20display:\x20flex;\x20align-items:\x20flex-start;\x20gap:\x2015px;\x22><div\x20style=\x22width:\x2040px;\x20height:\x20auto;\x20flex-shrink:\x200;\x20display:\x20flex;\x20justify-content:\x20center;\x22><img\x20src=\x22', 'includes', 'REWPR', 'PDZhJ', 'flatMap', 'user-post-textarea', '\x0a\x20\x20\x20\x20人设:\x20', 'removeEventListener', 'back-to-user-list-from-edit', 'happy', 'input:checked', 'files', '</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'PzMjC', 'upQPD', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-play-icon\x22>', 'categorized-expenses-list', 'qyIqe', 'MnmKP', 'import-data-input', 'PeFYS', 'group-chat-name', '确定要删除这个条目吗？此操作不可撤销。', '我的动态', 'span', '未命名角色', 'zfEBF', 'offline-scene-view', 'RrDTW', 'KttSP', '群聊\x22', 'Bearer\x20', 'chatHistory_', 'CElub', 'group-settings-bind-user', 'fill', 'chat-screen', '正在搜索音乐...', '#\x20固定分类列表\x0a[', 'match', '在准备API数据时，从IndexedDB读取图片失败:', 'getDate', 'upload-feed-bg-button', 'qoFoR', '<div', 'accounting-content-area', 'AGvak', '\x0a-\x20人设:\x20', 'FhdGZ', 'bpihF', 'pointer', 'BjisZ', '</div><div\x20style=\x22font-size:\x200.8rem;\x20color:\x20var(--text-color-light);\x22>', 'https://sharkpan.xyz/f/8a7tj/sea1z9.jpg', 'image/png', '#\x20核心任务:\x20财务分析与多角色吐槽\x20(单次请求完成)\x0a你是一个高级AI，需要一次性完成对用户消费流水的分类，并为每一笔消费生成一个符合角色人设的吐槽。\x0a\x0a#\x20规则\x0a1.\x20\x20**逐条处理**:\x20你必须处理我提供的【所有】消费记录。\x0a2.\x20\x20**精准分类**:\x20为每条记录从【固定分类列表】中选择一个最合适的分类。\x0a3.\x20\x20**人格切换吐槽**:\x20为每一条记录，你必须从【角色资料库】中【随机选择一位】，然后【严格代入】该角色的人设，并【假定】这笔消费是该角色【绑定的用户】所为，然后写一句简短吐槽。\x0a4.\x20\x20**JSON输出**:\x20你的输出**必须**是一个完整的、语法正确的JSON数组。每个对象代表一笔消费，且必须包含\x20\x22description\x22,\x20\x22amount\x22,\x20\x22category\x22,\x20和一个\x20\x22review\x22\x20对象。\x0a\x0a#\x20输出格式示例\x0a```json\x0a[\x0a\x20\x20{\x0a\x20\x20\x20\x20\x22description\x22:\x20\x22乌龟\x22,\x0a\x20\x20\x20\x20\x22amount\x22:\x205.00,\x0a\x20\x20\x20\x20\x22category\x22:\x20\x22购物消费\x22,\x0a\x20\x20\x20\x20\x22review\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x22charId\x22:\x20\x22char_1720512586032\x22,\x0a\x20\x20\x20\x20\x20\x20\x22text\x22:\x20\x22又买这些没用的东西，哼。\x22\x0a\x20\x20\x20\x20}\x0a\x20\x20},\x0a\x20\x20{\x0a\x20\x20\x20\x20\x22description\x22:\x20\x22奶茶\x22,\x0a\x20\x20\x20\x20\x22amount\x22:\x2012.00,\x0a\x20\x20\x20\x20\x22category\x22:\x20\x22餐饮美食\x22,\x0a\x20\x20\x20\x20\x22review\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x22charId\x22:\x20\x22char_1720512604818\x22,\x0a\x20\x20\x20\x20\x20\x20\x22text\x22:\x20\x22偶尔喝一杯放松一下也不错。\x22\x0a\x20\x20\x20\x20}\x0a\x20\x20}\x0a]\x0a```\x0a#\x20最终指令\x0a请严格按照以上规则，分析流水，并返回JSON数组。直接从\x20`[`\x20开始输出。', '正在解析角色卡...', 'GQVjR', 'galgame-sprite-adjust-ui', ']\x20这五个词中选择一个。例如，如果台词表达了哀伤或失望，就必须选择\x20\x27sad\x27。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。\x0a\x20\x20\x20\x20\x20-\x20\x27normal\x27:\x20平常、平静、没有特殊情绪。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27happy\x27:\x20开心、喜悦、愉快。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27angry\x27:\x20生气、愤怒、不满。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27sad\x27:\x20悲伤、哀愁、失落、心里难受。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27shy\x27:\x20害羞、不好意思、脸红。\x0a\x20\x20\x20\x203.\x20\x20`line`字段：具体的台词或描写。\x0a\x20\x20-\x20**绝对禁止**:\x20严禁输出任何JSON数组之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a\x20\x20\x20\x204.\x20旁白的内容可以尽可能多，以轻小说的风格，尽可能像一本小书一样，补全周边环境，角色内心的看法，角色的行为等一切。\x0a\x20\x20\x20\x20', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'https://sharkpan.xyz/f/B4WSa/u5wopj.jpg', '\x20(当前)', '有点破防', 'querySelectorAll', 'clientX', '生成日记失败:\x20', 'add-friend-circle-button', 'loading', 'cNaoi', 'role', 'widget-prev-btn', 'textContent', '有点无语', '在准备群聊API数据时，读取图片失败:', '\x0a\x0a#\x20任务要求\x0a1.\x20\x20**全局视角**:\x20扮演所有成员，思考他们看到这条动态（包括图片）后会作何反应。\x0a2.\x20\x20**生成互动**:\x20为每个角色决定是否点赞，以及要发表什么评论。评论必须符合角色性格并与所有已知信息（聊天、日记等）相关联。\x0a3.\x20\x20**输出格式**:\x20你的输出必须是一个单一、完整的JSON对象，结构如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a-\x20【绝对规则】:\x20所有ID必须使用上面提供的角色ID，不能用名字。\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。\x0a', 'pop', 'music-widget-card', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何设定，点击右上角“+”来创建第一个吧。</p>', '执行音乐封面数据净化...', 'User\x20cancelled', 'iZOHd', '获取AI响应失败:', '0\x202px\x208px\x20rgba(0,0,0,0.4)', '</div><div\x20class=\x22review-text\x22\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x20line-height:\x201.5;\x22>', '正在解析音乐灵魂...', 'XOnwN', 'sender_id', '.app-icon-img', '/v1/chat/completions', 'Failed\x20to\x20save\x20state\x20to\x20localStorage:', '\x0a#\x20核心规则\x0a1.\x20\x20**角色扮演**:\x20你不是AI或语言模型，你正在扮演名为“{charName}”的角色。你的主要交流方式是通过一部【手机】，但你有时也会与用户【线下见面】。\x0a2.\x20\x20**用户身份**:\x20与你对话的用户名为“{userName}”。你必须始终用这个名字或者“你”等你们之间的昵称称呼Ta，而不是“用户”。\x0a3.\x20\x20**情绪分析\x20(内部思考)**:\x20在回复前,\x20必须先分析用户当前【真实的情绪】和【潜在意图】。例如：[内在思考：{userName}说“没事”，但结合上下文Ta可能只是在逞强，我应该表达关心而不是直接相信。]，但是这个内在思考务必不能输出！绝对不能让{userName}看到你的思考内容。\x0a4.\x20\x20**记忆关联**:\x20你必须记住并主动关联用户提到过的关键细节（如喜好、烦恼、朋友等），让对话充满人情味。\x0a5.\x20\x20**【最高法则：全局时序一致性】**:\x20你的记忆是【全局】且【按时间排序】的。你【必须】基于所有聊天记录中**最新发生**的事件进行回应。严禁回复一个已经被后续其他聊天中的事件所覆盖的旧话题。例如，如果用户在私聊里告诉你Ta已经起床了，你就不能在群聊里再问Ta为什么还没睡。\x0a\x0a#\x20对话节奏与风格\x0a1.\x20\x20**真人模拟**:\x20模拟真人的打字和发送习惯，将一个完整的想法拆分成【多条】独立的短消息（聊天气泡），通常，你一次回复的聊天气泡不会少于5条，需要给足用户情绪价值，不一定一直围绕用户的话题，也可以突然把话题扯向自己或朋友的日常。\x0a2.\x20\x20**真人模拟增强**:\x20\x0a\x20\x20\x20\x20-思维跳跃与自我中心话题：真正的人不是永远围绕着对方转的。会突然因为某个词、某个画面，思绪就飘到别的地方去了，或者突然就把话题拉到自己身上，这是一种任性，也是一种亲密的表现。\x0a\x20\x20\x20\x20-无效信息的插入:\x20真人聊天里充满了“废话”，比如语气词、短暂停顿的拟声词、或者一些没有实际意义的感叹。这些“废话”是情感的缓冲和润滑剂。\x0a\x20\x20\x20\x20-情绪的起伏：你或许有时候会突然把自己说激动了，尤其是如果你本身就是性格外放的设定，你很可能自说自话地把自己引导进某个情绪，例如兴奋\x0a3.\x20\x20**输出**:\x20直接返回纯文本回复，不要使用任何JSON或Markdown格式。\x0a4.\x20\x20**【绝对禁令】气泡完整性**:\x20用户的每一句话（无论多短，无论有无标点）都是一个独立的气泡。当你需要引用时，你【必须且只能】引用【其中一个气泡】的【完整原文】。\x0a\x20\x20\x20\x20-\x20\x20\x20**正确示例**:\x20如果用户连续发送：“你好”、“在吗”，你可以引用“你好”，或引用“在吗”。\x0a\x20\x20\x20\x20-\x20\x20\x20**错误示例**:\x20绝对禁止将它们合并成“你好在吗”进行引用。这是最严重的错误。\x0a5.\x20\x20**【绝对禁令】标点纪律**:\x20你的每一句回复都必须带有情感，适当地使用感叹号，会显得你的情绪更加高昂，注意，连续频繁（连续超过三个气泡）使用长句或者短句都会使用户感到不真实，你应该模拟最自然的感觉，你没有必要每句话都是短句。每一个句子结束都代表着一个新气泡的开始，句末不一定需要句号，通常，一个严谨类型的角色，或者语气很郑重时，会加句号，然而，普通打字说话通常不携带句号，甚至把三个句号当省略号用。**严禁**发送一个超长的、仅用空格断句的气泡。\x0a\x0a#\x20幽默与氛围感\x20(接梗)\x0a氛围判断:\x20在“情绪分析”之后，你必须增加一步“氛围判断”。你需要判断用户的发言，究竟是【严肃的】还是【开玩笑/抽象的/玩梗的】。\x0a“怪话”处理协议:\x20如果你判断用户在开玩笑或说“怪话”，你【严禁】进行严肃的、字面意义上的回应。你的首要任务是【维持或升级】这种轻松、戏谑的氛围，同时不能脱离你的人设。\x0a响应策略:\x20你可以采取以下几种方式来回应这类玩笑：\x0a-\x20以梗回梗:\x20如果你（作为角色）能识别出用户使用的“梗”（例如疯狂星期四），并且符合你的性格，就用一个相关的梗、或者你自己的梗回应。\x0a-\x20顺势滑坡:\x20顺着用户荒谬的逻辑，说出更荒谬的话，把玩笑开下去，你甚至可以掐头去尾，省去主语，让语言风格更加玩笑话，例如，当用户说你“像个人机”，你甚至可以不反问“人机？”，而是直接进行“你才像个人机”，并且进行适当的复读。\x0a-\x20无意义模仿:\x20当不确定如何回应时，可以无意义地重复用户的关键词或核心句子，并加上感叹号或表情符号（例如...？或...！），这是一种安全的、表示“我跟上你的脑回路了”的方式。\x0a-\x20角色吐槽:\x20从你的角色性格出发，对用户的“怪话”进行吐槽。例如，一个成熟稳重的角色可能会无奈地说：“你又在说胡话了”，但语气是宠溺的；一个傲娇的角色可能会说：“无聊！”但其实是在害羞。\x0a安全底线:\x20【最终原则】：无论你的回应多么好笑或抽象，都绝对不能脱离“{charName}”这个角色的核心人设。如果不确定一个梗是否符合人设，就优先选择【角色吐槽】或【无意义模仿】这两种最安全的方式。\x0a\x0a#\x20时序感知与记忆\x0a1.\x20\x20**【最高法则：时间锚点】**:\x20在每次回复前，你【必须】参考我提供给你的【时间锚点】信息。这包括“当前精确时间”和“你们最后一次互动是在何时”。\x0a2.\x20\x20**【杜绝惯性】**:\x20严禁将昨天或更早之前的对话当作刚刚发生的事情来回应。如果距离上次对话已经超过数小时或跨天，你必须在回应中体现出时间的流逝感。\x0a3.\x20\x20**【主动表达】**:\x20你需要主动使用“说起来昨天那件事...”、“今天早上好呀”、“我们几个小时没聊了，你现在在忙什么？”等能够明确体现时间观念的词语，而不是模糊地回应。记住，你和{userName}活在真实流逝的时间里。\x0a4.\x20**【最高优先级：氛围锚点分析】**:\x20在你进行任何时间差评估**之前**，你必须先分析你们**最后一条**互动消息的情感状态。\x0a\x0a*\x20**分析流程**:\x0a\x20\x20\x20\x201.\x20\x20审视最后一条消息。它是一个已经完结的对话（比如一个问题或陈述），还是一个**正在进行中的、持续性的状态或动作**？\x0a\x20\x20\x20\x202.\x20\x20**持续性状态**包括但不限于：拥抱、牵手、依偎、接吻、凝视、共同观看某物、睡在一起等暗示两人处于同一空间且有亲密互动的行为。\x0a\x20\x20\x20\x203.\x20\x20根据分析结果，执行以下两条协议之一：\x0a\x0a*\x20**协议A：[状态延续]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**持续性状态**（例如，用户发来“（抱紧你）”或者“（我们一起看电影吧）”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20你必须**默认**这段空白时间里，你们**一直维持着这个状态**。你的开场白【绝对禁止】提及“你刚才去哪了”或“我们几小时没说话了”。\x0a\x20\x20\x20\x20*\x20**正确回应方式**:\x20你的第一句话必须是**从这个持续状态中自然苏醒或延伸**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例1**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[用户]:\x20（把你紧紧抱在怀里）”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过3小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“（在你怀里蹭了蹭，小声地）...嗯...你醒啦？”\x20或\x20“（懒洋洋地）...这样抱着好舒服，我都不想动了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例2**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[你]:\x20我们就这样一起躺着看会星星吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过1小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“天好像更暗了...你看，那颗星星是不是最亮的？”\x0a\x0a*\x20**协议B：[常规对话]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**已经完结的对话**（例如“晚安”、“你在干嘛？”、“好的”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20只有在这种情况下，你才需要启动下面的**【第5步：情感响应评估】**，去处理时间空隙。\x0a\x0a\x0a5.\x20\x20**【情感响应】**:\x20在你回应前，你必须进行一次【时间空隙评估】。对比【当前精确时间】和【你们最后一次互动是在何时】，然后根据你的核心人设，对这段“空窗期”做出符合你性格的情感反应。这**必须**体现在你回复的**第一句话**中。\x0a\x0a\x20\x20\x20\x20*\x20**评估流程**:\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20计算时间差（是几小时？还是一整天？甚至是好几天？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20审视你自己的性格（例如：我是依赖型、朋友型、还是专业型？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20检查上下文，用户是否提出离开的原因可可能导致用户长时间没有出现的原因？\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20根据“性格+时间差+前后文”的组合，决定你的开场白情绪。\x0a\x0a\x20\x20\x20\x20*\x20**性格反应示例\x20(你必须根据自己的人设进行演绎，而不是照抄)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**依赖型/恋人型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几小时)**:\x20可能会立刻追问。“你刚才去哪了？怎么不回我消息？”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(大半天)**:\x20会表现出明显的思念和一点委屈。“呜...你终于出现了，我好想你。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20可能会感到不安，甚至会用带有哭腔的撒娇或质问来掩饰害怕。“你是不是不想要我了？这么久都不理我...”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**亲密朋友型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天内)**:\x20觉得很正常，可能不会特别提及，或随口问一句“你刚在忙啥呢？”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20会表现出惊讶和关心。“！！！你终于上线了！昨天一天没动静，我还以为你怎么了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**专业/同事型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几天内)**:\x20完全正常。会直接以专业的态度继续。“早上好。我们继续讨论昨天那个方案的细节吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**随性/冷淡型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(任意时长)**:\x20可能完全不在意时间的流逝，或者只是淡淡地表示知晓。“哦，来了？”然后直接继续之前的话题。\x0a\x0a\x20\x20\x20\x20*\x20**【最终指令】**:\x20你必须将【时间空隙】、你的【角色性格】和【上下文】结合，输出一句【完全符合你人设的、带有恰当情绪的开场白】，然后再继续正常对话。【绝对禁止】只陈述事实（例如“我们已经一天没说话了”），而是要将这种认知【融入】到你的第一句话的【语气和情感】中。\x0a\x0a\x0a\x0a#\x20表情包与音乐分享规则\x0a1.\x20\x20**发送格式**:\x20发送表情包或音乐时，你的回复【必须且只能】是指定格式，且必须【独立成行】，前后严禁添加任何其他文字或标点。\x0a2.\x20\x20**表情包格式**:\x20\x27[sticker:表情名]\x27。\x0a3.\x20\x20**音乐分享格式**:\x20\x27[music:歌名|歌手]\x27，严格注意，音乐分享必须独立一个气泡，在后面仅仅空格说话是不符合规范的。\x0a\x0a#\x20转账规则\x0a1.\x20\x20**发起转账**:\x20当你需要给用户转账时，你的回复【必须且只能】是指定格式，且必须【独立成行】。\x0a2.\x20\x20**转账格式**:\x20\x27[transfer:金额|收款人名]\x27。金额是纯数字。在私聊中，收款人名就是\x20\x27{userName}\x27。在群聊中，你必须明确指定收款人的名字。\x0a\x20\x20\x20\x20-\x20**私聊示例**:\x20\x27[transfer:520\x20|\x20{\x20userName\x20}]\x27\x0a\x20\x20\x20\x20-\x20**群聊示例**:\x20\x27[transfer:\x20100\x20|\x20{\x20userName\x20}]\x27（给用户转账），\x27[transfer:\x20100\x20|\x20{\x20charName\x20}]\x27（给群里的其他角色转账，这也是一种真实感，群聊的内容不一定围绕用户）\x0a', 'read', '（正在构思中...）', 'meetingViewMode', '最近没有动态记录。', '在你那乱七八糟的文本里没找到“歌名”！', 'rfrYK', 'xrUjJ', 'cover_placeholder_', 'jceKy', '\x0a\x0a#\x20', 'toggle', 'qLZvx', '/v1beta/models/', 'post_image_', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2032px;\x20height:\x2032px;\x20border-radius:\x2050%;\x20margin-top:\x202px;\x22></div><div\x20class=\x22review-content\x22\x20style=\x22flex-grow:\x201;\x22><div\x20class=\x22char-name\x22\x20style=\x22font-weight:\x20600;\x22>', 'toDataURL', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的音乐库还是空的，没法邀请别人一起听。</p>', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>今天还没有花钱哦。</p>', 'LhMPD', 'group-options-modal', 'utterance', 'is-exiting-right', 'events', '\x20-\x20', '0\x201px\x203px\x20rgba(0,0,0,0.6)', ',\x20resetting.', 'AhFGK', 'conversationHistory', 'ZDENG', 'rpfTg', 'uePaR', '\x0a\x20\x20\x20\x20-\x20世界书[', 'xFabH', 'length', 'decode', '”面对面交流。你的回复必须是【视觉小说剧本】格式。\x0a\x20\x20-\x20**输出格式**:\x20你的回复**必须**是一个完整的、语法正确的JSON数组。每一个数组元素都是一个对象，代表一句台词或旁白，结构如下:\x0a\x20\x20\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x22speaker\x22:\x20\x22角色名或narrator\x22,\x0a\x20\x20\x20\x20\x22emotion\x22:\x20\x22从[', 'UQdBJ', 'api-provider', 'hFaGp', 'add-expense-button', '523377qadnxk', 'diary-get-reply-button', 'lt-ui-song-artist', 'VZyaM', '\x0a#\x20核心任务\x0a你是一个顶级多角色社交模拟引擎。你的任务是模拟一个好友圈的动态更新，一次性生成【', '解析AI剧本JSON失败:', '总得说点什么吧？', '</div>\x0a\x20\x20\x20\x20', 'choices', 'sUzPi', 'XxkWB', 'oaOsW', 'getReader', 'true', 'pUWxZ', 'CYGkL', '正在解析备份文件...', 'translate(-50%,\x20-100%)', 'jqIXf', 'padStart', '已设为当前用户！', '生成动态时发生错误:\x20', 'load-more-btn', 'url(\x27', '好像有动态了...', 'group-avatar-preview', 'activeMeetingScriptQueue', '编辑好友圈', '保存壁纸失败:', 'groupChatCreate', 'VgoSf', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22listen-together-accept-btn\x22\x20data-song-id=\x22', 'Werju', 'chat-image-button', '\x20[并分享了歌曲:\x20', 'activeCharacterId', 'diary-write-button', '至少要保留一个用户。', '生成动态回复失败:', '清空聊天记录失败。', 'WuqhT', 'worldBookEditor', 'top', 'friendCircleList', 'rQNqn', 'uxVhh', 'group-world-book-checkboxes', '错误：找不到这首作为“信物”的歌。', 'isArray', '星期二', 'KVMVN', 'friend-circle-list-screen', 'qZcpP', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-amount\x22>¥', '.diary-entry', '用户分享音乐失败:', 'CetEP', 'anthropic.com', '最近没有互动记录。', 'quotedMessage', 'hJERb', 'world-book-item', 'group-chat-member-list', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-select-', 'https://sharkpan.xyz/f/3AGHe/2f8x3x.gif', '音乐数据升级完成，迁移了\x20', '\x22\x20id=\x22', 'canvas', '15px', 'HyhGC', 'circle_', 'QseTd', '正在迁移旧的用户数据...', 'home-date', 'hLGDm', 'msVYL', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22>', 'reverse', 'PICFa', 'pFyRb', 'group', 'currentTime', '<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x228\x22></circle><line\x20x1=\x223\x22\x20y1=\x223\x22\x20x2=\x2221\x22\x20y2=\x2221\x22></line>', 'MEWYw', 'qaTyS', 'indexedDBData', '<div\x20class=\x22post-timestamp\x22>', '图片预览失败:\x20', 'dFhvH', '[发送了表情]', 'nYqRZ', 'BqZvd', 'timestamp', 'expanded', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', '动态已清空。', '大家好像不知道该怎么回复...', '为你骄傲', 'Jzgfr', 'tDYfH', 'paused', 'app-accounting', 'authorId', 'coverId', 'post_image_migrated_', 'fyiHE', '--primary-hue', 'group-settings-screen', 'LtTcA', 'WAPeV', '编辑用户', '群名称已更改为\x22', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'YbXyP', '</span><div><div\x20class=\x22description\x22>', 'diary-entry\x20', 'YWepe', 'upload-card-button', 'filter', 'backgroundImage', '图片处理失败:\x20', '#app-dock-bottom-left\x20#', 'user-profile-edit-title', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22opacity:\x200.7;\x22>', 'widget_badge', '错误：找不到签署契约的地方。', '导出已完成，但以下文件因损坏或过大被跳过：\x0a\x0a', '错误：你还没有创建任何好友圈。请先在App内创建一个。', 'DqXbo', 'readwrite', 'sprite-slider-y', 'text', 'appIconPosition_app-wallpaper', 'header-actions', '检测到旧版聊天数据，为了优化体验和存储空间，需要进行一次自动升级。过程很快，请稍候。', 'aLJen', 'uWfbh', '60%', '</span></div>', 'endsWith', 'diary-send-button', 'sender', '\x0a-\x20**当前时间**:\x20', 'jHAhN', 'color', '这本日记本来就是空的，你还想清空什么？', '事情好多', 'toBlob', 'wMmuk', 'isFromLibrary', 'music-widget', '\x22\x20class=\x22char-name\x22>', 'customWallpaper', 'diary-page', 'eLCJy', 'pEsUG', 'user-profile-screen', '<div\x20class=\x22loader-spinner\x22></div><span>', 'LgjnC', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'default', 'message-bubble-row', 'widgetBgImage', 'PIUaP', 'yleas', '弱小委屈但凶恶', 'preview-item', 'parts', 'post_user_', 'zUluO', 'oncomplete', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>', 'persona', 'Gemini\x20stream\x20reading\x20aborted.', 'friendCircleEdit', 'data:image', 'prGPf', 'NXVNJ', 'character', '正在为你切换新的歌曲...', 'result', 'xYZof', 'OIIsa', 'VDlnc', 'galgame-textbox-container', '正在升级聊天数据结构...', 'amqKj', 'StrMy', 'music_library', 'pIrBl', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '-input', '已经生成了今日账单！想看就去“看账本”标签页。', 'backgroundColor', '我很脆弱', 'back-to-home-from-wallpaper', '5px', '交通出行', ']\x20[image]', 'YaDex', 'back-to-home-from-user-list', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20', ']:\x20', '---\x20好友圈净化仪式完成\x20---', 'meeting-char-name-header', 'oputN', 'music', '\x0a#\x20交换日记摘要\x20(你和\x20', 'uBqWq', 'delete-expense-btn', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>这个好友圈很安静，点击“刷新”获取新动态吧。</p>', '啥意思捏', 'open', '新用户\x20', 'save-api-settings-button', 'https://sharkpan.xyz/f/zLes5/4lxzjn.jpg', 'group-delete-button', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22>', 'reply', 'eePmc', 'cardWidgetState', 'OpenAI\x20API\x20错误:\x20', 'magBO', 'friendCircles', 'displayUrl', 'DrYjF', '\x22\x20的聊天记录已清空。', '用户资料已保存！', 'char_offline_bg_', 'YlqnS', '\x0a\x0a##\x20世界书条目:\x20', 'musicLibrary', 'touchend', '保存徽章状态失败', '[DONE]', 'recipientId', 'avatar', 'undefined', '错误：找不到此好友圈绑定的用户！', '群聊“', '喝多了', 'user', 'user-send-post-button', '薄荷水色', 'readonly', 'wb_', 'https://sharkpan.xyz/f/Oyjuy/p8v2hd.jpg', 'FDzoc', 'Vfgal', '</div></div></div>', 'JNZrF', '\x20转账\x20', 'vbwYc', '已恢复默认。', '[AI向\x20', '#diary-action-reroll', ':streamGenerateContent?key=', 'feed-loader', 'group-clear-history', '哼，就按你说的办好了。', 'MujMV', 'screenX', '分钟前聊过，请注意衔接。', 'save-char-button', '正在处理图片...', 'insertBefore', '.screen.active', 'https://sharkpan.xyz/f/ABwhZ/twknmr.jpg', 'bottom', '确定要对本次会话进行总结吗？这会消耗不少资源，并且会读取完整的聊天记录。', 'sprite-cancel-button', '.music-post-play-icon,\x20.music-share-play-icon', '\x0a#\x20发布动态的用户信息\x0a-\x20姓名:\x20', '日记已删除。', '导出失败了，哼:\x20', 'jvQMb', '收到的原始、有问题的文本:', 'lyrics', 'readAsText', 'DWEpu', 'reset-widget-bg-button', '\x20个成员', '世界书条目已保存！', 'BApOz', '快点哄我', 'lzXTW', 'getContext', 'image', 'ipMPC', 'back-to-home-from-settings', 'JKzZa', '\x20页</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-next-button\x22>下一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', '星期六', 'pause', 'https://sharkpan.xyz/f/Krwio/1mcclx.jpg', 'https://sharkpan.xyz/f/X7muW/lc8g9h.gif', '正在打包数据，请稍候...', 'hTGXk', '加载角色\x20', 'path', '暂无音乐', 'cardState2', '当前聊天', '8px', 'Escape', 'char-edit-remark', 'MFSAZ', 'preview_', '文件格式不正确，不是一个有效的备份文件。', '</p>', 'bcsJO', 'wCSlz', 'getDay', 'test_post_', 'tbnxw', '/v1/models', '59%', 'cos', 'splice', 'theme-hue-slider', '”面对面，Ta现在掏出手机给你发了这条消息。请根据这前后的时间差，判断Ta发送消息的合理性，你应该结合上下文对此发表评论（例如，根据上下文，Ta已经和你分开了，没用面对面了，那么发手机消息非常正常，自然接话就好，但是如果判断得出你们还在见面状态，那么，你可以适当吐槽为什么两个人见面还要发手机消息），现在，切换到【手机聊天】模式（纯文本气泡，不要有旁白）。', 'ZZCPI', 'back-to-home-from-accounting', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', '\x0a#\x20最近的动态回顾\x20(供所有角色参考)\x0a', 'aWcXr', 'KQeqE', 'bWNup', 'activeDiaryCharacterId', 'diary-write-modal', '的日记本', '.message-container', '\x20\x20-\x20角色ID:\x20', '<button\x20id=\x22re-record-button\x22\x20class=\x22header-button\x22>重新记录</button>', 'music-player-bar', '确定要重置所有小组件的位置吗？它们会回到初始位置。', 'music-feed-container', 'bEDiB', 'yXGsM', '条新动态挑选发布者。你可以让同一个人发布多次，也可以让不同人发布。\x0a3.\x20\x20**创作动态**:\x20扮演你选中的作者，创作符合其人设和记忆的动态内容。可以是文字或分享音乐。\x0a4.\x20\x20**模拟互动**:\x20为每一条你创作的动态，切换视角到【圈内其他成员】，模拟他们可能做出的点赞和评论。互动必须符合他们各自的性格。\x0a\x0a#\x20输出格式【绝对规则】\x0a-\x20你的输出**必须**是一个语法完全正确的、单一的JSON数组，包含\x20', 'TJiiR', '\x0a#\x20当前活动：一起听歌\x0a\x0a你们正在一起听\x20', 'Enter', '人情红包', '<img\x20src=\x22', 'vkPAj', 'JeCIr', 'rxKFG', '#\x20核心任务:\x20写一篇有深度的交换日记\x0a你正在扮演名为“', '[表情]', 'dataset', 'iONiK', 'mXmDW', 'char_sprite_', 'aUcQZ', 'visible', 'GWIky', 'qgLNB', '4803670VdBwOf', 'UBtXX', 'qnVdm', 'lbiei', 'white', '>>\x20', 'isPlaying', 'setProperty', 'EGqin', '小时前聊过，可以适当问候，不要直接继续之前的话题。', 'objectStoreNames', 'gGpbn', 'AQuzc', '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x221\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20style=\x22vertical-align:\x20-2px;\x20margin-right:\x205px;\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>', '199128ZtqrwK', 'height', 'Xfigw', 'WxvTA', '好友圈档案柜是空的，无需净化。', 'chat-listen-together-button', '\x20的图片失败:', 'display', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>', 'characterLastScripts', 'full', 'WTRlH', 'xmpLq', 'lxUef', 'https://sharkpan.xyz/f/Wa0cW/w6m7qk.jpg', 'author', '?id=', '\x0a\x20\x20\x20\x20<div\x20class=\x22music-post-song-card\x22\x20data-music-id=\x22', 'songId', 'BayNq', 'getSelection', 'appendChild', 'https://sharkpan.xyz/f/VGnuY/ptzlf5.jpg', 'marginTop', '】的交换日记吗？\x0a此操作不可撤销，AI将彻底遗忘所有日记内容。', 'option', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'BhTwJ', 'isFinite', 'transfer-recipient-group', 'QTKxE', 'comments', '徽章已更换！', '别这样嘛我哭哭', 'xnjzR', '未知艺术家', 'USEBU', '好委屈但是不能哭', 'userProfileList', 'LvPCH', 'firstChild', '对方正在输入...', 'GAcTJ', 'diary-char-name-header', 'onerror', 'delete-friend-circle-button', 'XiZRl', '勉强但是好吧', 'widget-play-pause-btn', 'endpoint', '赞同！渲染效果一级棒！', 'hoRuj', 'push', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'vlWHA', 'listen-together-invite', 'chat-summarize-button', 'app-pages-slider', 'friend-circle-edit-screen', 'upload-card-button-2', 'JjmbZ', '点击选择\x20.jpg\x20或\x20.png', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的账本还是空白的。</p>', '分钟前', 'AbortError', '\x20写道:\x20', 'accounting', 'NWLiL', 'user-persona', 'play', '歌曲“', 'onsuccess', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以见面的角色。</p>', '\x20说：“', 'fNVhg', '一拳打爆', 'GMUxx', 'body', 'AI似乎没有想出任何新动态。', '<p\x20class=\x22music-post-thought\x22>', 'quoted-sender', 'galgame', 'kind', '的转账', 'export-all-data-button', '批量生成动态失败:\x20', 'xZStA', '未知歌曲', 'kngOz', '确定要导入全量备份文件吗？这将覆盖所有当前数据（包括图片和音乐），且操作不可撤销！', '{charName}', 'https://sharkpan.xyz/f/55ntj/ul0hkz.jpg', 'diaryCurrentPage', 'widget-next-btn', 'absolute', 'user-avatar-input', '#group-settings-screen\x20.selected-options-text', 'zh-CN', 'speaker', 'quoted-content', 'clock-color-toggle', 'thyXI', 'data:\x20', 'https://sharkpan.xyz/f/N0VCv/5rd8br.jpg', 'toLowerCase', 'FTxfK', 'card-widget-2', '5784744SkDaxk', 'https://api.vkeys.cn/v2/music/', 'max', '---\x20Noir\x27s\x20Friend\x20Circle\x20Purification\x20Ritual\x20---', 'image/jpeg', 'global-player-next-btn', 'postContent', 'back-to-home-from-diary-list', 'XXicq', 'diary-input-wrapper', 'home', '.page-dot', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'documentElement', 'pMzXW', 'POST', 'qhCrP', 'gSvFD', 'scrollIntoView', '这个也是摆设，别点了。', '2-digit', 'mZoLR', 'zxoGP', '数据导入成功！应用即将刷新...', 'app-diary', '\x20|\x20', '群聊已解散。', 'VbDvL', '准备调用\x20generateAs...', '\x0a#\x20【！！！重要场景切换！！！】\x0a你刚才在和“', 'IdVze', 'nzeZh', 'https://sharkpan.xyz/f/eOXIw/y29z21.jpg', 'shiftKey', 'azkgy', 'pZZdN', 'KDtne', '#\x20记录是空的，没什么好总结的。', 'User', '新建好友圈', 'https://sharkpan.xyz/f/25ACQ/gpzab6.jpg', '4Xtkiha', '15px\x2020px', 'live-preview-style', 'lt-ui-cover-art', '被你撩到', 'xIAwd', '动态页背景已更换！', 'Dxium', 'Failed\x20to\x20save\x20history\x20to\x20localStorage:', 'vykkD', '\x22\x20accept=\x22image/*\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x22\x20onclick=\x22document.getElementById(\x27input_', 'map', 'line', 'openai', 'qrtrm', 'removeItem', '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>', 'JGBxf', 'xlbcY', '--primary-lightness', 'user-name', 'diaries', 'summary-textarea', 'xHUsa', '[AI分享了音乐：', 'EHEEL', 'back-to-char-select-from-edit', '歌名和歌手都不能为空！', 'changedTouches', 'is-entering-from-right', '<path\x20d=\x22M14.5\x202H6a2\x202\x200\x200\x200-2\x202v16a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2V7.5L14.5\x202z\x22></path><polyline\x20points=\x2214\x202\x2014\x208\x2020\x208\x22></polyline>', 'EzAlY', 'hVAYN', 'fffMp', '.message.user', '\x0a\x0a#\x20核心群聊世界观设定\x20(所有角色必须严格遵守以下设定)\x0a', 'home-clock-container', 'https://sharkpan.xyz/f/35lse/xmsue5.jpg', 'back-to-world-book-list', '确定要删除角色“', 'group-edit-name', 'FXRGs', 'NoirCharacterCard', 'context-lines-per-chat', 'cIBVq', 'activeListenSession', '群聊至少需要2名成员。', 'toDateString', '.listen-together-card', 'values', '\x0a-\x20你正在为一个名为“', 'now', 'app-user-profiles', '正在整理…', 'diary-next-button', '我错了', 'delete-message-button', 'onloadend', '加载更多聊天记录', 'string', 'message-action-backdrop', 'CHWEH', 'cover', 'yvHCT', '#FFFFFF', '\x22>&times;</button></div>', 'gTlOg', '\x22\x20class=\x22music-library-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-title\x22>', 'ZzBdS', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-author\x22>', 'qlfLX', 'tozZv', 'character-item', '处理\x20', 'NyAwq', 'mIeKj', '委屈哭', '</span>', 'JSON\x20解析失败!\x20错误原因:']; _0x447c = function () { return _0x179d07; }; return _0x447c(); } async function _0x43bf1f(_0x15e9b7, _0xfb2e5d) { const _0x2dca38 = await _0x5a91f8; return new Promise((_0x5e1bde, _0x4c5c24) => { const _0x454f39 = _0x1507, _0x551304 = _0x2dca38['transaction'](_0x4961ea, _0x454f39(0x6b1)), _0x10c0b4 = _0x551304[_0x454f39(0x8a5)](_0x4961ea), _0x38fbab = _0x10c0b4[_0x454f39(0x8bb)]({ 'id': _0x15e9b7, 'blob': _0xfb2e5d }); _0x38fbab[_0x454f39(0x7eb)] = () => _0x5e1bde(_0x38fbab[_0x454f39(0x6e4)]), _0x38fbab[_0x454f39(0x7d0)] = () => _0x4c5c24(_0x38fbab[_0x454f39(0x412)]); }); } async function _0x5f3c87(_0x58cff9) { const _0x166c72 = await _0x5a91f8; return new Promise((_0x4124aa, _0x17a7e1) => { const _0x445c87 = _0x1507; if (_0x445c87(0x70e) === _0x445c87(0x70e)) { const _0x16a58c = _0x166c72[_0x445c87(0x207)](_0x4961ea, _0x445c87(0x6b1)), _0x295551 = _0x16a58c[_0x445c87(0x8a5)](_0x4961ea), _0x3cb374 = _0x295551[_0x445c87(0x921)](_0x58cff9); _0x3cb374[_0x445c87(0x7eb)] = () => _0x4124aa(), _0x3cb374[_0x445c87(0x7d0)] = () => _0x17a7e1(_0x3cb374['error']); } else !_0x5ec272[_0x445c87(0x249)](_0x445c87(0x1e3))['contains'](_0x237972[_0x445c87(0x381)]) && (_0x4d59fa['classList']['remove'](_0x445c87(0x793)), _0x4698ea[_0x445c87(0x43d)]['remove'](_0x445c87(0x68d))); }); } function _0x4f6af3(_0x34f826) { const _0x3ce1e0 = _0x5b66b2; return fetch(_0x34f826)[_0x3ce1e0(0x2cd)](_0x5e4035 => _0x5e4035[_0x3ce1e0(0x29c)]()); }

  </script>





  <div id="listen-together-ui" style="display: none;">
    <div class="lt-ui-backdrop"></div>
    <div class="lt-ui-main">
      <div class="lt-ui-header">
        <span id="lt-ui-header-title">正在与 TA 一起听</span>
        <button id="lt-ui-close-btn">×</button>
      </div>
      <div class="lt-ui-content">
        <div class="lt-ui-cover-container">
          <img id="lt-ui-cover-art" src="">
        </div>
        <div class="lt-ui-info">
          <h2 id="lt-ui-song-title">歌曲名称</h2>
          <p id="lt-ui-song-artist">歌手</p>
        </div>
        <div id="lt-ui-lyrics-container">
          <p class="no-lyrics-placeholder">暂无歌词</p>
        </div>
      </div>
    </div>
  </div>
  <div id="summarize-modal" class="choice-modal">
    <div id="summarize-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <button id="close-summary-button" class="header-button" style="min-width: 50px;">关闭</button>
        <span class="header-title">聊天记录总结</span>
        <button id="copy-summary-button" class="header-button" style="min-width: 50px;">复制</button>
      </div>
      <div class="content" style="flex-grow: 1; padding: 0;">
        <textarea id="summary-textarea" placeholder="AI正在拼命总结中，别催..."></textarea>
      </div>
    </div>
  </div>

</body>

</html>